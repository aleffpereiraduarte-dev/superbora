(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9327],{7374:function(e,a,s){Promise.resolve().then(s.bind(s,8246))},4445:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});var t=s(7437),n=s(8253);function r(e){let{section:a,children:s}=e,{hasPermission:r}=(0,n.q)();return r(a)?(0,t.jsx)(t.Fragment,{children:s}):(0,t.jsxs)("div",{className:"role-denied",children:[(0,t.jsx)("div",{className:"role-denied-icon",children:"\uD83D\uDD12"}),(0,t.jsx)("h2",{children:"Acesso Negado"}),(0,t.jsx)("p",{children:"Voce nao tem permissao para acessar esta secao."}),(0,t.jsx)("p",{className:"role-denied-hint",children:"Contate o administrador para solicitar acesso."})]})}},1656:function(e,a,s){"use strict";s.d(a,{X:function(){return l},Z:function(){return r}});var t=s(7437);let n={success:"badge-success",warning:"badge-warning",danger:"badge-danger",info:"badge-info",neutral:"badge-neutral"};function r(e){let{label:a,variant:s="neutral"}=e;return(0,t.jsx)("span",{className:"badge ".concat(n[s]||n.neutral),children:a})}function l(e){return({pendente:"warning",confirmado:"info",preparando:"info",pronto:"info",coletado:"info",em_entrega:"warning",entregue:"success",cancelado:"danger",recusado:"danger",ativo:"success",inativo:"neutral",bloqueado:"danger",online:"success",offline:"neutral",aprovado:"success",reprovado:"danger",pago:"success",pendente_pagamento:"warning",processando:"info",aberto:"warning",resolvido:"success",fechado:"neutral"})[e]||"neutral"}},9246:function(e,a,s){"use strict";s.d(a,{Z:function(){return i}});var t=s(7437),n=s(2265);function r(e){let{value:a,onChange:s,placeholder:r="Buscar...",delay:l=300}=e,[i,c]=(0,n.useState)(a||""),d=(0,n.useRef)(null);return(0,n.useEffect)(()=>{c(a||"")},[a]),(0,t.jsxs)("div",{className:"search-input-wrapper",children:[(0,t.jsx)("span",{className:"search-input-icon",children:"\uD83D\uDD0D"}),(0,t.jsx)("input",{type:"text",className:"search-input",value:i,onChange:e=>{let a=e.target.value;c(a),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{null==s||s(a)},l)},placeholder:r}),i&&(0,t.jsx)("button",{className:"search-input-clear",onClick:()=>{c(""),null==s||s("")},children:"✕"})]})}var l=s(4420);function i(e){let{columns:a=[],data:s=[],loading:i=!1,searchable:c=!0,pageSize:d=15,emptyMessage:o="Nenhum registro encontrado",onRowClick:u}=e,[h,m]=(0,n.useState)(""),[v,p]=(0,n.useState)(null),[x,j]=(0,n.useState)("asc"),[g,b]=(0,n.useState)(1),N=(0,n.useMemo)(()=>{if(!h)return s;let e=h.toLowerCase();return s.filter(s=>a.some(a=>{let t=s[a.key];return null!=t&&String(t).toLowerCase().includes(e)}))},[s,h,a]),f=(0,n.useMemo)(()=>v?[...N].sort((e,a)=>{var s,t;let n=null!==(s=e[v])&&void 0!==s?s:"",r=null!==(t=a[v])&&void 0!==t?t:"";if("number"==typeof n&&"number"==typeof r)return"asc"===x?n-r:r-n;let l=String(n).localeCompare(String(r));return"asc"===x?l:-l}):N,[N,v,x]),y=Math.max(1,Math.ceil(f.length/d)),k=f.slice((g-1)*d,g*d);(0,n.useEffect)(()=>{g>y&&b(1)},[g,y]);let _=e=>{v===e?j(e=>"asc"===e?"desc":"asc"):(p(e),j("asc"))};return i?(0,t.jsxs)("div",{className:"datatable",children:[c&&(0,t.jsx)("div",{className:"datatable-toolbar",children:(0,t.jsx)(r,{value:"",onChange:()=>{},placeholder:"Buscar..."})}),(0,t.jsx)("div",{className:"datatable-skeleton",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsx)("div",{className:"skeleton-row",children:a.map((e,a)=>(0,t.jsx)("div",{className:"skeleton-cell"},a))},s))})]}):(0,t.jsxs)("div",{className:"datatable",children:[c&&(0,t.jsxs)("div",{className:"datatable-toolbar",children:[(0,t.jsx)(r,{value:h,onChange:e=>{m(e),b(1)},placeholder:"Buscar na tabela..."}),(0,t.jsxs)("span",{className:"datatable-count",children:[N.length," registro(s)"]})]}),(0,t.jsx)("div",{className:"datatable-wrapper",children:(0,t.jsxs)("table",{className:"datatable-table",children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{children:a.map(e=>(0,t.jsxs)("th",{onClick:()=>!1!==e.sortable&&_(e.key),className:!1!==e.sortable?"sortable":"",style:e.width?{width:e.width}:void 0,children:[e.label,v===e.key&&(0,t.jsx)("span",{className:"sort-indicator",children:"asc"===x?" ▲":" ▼"})]},e.key))})}),(0,t.jsx)("tbody",{children:0===k.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:a.length,className:"datatable-empty",children:o})}):k.map((e,s)=>(0,t.jsx)("tr",{onClick:()=>null==u?void 0:u(e),className:u?"clickable-row":"",children:a.map(a=>{var s;return(0,t.jsx)("td",{children:a.render?a.render(e[a.key],e):null!==(s=e[a.key])&&void 0!==s?s:"-"},a.key)})},e.id||s))})]})}),y>1&&(0,t.jsx)(l.Z,{page:g,totalPages:y,onPageChange:b})]})}},4420:function(e,a,s){"use strict";s.d(a,{Z:function(){return n}});var t=s(7437);function n(e){let{page:a,totalPages:s,onPageChange:n}=e,r=[],l=Math.max(1,a-Math.floor(2.5)),i=Math.min(s,l+5-1);i-l<4&&(l=Math.max(1,i-5+1));for(let e=l;e<=i;e++)r.push(e);return(0,t.jsxs)("div",{className:"pagination",children:[(0,t.jsx)("button",{className:"pagination-btn",disabled:a<=1,onClick:()=>n(a-1),children:"‹ Anterior"}),l>1&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{className:"pagination-btn",onClick:()=>n(1),children:"1"}),l>2&&(0,t.jsx)("span",{className:"pagination-dots",children:"..."})]}),r.map(e=>(0,t.jsx)("button",{className:"pagination-btn ".concat(e===a?"pagination-active":""),onClick:()=>n(e),children:e},e)),i<s&&(0,t.jsxs)(t.Fragment,{children:[i<s-1&&(0,t.jsx)("span",{className:"pagination-dots",children:"..."}),(0,t.jsx)("button",{className:"pagination-btn",onClick:()=>n(s),children:s})]}),(0,t.jsx)("button",{className:"pagination-btn",disabled:a>=s,onClick:()=>n(a+1),children:"Proximo ›"})]})}},6939:function(e,a,s){"use strict";s.d(a,{Z:function(){return l}});var t=s(7437),n=s(6971);let r={success:"&#10003;",error:"&#10007;",warning:"&#9888;",info:"&#8505;"};function l(){let{toasts:e,removeToast:a}=(0,n.l)();return 0===e.length?null:(0,t.jsx)("div",{className:"toast-container",children:e.map(e=>(0,t.jsxs)("div",{className:"toast toast-".concat(e.type),children:[(0,t.jsx)("span",{className:"toast-icon",dangerouslySetInnerHTML:{__html:r[e.type]||r.info}}),(0,t.jsx)("span",{className:"toast-message",children:e.message}),(0,t.jsx)("button",{className:"toast-close",onClick:()=>a(e.id),children:"✕"})]},e.id))})}},8246:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return p}});var t=s(7437),n=s(2265),r=s(8779),l=s(4477),i=s(4445),c=s(9246),d=s(1656),o=s(6939),u=s(8789),h=s(6971),m=s(6428);function v(){var e;let{collapsed:a}=(0,u.A)(),{success:s,error:r}=(0,h.l)(),[i,v]=(0,n.useState)([]),[p,x]=(0,n.useState)(!0),[j,g]=(0,n.useState)(""),[b,N]=(0,n.useState)(""),[f,y]=(0,n.useState)(null);(0,n.useEffect)(()=>{_(),k()},[j,b]);let k=async()=>{try{let e=await (0,m.SC)("/tickets.php?view=sla");y(e.sla||null)}catch(e){console.warn("SLA load failed:",e)}},_=async()=>{x(!0);try{let e=new URLSearchParams;j&&e.set("status",j),b&&e.set("priority",b);let a=e.toString()?"?".concat(e.toString()):"",s=await (0,m.SC)("/tickets.php".concat(a));v(s.tickets||s.data||[])}catch(e){r("Erro ao carregar tickets")}finally{x(!1)}},w=async e=>{try{await (0,m.sg)("/tickets.php",{ticket_id:e.id||e.ticket_id,action:"close"}),s("Ticket fechado"),_()}catch(e){r("Erro: "+e.message)}},C=e=>({alta:"danger",high:"danger",media:"warning",medium:"warning",baixa:"info",low:"info"})[e]||"neutral",S=[{key:"id",label:"ID",render:(e,a)=>(0,t.jsxs)("strong",{children:["#",e||a.ticket_id]})},{key:"subject",label:"Assunto",render:(e,a)=>(0,t.jsx)("a",{href:"/suporte/detalhe?id=".concat(a.id||a.ticket_id),style:{color:"var(--primary)",textDecoration:"none"},children:e||a.assunto||"-"})},{key:"customer_name",label:"Cliente",render:(e,a)=>e||a.cliente_nome||"-"},{key:"category",label:"Categoria",render:(e,a)=>(0,t.jsx)(d.Z,{label:e||a.categoria||"geral",variant:"info"})},{key:"priority",label:"Prioridade",render:(e,a)=>(0,t.jsx)(d.Z,{label:e||a.prioridade||"media",variant:C(e||a.prioridade)})},{key:"assigned_to",label:"Responsavel",render:(e,a)=>e||a.responsavel||"-"},{key:"status",label:"Status",render:e=>(0,t.jsx)(d.Z,{label:e||"aberto",variant:(0,d.X)(e||"aberto")})},{key:"created_at",label:"Aberto em",render:(e,a)=>e||a.data||"-"},{key:"updated_at",label:"Ultima Atualizacao",render:(e,a)=>e||a.atualizado_em||"-"},{key:"actions",label:"Acoes",sortable:!1,render:(e,a)=>(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("a",{href:"/suporte/detalhe?id=".concat(a.id||a.ticket_id),className:"btn btn-sm btn-secondary",children:"Ver"}),("aberto"===a.status||"open"===a.status)&&(0,t.jsx)("button",{className:"btn btn-sm btn-warning",onClick:e=>{e.stopPropagation(),w(a)},children:"Fechar"})]})}];return(0,t.jsxs)("div",{className:"admin-layout",children:[(0,t.jsx)(l.Z,{}),(0,t.jsxs)("main",{className:"admin-main ".concat(a?"main-collapsed":""),children:[(0,t.jsxs)("div",{className:"page-header",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"page-title",children:"Suporte"}),(0,t.jsx)("p",{className:"page-subtitle",children:"Central de tickets de suporte"})]}),(0,t.jsx)("div",{className:"page-actions",children:(0,t.jsx)("button",{className:"btn btn-secondary",onClick:_,children:"Atualizar"})})]}),f&&(0,t.jsxs)("div",{className:"stats-grid",style:{marginBottom:"1.5rem"},children:[(0,t.jsxs)("div",{className:"stats-card",children:[(0,t.jsx)("div",{className:"stats-card-value",children:f.total||0}),(0,t.jsx)("div",{className:"stats-card-label",children:"Total Tickets"})]}),(0,t.jsxs)("div",{className:"stats-card",children:[(0,t.jsx)("div",{className:"stats-card-value",style:{color:"var(--warning)"},children:f.open||0}),(0,t.jsx)("div",{className:"stats-card-label",children:"Em Aberto"})]}),(0,t.jsxs)("div",{className:"stats-card",children:[(0,t.jsx)("div",{className:"stats-card-value",style:{color:"var(--success)"},children:f.resolved||0}),(0,t.jsx)("div",{className:"stats-card-label",children:"Resolvidos"})]}),(0,t.jsxs)("div",{className:"stats-card",children:[(0,t.jsxs)("div",{className:"stats-card-value",children:[f.avg_first_response_hours||0,"h"]}),(0,t.jsx)("div",{className:"stats-card-label",children:"Tempo Medio 1a Resposta"})]}),(0,t.jsxs)("div",{className:"stats-card",children:[(0,t.jsxs)("div",{className:"stats-card-value",children:[f.avg_resolution_hours||0,"h"]}),(0,t.jsx)("div",{className:"stats-card-label",children:"Tempo Medio Resolucao"})]}),(0,t.jsxs)("div",{className:"stats-card",children:[(0,t.jsxs)("div",{className:"stats-card-value",style:{color:f.resolved_24h_pct>=80?"var(--success)":"var(--danger)"},children:[f.resolved_24h_pct||0,"%"]}),(0,t.jsx)("div",{className:"stats-card-label",children:"Resolvidos em 24h"})]}),(0,t.jsxs)("div",{className:"stats-card",children:[(0,t.jsxs)("div",{className:"stats-card-value",style:{color:f.resolved_72h_pct>=90?"var(--success)":"var(--warning)"},children:[f.resolved_72h_pct||0,"%"]}),(0,t.jsx)("div",{className:"stats-card-label",children:"Resolvidos em 72h"})]}),(0,t.jsxs)("div",{className:"stats-card",children:[(0,t.jsx)("div",{className:"stats-card-value",children:f.closed||0}),(0,t.jsx)("div",{className:"stats-card-label",children:"Fechados"})]})]}),(null==f?void 0:null===(e=f.top_categories)||void 0===e?void 0:e.length)>0&&(0,t.jsxs)("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--bg-card)",borderRadius:"8px",border:"1px solid var(--border)"},children:[(0,t.jsx)("h3",{style:{margin:"0 0 0.75rem",fontSize:"0.875rem",fontWeight:600},children:"Top Categorias (30 dias)"}),(0,t.jsx)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:f.top_categories.map((e,a)=>(0,t.jsxs)("span",{className:"badge badge-info",style:{fontSize:"0.75rem"},children:[e.category,": ",e.total]},a))})]}),(0,t.jsxs)("div",{className:"filters-bar",children:[(0,t.jsxs)("select",{className:"form-select",value:j,onChange:e=>g(e.target.value),children:[(0,t.jsx)("option",{value:"",children:"Todos Status"}),(0,t.jsx)("option",{value:"aberto",children:"Aberto"}),(0,t.jsx)("option",{value:"em_andamento",children:"Em Andamento"}),(0,t.jsx)("option",{value:"resolvido",children:"Resolvido"}),(0,t.jsx)("option",{value:"fechado",children:"Fechado"})]}),(0,t.jsxs)("select",{className:"form-select",value:b,onChange:e=>N(e.target.value),children:[(0,t.jsx)("option",{value:"",children:"Todas Prioridades"}),(0,t.jsx)("option",{value:"alta",children:"Alta"}),(0,t.jsx)("option",{value:"media",children:"Media"}),(0,t.jsx)("option",{value:"baixa",children:"Baixa"})]})]}),(0,t.jsx)(c.Z,{columns:S,data:i,loading:p,emptyMessage:"Nenhum ticket encontrado"})]}),(0,t.jsx)(o.Z,{})]})}function p(){return(0,t.jsx)(r.Z,{children:(0,t.jsx)(i.Z,{section:"support",children:(0,t.jsx)(v,{})})})}}},function(e){e.O(0,[3448,1006,2971,2117,1744],function(){return e(e.s=7374)}),_N_E=e.O()}]);
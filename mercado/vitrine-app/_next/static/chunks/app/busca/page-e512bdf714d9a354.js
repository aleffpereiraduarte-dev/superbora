(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[15],{5445:function(e,s,a){Promise.resolve().then(a.bind(a,6443))},6428:function(e,s,a){"use strict";a.d(s,{LP:function(){return n},QW:function(){return u},SC:function(){return i},o4:function(){return c},sg:function(){return l}});let t="/api/mercado",r="superbora_token";function n(){return localStorage.getItem(r)}function c(e){e?localStorage.setItem(r,e):localStorage.removeItem(r)}function o(){let e=n();return e?{Authorization:"Bearer ".concat(e)}:{}}async function i(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URL(t+e,window.location.origin);Object.entries(s).forEach(e=>{let[s,t]=e;null!=t&&""!==t&&a.searchParams.set(s,t)});let r=await fetch(a.toString(),{credentials:"include",headers:o()});if(!r.ok){let e=await r.json().catch(()=>null);throw Error((null==e?void 0:e.message)||"API error: ".concat(r.status," ").concat(r.statusText))}let n=await r.json();if(!n.success)throw Error(n.message||"Erro desconhecido na API");return n.data}async function l(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URL(t+e,window.location.origin),r=await fetch(a.toString(),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...o()},body:JSON.stringify(s)}),n=await r.json().catch(()=>null);if(!r.ok||!(null==n?void 0:n.success))throw Error((null==n?void 0:n.message)||"API error: ".concat(r.status));return n.data}async function u(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URL(t+e,window.location.origin);Object.entries(s).forEach(e=>{let[s,t]=e;null!=t&&""!==t&&a.searchParams.set(s,t)});let r=await fetch(a.toString(),{method:"DELETE",credentials:"include",headers:o()}),n=await r.json().catch(()=>null);if(!r.ok||!(null==n?void 0:n.success))throw Error((null==n?void 0:n.message)||"API error: ".concat(r.status));return n.data}},6443:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return u}});var t=a(7437),r=a(2265),n=a(9376),c=a(6428),o=a(7650),i=a(940),l=a.n(i);function u(){(0,n.useRouter)();let[e,s]=(0,r.useState)(""),[a,i]=(0,r.useState)({stores:[],products:[]}),[u,_]=(0,r.useState)(!1),[d,m]=(0,r.useState)(!1),h=(0,r.useCallback)(async e=>{if(!e||e.length<2){i({stores:[],products:[]}),m(!1);return}_(!0),m(!0);try{let[s,a]=await Promise.all([(0,c.SC)("/parceiros/vitrine.php",{busca:e,limit:5}).catch(()=>[]),(0,c.SC)("/produtos/buscar-global.php",{q:e,limit:10}).catch(()=>({produtos:[]}))]);i({stores:Array.isArray(s)?s:(null==s?void 0:s.parceiros)||[],products:(null==a?void 0:a.produtos)||a||[]})}catch(e){i({stores:[],products:[]})}finally{_(!1)}},[]);(0,r.useEffect)(()=>{let s=setTimeout(()=>h(e),400);return()=>clearTimeout(s)},[e,h]);let g=a.stores.length>0||a.products.length>0;return(0,t.jsxs)("div",{className:l().page,children:[(0,t.jsx)("div",{className:l().header,children:(0,t.jsx)("div",{className:l().title,children:"Buscar"})}),(0,t.jsx)("div",{className:l().searchBar,children:(0,t.jsx)("input",{type:"text",value:e,onChange:e=>s(e.target.value),className:l().searchInput,placeholder:"Buscar lojas e produtos...",autoFocus:!0})}),u&&(0,t.jsx)("div",{className:l().loader,children:(0,t.jsx)("div",{className:l().spinner})}),!u&&d&&!g&&(0,t.jsxs)("div",{className:l().empty,children:[(0,t.jsx)("div",{className:l().emptyIcon,children:(0,t.jsxs)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[(0,t.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,t.jsx)("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})}),(0,t.jsx)("div",{className:l().emptyTitle,children:"Nenhum resultado"}),(0,t.jsx)("div",{className:l().emptyText,children:"Tente buscar com outros termos"})]}),!u&&a.stores.length>0&&(0,t.jsxs)("div",{className:l().searchGroup,children:[(0,t.jsx)("div",{className:l().searchGroupTitle,children:"Lojas"}),a.stores.map(e=>(0,t.jsxs)("div",{className:l().searchResult,onClick:()=>{window.dispatchEvent(new CustomEvent("open-mini-loja",{detail:{partnerId:e.partner_id||e.id}}))},children:[e.logo?(0,t.jsx)("img",{src:e.logo,alt:"",className:l().searchResultImg}):(0,t.jsx)("div",{className:l().searchResultImg,style:{display:"flex",alignItems:"center",justifyContent:"center",color:"var(--color-text-muted)",fontWeight:700,fontSize:18},children:(e.trade_name||e.name||"?")[0]}),(0,t.jsxs)("div",{className:l().searchResultInfo,children:[(0,t.jsx)("div",{className:l().searchResultName,children:e.trade_name||e.name}),(0,t.jsxs)("div",{className:l().searchResultSub,children:[e.categoria||"Loja"," ",e.rating?" - ".concat(Number(e.rating).toFixed(1)):""]})]})]},e.partner_id||e.id))]}),!u&&a.products.length>0&&(0,t.jsxs)("div",{className:l().searchGroup,children:[(0,t.jsx)("div",{className:l().searchGroupTitle,children:"Produtos"}),a.products.map(e=>{let s=e.special_price&&parseFloat(e.special_price)>0&&parseFloat(e.special_price)<parseFloat(e.price)?parseFloat(e.special_price):parseFloat(e.price);return(0,t.jsxs)("div",{className:l().searchResult,children:[e.image&&(0,t.jsx)("img",{src:e.image,alt:"",className:l().searchResultImg}),(0,t.jsxs)("div",{className:l().searchResultInfo,children:[(0,t.jsx)("div",{className:l().searchResultName,children:e.name||e.nome}),(0,t.jsx)("div",{className:l().searchResultSub,children:e.partner_name||e.loja||""}),(0,t.jsx)("div",{className:l().searchResultPrice,children:(0,o.o_)(s)})]})]},e.product_id||e.id)})]}),!d&&!u&&(0,t.jsxs)("div",{className:l().empty,children:[(0,t.jsx)("div",{className:l().emptyIcon,children:(0,t.jsxs)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[(0,t.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,t.jsx)("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})}),(0,t.jsx)("div",{className:l().emptyTitle,children:"Busque por lojas ou produtos"}),(0,t.jsx)("div",{className:l().emptyText,children:"Digite pelo menos 2 caracteres para buscar"})]})]})}},7650:function(e,s,a){"use strict";function t(e){return null==e||isNaN(e)?"R$ 0,00":new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}function r(e){if(!e)return"";let s=e.replace(/\D/g,"");return 8!==s.length?e:"".concat(s.slice(0,5),"-").concat(s.slice(5))}function n(e){if(!e)return"";if(e<60)return"".concat(e," min");let s=Math.floor(e/60),a=e%60;return a>0?"".concat(s,"h").concat(a,"min"):"".concat(s,"h")}function c(e){return e?Number(e).toFixed(1):"0.0"}function o(e){return null==e?"":0===e?"Gratis":t(e)}a.d(s,{A6:function(){return c},ci:function(){return o},gN:function(){return n},hR:function(){return r},o_:function(){return t}})},9376:function(e,s,a){"use strict";var t=a(5475);a.o(t,"usePathname")&&a.d(s,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(s,{useSearchParams:function(){return t.useSearchParams}})},940:function(e){e.exports={page:"Pages_page__1BOVN",header:"Pages_header__jGmk8",backBtn:"Pages_backBtn__mTFay",title:"Pages_title__n2U_m",profileCard:"Pages_profileCard__wMFAT",profileAvatar:"Pages_profileAvatar__J6d58",profileName:"Pages_profileName__eHajI",profileEmail:"Pages_profileEmail__BG4As",section:"Pages_section__HV85g",sectionTitle:"Pages_sectionTitle__Tp1xX",menuItem:"Pages_menuItem___rXUi",menuIcon:"Pages_menuIcon__NOqLG",menuLabel:"Pages_menuLabel__Kl19j",menuArrow:"Pages_menuArrow__SdUUa",logoutBtn:"Pages_logoutBtn__f_kNh",formSection:"Pages_formSection__U2cjn",formRow:"Pages_formRow__JYsGc",formLabel:"Pages_formLabel__bb7Gh",formInput:"Pages_formInput__HPy8g",saveBtn:"Pages_saveBtn__I8a11",addressItem:"Pages_addressItem__WoRA7",addressBadge:"Pages_addressBadge__sJUoT",addressText:"Pages_addressText__d_ZO9",addressDelete:"Pages_addressDelete__cnadr",searchBar:"Pages_searchBar__5Dkwd",searchInput:"Pages_searchInput__uwXko",searchGroup:"Pages_searchGroup__GTpFY",searchGroupTitle:"Pages_searchGroupTitle__G7oMv",searchResult:"Pages_searchResult__pHApo",searchResultImg:"Pages_searchResultImg__Rm_38",searchResultInfo:"Pages_searchResultInfo___2tNW",searchResultName:"Pages_searchResultName__Uxe2e",searchResultSub:"Pages_searchResultSub__T6Igl",searchResultPrice:"Pages_searchResultPrice__0aoBM",favGrid:"Pages_favGrid__EeFq2",favCard:"Pages_favCard__2v7V3",favImg:"Pages_favImg__gibhm",favInfo:"Pages_favInfo__FUDHC",favName:"Pages_favName__iEqsH",favSub:"Pages_favSub__WiVId",favRemove:"Pages_favRemove__D9W9q",empty:"Pages_empty__453IL",emptyIcon:"Pages_emptyIcon__KgY7u",emptyTitle:"Pages_emptyTitle__DydbF",emptyText:"Pages_emptyText__j_lO2",emptyBtn:"Pages_emptyBtn__t6JhT",loader:"Pages_loader__CfUaA",spinner:"Pages_spinner__vfHyj",spin:"Pages_spin__EwJus"}}},function(e){e.O(0,[315,971,117,744],function(){return e(e.s=5445)}),_N_E=e.O()}]);
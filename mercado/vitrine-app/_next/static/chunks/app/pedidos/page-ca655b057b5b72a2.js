(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[429],{2320:function(e,t,r){Promise.resolve().then(r.bind(r,8725))},6428:function(e,t,r){"use strict";r.d(t,{LP:function(){return i},QW:function(){return c},SC:function(){return o},o4:function(){return s},sg:function(){return l}});let n="/api/mercado",a="superbora_token";function i(){return localStorage.getItem(a)}function s(e){e?localStorage.setItem(a,e):localStorage.removeItem(a)}function d(){let e=i();return e?{Authorization:"Bearer ".concat(e)}:{}}async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new URL(n+e,window.location.origin);Object.entries(t).forEach(e=>{let[t,n]=e;null!=n&&""!==n&&r.searchParams.set(t,n)});let a=await fetch(r.toString(),{credentials:"include",headers:d()});if(!a.ok){let e=await a.json().catch(()=>null);throw Error((null==e?void 0:e.message)||"API error: ".concat(a.status," ").concat(a.statusText))}let i=await a.json();if(!i.success)throw Error(i.message||"Erro desconhecido na API");return i.data}async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new URL(n+e,window.location.origin),a=await fetch(r.toString(),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...d()},body:JSON.stringify(t)}),i=await a.json().catch(()=>null);if(!a.ok||!(null==i?void 0:i.success))throw Error((null==i?void 0:i.message)||"API error: ".concat(a.status));return i.data}async function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new URL(n+e,window.location.origin);Object.entries(t).forEach(e=>{let[t,n]=e;null!=n&&""!==n&&r.searchParams.set(t,n)});let a=await fetch(r.toString(),{method:"DELETE",credentials:"include",headers:d()}),i=await a.json().catch(()=>null);if(!a.ok||!(null==i?void 0:i.success))throw Error((null==i?void 0:i.message)||"API error: ".concat(a.status));return i.data}},8779:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var n=r(7437),a=r(2265),i=r(9376),s=r(7128);function d(e){let{children:t}=e,{isAuthenticated:r,loading:d}=(0,s.a)(),o=(0,i.useRouter)();return((0,a.useEffect)(()=>{if(!d&&!r){let e=window.location.pathname;o.push("/login?return=".concat(encodeURIComponent(e)))}},[d,r,o]),d)?(0,n.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:(0,n.jsx)("div",{style:{width:32,height:32,border:"3px solid var(--color-border)",borderTopColor:"var(--color-accent)",borderRadius:"50%",animation:"spin 0.8s linear infinite"}})}):r?t:null}},7128:function(e,t,r){"use strict";r.d(t,{H:function(){return d},a:function(){return o}});var n=r(7437),a=r(2265),i=r(6428);let s=(0,a.createContext)(null);function d(e){let{children:t}=e,[r,d]=(0,a.useState)(null),[o,l]=(0,a.useState)(!0),c=(0,a.useCallback)(async()=>{if(!(0,i.LP)()){d(null),l(!1);return}try{let e=await (0,i.SC)("/auth/session.php");e.authenticated&&e.customer?d(e.customer):((0,i.o4)(null),d(null))}catch(e){(0,i.o4)(null),d(null)}finally{l(!1)}},[]);(0,a.useEffect)(()=>{c()},[c]);let u=(0,a.useCallback)(async(e,t)=>{let r=await (0,i.sg)("/auth/login.php",{email:e,senha:t});return(0,i.o4)(r.token),d(r.customer),r.customer},[]),m=(0,a.useCallback)(async e=>{let t=await (0,i.sg)("/auth/register.php",e);return(0,i.o4)(t.token),d(t.customer),t.customer},[]),_=(0,a.useCallback)(()=>{(0,i.o4)(null),d(null)},[]);return(0,n.jsx)(s.Provider,{value:{customer:r,loading:o,isAuthenticated:!!r,login:u,register:m,logout:_,refreshSession:c},children:t})}function o(){let e=(0,a.useContext)(s);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},8725:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return g}});var n=r(7437),a=r(2265),i=r(9376),s=r(7648),d=r(8779),o=r(6428),l=r(7650),c=r(8321),u=r.n(c);let m=[{key:"",label:"Todos"},{key:"pendente,confirmado,preparando,pronto,saiu_entrega",label:"Em andamento"},{key:"entregue",label:"Entregues"},{key:"cancelado",label:"Cancelados"}],_={pendente:"Pendente",confirmado:"Confirmado",preparando:"Preparando",pronto:"Pronto",saiu_entrega:"Saiu p/ entrega",entregue:"Entregue",cancelado:"Cancelado",recusado:"Recusado"};function h(e){return({pendente:u().badgePendente,confirmado:u().badgeConfirmado,preparando:u().badgePreparando,pronto:u().badgePronto,saiu_entrega:u().badgeSaiuEntrega,entregue:u().badgeEntregue,cancelado:u().badgeCancelado,recusado:u().badgeCancelado})[e]||u().badgePendente}function p(e){if(!e)return"";let t=new Date(e);return t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})+" "+t.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}function g(){return(0,n.jsx)(d.Z,{children:(0,n.jsx)(f,{})})}function f(){let e=(0,i.useSearchParams)().get("id");return e?(0,n.jsx)(v,{orderId:e}):(0,n.jsx)(x,{})}function x(){let e=(0,i.useRouter)(),[t,r]=(0,a.useState)([]),[d,c]=(0,a.useState)(!0),[g,f]=(0,a.useState)(""),[x,v]=(0,a.useState)(1),[j,N]=(0,a.useState)(null);return(0,a.useEffect)(()=>{c(!0),(0,o.SC)("/orders/list.php",{status:g,page:x,limit:10}).then(e=>{r(e.orders||[]),N(e.pagination)}).catch(()=>r([])).finally(()=>c(!1))},[g,x]),(0,n.jsxs)("div",{className:u().page,children:[(0,n.jsx)("div",{className:u().header,children:(0,n.jsx)("div",{className:u().title,children:"Meus pedidos"})}),(0,n.jsx)("div",{className:u().filters,children:m.map(e=>(0,n.jsx)("button",{className:"".concat(u().filter," ").concat(g===e.key?u().filterActive:""),onClick:()=>{f(e.key),v(1)},children:e.label},e.key))}),d?(0,n.jsx)("div",{className:u().loader,children:(0,n.jsx)("div",{className:u().spinner})}):0===t.length?(0,n.jsxs)("div",{className:u().empty,children:[(0,n.jsx)("div",{className:u().emptyIcon,children:(0,n.jsxs)("svg",{width:"56",height:"56",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[(0,n.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),(0,n.jsx)("polyline",{points:"14 2 14 8 20 8"})]})}),(0,n.jsx)("div",{className:u().emptyTitle,children:"Nenhum pedido encontrado"}),(0,n.jsx)("div",{className:u().emptyText,children:"Faca seu primeiro pedido agora"}),(0,n.jsx)(s.default,{href:"/",className:u().emptyBtn,children:"Ver lojas"})]}):(0,n.jsxs)(n.Fragment,{children:[t.map(t=>{var r,a,i;return(0,n.jsxs)("div",{className:u().card,onClick:()=>e.push("/pedidos?id=".concat(t.id)),children:[(0,n.jsxs)("div",{className:u().cardTop,children:[(null===(r=t.partner)||void 0===r?void 0:r.logo)?(0,n.jsx)("img",{src:t.partner.logo,alt:"",className:u().cardLogo}):(0,n.jsx)("div",{className:u().cardLogoPlaceholder,children:((null===(a=t.partner)||void 0===a?void 0:a.name)||"?")[0]}),(0,n.jsxs)("div",{className:u().cardInfo,children:[(0,n.jsx)("div",{className:u().cardPartner,children:null===(i=t.partner)||void 0===i?void 0:i.name}),(0,n.jsx)("div",{className:u().cardDate,children:p(t.date)})]}),(0,n.jsx)("span",{className:"".concat(u().badge," ").concat(h(t.status)),children:_[t.status]||t.status})]}),(0,n.jsxs)("div",{className:u().cardBottom,children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:u().cardItems,children:[t.items_count," ",1===t.items_count?"item":"itens"]}),(0,n.jsx)("div",{className:u().cardNumber,children:t.order_number})]}),(0,n.jsx)("div",{className:u().cardTotal,children:(0,l.o_)(t.total)})]})]},t.id)}),j&&j.pages>1&&(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:8,marginTop:16},children:[x>1&&(0,n.jsx)("button",{className:u().filter,onClick:()=>v(x-1),children:"Anterior"}),(0,n.jsxs)("span",{style:{padding:"8px 16px",fontSize:14,color:"var(--color-text-secondary)"},children:[x," de ",j.pages]}),x<j.pages&&(0,n.jsx)("button",{className:u().filter,onClick:()=>v(x+1),children:"Proximo"})]})]})]})}function v(e){var t,r,d;let{orderId:c}=e,m=(0,i.useRouter)(),[g,f]=(0,a.useState)(null),[x,v]=(0,a.useState)(!0),[j,N]=(0,a.useState)("");return((0,a.useEffect)(()=>{c&&(v(!0),(0,o.SC)("/orders/detail.php",{id:c}).then(e=>f(e.order)).catch(e=>N(e.message)).finally(()=>v(!1)))},[c]),x)?(0,n.jsx)("div",{className:u().page,children:(0,n.jsx)("div",{className:u().loader,children:(0,n.jsx)("div",{className:u().spinner})})}):j||!g?(0,n.jsx)("div",{className:u().page,children:(0,n.jsxs)("div",{className:u().empty,children:[(0,n.jsx)("div",{className:u().emptyTitle,children:"Pedido nao encontrado"}),(0,n.jsx)("div",{className:u().emptyText,children:j}),(0,n.jsx)(s.default,{href:"/pedidos",className:u().emptyBtn,children:"Ver meus pedidos"})]})}):(0,n.jsxs)("div",{className:u().page,children:[(0,n.jsxs)("div",{className:u().header,children:[(0,n.jsx)("button",{className:u().backBtn,onClick:()=>m.push("/pedidos"),children:(0,n.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("polyline",{points:"15 18 9 12 15 6"})})}),(0,n.jsx)("div",{children:(0,n.jsx)("div",{className:u().title,children:"Pedido"})})]}),(0,n.jsxs)("div",{className:u().detailSection,children:[(0,n.jsxs)("div",{className:u().detailHeader,children:[(0,n.jsx)("span",{className:u().orderNumber,children:g.order_number}),(0,n.jsx)("span",{className:"".concat(u().badge," ").concat(h(g.status)),children:_[g.status]||g.status})]}),(0,n.jsxs)("div",{className:u().detailPartner,children:[(null===(t=g.partner)||void 0===t?void 0:t.logo)?(0,n.jsx)("img",{src:g.partner.logo,alt:"",className:u().cardLogo}):(0,n.jsx)("div",{className:u().cardLogoPlaceholder,children:((null===(r=g.partner)||void 0===r?void 0:r.name)||"?")[0]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontWeight:600},children:null===(d=g.partner)||void 0===d?void 0:d.name}),(0,n.jsx)("div",{style:{fontSize:12,color:"var(--color-text-muted)"},children:p(g.date)})]})]}),g.address&&(0,n.jsxs)("div",{className:u().addressInfo,children:[(0,n.jsxs)("svg",{className:u().addressIcon,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,n.jsx)("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),(0,n.jsx)("circle",{cx:"12",cy:"10",r:"3"})]}),(0,n.jsx)("span",{children:g.address})]})]}),g.timeline&&g.timeline.length>0&&(0,n.jsxs)("div",{className:u().detailSection,children:[(0,n.jsx)("div",{style:{fontWeight:600,fontSize:16,marginBottom:16},children:"Acompanhamento"}),(0,n.jsx)("div",{className:u().timeline,children:g.timeline.map((e,t)=>(0,n.jsxs)("div",{className:u().timelineItem,children:[(0,n.jsx)("div",{className:"".concat(u().timelineDot," ").concat(e.completed?u().timelineDotDone:""," ").concat(e.current?u().timelineDotCurrent:""," ").concat(e.error?u().timelineDotError:"")}),t<g.timeline.length-1&&(0,n.jsx)("div",{className:"".concat(u().timelineLine," ").concat(e.completed?u().timelineLineDone:"")}),(0,n.jsx)("div",{className:"".concat(u().timelineLabel," ").concat(e.completed?u().timelineLabelDone:""),children:e.label}),e.date&&(0,n.jsx)("div",{className:u().timelineDate,children:p(e.date)})]},t))})]}),(0,n.jsxs)("div",{className:u().detailSection,children:[(0,n.jsx)("div",{style:{fontWeight:600,fontSize:16,marginBottom:12},children:"Itens do pedido"}),g.items.map((e,t)=>(0,n.jsxs)("div",{className:u().detailItem,children:[e.image&&(0,n.jsx)("img",{src:e.image,alt:"",className:u().detailItemImg}),(0,n.jsxs)("div",{className:u().detailItemInfo,children:[(0,n.jsx)("div",{className:u().detailItemName,children:e.name}),(0,n.jsxs)("div",{className:u().detailItemQty,children:["Qtd: ",e.quantity," x ",(0,l.o_)(e.price)]})]}),(0,n.jsx)("div",{className:u().detailItemPrice,children:(0,l.o_)(e.total)})]},t))]}),(0,n.jsxs)("div",{className:u().detailSection,children:[(0,n.jsx)("div",{style:{fontWeight:600,fontSize:16,marginBottom:12},children:"Pagamento"}),(0,n.jsxs)("div",{className:u().detailRow,children:[(0,n.jsx)("span",{children:"Subtotal"}),(0,n.jsx)("span",{children:(0,l.o_)(g.subtotal)})]}),(0,n.jsxs)("div",{className:u().detailRow,children:[(0,n.jsx)("span",{children:"Entrega"}),(0,n.jsx)("span",{children:0===g.delivery_fee?"Gratis":(0,l.o_)(g.delivery_fee)})]}),g.tip>0&&(0,n.jsxs)("div",{className:u().detailRow,children:[(0,n.jsx)("span",{children:"Gorjeta"}),(0,n.jsx)("span",{children:(0,l.o_)(g.tip)})]}),g.coupon_discount>0&&(0,n.jsxs)("div",{className:u().detailRow,style:{color:"var(--color-accent)"},children:[(0,n.jsx)("span",{children:"Desconto"}),(0,n.jsxs)("span",{children:["-",(0,l.o_)(g.coupon_discount)]})]}),(0,n.jsxs)("div",{className:u().detailTotal,children:[(0,n.jsx)("span",{children:"Total"}),(0,n.jsx)("span",{children:(0,l.o_)(g.total)})]}),(0,n.jsxs)("div",{style:{marginTop:8,fontSize:13,color:"var(--color-text-muted)"},children:["Pago com ","pix"===g.payment_method?"PIX":"credito"===g.payment_method?"Cartao de credito":g.payment_method]}),g.codigo_entrega&&(0,n.jsxs)("div",{style:{marginTop:12,padding:12,background:"var(--color-bg-muted)",borderRadius:8},children:[(0,n.jsx)("div",{style:{fontSize:12,color:"var(--color-text-muted)"},children:"Codigo de entrega"}),(0,n.jsx)("div",{style:{fontSize:20,fontWeight:700,fontFamily:"monospace",letterSpacing:4},children:g.codigo_entrega})]})]})]})}},7650:function(e,t,r){"use strict";function n(e){return null==e||isNaN(e)?"R$ 0,00":new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}function a(e){if(!e)return"";let t=e.replace(/\D/g,"");return 8!==t.length?e:"".concat(t.slice(0,5),"-").concat(t.slice(5))}function i(e){if(!e)return"";if(e<60)return"".concat(e," min");let t=Math.floor(e/60),r=e%60;return r>0?"".concat(t,"h").concat(r,"min"):"".concat(t,"h")}function s(e){return e?Number(e).toFixed(1):"0.0"}function d(e){return null==e?"":0===e?"Gratis":n(e)}r.d(t,{A6:function(){return s},ci:function(){return d},gN:function(){return i},hR:function(){return a},o_:function(){return n}})},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},8321:function(e){e.exports={page:"Orders_page__s84dz",header:"Orders_header__gY78e",backBtn:"Orders_backBtn__zJyQk",title:"Orders_title__2j4g7",filters:"Orders_filters__L_sRP",filter:"Orders_filter__c6pEa",filterActive:"Orders_filterActive__A95Nv",card:"Orders_card__wk7_m",cardTop:"Orders_cardTop__yXiVl",cardLogo:"Orders_cardLogo__Oiud6",cardLogoPlaceholder:"Orders_cardLogoPlaceholder__0BZBI",cardInfo:"Orders_cardInfo__duj_B",cardPartner:"Orders_cardPartner__vUP28",cardDate:"Orders_cardDate__z8Ga7",cardBottom:"Orders_cardBottom__vGV29",cardItems:"Orders_cardItems__gE0_P",cardTotal:"Orders_cardTotal__ipX_t",cardNumber:"Orders_cardNumber__LutSS",badge:"Orders_badge___6dP8",badgePendente:"Orders_badgePendente__JAdHZ",badgeConfirmado:"Orders_badgeConfirmado__LShqE",badgePreparando:"Orders_badgePreparando__Jx9mx",badgePronto:"Orders_badgePronto__kFMzO",badgeSaiuEntrega:"Orders_badgeSaiuEntrega__1Ke_a",badgeEntregue:"Orders_badgeEntregue__g35xb",badgeCancelado:"Orders_badgeCancelado__Xg7x_",detailSection:"Orders_detailSection__Fg__g",detailHeader:"Orders_detailHeader__Modau",orderNumber:"Orders_orderNumber__uns_u",detailPartner:"Orders_detailPartner__B_aEi",timeline:"Orders_timeline__9tXAH",timelineItem:"Orders_timelineItem__JwEQb",timelineDot:"Orders_timelineDot__XLA4S",timelineDotDone:"Orders_timelineDotDone__BGilb",timelineDotCurrent:"Orders_timelineDotCurrent__JyeWw",timelineDotError:"Orders_timelineDotError__Styfq",timelineLine:"Orders_timelineLine__Hm1Y_",timelineLineDone:"Orders_timelineLineDone__zEdgQ",timelineLabel:"Orders_timelineLabel__6mTbx",timelineLabelDone:"Orders_timelineLabelDone__VhpfH",timelineDate:"Orders_timelineDate__kobGe",detailItem:"Orders_detailItem__EMHa9",detailItemImg:"Orders_detailItemImg__JvyWZ",detailItemInfo:"Orders_detailItemInfo__djGPa",detailItemName:"Orders_detailItemName__t9vd4",detailItemQty:"Orders_detailItemQty__WgeKK",detailItemPrice:"Orders_detailItemPrice__0Od7o",detailRow:"Orders_detailRow__S_wxZ",detailTotal:"Orders_detailTotal__PHamy",empty:"Orders_empty__Kc5Sa",emptyIcon:"Orders_emptyIcon__Zcyy1",emptyTitle:"Orders_emptyTitle__B6Hqw",emptyText:"Orders_emptyText__AXA96",emptyBtn:"Orders_emptyBtn__EZDwV",loader:"Orders_loader__sTU6M",spinner:"Orders_spinner__XJaii",spin:"Orders_spin__Be9n0",reorderBtn:"Orders_reorderBtn__fGx5Q",addressInfo:"Orders_addressInfo__WI2rR",addressIcon:"Orders_addressIcon___YzJj"}}},function(e){e.O(0,[20,648,971,117,744],function(){return e(e.s=2320)}),_N_E=e.O()}]);
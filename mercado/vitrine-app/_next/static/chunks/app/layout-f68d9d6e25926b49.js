(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{3833:function(e,t,r){Promise.resolve().then(r.t.bind(r,7960,23)),Promise.resolve().then(r.bind(r,1241))},6428:function(e,t,r){"use strict";r.d(t,{LP:function(){return o},QW:function(){return u},SC:function(){return c},o4:function(){return i},sg:function(){return s}});let n="/api/mercado",a="superbora_token";function o(){return localStorage.getItem(a)}function i(e){e?localStorage.setItem(a,e):localStorage.removeItem(a)}function l(){let e=o();return e?{Authorization:"Bearer ".concat(e)}:{}}async function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new URL(n+e,window.location.origin);Object.entries(t).forEach(e=>{let[t,n]=e;null!=n&&""!==n&&r.searchParams.set(t,n)});let a=await fetch(r.toString(),{credentials:"include",headers:l()});if(!a.ok){let e=await a.json().catch(()=>null);throw Error((null==e?void 0:e.message)||"API error: ".concat(a.status," ").concat(a.statusText))}let o=await a.json();if(!o.success)throw Error(o.message||"Erro desconhecido na API");return o.data}async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new URL(n+e,window.location.origin),a=await fetch(r.toString(),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...l()},body:JSON.stringify(t)}),o=await a.json().catch(()=>null);if(!a.ok||!(null==o?void 0:o.success))throw Error((null==o?void 0:o.message)||"API error: ".concat(a.status));return o.data}async function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new URL(n+e,window.location.origin);Object.entries(t).forEach(e=>{let[t,n]=e;null!=n&&""!==n&&r.searchParams.set(t,n)});let a=await fetch(r.toString(),{method:"DELETE",credentials:"include",headers:l()}),o=await a.json().catch(()=>null);if(!a.ok||!(null==o?void 0:o.success))throw Error((null==o?void 0:o.message)||"API error: ".concat(a.status));return o.data}},7128:function(e,t,r){"use strict";r.d(t,{H:function(){return l},a:function(){return c}});var n=r(7437),a=r(2265),o=r(6428);let i=(0,a.createContext)(null);function l(e){let{children:t}=e,[r,l]=(0,a.useState)(null),[c,s]=(0,a.useState)(!0),u=(0,a.useCallback)(async()=>{if(!(0,o.LP)()){l(null),s(!1);return}try{let e=await (0,o.SC)("/auth/session.php");e.authenticated&&e.customer?l(e.customer):((0,o.o4)(null),l(null))}catch(e){(0,o.o4)(null),l(null)}finally{s(!1)}},[]);(0,a.useEffect)(()=>{u()},[u]);let d=(0,a.useCallback)(async(e,t)=>{let r=await (0,o.sg)("/auth/login.php",{email:e,senha:t});return(0,o.o4)(r.token),l(r.customer),r.customer},[]),h=(0,a.useCallback)(async e=>{let t=await (0,o.sg)("/auth/register.php",e);return(0,o.o4)(t.token),l(t.customer),t.customer},[]),f=(0,a.useCallback)(()=>{(0,o.o4)(null),l(null)},[]);return(0,n.jsx)(i.Provider,{value:{customer:r,loading:c,isAuthenticated:!!r,login:d,register:h,logout:f,refreshSession:u},children:t})}function c(){let e=(0,a.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},9146:function(e,t,r){"use strict";r.d(t,{Z:function(){return s},i:function(){return u}});var n=r(7437),a=r(2265),o=r(6428);let i=(0,a.createContext)(null),l="superbora_cart";function c(e,t){let r;switch(t.type){case"ADD_ITEM":{let{product:n,partnerId:a,partnerName:o}=t.payload;if(e.partnerId&&e.partnerId!==a)r={items:[{...n,quantity:1}],partnerId:a,partnerName:o};else{let t;let i=e.items.findIndex(e=>e.id===n.id);t=i>=0?e.items.map((e,t)=>t===i?{...e,quantity:e.quantity+1}:e):[...e.items,{...n,quantity:1}],r={...e,items:t,partnerId:a,partnerName:o}}break}case"REMOVE_ITEM":{let n;let{productId:a}=t.payload,o=e.items.findIndex(e=>e.id===a);if(o<0)return e;n=e.items[o].quantity>1?e.items.map((e,t)=>t===o?{...e,quantity:e.quantity-1}:e):e.items.filter((e,t)=>t!==o),r={...e,items:n,partnerId:n.length>0?e.partnerId:null,partnerName:n.length>0?e.partnerName:""};break}case"SET_ITEM_QTY":{let{productId:n,quantity:a}=t.payload;if(a<=0){let t=e.items.filter(e=>e.id!==n);r={...e,items:t,partnerId:t.length>0?e.partnerId:null,partnerName:t.length>0?e.partnerName:""}}else{let t=e.items.map(e=>e.id===n?{...e,quantity:a}:e);r={...e,items:t}}break}case"CLEAR":r={items:[],partnerId:null,partnerName:""};break;case"HYDRATE":return t.payload;default:return e}return!function(e){try{localStorage.setItem(l,JSON.stringify(e))}catch(e){}}(r),r}function s(e){let{children:t}=e,[r,s]=(0,a.useReducer)(c,{items:[],partnerId:null,partnerName:""}),u=(0,a.useRef)(null);(0,a.useEffect)(()=>{s({type:"HYDRATE",payload:function(){try{let e=localStorage.getItem(l);if(e)return JSON.parse(e)}catch(e){}return{items:[],partnerId:null,partnerName:""}}()})},[]),(0,a.useEffect)(()=>{if((r.items.length||r.partnerId)&&(0,o.LP)())return u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{(0,o.sg)("/cart/sync.php",{items:r.items,partner_id:r.partnerId}).catch(()=>{})},2e3),()=>{u.current&&clearTimeout(u.current)}},[r.items,r.partnerId]);let d=(0,a.useCallback)((e,t,r)=>{s({type:"ADD_ITEM",payload:{product:e,partnerId:t,partnerName:r}})},[]),h=(0,a.useCallback)(e=>{s({type:"REMOVE_ITEM",payload:{productId:e}})},[]),f=(0,a.useCallback)((e,t)=>{s({type:"SET_ITEM_QTY",payload:{productId:e,quantity:t}})},[]),m=(0,a.useCallback)(()=>{s({type:"CLEAR"})},[]),p=(0,a.useCallback)(e=>e.preco_promo&&e.preco_promo>0&&e.preco_promo<e.preco?e.preco_promo:e.preco,[]),g=r.items.reduce((e,t)=>e+p(t)*t.quantity,0),v=r.items.reduce((e,t)=>e+t.quantity,0),y=(0,a.useCallback)(e=>{let t=r.items.find(t=>t.id===e);return t?t.quantity:0},[r.items]);return(0,n.jsx)(i.Provider,{value:{items:r.items,partnerId:r.partnerId,partnerName:r.partnerName,subtotal:g,count:v,addItem:d,removeItem:h,setItemQty:f,clearCart:m,getItemQuantity:y,getItemPrice:p},children:t})}function u(){let e=(0,a.useContext)(i);if(!e)throw Error("useCartContext must be used within CartProvider");return e}},495:function(e,t,r){"use strict";r.d(t,{F:function(){return c},v:function(){return l}});var n=r(7437),a=r(2265);let o=(0,a.createContext)(null),i="superbora_location";function l(e){let{children:t}=e,[r,l]=(0,a.useState)({cep:"",endereco:"",bairro:"",cidade:"",lat:null,lng:null}),[c,s]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=function(){try{let e=localStorage.getItem(i);if(e)return JSON.parse(e)}catch(e){}return null}();e&&l(e)},[]);let u=(0,a.useCallback)(e=>{l(e),function(e){try{localStorage.setItem(i,JSON.stringify(e))}catch(e){}}(e)},[]),d=(0,a.useCallback)(async e=>{let t=e.replace(/\D/g,"");if(8!==t.length)return null;s(!0);try{let e=await fetch("https://viacep.com.br/ws/".concat(t,"/json/")),r=await e.json();if(r.erro)return null;let n={cep:t,endereco:r.logradouro||"",bairro:r.bairro||"",cidade:"".concat(r.localidade,"/").concat(r.uf),lat:null,lng:null};return u(n),n}catch(e){return null}finally{s(!1)}},[u]),h=(0,a.useCallback)(()=>{navigator.geolocation&&(s(!0),navigator.geolocation.getCurrentPosition(e=>{u({...r,lat:e.coords.latitude,lng:e.coords.longitude,endereco:"Localizacao atual"}),s(!1)},()=>s(!1),{enableHighAccuracy:!0,timeout:1e4}))},[r,u]),f=(0,a.useCallback)(()=>{l({cep:"",endereco:"",bairro:"",cidade:"",lat:null,lng:null});try{localStorage.removeItem(i)}catch(e){}},[]);return(0,n.jsx)(o.Provider,{value:{...r,loading:c,setLocation:u,lookupCep:d,getGeoLocation:h,clearLocation:f,hasLocation:!!(r.cep||r.lat)},children:t})}function c(){let e=(0,a.useContext)(o);if(!e)throw Error("useLocationContext must be used within LocationProvider");return e}},1241:function(e,t,r){"use strict";r.d(t,{Providers:function(){return f}});var n=r(7437),a=r(9146),o=r(495),i=r(7128),l=r(9376),c=r(7648),s=r(1477),u=r.n(s);let d=[{href:"/",label:"Inicio",icon:(0,n.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),(0,n.jsx)("polyline",{points:"9 22 9 12 15 12 15 22"})]})},{href:"/busca",label:"Busca",icon:(0,n.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,n.jsx)("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})},{href:"/pedidos",label:"Pedidos",icon:(0,n.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),(0,n.jsx)("polyline",{points:"14 2 14 8 20 8"}),(0,n.jsx)("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),(0,n.jsx)("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]})},{href:"/perfil",label:"Perfil",icon:(0,n.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,n.jsx)("circle",{cx:"12",cy:"7",r:"4"})]})}];function h(){let e=(0,l.usePathname)();return(0,n.jsx)("nav",{className:u().nav,children:d.map(t=>{var r;return(0,n.jsxs)(c.default,{href:t.href,className:"".concat(u().item," ").concat(("/"===(r=t.href)?"/"===e||""===e:e.startsWith(r))?u().active:""),children:[(0,n.jsx)("span",{className:u().icon,children:t.icon}),(0,n.jsx)("span",{className:u().label,children:t.label})]},t.href)})})}function f(e){let{children:t}=e;return(0,n.jsx)(i.H,{children:(0,n.jsx)(o.v,{children:(0,n.jsxs)(a.Z,{children:[(0,n.jsx)("div",{style:{paddingBottom:60},children:t}),(0,n.jsx)(h,{})]})})})}},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},7960:function(){},1477:function(e){e.exports={nav:"BottomNav_nav__T1kIM",item:"BottomNav_item__GeZmx",active:"BottomNav_active__Q5_PG",icon:"BottomNav_icon__dhNNZ",label:"BottomNav_label__CBee_"}}},function(e){e.O(0,[197,648,971,117,744],function(){return e(e.s=3833)}),_N_E=e.O()}]);
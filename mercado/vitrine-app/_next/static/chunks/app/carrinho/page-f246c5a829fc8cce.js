(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[521],{4223:function(e,t,a){Promise.resolve().then(a.bind(a,6408))},6428:function(e,t,a){"use strict";a.d(t,{LP:function(){return s},QW:function(){return u},SC:function(){return o},o4:function(){return i},sg:function(){return l}});let r="/api/mercado",n="superbora_token";function s(){return localStorage.getItem(n)}function i(e){e?localStorage.setItem(n,e):localStorage.removeItem(n)}function c(){let e=s();return e?{Authorization:"Bearer ".concat(e)}:{}}async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URL(r+e,window.location.origin);Object.entries(t).forEach(e=>{let[t,r]=e;null!=r&&""!==r&&a.searchParams.set(t,r)});let n=await fetch(a.toString(),{credentials:"include",headers:c()});if(!n.ok){let e=await n.json().catch(()=>null);throw Error((null==e?void 0:e.message)||"API error: ".concat(n.status," ").concat(n.statusText))}let s=await n.json();if(!s.success)throw Error(s.message||"Erro desconhecido na API");return s.data}async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URL(r+e,window.location.origin),n=await fetch(a.toString(),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...c()},body:JSON.stringify(t)}),s=await n.json().catch(()=>null);if(!n.ok||!(null==s?void 0:s.success))throw Error((null==s?void 0:s.message)||"API error: ".concat(n.status));return s.data}async function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URL(r+e,window.location.origin);Object.entries(t).forEach(e=>{let[t,r]=e;null!=r&&""!==r&&a.searchParams.set(t,r)});let n=await fetch(a.toString(),{method:"DELETE",credentials:"include",headers:c()}),s=await n.json().catch(()=>null);if(!n.ok||!(null==s?void 0:s.success))throw Error((null==s?void 0:s.message)||"API error: ".concat(n.status));return s.data}},6408:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return _}});var r=a(7437),n=a(2265),s=a(9376),i=a(7648),c=a(9146),o=a(7128),l=a(6428),u=a(7650),d=a(4972),m=a.n(d);let h=[{label:"Sem",value:0},{label:"R$ 2",value:2},{label:"R$ 5",value:5},{label:"R$ 10",value:10}],p=[{id:"asap",label:"O mais rapido",time:"30-50 min"},{id:"morning",label:"Manha",time:"08:00-12:00"},{id:"afternoon",label:"Tarde",time:"12:00-18:00"},{id:"evening",label:"Noite",time:"18:00-22:00"}];function _(){let e=(0,s.useRouter)(),{items:t,partnerId:a,partnerName:d,subtotal:_,count:f,removeItem:x,setItemQty:y,clearCart:j,getItemPrice:v}=(0,c.i)(),{isAuthenticated:C}=(0,o.a)(),[N,g]=(0,n.useState)("asap"),[b,k]=(0,n.useState)(0),[w,I]=(0,n.useState)(""),[T,B]=(0,n.useState)(null),[E,S]=(0,n.useState)(""),[R,q]=(0,n.useState)(!1),P=_>=99?0:9.99,A=(null==T?void 0:T.free_delivery)?0:P,D=(null==T?void 0:T.desconto)||0,L=_+A+2.49+b-D,O=C?.05*L:0;(0,n.useEffect)(()=>{localStorage.setItem("superbora_tip",String(b))},[b]),(0,n.useEffect)(()=>{{let e=(null==T?void 0:T.codigo)||"";localStorage.setItem("superbora_coupon",e)}},[T]);let M=Math.min(100,_/99*100),F=Math.max(0,99-_);async function U(){if(w.trim()){S(""),q(!0);try{let e=await (0,l.sg)("/carrinho/cupom.php",{code:w,partner_id:a,subtotal:_,cart_items_count:f});B(e)}catch(e){S(e.message),B(null)}finally{q(!1)}}}return 0===f?(0,r.jsx)("div",{className:m().page,children:(0,r.jsxs)("div",{className:m().empty,children:[(0,r.jsx)("div",{className:m().emptyIcon,children:(0,r.jsxs)("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("circle",{cx:"9",cy:"21",r:"1"}),(0,r.jsx)("circle",{cx:"20",cy:"21",r:"1"}),(0,r.jsx)("path",{d:"M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]})}),(0,r.jsx)("div",{className:m().emptyTitle,children:"Seu carrinho esta vazio"}),(0,r.jsx)("div",{className:m().emptyText,children:"Adicione produtos de uma loja para comecar"}),(0,r.jsx)(i.default,{href:"/",className:m().emptyBtn,children:"Ver lojas"})]})}):(0,r.jsxs)("div",{className:m().page,children:[(0,r.jsxs)("div",{className:m().header,children:[(0,r.jsx)("button",{className:m().backBtn,onClick:()=>e.back(),children:(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,r.jsx)("polyline",{points:"15 18 9 12 15 6"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:m().title,children:"Carrinho"}),d&&(0,r.jsx)("div",{className:m().partnerName,children:d})]})]}),_<99?(0,r.jsxs)("div",{className:m().freeBar,children:[(0,r.jsxs)("div",{className:m().freeBarText,children:["Falta ",(0,u.o_)(F)," para entrega gratis"]}),(0,r.jsx)("div",{className:m().freeBarTrack,children:(0,r.jsx)("div",{className:m().freeBarFill,style:{width:"".concat(M,"%")}})})]}):(0,r.jsx)("div",{className:m().freeBar,children:(0,r.jsx)("div",{className:m().freeBarDone,children:"Voce ganhou entrega gratis!"})}),(0,r.jsxs)("div",{className:m().section,children:[(0,r.jsxs)("div",{className:m().sectionTitle,children:["Itens (",f,")"]}),t.map(e=>{let t=v(e),a=e.preco_promo&&e.preco_promo>0&&e.preco_promo<e.preco;return(0,r.jsxs)("div",{className:m().item,children:[e.imagem&&(0,r.jsx)("img",{src:e.imagem,alt:"",className:m().itemImage}),(0,r.jsxs)("div",{className:m().itemInfo,children:[(0,r.jsx)("div",{className:m().itemName,children:e.nome}),e.unidade&&(0,r.jsx)("div",{className:m().itemUnit,children:e.unidade}),(0,r.jsxs)("div",{className:m().itemBottom,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:m().itemPrice,children:(0,u.o_)(t*e.quantity)}),a&&(0,r.jsx)("span",{className:m().itemOrigPrice,children:(0,u.o_)(e.preco*e.quantity)})]}),(0,r.jsxs)("div",{className:m().qtyControls,children:[(0,r.jsx)("button",{className:"".concat(m().qtyBtn," ").concat(1===e.quantity?m().qtyBtnDanger:""),onClick:()=>1===e.quantity?x(e.id):y(e.id,e.quantity-1),children:1===e.quantity?(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,r.jsx)("polyline",{points:"3 6 5 6 21 6"}),(0,r.jsx)("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}):"-"}),(0,r.jsx)("span",{className:m().qtyValue,children:e.quantity}),(0,r.jsx)("button",{className:m().qtyBtn,onClick:()=>y(e.id,e.quantity+1),children:"+"})]})]})]})]},e.id)})]}),(0,r.jsxs)("div",{className:m().section,children:[(0,r.jsx)("div",{className:m().sectionTitle,children:"Entrega"}),(0,r.jsx)("div",{className:m().slots,children:p.map(e=>(0,r.jsxs)("button",{className:"".concat(m().slot," ").concat(N===e.id?m().slotActive:""),onClick:()=>g(e.id),children:[(0,r.jsx)("div",{className:m().slotLabel,children:e.label}),(0,r.jsx)("div",{className:m().slotTime,children:e.time})]},e.id))})]}),(0,r.jsxs)("div",{className:m().section,children:[(0,r.jsx)("div",{className:m().sectionTitle,children:"Gorjeta para o entregador"}),(0,r.jsx)("div",{className:m().tips,children:h.map(e=>(0,r.jsx)("button",{className:"".concat(m().tipBtn," ").concat(b===e.value?m().tipActive:""),onClick:()=>k(e.value),children:e.label},e.value))})]}),(0,r.jsxs)("div",{className:m().section,children:[(0,r.jsx)("div",{className:m().sectionTitle,children:"Cupom de desconto"}),T?(0,r.jsxs)("div",{className:m().couponSuccess,children:[(0,r.jsxs)("span",{children:[T.codigo," - ",T.descricao]}),(0,r.jsx)("button",{className:m().couponRemove,onClick:()=>{B(null),I("")},children:"Remover"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:m().couponRow,children:[(0,r.jsx)("input",{type:"text",value:w,onChange:e=>I(e.target.value.toUpperCase()),className:m().couponInput,placeholder:"Codigo do cupom"}),(0,r.jsx)("button",{className:m().couponBtn,onClick:U,disabled:R||!w.trim(),children:R?"...":"Aplicar"})]}),E&&(0,r.jsx)("div",{className:m().couponError,children:E})]})]}),(0,r.jsxs)("div",{className:m().section,children:[(0,r.jsx)("div",{className:m().sectionTitle,children:"Resumo"}),(0,r.jsxs)("div",{className:m().summaryRow,children:[(0,r.jsx)("span",{children:"Subtotal"}),(0,r.jsx)("span",{children:(0,u.o_)(_)})]}),(0,r.jsxs)("div",{className:m().summaryRow,children:[(0,r.jsx)("span",{children:"Taxa de entrega"}),(0,r.jsx)("span",{children:0===A?"Gratis":(0,u.o_)(A)})]}),(0,r.jsxs)("div",{className:m().summaryRow,children:[(0,r.jsx)("span",{children:"Taxa de servico"}),(0,r.jsx)("span",{children:(0,u.o_)(2.49)})]}),b>0&&(0,r.jsxs)("div",{className:m().summaryRow,children:[(0,r.jsx)("span",{children:"Gorjeta"}),(0,r.jsx)("span",{children:(0,u.o_)(b)})]}),D>0&&(0,r.jsxs)("div",{className:"".concat(m().summaryRow," ").concat(m().summaryDiscount),children:[(0,r.jsx)("span",{children:"Desconto cupom"}),(0,r.jsxs)("span",{children:["-",(0,u.o_)(D)]})]}),(0,r.jsxs)("div",{className:m().summaryTotal,children:[(0,r.jsx)("span",{children:"Total"}),(0,r.jsx)("span",{children:(0,u.o_)(L)})]}),O>0&&(0,r.jsxs)("div",{className:m().cashback,children:["Voce ganha ",(0,u.o_)(O)," de cashback neste pedido"]})]}),(0,r.jsxs)("button",{className:m().cta,onClick:function(){if(!C){e.push("/login?return=/checkout");return}e.push("/checkout")},children:["Ir para o pagamento - ",(0,u.o_)(L)]})]})}},7128:function(e,t,a){"use strict";a.d(t,{H:function(){return c},a:function(){return o}});var r=a(7437),n=a(2265),s=a(6428);let i=(0,n.createContext)(null);function c(e){let{children:t}=e,[a,c]=(0,n.useState)(null),[o,l]=(0,n.useState)(!0),u=(0,n.useCallback)(async()=>{if(!(0,s.LP)()){c(null),l(!1);return}try{let e=await (0,s.SC)("/auth/session.php");e.authenticated&&e.customer?c(e.customer):((0,s.o4)(null),c(null))}catch(e){(0,s.o4)(null),c(null)}finally{l(!1)}},[]);(0,n.useEffect)(()=>{u()},[u]);let d=(0,n.useCallback)(async(e,t)=>{let a=await (0,s.sg)("/auth/login.php",{email:e,senha:t});return(0,s.o4)(a.token),c(a.customer),a.customer},[]),m=(0,n.useCallback)(async e=>{let t=await (0,s.sg)("/auth/register.php",e);return(0,s.o4)(t.token),c(t.customer),t.customer},[]),h=(0,n.useCallback)(()=>{(0,s.o4)(null),c(null)},[]);return(0,r.jsx)(i.Provider,{value:{customer:a,loading:o,isAuthenticated:!!a,login:d,register:m,logout:h,refreshSession:u},children:t})}function o(){let e=(0,n.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},9146:function(e,t,a){"use strict";a.d(t,{Z:function(){return l},i:function(){return u}});var r=a(7437),n=a(2265),s=a(6428);let i=(0,n.createContext)(null),c="superbora_cart";function o(e,t){let a;switch(t.type){case"ADD_ITEM":{let{product:r,partnerId:n,partnerName:s}=t.payload;if(e.partnerId&&e.partnerId!==n)a={items:[{...r,quantity:1}],partnerId:n,partnerName:s};else{let t;let i=e.items.findIndex(e=>e.id===r.id);t=i>=0?e.items.map((e,t)=>t===i?{...e,quantity:e.quantity+1}:e):[...e.items,{...r,quantity:1}],a={...e,items:t,partnerId:n,partnerName:s}}break}case"REMOVE_ITEM":{let r;let{productId:n}=t.payload,s=e.items.findIndex(e=>e.id===n);if(s<0)return e;r=e.items[s].quantity>1?e.items.map((e,t)=>t===s?{...e,quantity:e.quantity-1}:e):e.items.filter((e,t)=>t!==s),a={...e,items:r,partnerId:r.length>0?e.partnerId:null,partnerName:r.length>0?e.partnerName:""};break}case"SET_ITEM_QTY":{let{productId:r,quantity:n}=t.payload;if(n<=0){let t=e.items.filter(e=>e.id!==r);a={...e,items:t,partnerId:t.length>0?e.partnerId:null,partnerName:t.length>0?e.partnerName:""}}else{let t=e.items.map(e=>e.id===r?{...e,quantity:n}:e);a={...e,items:t}}break}case"CLEAR":a={items:[],partnerId:null,partnerName:""};break;case"HYDRATE":return t.payload;default:return e}return!function(e){try{localStorage.setItem(c,JSON.stringify(e))}catch(e){}}(a),a}function l(e){let{children:t}=e,[a,l]=(0,n.useReducer)(o,{items:[],partnerId:null,partnerName:""}),u=(0,n.useRef)(null);(0,n.useEffect)(()=>{l({type:"HYDRATE",payload:function(){try{let e=localStorage.getItem(c);if(e)return JSON.parse(e)}catch(e){}return{items:[],partnerId:null,partnerName:""}}()})},[]),(0,n.useEffect)(()=>{if((a.items.length||a.partnerId)&&(0,s.LP)())return u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{(0,s.sg)("/cart/sync.php",{items:a.items,partner_id:a.partnerId}).catch(()=>{})},2e3),()=>{u.current&&clearTimeout(u.current)}},[a.items,a.partnerId]);let d=(0,n.useCallback)((e,t,a)=>{l({type:"ADD_ITEM",payload:{product:e,partnerId:t,partnerName:a}})},[]),m=(0,n.useCallback)(e=>{l({type:"REMOVE_ITEM",payload:{productId:e}})},[]),h=(0,n.useCallback)((e,t)=>{l({type:"SET_ITEM_QTY",payload:{productId:e,quantity:t}})},[]),p=(0,n.useCallback)(()=>{l({type:"CLEAR"})},[]),_=(0,n.useCallback)(e=>e.preco_promo&&e.preco_promo>0&&e.preco_promo<e.preco?e.preco_promo:e.preco,[]),f=a.items.reduce((e,t)=>e+_(t)*t.quantity,0),x=a.items.reduce((e,t)=>e+t.quantity,0),y=(0,n.useCallback)(e=>{let t=a.items.find(t=>t.id===e);return t?t.quantity:0},[a.items]);return(0,r.jsx)(i.Provider,{value:{items:a.items,partnerId:a.partnerId,partnerName:a.partnerName,subtotal:f,count:x,addItem:d,removeItem:m,setItemQty:h,clearCart:p,getItemQuantity:y,getItemPrice:_},children:t})}function u(){let e=(0,n.useContext)(i);if(!e)throw Error("useCartContext must be used within CartProvider");return e}},7650:function(e,t,a){"use strict";function r(e){return null==e||isNaN(e)?"R$ 0,00":new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}function n(e){if(!e)return"";let t=e.replace(/\D/g,"");return 8!==t.length?e:"".concat(t.slice(0,5),"-").concat(t.slice(5))}function s(e){if(!e)return"";if(e<60)return"".concat(e," min");let t=Math.floor(e/60),a=e%60;return a>0?"".concat(t,"h").concat(a,"min"):"".concat(t,"h")}function i(e){return e?Number(e).toFixed(1):"0.0"}function c(e){return null==e?"":0===e?"Gratis":r(e)}a.d(t,{A6:function(){return i},ci:function(){return c},gN:function(){return s},hR:function(){return n},o_:function(){return r}})},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},4972:function(e){e.exports={page:"Cart_page__u2TJh",header:"Cart_header__DnUen",backBtn:"Cart_backBtn__NrPyA",title:"Cart_title__sK19a",partnerName:"Cart_partnerName__o7yJk",section:"Cart_section__OKdhO",sectionTitle:"Cart_sectionTitle__rd1Ef",item:"Cart_item__XxL4W",itemImage:"Cart_itemImage__SoDjw",itemInfo:"Cart_itemInfo__8u6fs",itemName:"Cart_itemName__B0MWC",itemUnit:"Cart_itemUnit__Eyjk1",itemBottom:"Cart_itemBottom__7yMuj",itemPrice:"Cart_itemPrice__ec3Zo",itemOrigPrice:"Cart_itemOrigPrice__g0KFt",qtyControls:"Cart_qtyControls__t04R1",qtyBtn:"Cart_qtyBtn__GVmyU",qtyBtnDanger:"Cart_qtyBtnDanger__hgNBv",qtyValue:"Cart_qtyValue__ajE7b",freeBar:"Cart_freeBar__XWueI",freeBarText:"Cart_freeBarText__WKgND",freeBarTrack:"Cart_freeBarTrack__GwISz",freeBarFill:"Cart_freeBarFill__OA3FG",freeBarDone:"Cart_freeBarDone__5OvDX",slots:"Cart_slots__7f2b1",slot:"Cart_slot__fxKN5",slotActive:"Cart_slotActive__2MSYX",slotLabel:"Cart_slotLabel__chK7w",slotTime:"Cart_slotTime__BtynX",tips:"Cart_tips__RJDdr",tipBtn:"Cart_tipBtn__f7heA",tipActive:"Cart_tipActive__pDFyT",couponRow:"Cart_couponRow__SFplR",couponInput:"Cart_couponInput__B3KhC",couponBtn:"Cart_couponBtn__X3hTs",couponSuccess:"Cart_couponSuccess__nfDPy",couponRemove:"Cart_couponRemove__Pm0pL",couponError:"Cart_couponError__lPtUe",summaryRow:"Cart_summaryRow__jtO0l",summaryDiscount:"Cart_summaryDiscount__jIntF",summaryTotal:"Cart_summaryTotal__YPTqf",cashback:"Cart_cashback__hhKUc",cta:"Cart_cta__geg2q",empty:"Cart_empty__6fq_4",emptyIcon:"Cart_emptyIcon__rtvqy",emptyTitle:"Cart_emptyTitle__waDI4",emptyText:"Cart_emptyText__wkdwd",emptyBtn:"Cart_emptyBtn__XSmEk"}}},function(e){e.O(0,[510,648,971,117,744],function(){return e(e.s=4223)}),_N_E=e.O()}]);
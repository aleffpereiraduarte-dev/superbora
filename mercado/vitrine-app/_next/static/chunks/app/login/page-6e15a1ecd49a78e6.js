(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{4467:function(e,t,a){Promise.resolve().then(a.bind(a,1834))},6428:function(e,t,a){"use strict";a.d(t,{LP:function(){return s},QW:function(){return u},SC:function(){return c},o4:function(){return r},sg:function(){return i}});let n="/api/mercado",l="superbora_token";function s(){return localStorage.getItem(l)}function r(e){e?localStorage.setItem(l,e):localStorage.removeItem(l)}function o(){let e=s();return e?{Authorization:"Bearer ".concat(e)}:{}}async function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URL(n+e,window.location.origin);Object.entries(t).forEach(e=>{let[t,n]=e;null!=n&&""!==n&&a.searchParams.set(t,n)});let l=await fetch(a.toString(),{credentials:"include",headers:o()});if(!l.ok){let e=await l.json().catch(()=>null);throw Error((null==e?void 0:e.message)||"API error: ".concat(l.status," ").concat(l.statusText))}let s=await l.json();if(!s.success)throw Error(s.message||"Erro desconhecido na API");return s.data}async function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URL(n+e,window.location.origin),l=await fetch(a.toString(),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...o()},body:JSON.stringify(t)}),s=await l.json().catch(()=>null);if(!l.ok||!(null==s?void 0:s.success))throw Error((null==s?void 0:s.message)||"API error: ".concat(l.status));return s.data}async function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URL(n+e,window.location.origin);Object.entries(t).forEach(e=>{let[t,n]=e;null!=n&&""!==n&&a.searchParams.set(t,n)});let l=await fetch(a.toString(),{method:"DELETE",credentials:"include",headers:o()}),s=await l.json().catch(()=>null);if(!l.ok||!(null==s?void 0:s.success))throw Error((null==s?void 0:s.message)||"API error: ".concat(l.status));return s.data}},7128:function(e,t,a){"use strict";a.d(t,{H:function(){return o},a:function(){return c}});var n=a(7437),l=a(2265),s=a(6428);let r=(0,l.createContext)(null);function o(e){let{children:t}=e,[a,o]=(0,l.useState)(null),[c,i]=(0,l.useState)(!0),u=(0,l.useCallback)(async()=>{if(!(0,s.LP)()){o(null),i(!1);return}try{let e=await (0,s.SC)("/auth/session.php");e.authenticated&&e.customer?o(e.customer):((0,s.o4)(null),o(null))}catch(e){(0,s.o4)(null),o(null)}finally{i(!1)}},[]);(0,l.useEffect)(()=>{u()},[u]);let h=(0,l.useCallback)(async(e,t)=>{let a=await (0,s.sg)("/auth/login.php",{email:e,senha:t});return(0,s.o4)(a.token),o(a.customer),a.customer},[]),m=(0,l.useCallback)(async e=>{let t=await (0,s.sg)("/auth/register.php",e);return(0,s.o4)(t.token),o(t.customer),t.customer},[]),d=(0,l.useCallback)(()=>{(0,s.o4)(null),o(null)},[]);return(0,n.jsx)(r.Provider,{value:{customer:a,loading:c,isAuthenticated:!!a,login:h,register:m,logout:d,refreshSession:u},children:t})}function c(){let e=(0,l.useContext)(r);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},1834:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var n=a(7437),l=a(2265),s=a(9376),r=a(7128),o=a(3510),c=a.n(o);function i(e){let{onSuccess:t}=e,{login:a}=(0,r.a)(),[s,o]=(0,l.useState)(""),[i,u]=(0,l.useState)(""),[h,m]=(0,l.useState)(""),[d,p]=(0,l.useState)(!1);async function f(e){e.preventDefault(),m(""),p(!0);try{await a(s,i),null==t||t()}catch(e){m(e.message)}finally{p(!1)}}return(0,n.jsxs)("form",{onSubmit:f,className:c().form,children:[h&&(0,n.jsx)("div",{className:c().error,children:h}),(0,n.jsxs)("label",{className:c().label,children:["Email",(0,n.jsx)("input",{type:"email",value:s,onChange:e=>o(e.target.value),className:c().input,placeholder:"seu@email.com",required:!0,autoComplete:"email"})]}),(0,n.jsxs)("label",{className:c().label,children:["Senha",(0,n.jsx)("input",{type:"password",value:i,onChange:e=>u(e.target.value),className:c().input,placeholder:"Sua senha",required:!0,minLength:6,autoComplete:"current-password"})]}),(0,n.jsx)("button",{type:"submit",className:c().button,disabled:d,children:d?"Entrando...":"Entrar"})]})}function u(e){let{onSuccess:t}=e,{register:a}=(0,r.a)(),[s,o]=(0,l.useState)({nome:"",sobrenome:"",email:"",telefone:"",cpf:"",senha:"",confirmarSenha:""}),[i,u]=(0,l.useState)(""),[h,m]=(0,l.useState)(!1);function d(e){let{name:t,value:a}=e.target;o(e=>({...e,[t]:a}))}async function p(e){if(e.preventDefault(),u(""),s.senha!==s.confirmarSenha){u("As senhas nao conferem");return}m(!0);try{await a({nome:s.nome,sobrenome:s.sobrenome,email:s.email,telefone:s.telefone.replace(/\D/g,""),cpf:s.cpf.replace(/\D/g,""),senha:s.senha}),null==t||t()}catch(e){u(e.message)}finally{m(!1)}}return(0,n.jsxs)("form",{onSubmit:p,className:c().form,children:[i&&(0,n.jsx)("div",{className:c().error,children:i}),(0,n.jsxs)("div",{className:c().row,children:[(0,n.jsxs)("label",{className:c().label,children:["Nome",(0,n.jsx)("input",{type:"text",name:"nome",value:s.nome,onChange:d,className:c().input,placeholder:"Nome",required:!0})]}),(0,n.jsxs)("label",{className:c().label,children:["Sobrenome",(0,n.jsx)("input",{type:"text",name:"sobrenome",value:s.sobrenome,onChange:d,className:c().input,placeholder:"Sobrenome"})]})]}),(0,n.jsxs)("label",{className:c().label,children:["Email",(0,n.jsx)("input",{type:"email",name:"email",value:s.email,onChange:d,className:c().input,placeholder:"seu@email.com",required:!0,autoComplete:"email"})]}),(0,n.jsxs)("label",{className:c().label,children:["Telefone",(0,n.jsx)("input",{type:"tel",name:"telefone",value:s.telefone,onChange:e=>o(t=>({...t,telefone:function(e){let t=e.replace(/\D/g,"").slice(0,11);return t.length<=2?t:t.length<=7?"(".concat(t.slice(0,2),") ").concat(t.slice(2)):"(".concat(t.slice(0,2),") ").concat(t.slice(2,7),"-").concat(t.slice(7))}(e.target.value)})),className:c().input,placeholder:"(11) 99999-9999"})]}),(0,n.jsxs)("label",{className:c().label,children:["CPF",(0,n.jsx)("input",{type:"text",name:"cpf",value:s.cpf,onChange:e=>o(t=>({...t,cpf:function(e){let t=e.replace(/\D/g,"").slice(0,11);return t.length<=3?t:t.length<=6?"".concat(t.slice(0,3),".").concat(t.slice(3)):t.length<=9?"".concat(t.slice(0,3),".").concat(t.slice(3,6),".").concat(t.slice(6)):"".concat(t.slice(0,3),".").concat(t.slice(3,6),".").concat(t.slice(6,9),"-").concat(t.slice(9))}(e.target.value)})),className:c().input,placeholder:"000.000.000-00"})]}),(0,n.jsxs)("label",{className:c().label,children:["Senha",(0,n.jsx)("input",{type:"password",name:"senha",value:s.senha,onChange:d,className:c().input,placeholder:"Minimo 6 caracteres",required:!0,minLength:6,autoComplete:"new-password"})]}),(0,n.jsxs)("label",{className:c().label,children:["Confirmar senha",(0,n.jsx)("input",{type:"password",name:"confirmarSenha",value:s.confirmarSenha,onChange:d,className:c().input,placeholder:"Repita a senha",required:!0,minLength:6,autoComplete:"new-password"})]}),(0,n.jsx)("button",{type:"submit",className:c().button,disabled:h,children:h?"Criando conta...":"Criar conta"})]})}function h(){let[e,t]=(0,l.useState)("login"),a=(0,s.useRouter)(),{isAuthenticated:o}=(0,r.a)();function h(){let e=new URLSearchParams(window.location.search).get("return")||"/";a.push(e)}return o?(h(),null):(0,n.jsx)("div",{className:c().page,children:(0,n.jsxs)("div",{className:c().card,children:[(0,n.jsxs)("div",{className:c().logo,children:[(0,n.jsx)("div",{className:c().logoText,children:"SuperBora"}),(0,n.jsx)("div",{className:c().logoSub,children:"Delivery para voce"})]}),(0,n.jsxs)("div",{className:c().tabs,children:[(0,n.jsx)("button",{className:"".concat(c().tab," ").concat("login"===e?c().tabActive:""),onClick:()=>t("login"),children:"Entrar"}),(0,n.jsx)("button",{className:"".concat(c().tab," ").concat("register"===e?c().tabActive:""),onClick:()=>t("register"),children:"Criar conta"})]}),"login"===e?(0,n.jsx)(i,{onSuccess:h}):(0,n.jsx)(u,{onSuccess:h})]})})}},9376:function(e,t,a){"use strict";var n=a(5475);a.o(n,"usePathname")&&a.d(t,{usePathname:function(){return n.usePathname}}),a.o(n,"useRouter")&&a.d(t,{useRouter:function(){return n.useRouter}}),a.o(n,"useSearchParams")&&a.d(t,{useSearchParams:function(){return n.useSearchParams}})},3510:function(e){e.exports={form:"Auth_form__k4Q0w",label:"Auth_label__k_4Q_",input:"Auth_input__mAw6A",row:"Auth_row__mvI26",button:"Auth_button__K7ImG",error:"Auth_error__XPBex",tabs:"Auth_tabs__BDyKD",tab:"Auth_tab__6_xKK",tabActive:"Auth_tabActive__q0D2Y",page:"Auth_page__Yt5C7",card:"Auth_card__8s6Fq",logo:"Auth_logo__VUzrE",logoText:"Auth_logoText__iBvrn",logoSub:"Auth_logoSub__aZQti",backLink:"Auth_backLink__pVzO9"}}},function(e){e.O(0,[576,971,117,744],function(){return e(e.s=4467)}),_N_E=e.O()}]);
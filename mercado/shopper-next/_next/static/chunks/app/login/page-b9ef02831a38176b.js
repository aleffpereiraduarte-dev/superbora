(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{3772:function(e,t,n){Promise.resolve().then(n.bind(n,2175))},6428:function(e,t,n){"use strict";n.d(t,{B9:function(){return u},LP:function(){return o},SC:function(){return c},o4:function(){return s},pE:function(){return d},sg:function(){return l}});let r="/api/mercado/shopper",a="shopper_token";function o(){return localStorage.getItem(a)}function s(e){e?localStorage.setItem(a,e):localStorage.removeItem(a)}function i(){let e=o();return e?{Authorization:"Bearer ".concat(e)}:{}}async function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="".concat(r).concat(e),a=Object.entries(t).filter(e=>{let[,t]=e;return null!=t&&""!==t}).map(e=>{let[t,n]=e;return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(n))}).join("&");a&&(n+="?".concat(a));let o=await fetch(n,{credentials:"include",headers:i()});if(!o.ok){let e=await o.json().catch(()=>null);throw Error((null==e?void 0:e.message)||"API error: ".concat(o.status," ").concat(o.statusText))}let s=await o.json();if(!s.success)throw Error(s.message||"Erro desconhecido na API");return s.data}async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=await fetch("".concat(r).concat(e),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...i()},body:JSON.stringify(t)}),a=await n.json().catch(()=>null);if(!n.ok||!(null==a?void 0:a.success))throw Error((null==a?void 0:a.message)||"API error: ".concat(n.status));return a.data}async function u(e,t){let n=await fetch("".concat(r).concat(e),{method:"POST",credentials:"include",headers:i(),body:t}),a=await n.json().catch(()=>null);if(!n.ok||!(null==a?void 0:a.success))throw Error((null==a?void 0:a.message)||"API error: ".concat(n.status));return a.data}async function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=await fetch("".concat(r).concat(e),{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",...i()},body:JSON.stringify(t)}),a=await n.json().catch(()=>null);if(!n.ok||!(null==a?void 0:a.success))throw Error((null==a?void 0:a.message)||"API error: ".concat(n.status));return a.data}},7128:function(e,t,n){"use strict";n.d(t,{H:function(){return i},a:function(){return c}});var r=n(7437),a=n(2265),o=n(6428);let s=(0,a.createContext)(null);function i(e){let{children:t}=e,[n,i]=(0,a.useState)(null),[c,l]=(0,a.useState)(!0),u=(0,a.useCallback)(async()=>{if(!(0,o.LP)()){i(null),l(!1);return}try{let e=await (0,o.SC)("/auth/session.php");e.authenticated&&e.shopper?i(e.shopper):((0,o.o4)(null),i(null))}catch(e){(0,o.o4)(null),i(null)}finally{l(!1)}},[]);(0,a.useEffect)(()=>{u()},[u]);let d=(0,a.useCallback)(async(e,t)=>{let n=await (0,o.sg)("/auth/login.php",{email:e,senha:t});(0,o.o4)(n.token);let r=n.shopper||{id:n.shopper_id,nome:n.nome,email:n.email,telefone:n.telefone,foto:n.foto,saldo:n.saldo,status:n.status};return i(r),r},[]),h=(0,a.useCallback)(()=>{(0,o.o4)(null),i(null)},[]);return(0,r.jsx)(s.Provider,{value:{shopper:n,loading:c,isAuthenticated:!!n,login:d,logout:h,refreshSession:u},children:t})}function c(){let e=(0,a.useContext)(s);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},2175:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(7437),a=n(2265),o=n(9376),s=n(7128);function i(){let[e,t]=(0,a.useState)(""),[n,i]=(0,a.useState)(""),[c,l]=(0,a.useState)(!1),[u,d]=(0,a.useState)(""),h=(0,o.useRouter)(),{login:f,isAuthenticated:m,loading:p}=(0,s.a)();if((0,a.useEffect)(()=>{if(!p&&m){let e=new URLSearchParams(window.location.search).get("return")||"/";h.push(e)}},[p,m,h]),p)return null;async function g(t){t.preventDefault(),d(""),l(!0);try{await f(e,n);let t=new URLSearchParams(window.location.search).get("return")||"/";h.push(t)}catch(e){d(e.message||"Erro ao fazer login")}finally{l(!1)}}return(0,r.jsxs)("div",{style:{minHeight:"100dvh",display:"flex",flexDirection:"column",justifyContent:"center",padding:24},children:[(0,r.jsxs)("div",{style:{textAlign:"center",marginBottom:40},children:[(0,r.jsx)("div",{style:{width:72,height:72,borderRadius:"50%",background:"linear-gradient(135deg, #00E676, #00C853)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px",fontSize:28,fontWeight:700,color:"#1a1a2e"},children:"S"}),(0,r.jsx)("h1",{style:{fontSize:24,fontWeight:700,marginBottom:4},children:"SuperBora Shopper"}),(0,r.jsx)("p",{style:{fontSize:14,color:"var(--color-text-secondary)"},children:"Faca login para comecar a comprar"})]}),(0,r.jsxs)("form",{onSubmit:g,children:[u&&(0,r.jsx)("div",{style:{padding:12,background:"#fef2f2",color:"#991b1b",borderRadius:8,fontSize:13,marginBottom:16},children:u}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",htmlFor:"email",children:"Email"}),(0,r.jsx)("input",{id:"email",type:"email",className:"form-input",placeholder:"seu@email.com",value:e,onChange:e=>t(e.target.value),required:!0,autoComplete:"email"})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",htmlFor:"senha",children:"Senha"}),(0,r.jsx)("input",{id:"senha",type:"password",className:"form-input",placeholder:"Sua senha",value:n,onChange:e=>i(e.target.value),required:!0,autoComplete:"current-password"})]}),(0,r.jsx)("button",{type:"submit",className:"btn btn-primary btn-lg",disabled:c,style:{marginTop:8},children:c?"Entrando...":"Entrar"}),(0,r.jsxs)("button",{type:"button",className:"btn btn-secondary",style:{marginTop:10},onClick:function(){alert("Login biometrico sera implementado em breve")},children:[(0,r.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,r.jsx)("path",{d:"M2 12C2 6.48 6.48 2 12 2s10 4.48 10 10"}),(0,r.jsx)("path",{d:"M7 12c0-2.76 2.24-5 5-5s5 2.24 5 5"}),(0,r.jsx)("path",{d:"M12 12v4"}),(0,r.jsx)("circle",{cx:"12",cy:"12",r:"1"})]}),"Login Biometrico"]})]}),(0,r.jsx)("div",{style:{textAlign:"center",marginTop:32},children:(0,r.jsxs)("p",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:["Ainda nao tem conta?"," ",(0,r.jsx)("a",{href:"/mercado/shopper-next/cadastro/",style:{color:"var(--color-primary-dark)",fontWeight:600},children:"Cadastre-se"})]})})]})}},9376:function(e,t,n){"use strict";var r=n(5475);n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}}),n.o(r,"useSearchParams")&&n.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[971,117,744],function(){return e(e.s=3772)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[285],{9242:function(e,t,a){Promise.resolve().then(a.bind(a,1417))},1417:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return j}});var s=a(7437),r=a(2265),n=a(9376),o=a(7648),l=a(8779),i=a(7128),c=a(9146),d=a(6428),u=a(7650);function p(e){return Math.round(100*e)/100}function h(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}a(3904);var m=a(3679),x=a.n(m);function _(e){let{total:t,selectedInstallments:a=1,onSelect:n,maxInstallments:o=12}=e,[l,i]=(0,r.useState)(!1),c=(0,r.useMemo)(()=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,a=[];if("number"!=typeof e||!Number.isFinite(e)||e<=0)return null!=e&&console.warn("calculateInstallments: Invalid total value provided:",e),[{installments:1,installmentValue:0,totalAmount:0,hasInterest:!1,interestRate:0,label:"R$ 0,00 a vista"}];("number"!=typeof t||!Number.isInteger(t)||t<1)&&(t=12),t>24&&(t=12);for(let s=1;s<=t;s++){let t,r;let n=!1;if(s<=6)t=e/s,r=e,n=!1;else{let a=Math.pow(1.0199,s),o=a-1;0!==o&&Number.isFinite(o)&&Number.isFinite(a)?(r=(t=.0199*a*e/o)*s,n=!0,Number.isFinite(t)&&Number.isFinite(r)||(console.warn("calculateInstallments: NaN detected in calculation, using fallback"),t=e/s,r=e,n=!1)):(t=e/s,r=e,n=!1)}if(t<10&&s>1)break;a.push({installments:s,installmentValue:p(t),totalAmount:p(r),hasInterest:n,interestRate:n?1.9900000000000002:0,label:function(e,t,a,s,r){let n=h(t);return 1===e?"".concat(n," a vista"):s?"".concat(e,"x de ").concat(n," (").concat(h(a)," total)"):"".concat(e,"x de ").concat(n," sem juros")}(s,t,r,n,0)})}return a})(t,o),[t,o]),d=(0,r.useMemo)(()=>c.find(e=>e&&e.installments===a)||(c.length>0?c[0]:null),[c,a]);if(0===c.length||t<=0||!d)return null;let m=e=>{n(e),i(!1)},_=c.filter(e=>!e.hasInterest).length;return(0,s.jsxs)("div",{className:x().container,children:[(0,s.jsx)("label",{className:x().label,children:"Parcelamento"}),(0,s.jsxs)("div",{className:x().selector,children:[(0,s.jsxs)("button",{type:"button",className:x().selectedOption,onClick:()=>i(!l),"aria-expanded":l,children:[(0,s.jsxs)("div",{className:x().optionContent,children:[(0,s.jsx)("span",{className:x().optionText,children:1===d.installments?(0,s.jsxs)(s.Fragment,{children:[(0,u.o_)(d.installmentValue)," a vista"]}):(0,s.jsxs)(s.Fragment,{children:[d.installments,"x de ",(0,u.o_)(d.installmentValue)]})}),!d.hasInterest&&d.installments>1&&(0,s.jsx)("span",{className:x().interestFreeBadge,children:"sem juros"}),d.hasInterest&&(0,s.jsxs)("span",{className:x().interestBadge,children:[(0,u.o_)(d.totalAmount)," total"]})]}),(0,s.jsx)("svg",{className:"".concat(x().arrow," ").concat(l?x().arrowUp:""),width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("polyline",{points:"6 9 12 15 18 9"})})]}),l&&(0,s.jsxs)("div",{className:x().dropdown,children:[_>1&&(0,s.jsxs)("div",{className:x().interestFreeHighlight,children:["Ate ",_,"x sem juros"]}),(0,s.jsx)("div",{className:x().optionsList,children:c.map(e=>{if(!e)return null;let r=e.installments===a,n=e.hasInterest&&e.hasInterest?p(e.totalAmount-t):0;return(0,s.jsxs)("button",{type:"button",className:"".concat(x().option," ").concat(r?x().optionSelected:""),onClick:()=>m(e),children:[(0,s.jsxs)("div",{className:x().optionLeft,children:[(0,s.jsx)("div",{className:"".concat(x().radio," ").concat(r?x().radioSelected:""),children:r&&(0,s.jsx)("div",{className:x().radioDot})}),(0,s.jsxs)("div",{className:x().optionDetails,children:[(0,s.jsx)("span",{className:x().installmentText,children:1===e.installments?(0,s.jsxs)("strong",{children:[(0,u.o_)(e.installmentValue)," a vista"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("strong",{children:[e.installments,"x"]})," de"," ",(0,s.jsx)("strong",{children:(0,u.o_)(e.installmentValue)})]})}),!e.hasInterest&&e.installments>1&&(0,s.jsx)("span",{className:x().interestFreeBadgeSmall,children:"sem juros"})]})]}),(0,s.jsx)("div",{className:x().optionRight,children:e.hasInterest?(0,s.jsxs)("div",{className:x().interestInfo,children:[(0,s.jsx)("span",{className:x().totalWithInterest,children:(0,u.o_)(e.totalAmount)}),(0,s.jsxs)("span",{className:x().interestDiff,children:["+",(0,u.o_)(n)," juros"]})]}):(0,s.jsx)("span",{className:x().totalNoInterest,children:(0,u.o_)(e.totalAmount)})})]},e.installments)})})]})]}),d.hasInterest&&(0,s.jsxs)("div",{className:x().interestSummary,children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,s.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,s.jsx)("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),(0,s.jsx)("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),(0,s.jsxs)("span",{children:["Total a prazo: ",(0,s.jsx)("strong",{children:(0,u.o_)(d.totalAmount)})," ","(juros de 1,99% a.m.)"]})]})]})}var g=a(6349),f=a.n(g);function v(e){let{amount:t,orderId:a,onCreateOrder:n,onSuccess:o,onError:l,label:i="Total do Pedido",disabled:c=!1}=e,[u,p]=(0,r.useState)(!1),[h,m]=(0,r.useState)(null),[x,_]=(0,r.useState)(null),[g,v]=(0,r.useState)(!0),[j,k]=(0,r.useState)(!1),C=(0,r.useRef)(!1),S=(0,r.useRef)(null),N=(0,r.useRef)(!0);(0,r.useEffect)(()=>()=>{N.current=!1},[]),(0,r.useEffect)(()=>{p(!0)},[]),(0,r.useEffect)(()=>{u&&!C.current&&(async()=>{if(window.Stripe){await I();return}let e=document.createElement("script");e.src="https://js.stripe.com/v3/",e.async=!0,e.onload=I,document.head.appendChild(e)})()},[u]);let I=(0,r.useCallback)(async()=>{if(!C.current){C.current=!0;try{var e;let a=await fetch("/api/mercado/checkout/stripe-config.php");if(!a.ok){v(!1);return}let s=await a.json();if(!(null===(e=s.data)||void 0===e?void 0:e.publishable_key)){v(!1);return}S.current=s.data.publishable_key;let r=window.Stripe(s.data.publishable_key);m(r);let n=r.paymentRequest({country:"BR",currency:"brl",total:{label:i,amount:Math.round(100*(t||100))},requestPayerName:!0,requestPayerEmail:!0}),o=await n.canMakePayment();_(o),v(!1)}catch(e){console.warn("[StripePayment] Failed to initialize Stripe:",e),v(!1)}}},[t,i]),w=(0,r.useCallback)(async()=>{if(h&&x&&!j&&!c){k(!0);try{let e=a;if(!e&&n&&!(e=await n())){k(!1);return}if(!e){null==l||l("Erro ao criar pedido"),k(!1);return}let s=await (0,d.sg)("/checkout/stripe-payment.php",{order_id:e});if(!s.client_secret){null==l||l("Erro ao iniciar pagamento"),k(!1);return}let r=h.paymentRequest({country:"BR",currency:"brl",total:{label:i,amount:s.amount||Math.round(100*(t||0))},requestPayerName:!0,requestPayerEmail:!0});r.on("paymentmethod",async e=>{try{let{error:t,paymentIntent:a}=await h.confirmCardPayment(s.client_secret,{payment_method:e.paymentMethod.id},{handleActions:!1});if(t){e.complete("fail"),N.current&&(null==l||l(t.message),k(!1));return}if("requires_action"===a.status){let{error:t}=await h.confirmCardPayment(s.client_secret);if(t){e.complete("fail"),N.current&&(null==l||l(t.message),k(!1));return}}e.complete("success"),N.current&&(null==o||o(a),k(!1))}catch(t){e.complete("fail"),N.current&&(null==l||l(t.message||"Erro no pagamento"),k(!1))}}),r.on("cancel",()=>{N.current&&k(!1)}),await r.canMakePayment()?r.show():(null==l||l("Pagamento por carteira nao disponivel"),k(!1))}catch(e){null==l||l(e.message||"Erro ao processar pagamento"),k(!1)}}},[h,x,j,c,a,n,t,i,o,l]);if(!u||g||!x)return null;let T=x.applePay,R=x.googlePay;return T||R?(0,s.jsxs)("div",{className:f().walletPayment,children:[T&&(0,s.jsx)("button",{type:"button",className:f().applePayBtn,onClick:w,disabled:c||j,"aria-label":"Pagar com Apple Pay",children:j?(0,s.jsx)("span",{className:f().btnSpinner}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(y,{}),(0,s.jsx)("span",{children:"Pagar com Apple Pay"})]})}),R&&(0,s.jsx)("button",{type:"button",className:f().googlePayBtn,onClick:w,disabled:c||j,"aria-label":"Pagar com Google Pay",children:j?(0,s.jsx)("span",{className:f().btnSpinner}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b,{}),(0,s.jsx)("span",{children:"Pagar com Google Pay"})]})}),(0,s.jsx)("div",{className:f().walletDivider,children:(0,s.jsx)("span",{children:"ou pague de outra forma"})})]}):null}function y(){return(0,s.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M7.13 21.72c-.73 0-1.44-.28-2.01-.78-.58-.52-.95-1.24-1.03-2-.12-1.17.37-2.35 1.3-3.13.77-.64 1.74-.97 2.73-.92.1.84-.24 1.67-.91 2.24-.67.56-1.54.82-2.42.7.08.53.35 1.01.76 1.35.58.49 1.41.7 2.17.54.76-.16 1.4-.64 1.73-1.32.38-.77.38-1.67 0-2.44-.19-.39-.48-.72-.83-.97 1.13-.65 1.98-1.69 2.38-2.9.4-1.22.35-2.54-.14-3.72-.48-1.18-1.38-2.16-2.53-2.75-1.15-.58-2.48-.72-3.74-.39-1.25.33-2.35 1.1-3.09 2.16-.74 1.06-1.08 2.35-.97 3.64.12 1.28.69 2.49 1.61 3.39-.27.31-.49.67-.64 1.06-.35.89-.35 1.88 0 2.77.35.89.99 1.63 1.82 2.1.82.47 1.78.65 2.72.52.93-.13 1.8-.56 2.47-1.21.67-.66 1.1-1.52 1.22-2.44-1.16-.35-2.1-1.17-2.6-2.25zm5.5-14.47c.55.65.85 1.48.85 2.33 0 .85-.3 1.68-.85 2.33-.55.65-1.31 1.07-2.15 1.19.01-1.72.71-3.37 1.93-4.56.12-.11.22-.2.22-.29zm5.61 5.04c-.55-.83-1.34-1.47-2.26-1.83-.92-.36-1.93-.44-2.9-.23.05-.86.35-1.69.86-2.37.5-.69 1.2-1.2 2-1.48-.32-.81-.86-1.52-1.56-2.04-.7-.53-1.54-.84-2.41-.9.01-.86.27-1.71.75-2.43.48-.72 1.16-1.29 1.95-1.64-.18-.32-.41-.61-.68-.86-.6-.55-1.37-.88-2.17-.93.64-.67 1.47-1.13 2.37-1.32.9-.19 1.85-.1 2.7.26.85.36 1.58.97 2.08 1.74.5.78.75 1.69.72 2.61-.03.92-.35 1.81-.92 2.54-.56.73-1.34 1.28-2.22 1.56.78.25 1.48.7 2.04 1.3.55.6.95 1.33 1.15 2.13.2.79.2 1.62 0 2.42-.2.79-.6 1.53-1.15 2.13-.56.6-1.26 1.04-2.04 1.3.88.28 1.66.83 2.22 1.56.57.73.89 1.62.92 2.54.03.92-.22 1.83-.72 2.61-.5.77-1.23 1.38-2.08 1.74-.85.36-1.8.45-2.7.26-.9-.19-1.73-.65-2.37-1.32.8-.05 1.57-.38 2.17-.93.27-.25.5-.54.68-.86-.79-.35-1.47-.92-1.95-1.64-.48-.72-.74-1.57-.75-2.43.87-.06 1.71-.37 2.41-.9.7-.52 1.24-1.23 1.56-2.04-.8-.28-1.5-.79-2-1.48-.51-.68-.81-1.51-.86-2.37.97.21 1.98.13 2.9-.23.92-.36 1.71-1 2.26-1.83z"})})}function b(){return(0,s.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{fill:"#4285F4",d:"M12.24 10.285V14.4h6.806c-.275 1.765-2.056 5.174-6.806 5.174-4.095 0-7.439-3.389-7.439-7.574s3.345-7.574 7.439-7.574c2.33 0 3.891.989 4.785 1.849l3.254-3.138C18.189 1.186 15.479 0 12.24 0c-6.635 0-12 5.365-12 12s5.365 12 12 12c6.926 0 11.52-4.869 11.52-11.726 0-.788-.085-1.39-.189-1.989H12.24z"})})}function j(){return(0,s.jsx)(l.Z,{children:(0,s.jsx)(k,{})})}function k(){let e=(0,n.useRouter)(),{customer:t}=(0,i.a)(),{stores:a,items:l,subtotal:p,count:h,storeCount:m,clearCart:x,getItemPrice:g,getStoreSubtotal:y}=(0,c.iQ)(),[b,j]=(0,r.useState)(0),[k,C]=(0,r.useState)([]),[S,N]=(0,r.useState)(null),[I,w]=(0,r.useState)(!1),[T,R]=(0,r.useState)({label:"Casa",cep:"",logradouro:"",numero:"",complemento:"",bairro:"",cidade:"",estado:""}),[B,P]=(0,r.useState)("pix"),[A,z]=(0,r.useState)({number:"",name:"",expiry:"",cvv:""}),[F,D]=(0,r.useState)(!1),[L,E]=(0,r.useState)([]),[O,W]=(0,r.useState)(!1),[M,V]=(0,r.useState)({}),[Q,q]=(0,r.useState)(""),G=(0,r.useRef)(null),U=(0,r.useRef)(null),[H,X]=(0,r.useState)([]),[K,J]=(0,r.useState)(null),[Z,Y]=(0,r.useState)(!1),[$,ee]=(0,r.useState)(1),[et,ea]=(0,r.useState)(null),[es,er]=(0,r.useState)(null),[en,eo]=(0,r.useState)(!1),[el,ei]=(0,r.useState)(0),[ec,ed]=(0,r.useState)(null),[eu,ep]=(0,r.useState)(0),[eh,em]=(0,r.useState)(!1),[ex,e_]=(0,r.useState)(0),[eg,ef]=(0,r.useState)(!1),[ev,ey]=(0,r.useState)(0),[eb,ej]=(0,r.useState)([]),[ek,eC]=(0,r.useState)(""),[eS,eN]=(0,r.useState)(!1),[eI,ew]=(0,r.useState)({}),[eT,eR]=(0,r.useState)({}),eB=(()=>{try{return parseFloat(localStorage.getItem("superbora_tip")||"0")||0}catch(e){return console.warn("[Checkout] Failed to read tip from localStorage"),0}})(),eP=(()=>{try{return localStorage.getItem("superbora_coupon")||""}catch(e){return console.warn("[Checkout] Failed to read coupon from localStorage"),""}})(),eA=(0,r.useCallback)(e=>{let t=eI[e]||"standard",a=eT[e],s=y(e);if("pickup"===t)return 0;if(a&&a[t]){let e=a[t];return e.free_above&&e.free_above>0&&s>=e.free_above?0:e.fee||0}return s>=99?0:9.99},[eI,eT,y]),ez=Object.keys(a).reduce((e,t)=>e+eA(t),0),eF=Object.keys(a).length>0&&Object.keys(a).every(e=>"pickup"===eI[e]),eD=Object.keys(a).some(e=>"express"===eI[e]),eL=en?parseFloat(Math.min(.01*el,.5*p).toFixed(2)):0,eE=eh?parseFloat(Math.min(eu,p+ez+2.49+eB-eL).toFixed(2)):0,eO=eg?parseFloat(Math.min(ev,p+ez+2.49+eB-eL-eE).toFixed(2)):0,eW=Math.max(0,parseFloat((p+ez+2.49+eB-eL-eE-eO).toFixed(2)));async function eM(e){let t=e.replace(/\D/g,"");if(8===t.length)try{let e=await fetch("https://viacep.com.br/ws/".concat(t,"/json/"));if(!e.ok)throw Error("CEP lookup failed");let a=await e.json();if(a.erro)throw Error("CEP not found");a&&R(e=>({...e,logradouro:a.logradouro||e.logradouro,bairro:a.bairro||e.bairro,cidade:a.localidade||e.cidade,estado:a.uf||e.estado}))}catch(e){console.warn("[Checkout] CEP lookup failed:",e.message)}}async function eV(){try{let e=await (0,d.sg)("/addresses/list.php",{...T,is_default:0===k.length}),t={id:e.address_id,...T,formatted:"".concat(T.logradouro,", ").concat(T.numero," - ").concat(T.bairro,", ").concat(T.cidade,"/").concat(T.estado)};C(e=>[...e,t]),N(e.address_id),w(!1),R({label:"Casa",cep:"",logradouro:"",numero:"",complemento:"",bairro:"",cidade:"",estado:""})}catch(e){q(e.message)}}async function eQ(){if(!eF&&!S){q("Selecione um endereco de entrega");return}D(!0),q("");try{let e=[...eb];ek.trim()&&e.push(ek.trim());let t=e.join("; "),s=Object.entries(a),r=[];for(let[e,a]of s){let n=eI[e]||"standard",o=eT[e],l="pickup"===n,i="express"===n,c=eA(e),u={address_id:l?null:S,payment_method:B,items:a.items.map(e=>({id:e.id,quantity:e.quantity,notes:e.notes||"",addons:e.selectedOptions?e.selectedOptions.map(e=>e.id):[]})),partner_id:parseInt(e),tip:s.length>1?Math.round(eB/s.length*100)/100:eB,coupon_code:eP,notes:"",delivery_instructions:l?"":t,contactless:!l&&eS,is_pickup:l,is_express:i,delivery_method:n,delivery_fee:c};i&&o&&o.express&&(u.express_fee=o.express.fee||0,u.express_time_estimate=o.express.time_min||20),"credito"===B&&K&&(u.saved_card_id=K),"credito"===B&&$>1&&(u.installments=$,u.installment_value=(null==et?void 0:et.installmentValue)||null,u.installment_total=(null==et?void 0:et.totalAmount)||null,u.installment_has_interest=(null==et?void 0:et.hasInterest)||!1),ec&&(u.schedule_date=ec.date,u.schedule_time=ec.time),en&&el>0&&(u.use_points=Math.round(el/s.length)),eg&&eO>0&&(u.use_cashback=s.length>1?Math.round(eO/s.length*100)/100:eO);let p=await (0,d.sg)("/checkout/process.php",u);r.push({...p,partnerName:a.partnerName,partnerId:parseInt(e)})}if(E(r),j(2),x(),Z&&"credito"===B&&!K&&A.number)try{let e=A.number.replace(/\s/g,""),t=A.expiry?A.expiry.split("/"):[],a=t[0]||"",s=t[1]||"",r=parseInt(a,10),n=parseInt(s,10);a&&s&&!isNaN(r)&&!isNaN(n)&&await (0,d.sg)("/customer/cards.php",{card_last4:e.slice(-4),card_brand:e.startsWith("4")?"visa":/^5[1-5]/.test(e)?"mastercard":/^3[47]/.test(e)?"amex":/^6(?:011|5)/.test(e)?"discover":"visa",card_exp_month:r,card_exp_year:2e3+n})}catch(e){console.warn("[Checkout] Failed to save card:",e.message)}try{localStorage.removeItem("superbora_schedule")}catch(e){console.warn("[Checkout] Failed to clear schedule")}"pix"===B&&r.forEach(e=>{e.order_id&&function(e){let t=setInterval(async()=>{try{let a=await (0,d.SC)("/checkout/pix-status.php",{order_id:e});(a.paid||"confirmado"===a.status||"preparando"===a.status)&&(V(t=>({...t,[e]:!0})),clearInterval(t))}catch(e){}},5e3);G.current||(G.current=[]),G.current.push(t)}(e.order_id)})}catch(e){q(e.message)}finally{D(!1)}}function eq(e){try{let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-9999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),W(!0),U.current&&clearTimeout(U.current),U.current=setTimeout(()=>W(!1),3e3)}catch(e){console.warn("[Checkout] Fallback copy failed:",e.message)}}async function eG(e){try{await (0,d.QW)("/customer/cards.php",{id:e}),X(t=>t.filter(t=>t.id!==e)),K===e&&J(null)}catch(e){console.warn("[Checkout] Failed to delete card:",e.message)}}return(0,r.useEffect)(()=>{let e=!1;(0,d.SC)("/addresses/list.php").then(t=>{var a;if(e)return;C((null==t?void 0:t.addresses)||[]);let s=((null==t?void 0:t.addresses)||[]).find(e=>e.is_default);s?N(s.id):(null==t?void 0:null===(a=t.addresses)||void 0===a?void 0:a.length)&&N(t.addresses[0].id)}).catch(e=>{"AbortError"!==e.name&&console.warn("[Checkout] Failed to load addresses")}),(0,d.SC)("/customer/cards.php").then(t=>{if(e)return;X((null==t?void 0:t.cards)||[]);let a=((null==t?void 0:t.cards)||[]).find(e=>e.is_default);a&&J(a.id)}).catch(e=>{"AbortError"!==e.name&&console.warn("[Checkout] Failed to load cards")}),(0,d.SC)("/customer/loyalty.php").then(t=>{!e&&(er(t),(null==t?void 0:t.points_balance)>0&&ei(Math.min(t.points_balance,Math.floor(50*p))))}).catch(e=>{"AbortError"!==e.name&&console.warn("[Checkout] Failed to load loyalty")}),(0,d.SC)("/gift-cards/balance.php").then(t=>{e||ep((null==t?void 0:t.balance)||0)}).catch(e=>{"AbortError"!==e.name&&console.warn("[Checkout] Failed to load gift cards")}),(0,d.SC)("/customer/cashback.php").then(t=>{var a;if(e)return;let s=(null==t?void 0:null===(a=t.wallet)||void 0===a?void 0:a.available)||0;e_(s),ey(s)}).catch(e=>{"AbortError"!==e.name&&console.warn("[Checkout] Failed to load cashback")});try{let e=localStorage.getItem("superbora_schedule");if(e){let t=JSON.parse(e);t&&t.date&&t.time&&ed(t)}}catch(e){console.warn("[Checkout] Failed to parse schedule from localStorage")}try{let e=localStorage.getItem("superbora_delivery_methods"),t=localStorage.getItem("superbora_delivery_options"),a=e?JSON.parse(e):{},s=t?JSON.parse(t):{};ew(a),eR(s)}catch(e){console.warn("[Checkout] Failed to parse delivery methods from localStorage")}return()=>{e=!0}},[]),(0,r.useEffect)(()=>()=>{G.current&&Array.isArray(G.current)&&(G.current.forEach(e=>{e&&clearInterval(e)}),G.current=[]),U.current&&(clearTimeout(U.current),U.current=null)},[]),0===h&&0===L.length?(e.push("/carrinho"),null):2===b&&L.length>0?(L.every(e=>!e.pix||M[e.order_id]),(0,s.jsx)("div",{className:f().page,children:(0,s.jsx)("div",{className:f().section,children:(0,s.jsxs)("div",{className:f().success,children:[(0,s.jsx)("div",{className:f().successIcon,children:(0,s.jsx)("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("polyline",{points:"20 6 9 17 4 12"})})}),(0,s.jsx)("div",{className:f().successTitle,children:L.length>1?"".concat(L.length," pedidos realizados!"):"Pedido realizado!"}),L.map((e,t)=>{var a;return(0,s.jsxs)("div",{style:{padding:14,marginBottom:12,border:"1px solid var(--color-border)",borderRadius:"var(--radius-sm)",textAlign:"left"},children:[(0,s.jsx)("div",{style:{fontWeight:600,fontSize:15,marginBottom:4},children:e.partnerName||(null===(a=e.partner)||void 0===a?void 0:a.name)}),(0,s.jsxs)("div",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:["Pedido ",e.order_number]}),e.is_scheduled&&e.schedule_date&&(0,s.jsxs)("div",{style:{padding:"6px 10px",background:"#f0fdf4",borderRadius:6,fontSize:13,color:"var(--color-accent)",marginTop:8},children:["Agendado para ",new Date(e.schedule_date+"T00:00:00").toLocaleDateString("pt-BR")," as ",e.schedule_time]}),e.points_earned>0&&(0,s.jsxs)("div",{style:{padding:"6px 10px",background:"#fef9c3",borderRadius:6,fontSize:13,color:"#854d0e",marginTop:8},children:["+",e.points_earned," pontos de fidelidade"]}),"pix"===B&&e.pix&&!M[e.order_id]&&(0,s.jsx)("div",{style:{marginTop:12},children:(0,s.jsxs)("div",{className:f().pixBox,children:[(0,s.jsx)("div",{className:f().pixQr,children:"QR Code PIX"}),(0,s.jsxs)("div",{className:f().pixCode,children:[(0,s.jsx)("input",{type:"text",value:e.pix.qr_code_text,readOnly:!0,className:f().pixCodeInput}),(0,s.jsx)("button",{className:f().pixCopyBtn,onClick:()=>{var t;return t=e.pix.qr_code_text,void(navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(t).then(()=>{W(!0),U.current&&clearTimeout(U.current),U.current=setTimeout(()=>W(!1),3e3)}).catch(()=>{eq(t)}):eq(t))},children:O?"Copiado!":"Copiar"})]}),(0,s.jsxs)("div",{className:f().pixStatus,children:[(0,s.jsx)("div",{className:f().spinner}),"Aguardando pagamento..."]})]})}),M[e.order_id]&&(0,s.jsxs)("div",{className:"".concat(f().pixStatus," ").concat(f().pixPaid),style:{marginTop:8},children:[(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("polyline",{points:"20 6 9 17 4 12"})}),"Pagamento confirmado!"]})]},e.order_id||t)}),(0,s.jsxs)("div",{className:f().navBtns,style:{marginTop:16},children:[(0,s.jsx)(o.default,{href:"/pedidos",className:f().btnPrimary,style:{textDecoration:"none"},children:"Acompanhar pedidos"}),(0,s.jsx)(o.default,{href:"/",className:f().btnSecondary,style:{textDecoration:"none"},children:"Voltar ao inicio"})]})]})})})):(0,s.jsxs)("div",{className:f().page,children:[(0,s.jsxs)("div",{className:f().header,children:[(0,s.jsx)("button",{className:f().backBtn,onClick:()=>b>0?j(b-1):e.push("/carrinho"),"aria-label":"Voltar",children:(0,s.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("polyline",{points:"15 18 9 12 15 6"})})}),(0,s.jsx)("div",{className:f().title,children:"Checkout"})]}),(0,s.jsxs)("div",{className:f().steps,children:[(0,s.jsx)("div",{className:"".concat(f().step," ").concat(b>=0?f().stepDone:"")}),(0,s.jsx)("div",{className:"".concat(f().step," ").concat(b>=1?f().stepDone:""," ").concat(0===b?f().stepCurrent:"")}),(0,s.jsx)("div",{className:"".concat(f().step," ").concat(b>=2?f().stepDone:""," ").concat(1===b?f().stepCurrent:"")})]}),Q&&(0,s.jsx)("div",{style:{padding:12,background:"#fef2f2",border:"1px solid #fecaca",borderRadius:8,color:"#dc2626",fontSize:14,marginBottom:16},children:Q}),(0,s.jsxs)("div",{className:f().layout,children:[(0,s.jsxs)("div",{className:f().main,children:[0===b&&(0,s.jsxs)("div",{className:f().section,children:[eF?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:f().sectionTitle,children:"Retirada na loja"}),(0,s.jsxs)("div",{style:{padding:16,background:"#eff6ff",borderRadius:"var(--radius-sm)",border:"1px solid #bfdbfe",marginBottom:16},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12,color:"#1e40af",fontWeight:600},children:[(0,s.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"}),(0,s.jsx)("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),(0,s.jsx)("path",{d:"M16 10a4 4 0 0 1-8 0"})]}),"Voce escolheu retirar na loja"]}),Object.entries(a).map(e=>{let[t,a]=e,r=eT[t],n=null==r?void 0:r.pickup;return(0,s.jsxs)("div",{style:{marginBottom:12,paddingBottom:12,borderBottom:"1px solid #bfdbfe"},children:[(0,s.jsx)("div",{style:{fontWeight:600,fontSize:14,color:"#1e40af",marginBottom:4},children:a.partnerName}),n&&n.store_address&&(0,s.jsx)("div",{style:{fontSize:13,color:"#1e40af",marginBottom:4},children:n.store_address}),n&&n.pickup_instructions&&(0,s.jsx)("div",{style:{fontSize:12,color:"#3b82f6"},children:n.pickup_instructions}),n&&n.store_phone&&(0,s.jsxs)("div",{style:{fontSize:12,color:"#1e40af",marginTop:4},children:["Tel: ",n.store_phone]})]},t)}),(0,s.jsx)("div",{style:{fontSize:13,color:"#3b82f6",marginTop:8},children:"Apresente o codigo do pedido no balcao para retirar."})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:f().sectionTitle,children:"Endereco de entrega"}),Object.keys(a).some(e=>"pickup"===eI[e])&&(0,s.jsxs)("div",{style:{padding:12,background:"#fef3c7",borderRadius:"var(--radius-sm)",border:"1px solid #fcd34d",marginBottom:16,fontSize:13,color:"#92400e"},children:[(0,s.jsx)("strong",{children:"Atencao:"})," Alguns itens serao retirados na loja:",(0,s.jsx)("ul",{style:{margin:"8px 0 0 16px",padding:0},children:Object.entries(a).filter(e=>{let[t]=e;return"pickup"===eI[t]}).map(e=>{let[t,a]=e;return(0,s.jsx)("li",{children:a.partnerName},t)})})]}),k.length>0&&(0,s.jsx)("div",{className:f().addressList,children:k.map(e=>(0,s.jsxs)("div",{className:"".concat(f().addressCard," ").concat(S===e.id?f().addressActive:""),onClick:()=>N(e.id),children:[(0,s.jsx)("div",{className:"".concat(f().addressRadio," ").concat(S===e.id?f().addressRadioActive:""),children:S===e.id&&(0,s.jsx)("div",{className:f().addressRadioDot})}),(0,s.jsxs)("div",{className:f().addressInfo,children:[(0,s.jsx)("div",{className:f().addressLabel,children:e.label}),(0,s.jsx)("div",{className:f().addressText,children:e.formatted})]})]},e.id))}),I?(0,s.jsxs)("div",{style:{marginTop:16},children:[(0,s.jsxs)("div",{className:f().formGrid,children:[(0,s.jsxs)("label",{className:f().formLabel,children:["CEP",(0,s.jsx)("input",{type:"text",value:T.cep,onChange:e=>{let t=e.target.value.replace(/\D/g,"").slice(0,8);R(e=>({...e,cep:t})),8===t.length&&eM(t)},className:f().formInput,placeholder:"00000-000"})]}),(0,s.jsxs)("label",{className:"".concat(f().formLabel," ").concat(f().formFull),children:["Rua",(0,s.jsx)("input",{type:"text",value:T.logradouro,onChange:e=>R(t=>({...t,logradouro:e.target.value})),className:f().formInput})]}),(0,s.jsxs)("label",{className:f().formLabel,children:["Numero",(0,s.jsx)("input",{type:"text",value:T.numero,onChange:e=>R(t=>({...t,numero:e.target.value})),className:f().formInput})]}),(0,s.jsxs)("label",{className:f().formLabel,children:["Complemento",(0,s.jsx)("input",{type:"text",value:T.complemento,onChange:e=>R(t=>({...t,complemento:e.target.value})),className:f().formInput,placeholder:"Apto, bloco..."})]}),(0,s.jsxs)("label",{className:f().formLabel,children:["Bairro",(0,s.jsx)("input",{type:"text",value:T.bairro,onChange:e=>R(t=>({...t,bairro:e.target.value})),className:f().formInput})]}),(0,s.jsxs)("label",{className:f().formLabel,children:["Cidade",(0,s.jsx)("input",{type:"text",value:T.cidade,onChange:e=>R(t=>({...t,cidade:e.target.value})),className:f().formInput})]}),(0,s.jsxs)("label",{className:f().formLabel,children:["Estado",(0,s.jsx)("input",{type:"text",value:T.estado,onChange:e=>R(t=>({...t,estado:e.target.value.toUpperCase().slice(0,2)})),className:f().formInput,maxLength:2})]})]}),(0,s.jsxs)("div",{className:f().navBtns,children:[(0,s.jsx)("button",{className:f().btnSecondary,onClick:()=>w(!1),children:"Cancelar"}),(0,s.jsx)("button",{className:f().btnPrimary,onClick:eV,children:"Salvar endereco"})]})]}):(0,s.jsxs)("button",{className:f().addAddress,onClick:()=>w(!0),style:{marginTop:12},children:[(0,s.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,s.jsx)("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),(0,s.jsx)("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Adicionar endereco"]})]}),ec&&(0,s.jsxs)("div",{style:{marginTop:12,padding:"10px 14px",background:"#f0fdf4",borderRadius:8,fontSize:13,color:"var(--color-accent)",fontWeight:500},children:["Entrega agendada para ",new Date(ec.date+"T00:00:00").toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})," as ",ec.time]}),!eF&&(0,s.jsxs)("div",{style:{marginTop:20,borderTop:"1px solid var(--color-border)",paddingTop:16},children:[(0,s.jsx)("div",{style:{fontSize:15,fontWeight:600,marginBottom:12},children:"Instrucoes de entrega"}),(0,s.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginBottom:12},children:[{label:"Tocar campainha",icon:"\uD83D\uDD14"},{label:"Deixar na portaria",icon:"\uD83C\uDFE2"},{label:"Ligar ao chegar",icon:"\uD83D\uDCDE"},{label:"Nao tocar campainha",icon:"\uD83D\uDD15"}].map(e=>{let t=eb.includes(e.label);return(0,s.jsxs)("button",{type:"button",onClick:()=>{t?ej(eb.filter(t=>t!==e.label)):ej([...eb,e.label])},style:{padding:"8px 14px",borderRadius:"var(--radius-pill)",border:t?"2px solid var(--color-accent)":"1px solid var(--color-border)",background:t?"#f0fdf4":"transparent",fontSize:13,fontWeight:t?600:400,cursor:"pointer",display:"flex",alignItems:"center",gap:6,transition:"all 0.2s"},children:[(0,s.jsx)("span",{children:e.icon}),e.label]},e.label)})}),(0,s.jsx)("input",{type:"text",value:ek,onChange:e=>eC(e.target.value),placeholder:"Outras instrucoes... (ex: Apartamento 302, bloco B)",maxLength:200,className:f().formInput,style:{width:"100%"}}),(0,s.jsxs)("div",{role:"switch",tabIndex:0,"aria-checked":eS,onClick:()=>eN(!eS),onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),eN(!eS))},style:{marginTop:16,display:"flex",alignItems:"center",gap:12,padding:"14px 16px",borderRadius:"var(--radius-sm)",border:eS?"2px solid var(--color-accent)":"1px solid var(--color-border)",background:eS?"#f0fdf4":"transparent",cursor:"pointer",transition:"all 0.2s"},children:[(0,s.jsx)("div",{style:{width:44,height:24,borderRadius:12,background:eS?"var(--color-accent)":"#d1d5db",position:"relative",transition:"background 0.2s",flexShrink:0},children:(0,s.jsx)("div",{style:{width:20,height:20,borderRadius:"50%",background:"#fff",position:"absolute",top:2,left:eS?22:2,transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0,0,0,0.2)"}})}),(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsx)("div",{style:{fontSize:14,fontWeight:600,color:eS?"var(--color-accent)":"var(--color-text)"},children:"Entrega sem contato"}),(0,s.jsx)("div",{style:{fontSize:12,color:"var(--color-text-muted)",marginTop:2},children:"Deixar na porta / portaria"})]}),(0,s.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:eS?"var(--color-accent)":"var(--color-text-muted)",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"}),(0,s.jsx)("polyline",{points:"9 22 9 12 15 12 15 22"})]})]})]}),eD&&(0,s.jsxs)("div",{style:{marginTop:16,padding:14,background:"linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%)",border:"1px solid #fcd34d",borderRadius:"var(--radius-sm)",display:"flex",alignItems:"flex-start",gap:12,color:"#92400e"},children:[(0,s.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#f59e0b",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{flexShrink:0,marginTop:2},children:(0,s.jsx)("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{fontWeight:600,fontSize:14,marginBottom:4},children:"Entrega Express selecionada"}),(0,s.jsxs)("div",{style:{fontSize:13},children:["Seu pedido sera priorizado para entrega rapida!",Object.entries(a).filter(e=>{let[t]=e;return"express"===eI[t]}).map(e=>{var t;let[a,r]=e,n=null===(t=eT[a])||void 0===t?void 0:t.express;return n?(0,s.jsxs)("span",{style:{display:"block",marginTop:4},children:[r.partnerName,": ate ",n.time_min||20," min"]},a):null})]})]})]}),(0,s.jsxs)("div",{className:f().navBtns,children:[(0,s.jsx)("button",{className:f().btnSecondary,onClick:()=>e.push("/carrinho"),children:"Voltar"}),(0,s.jsx)("button",{className:f().btnPrimary,onClick:()=>{eF?j(1):S?j(1):q("Selecione um endereco")},children:"Continuar"})]})]}),1===b&&(0,s.jsxs)("div",{className:f().section,children:[(0,s.jsx)("div",{className:f().sectionTitle,children:"Forma de pagamento"}),(0,s.jsx)(v,{amount:eW,label:"Pedido SuperBora",onCreateOrder:async()=>{D(!0);try{let[e,t]=Object.entries(a)[0],s=eI[e]||"standard",r="pickup"===s,n=eA(e),o={address_id:r?null:S,payment_method:"stripe",items:t.items.map(e=>({id:e.id,quantity:e.quantity,notes:e.notes||"",addons:e.selectedOptions?e.selectedOptions.map(e=>e.id):[]})),partner_id:parseInt(e),tip:eB,coupon_code:eP,notes:"",delivery_instructions:r?"":eb.join("; "),contactless:!r&&eS,is_pickup:r,delivery_method:s,delivery_fee:n};return ec&&(o.schedule_date=ec.date,o.schedule_time=ec.time),(await (0,d.sg)("/checkout/process.php",o)).order_id}catch(e){return q(e.message),null}finally{D(!1)}},onSuccess:t=>{x(),e.push("/pedidos?success=1")},onError:e=>q(e),disabled:F||!eF&&!S}),(0,s.jsxs)("div",{className:f().payTabs,children:[(0,s.jsxs)("button",{className:"".concat(f().payTab," ").concat("pix"===B?f().payTabActive:""),onClick:()=>P("pix"),children:[(0,s.jsx)("div",{className:f().payTabIcon,children:(0,s.jsxs)("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[(0,s.jsx)("rect",{x:"2",y:"6",width:"20",height:"12",rx:"2"}),(0,s.jsx)("path",{d:"M12 12h.01"})]})}),(0,s.jsx)("div",{className:f().payTabLabel,children:"PIX"})]}),(0,s.jsxs)("button",{className:"".concat(f().payTab," ").concat("credito"===B?f().payTabActive:""),onClick:()=>P("credito"),children:[(0,s.jsx)("div",{className:f().payTabIcon,children:(0,s.jsxs)("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[(0,s.jsx)("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),(0,s.jsx)("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]})}),(0,s.jsx)("div",{className:f().payTabLabel,children:"Cartao"})]})]}),"credito"===B&&H.length>0&&(0,s.jsxs)("div",{style:{marginBottom:16},children:[(0,s.jsx)("div",{style:{fontSize:14,fontWeight:500,marginBottom:8},children:"Cartoes salvos"}),H.map(e=>(0,s.jsxs)("div",{onClick:()=>J(K===e.id?null:e.id),style:{display:"flex",alignItems:"center",gap:12,padding:"12px 14px",border:K===e.id?"2px solid var(--color-accent)":"1px solid var(--color-border)",borderRadius:"var(--radius-sm)",cursor:"pointer",marginBottom:6,background:K===e.id?"#f0fdf4":"transparent"},children:[(0,s.jsx)("div",{style:{width:20,height:20,borderRadius:"50%",border:K===e.id?"2px solid var(--color-accent)":"2px solid var(--color-border)",display:"flex",alignItems:"center",justifyContent:"center"},children:K===e.id&&(0,s.jsx)("div",{style:{width:10,height:10,borderRadius:"50%",background:"var(--color-accent)"}})}),(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsxs)("span",{style:{fontWeight:500,fontSize:14},children:["**** **** **** ",e.card_last4]}),(0,s.jsxs)("span",{style:{color:"var(--color-text-muted)",fontSize:12,marginLeft:8},children:[(e.card_brand||"").toUpperCase()," ",e.card_exp_month,"/",e.card_exp_year]})]}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),eG(e.id)},style:{color:"var(--color-text-muted)",fontSize:18,lineHeight:1},children:"\xd7"})]},e.id)),(0,s.jsxs)("div",{onClick:()=>J(null),style:{display:"flex",alignItems:"center",gap:12,padding:"12px 14px",border:null===K?"2px solid var(--color-accent)":"1px solid var(--color-border)",borderRadius:"var(--radius-sm)",cursor:"pointer",background:null===K?"#f0fdf4":"transparent"},children:[(0,s.jsx)("div",{style:{width:20,height:20,borderRadius:"50%",border:null===K?"2px solid var(--color-accent)":"2px solid var(--color-border)",display:"flex",alignItems:"center",justifyContent:"center"},children:null===K&&(0,s.jsx)("div",{style:{width:10,height:10,borderRadius:"50%",background:"var(--color-accent)"}})}),(0,s.jsx)("span",{style:{fontSize:14,fontWeight:500},children:"Usar novo cartao"})]})]}),"credito"===B&&!K&&(0,s.jsxs)("div",{className:f().cardForm,children:[(0,s.jsxs)("label",{className:f().formLabel,children:["Numero do cartao",(0,s.jsx)("input",{type:"text",value:A.number,onChange:e=>z(t=>({...t,number:e.target.value.replace(/\D/g,"").slice(0,16).replace(/(\d{4})/g,"$1 ").trim()})),className:f().formInput,placeholder:"0000 0000 0000 0000"})]}),(0,s.jsxs)("label",{className:f().formLabel,children:["Nome no cartao",(0,s.jsx)("input",{type:"text",value:A.name,onChange:e=>z(t=>({...t,name:e.target.value.toUpperCase()})),className:f().formInput,placeholder:"NOME COMO NO CARTAO"})]}),(0,s.jsxs)("div",{className:f().cardRow,children:[(0,s.jsxs)("label",{className:f().formLabel,children:["Validade",(0,s.jsx)("input",{type:"text",value:A.expiry,onChange:e=>{let t=e.target.value.replace(/\D/g,"").slice(0,4);t.length>2&&(t=t.slice(0,2)+"/"+t.slice(2)),z(e=>({...e,expiry:t}))},className:f().formInput,placeholder:"MM/AA"})]}),(0,s.jsxs)("label",{className:f().formLabel,children:["CVV",(0,s.jsx)("input",{type:"text",value:A.cvv,onChange:e=>z(t=>({...t,cvv:e.target.value.replace(/\D/g,"").slice(0,4)})),className:f().formInput,placeholder:"000"})]})]}),(0,s.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8,marginTop:8,cursor:"pointer",fontSize:14},children:[(0,s.jsx)("input",{type:"checkbox",checked:Z,onChange:e=>Y(e.target.checked)}),"Salvar cartao para proximas compras"]})]}),"credito"===B&&eW>0&&(0,s.jsx)(_,{total:eW,selectedInstallments:$,onSelect:e=>{ee(e.installments),ea(e)},maxInstallments:12}),"pix"===B&&(0,s.jsx)("div",{style:{padding:16,background:"#f0fdf4",borderRadius:8,fontSize:14,color:"#15803d"},children:m>1?"Serao gerados ".concat(m," codigos PIX (um por loja). O QR code expira em 30 minutos."):"Apos confirmar, voce recebera o codigo PIX para pagamento. O QR code expira em 30 minutos."}),es&&es.points_balance>0&&(0,s.jsxs)("div",{style:{marginTop:16,padding:14,border:"1px solid var(--color-border)",borderRadius:"var(--radius-sm)",background:en?"#fef9c3":"transparent"},children:[(0,s.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:10,cursor:"pointer"},children:[(0,s.jsx)("input",{type:"checkbox",checked:en,onChange:e=>eo(e.target.checked)}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{style:{fontWeight:600,fontSize:14},children:["Usar ",es.points_balance.toLocaleString("pt-BR")," pontos"]}),(0,s.jsxs)("div",{style:{fontSize:12,color:"var(--color-text-muted)"},children:["= ",(0,u.o_)(es.points_value)," de desconto (max 50% do subtotal)"]})]})]}),en&&eL>0&&(0,s.jsxs)("div",{style:{marginTop:8,fontSize:13,color:"var(--color-accent)",fontWeight:600},children:["Desconto de pontos: -",(0,u.o_)(eL)]})]}),eu>0&&(0,s.jsxs)("div",{style:{marginTop:16,padding:14,border:"1px solid var(--color-border)",borderRadius:"var(--radius-sm)",background:eh?"#e8f5e9":"transparent"},children:[(0,s.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:10,cursor:"pointer"},children:[(0,s.jsx)("input",{type:"checkbox",checked:eh,onChange:e=>em(e.target.checked)}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{fontWeight:600,fontSize:14},children:"Usar saldo de cartao presente"}),(0,s.jsxs)("div",{style:{fontSize:12,color:"var(--color-text-muted)"},children:["Saldo disponivel: ",(0,u.o_)(eu)]})]})]}),eh&&eE>0&&(0,s.jsxs)("div",{style:{marginTop:8,fontSize:13,color:"var(--color-accent)",fontWeight:600},children:["Desconto cartao presente: -",(0,u.o_)(eE)]})]}),ex>0&&(0,s.jsxs)("div",{style:{marginTop:16,padding:14,border:eg?"2px solid #10b981":"1px solid var(--color-border)",borderRadius:"var(--radius-sm)",background:eg?"#dcfce7":"transparent",transition:"all 0.2s"},children:[(0,s.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:10,cursor:"pointer"},children:[(0,s.jsx)("input",{type:"checkbox",checked:eg,onChange:e=>ef(e.target.checked),style:{width:18,height:18,accentColor:"#10b981"}}),(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsx)("div",{style:{fontWeight:600,fontSize:14,color:eg?"#059669":"var(--color-text)"},children:"Usar meu cashback"}),(0,s.jsxs)("div",{style:{fontSize:12,color:"var(--color-text-muted)"},children:["Saldo disponivel: ",(0,u.o_)(ex)]})]}),(0,s.jsx)("div",{style:{background:"#10b981",color:"white",padding:"4px 8px",borderRadius:6,fontSize:12,fontWeight:600},children:"CASHBACK"})]}),eg&&(0,s.jsxs)("div",{style:{marginTop:12},children:[(0,s.jsx)("div",{style:{fontSize:12,color:"var(--color-text-muted)",marginBottom:6},children:"Quanto deseja usar?"}),(0,s.jsx)("input",{type:"range",min:"0",max:ex,step:"0.01",value:ev,onChange:e=>ey(parseFloat(e.target.value)),style:{width:"100%",accentColor:"#10b981"}}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:4},children:[(0,s.jsx)("span",{style:{fontSize:12,color:"var(--color-text-muted)"},children:"R$ 0,00"}),(0,s.jsxs)("span",{style:{fontSize:14,fontWeight:600,color:"#10b981"},children:["-",(0,u.o_)(eO)]}),(0,s.jsx)("span",{style:{fontSize:12,color:"var(--color-text-muted)"},children:(0,u.o_)(ex)})]})]})]}),(0,s.jsxs)("div",{className:f().navBtns,children:[(0,s.jsx)("button",{className:f().btnSecondary,onClick:()=>j(0),children:"Voltar"}),(0,s.jsx)("button",{className:f().btnPrimary,onClick:eQ,disabled:F,children:F?(0,s.jsxs)("span",{className:f().loader,children:[(0,s.jsx)("span",{className:f().spinner})," Processando..."]}):"Confirmar ".concat(m>1?m+" pedidos":"pedido"," - ").concat((0,u.o_)(eW))})]})]})]}),(0,s.jsx)("div",{className:f().sidebar,children:(0,s.jsxs)("div",{className:"".concat(f().section," ").concat(f().summaryCard),children:[(0,s.jsx)("div",{className:f().sectionTitle,children:"Resumo do pedido"}),Object.entries(a).map(e=>{let[t,a]=e,r=y(t),n=eA(t),o=eI[t]||"standard";return(0,s.jsxs)("div",{style:{marginBottom:12,paddingBottom:12,borderBottom:"1px solid var(--color-border)"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[(0,s.jsx)("span",{style:{fontSize:14,fontWeight:600,color:"var(--color-text)",flex:1},children:a.partnerName}),"express"===o&&(0,s.jsx)("span",{style:{fontSize:10,fontWeight:700,padding:"2px 6px",background:"#f59e0b",color:"#fff",borderRadius:4},children:"EXPRESS"}),"pickup"===o&&(0,s.jsx)("span",{style:{fontSize:10,fontWeight:700,padding:"2px 6px",background:"#3b82f6",color:"#fff",borderRadius:4},children:"RETIRADA"})]}),(0,s.jsx)("div",{className:f().summaryItems,children:a.items.map(e=>(0,s.jsxs)("div",{className:f().summaryItem,children:[(0,s.jsxs)("span",{children:[e.nome," ",(0,s.jsxs)("span",{className:f().summaryItemQty,children:["x",e.quantity]}),e.selectedOptions&&e.selectedOptions.length>0&&(0,s.jsx)("span",{style:{display:"block",fontSize:11,color:"var(--color-text-muted)",marginTop:1},children:e.selectedOptions.map(e=>e.name).join(", ")})]}),(0,s.jsx)("span",{children:(0,u.o_)(g(e)*e.quantity)})]},e.cartKey||e.id))}),(0,s.jsxs)("div",{className:f().summaryRow,style:{fontSize:12},children:[(0,s.jsx)("span",{children:"Subtotal"}),(0,s.jsx)("span",{children:(0,u.o_)(r)})]}),(0,s.jsxs)("div",{className:f().summaryRow,style:{fontSize:12},children:[(0,s.jsx)("span",{children:"pickup"===o?"Retirada":"express"===o?"Express":"Entrega"}),(0,s.jsx)("span",{style:{color:0===n?"var(--color-accent)":"inherit"},children:0===n?"Gratis":(0,u.o_)(n)})]})]},t)}),(0,s.jsxs)("div",{className:f().summaryRow,children:[(0,s.jsx)("span",{children:"Subtotal geral"}),(0,s.jsx)("span",{children:(0,u.o_)(p)})]}),(0,s.jsxs)("div",{className:f().summaryRow,children:[(0,s.jsx)("span",{children:"Entregas"}),(0,s.jsx)("span",{children:0===ez?"Gratis":(0,u.o_)(ez)})]}),(0,s.jsxs)("div",{className:f().summaryRow,children:[(0,s.jsx)("span",{children:"Servico"}),(0,s.jsx)("span",{children:(0,u.o_)(2.49)})]}),eB>0&&(0,s.jsxs)("div",{className:f().summaryRow,children:[(0,s.jsx)("span",{children:"Gorjeta"}),(0,s.jsx)("span",{children:(0,u.o_)(eB)})]}),en&&eL>0&&(0,s.jsxs)("div",{className:f().summaryRow,style:{color:"var(--color-accent)"},children:[(0,s.jsx)("span",{children:"Pontos"}),(0,s.jsxs)("span",{children:["-",(0,u.o_)(eL)]})]}),eh&&eE>0&&(0,s.jsxs)("div",{className:f().summaryRow,style:{color:"var(--color-accent)"},children:[(0,s.jsx)("span",{children:"Cartao presente"}),(0,s.jsxs)("span",{children:["-",(0,u.o_)(eE)]})]}),eg&&eO>0&&(0,s.jsxs)("div",{className:f().summaryRow,style:{color:"#10b981"},children:[(0,s.jsx)("span",{children:"Cashback"}),(0,s.jsxs)("span",{children:["-",(0,u.o_)(eO)]})]}),(0,s.jsxs)("div",{className:f().summaryTotal,children:[(0,s.jsx)("span",{children:"Total"}),(0,s.jsx)("span",{children:(0,u.o_)(eW)})]}),"credito"===B&&$>1&&et&&(0,s.jsxs)("div",{style:{marginTop:12,padding:"10px 12px",background:et.hasInterest?"#fef3c7":"#dcfce7",borderRadius:"var(--radius-sm)",fontSize:13},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",color:et.hasInterest?"#92400e":"#15803d",fontWeight:600},children:[(0,s.jsxs)("span",{children:[$,"x de ",(0,u.o_)(et.installmentValue)]}),!et.hasInterest&&(0,s.jsx)("span",{style:{fontSize:10,padding:"2px 6px",background:"#15803d",color:"#fff",borderRadius:"var(--radius-pill)"},children:"SEM JUROS"})]}),et.hasInterest&&(0,s.jsxs)("div",{style:{fontSize:11,color:"#b45309",marginTop:4},children:["Total a prazo: ",(0,u.o_)(et.totalAmount)]})]})]})})]})]})}},8779:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(7437),r=a(2265),n=a(9376),o=a(7128);function l(e){let{children:t}=e,{isAuthenticated:a,loading:l}=(0,o.a)(),i=(0,n.useRouter)();return((0,r.useEffect)(()=>{if(!l&&!a){let e=window.location.pathname;i.push("/login?return=".concat(encodeURIComponent(e)))}},[l,a,i]),l)?(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:(0,s.jsx)("div",{style:{width:32,height:32,border:"3px solid var(--color-border)",borderTopColor:"var(--color-accent)",borderRadius:"50%",animation:"spin 0.8s linear infinite"}})}):a?t:null}},6349:function(e){e.exports={page:"Checkout_page__fcSIm",header:"Checkout_header__NbpnQ",backBtn:"Checkout_backBtn__DONgs",title:"Checkout_title__fGtPZ",layout:"Checkout_layout__xL7WM",main:"Checkout_main__ANQk8",sidebar:"Checkout_sidebar__tL_Oe",steps:"Checkout_steps__VARjs",step:"Checkout_step__mAOpd",stepDone:"Checkout_stepDone__YeHdW",stepShine:"Checkout_stepShine__5Z4uA",stepCurrent:"Checkout_stepCurrent__hG1fX",stepPulse:"Checkout_stepPulse__7A5XR",section:"Checkout_section___C0mZ",sectionTitle:"Checkout_sectionTitle__Hs88w",addressList:"Checkout_addressList__StJMC",addressCard:"Checkout_addressCard__574N1",addressActive:"Checkout_addressActive__7ogu_",addressRadio:"Checkout_addressRadio__iKWsp",addressRadioActive:"Checkout_addressRadioActive__zPPtk",addressRadioDot:"Checkout_addressRadioDot__NpZts",addressInfo:"Checkout_addressInfo__MO2X6",addressLabel:"Checkout_addressLabel__giOgc",addressText:"Checkout_addressText__uI8cA",addAddress:"Checkout_addAddress__8IBWD",formGrid:"Checkout_formGrid__rjUxk",formFull:"Checkout_formFull__LHkpy",formLabel:"Checkout_formLabel__0MHaB",formInput:"Checkout_formInput__odD4q",payTabs:"Checkout_payTabs__AVEs7",payTab:"Checkout_payTab__JUZXK",payTabActive:"Checkout_payTabActive__FICHI",payTabIcon:"Checkout_payTabIcon__wNGs7",payTabLabel:"Checkout_payTabLabel__SFly8",pixBox:"Checkout_pixBox__Al3kk",pixQr:"Checkout_pixQr__8Cy_X",pixCode:"Checkout_pixCode__WvJa5",pixCodeInput:"Checkout_pixCodeInput__bTEO4",pixCopyBtn:"Checkout_pixCopyBtn__F6cHT",pixTimer:"Checkout_pixTimer__CdOb8",pixStatus:"Checkout_pixStatus__bQozD",pixPaid:"Checkout_pixPaid__sWN4L",cardForm:"Checkout_cardForm__949_a",cardRow:"Checkout_cardRow__Am_K_",summaryCard:"Checkout_summaryCard__fMe7k",summaryItems:"Checkout_summaryItems__PIhKZ",summaryItem:"Checkout_summaryItem___nDIu",summaryItemQty:"Checkout_summaryItemQty__L0a_G",summaryRow:"Checkout_summaryRow__eLtxa",summaryDiscount:"Checkout_summaryDiscount__BjX4L",summaryTotal:"Checkout_summaryTotal__EDBhm",navBtns:"Checkout_navBtns__6uSi4",btnSecondary:"Checkout_btnSecondary__M8EAe",btnPrimary:"Checkout_btnPrimary__tANWz",btnPrimaryShine:"Checkout_btnPrimaryShine__Z_XBp",success:"Checkout_success__Fi3HG",celebrationBg:"Checkout_celebrationBg__buFcD",successIcon:"Checkout_successIcon__3F1_g",successIconPop:"Checkout_successIconPop__9_km6",successRingPulse:"Checkout_successRingPulse__fGAlt",successTitle:"Checkout_successTitle__M6lsV",successTextSlide:"Checkout_successTextSlide__d66RX",successText:"Checkout_successText__5bnLp",successOrderNum:"Checkout_successOrderNum__4Fwnu",orderNumPop:"Checkout_orderNumPop__cwKvN",orderNumShine:"Checkout_orderNumShine__BH9_I",successConfetti:"Checkout_successConfetti__QrTnU",celebrationParticle:"Checkout_celebrationParticle___Jl3B",floatParticle:"Checkout_floatParticle__I14R_",loader:"Checkout_loader__ri2_k",spinner:"Checkout_spinner__w5w9I",spin:"Checkout_spin__Z8ak7",walletPayment:"Checkout_walletPayment__BxVG8",applePayBtn:"Checkout_applePayBtn__8OWfG",googlePayBtn:"Checkout_googlePayBtn__y3dnQ",walletDivider:"Checkout_walletDivider__Fo340",btnSpinner:"Checkout_btnSpinner__Kaxnd"}},3679:function(e){e.exports={container:"InstallmentSelector_container__yMQa_",label:"InstallmentSelector_label__blltl",selector:"InstallmentSelector_selector__lpaUU",selectedOption:"InstallmentSelector_selectedOption__TArCK",optionContent:"InstallmentSelector_optionContent__VVrYT",optionText:"InstallmentSelector_optionText__X5So_",arrow:"InstallmentSelector_arrow__dzt20",arrowUp:"InstallmentSelector_arrowUp__TAjUP",interestFreeBadge:"InstallmentSelector_interestFreeBadge__oM0Qd",interestFreeBadgeSmall:"InstallmentSelector_interestFreeBadgeSmall__RHd6V",interestBadge:"InstallmentSelector_interestBadge__TA94s",dropdown:"InstallmentSelector_dropdown__S7ej4",interestFreeHighlight:"InstallmentSelector_interestFreeHighlight__yIvln",optionsList:"InstallmentSelector_optionsList__5MYsA",option:"InstallmentSelector_option__zBRJI",optionSelected:"InstallmentSelector_optionSelected__qbS02",optionLeft:"InstallmentSelector_optionLeft__QAJT2",optionDetails:"InstallmentSelector_optionDetails__gl_s2",installmentText:"InstallmentSelector_installmentText___PGKq",radio:"InstallmentSelector_radio__8t57d",radioSelected:"InstallmentSelector_radioSelected__GPBy9",radioDot:"InstallmentSelector_radioDot__ATukC",optionRight:"InstallmentSelector_optionRight__AwStr",totalNoInterest:"InstallmentSelector_totalNoInterest__opDA7",interestInfo:"InstallmentSelector_interestInfo__65Tp9",totalWithInterest:"InstallmentSelector_totalWithInterest__5cX7A",interestDiff:"InstallmentSelector_interestDiff__aIKtk",interestSummary:"InstallmentSelector_interestSummary__li3C9"}}},function(e){e.O(0,[9252,7648,9938,0,2971,2117,1744],function(){return e(e.s=9242)}),_N_E=e.O()}]);
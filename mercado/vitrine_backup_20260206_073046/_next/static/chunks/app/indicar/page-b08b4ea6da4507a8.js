(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6132],{1428:function(e,t,a){Promise.resolve().then(a.bind(a,6135))},6428:function(e,t,a){"use strict";a.d(t,{LP:function(){return i},QW:function(){return u},SC:function(){return l},o4:function(){return o},pE:function(){return h},sg:function(){return d}}),a(257);let s="/api/mercado",r="superbora_token";function n(){return window.location.origin}function i(){try{return localStorage.getItem(r)}catch(e){return null}}function o(e){try{e?localStorage.setItem(r,e):localStorage.removeItem(r)}catch(e){}}function c(){let e=i();return e?{Authorization:"Bearer ".concat(e)}:{}}async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{signal:r}=a,i=new URL(s+e,n());Object.entries(t).forEach(e=>{let[t,a]=e;null!=a&&""!==a&&i.searchParams.set(t,a)});let o=await fetch(i.toString(),{credentials:"include",headers:c(),signal:r});if(!o.ok){let e=await o.json().catch(()=>null);throw Error((null==e?void 0:e.message)||"API error: ".concat(o.status))}let l=await o.json().catch(()=>null);if(!l||!l.success)throw Error((null==l?void 0:l.message)||"Erro desconhecido na API");return void 0!==l.data?l.data:null}async function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{signal:r}=a,i=new URL(s+e,n()),o=await fetch(i.toString(),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...c()},body:JSON.stringify(t),signal:r}),l=await o.json().catch(()=>null);if(!o.ok||!(null==l?void 0:l.success))throw Error((null==l?void 0:l.message)||"API error: ".concat(o.status));return void 0!==l.data?l.data:null}async function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{signal:r}=a,i=new URL(s+e,n()),o=await fetch(i.toString(),{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",...c()},body:JSON.stringify(t),signal:r}),l=await o.json().catch(()=>null);if(!o.ok||!(null==l?void 0:l.success))throw Error((null==l?void 0:l.message)||"API error: ".concat(o.status));return void 0!==l.data?l.data:null}async function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{signal:r}=a,i=new URL(s+e,n());Object.entries(t).forEach(e=>{let[t,a]=e;null!=a&&""!==a&&i.searchParams.set(t,a)});let o=await fetch(i.toString(),{method:"DELETE",credentials:"include",headers:c(),signal:r}),l=await o.json().catch(()=>null);if(!o.ok||!(null==l?void 0:l.success))throw Error((null==l?void 0:l.message)||"API error: ".concat(o.status));return void 0!==l.data?l.data:null}},8779:function(e,t,a){"use strict";a.d(t,{Z:function(){return o}});var s=a(7437),r=a(2265),n=a(9376),i=a(7128);function o(e){let{children:t}=e,{isAuthenticated:a,loading:o}=(0,i.a)(),c=(0,n.useRouter)();return((0,r.useEffect)(()=>{if(!o&&!a){let e=window.location.pathname;c.push("/login?return=".concat(encodeURIComponent(e)))}},[o,a,c]),o)?(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:(0,s.jsx)("div",{style:{width:32,height:32,border:"3px solid var(--color-border)",borderTopColor:"var(--color-accent)",borderRadius:"50%",animation:"spin 0.8s linear infinite"}})}):a?t:null}},7128:function(e,t,a){"use strict";a.d(t,{H:function(){return o},a:function(){return c}});var s=a(7437),r=a(2265),n=a(6428);let i=(0,r.createContext)(null);function o(e){let{children:t}=e,[a,o]=(0,r.useState)(null),[c,l]=(0,r.useState)(!0),d=(0,r.useRef)(!0);(0,r.useEffect)(()=>(d.current=!0,()=>{d.current=!1}),[]);let h=(0,r.useCallback)(async()=>{if(!(0,n.LP)()){d.current&&(o(null),l(!1));return}try{let e=await (0,n.SC)("/auth/session.php");if(!d.current)return;e.authenticated&&e.customer?o(e.customer):((0,n.o4)(null),o(null))}catch(e){if(!d.current)return;"AbortError"!==e.name&&console.warn("[Auth] Session check failed"),(0,n.o4)(null),o(null)}finally{d.current&&l(!1)}},[]);(0,r.useEffect)(()=>{h()},[h]);let u=(0,r.useCallback)(async(e,t)=>{try{let a=await (0,n.sg)("/auth/login.php",{email:e,senha:t});if(!d.current)return null;return(0,n.o4)(a.token),o(a.customer),a.customer}catch(e){throw console.warn("[AuthContext] Login failed:",e.message),e}},[]),p=(0,r.useCallback)(async e=>{try{let t=await (0,n.sg)("/auth/register.php",e);if(!d.current)return null;return(0,n.o4)(t.token),o(t.customer),t.customer}catch(e){throw console.warn("[AuthContext] Register failed:",e.message),e}},[]),_=(0,r.useCallback)(async e=>{try{let t=await (0,n.sg)("/auth/google.php",{credential:e});if(!d.current)return null;return(0,n.o4)(t.token),o(t.customer),t}catch(e){throw console.warn("[AuthContext] Google login failed:",e.message),e}},[]),m=(0,r.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"whatsapp";try{let a={channel:t};return"email"===t?a.email=e:a.phone=e,await (0,n.sg)("/auth/send-code.php",a)}catch(e){throw console.warn("[AuthContext] Send OTP failed:",e.message),e}},[]),g=(0,r.useCallback)(async(e,t,a)=>{try{let s={phone:e,code:t};a&&(s.name=a);let r=await (0,n.sg)("/auth/verify-code.php",s);if(!d.current)return null;return(0,n.o4)(r.token),o(r.customer),r}catch(e){throw console.warn("[AuthContext] Verify OTP failed:",e.message),e}},[]),x=(0,r.useCallback)(()=>{(0,n.o4)(null),o(null)},[]),v=(0,r.useCallback)(e=>{o(t=>t?{...t,...e}:t)},[]),j=(0,r.useMemo)(()=>({customer:a,loading:c,isAuthenticated:!!a,login:u,loginWithGoogle:_,register:p,sendOtp:m,verifyOtp:g,logout:x,updateCustomer:v,refreshSession:h}),[a,c,u,_,p,m,g,x,v,h]);return(0,s.jsx)(i.Provider,{value:j,children:t})}function c(){let e=(0,r.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},6135:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var s=a(7437),r=a(2265),n=a(7648),i=a(8779),o=a(5086),c=a(6428),l=a(5950),d=a.n(l);function h(){return(0,s.jsx)(i.Z,{children:(0,s.jsx)(u,{})})}function u(){let[e,t]=(0,r.useState)(null),[a,i]=(0,r.useState)(!0),[l,h]=(0,r.useState)(""),[u,p]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(0,c.SC)("/customer/referral-dashboard.php").then(e=>t(e)).catch(e=>h(e.message||"Erro ao carregar")).finally(()=>i(!1))},[]);let _=(0,r.useCallback)(async()=>{if(e){try{await navigator.clipboard.writeText(e.referral_code)}catch(a){let t=document.createElement("textarea");t.value=e.referral_code,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}p(!0),setTimeout(()=>p(!1),2e3)}},[e]),m=(0,r.useCallback)(()=>{if(!e)return;let t="Use meu codigo ".concat(e.referral_code," no SuperBora e ganhe R$10 de desconto na primeira compra! ").concat(e.share_url);window.open("https://wa.me/?text=".concat(encodeURIComponent(t)),"_blank")},[e]);return a?(0,s.jsx)("div",{className:d().page,children:(0,s.jsx)("div",{className:d().loader,children:(0,s.jsx)("div",{className:d().spinner})})}):l?(0,s.jsx)("div",{className:d().page,children:(0,s.jsxs)("div",{className:d().errorCard,children:[(0,s.jsx)("p",{children:l}),(0,s.jsx)(n.default,{href:"/perfil",className:d().backLink,children:"Voltar ao perfil"})]})}):e?(0,s.jsxs)("div",{className:d().page,children:[(0,s.jsxs)("div",{className:d().header,children:[(0,s.jsx)(n.default,{href:"/perfil",className:d().backBtn,"aria-label":"Voltar",children:(0,s.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("polyline",{points:"15 18 9 12 15 6"})})}),(0,s.jsx)("h1",{className:d().headerTitle,children:"Indique amigos"})]}),(0,s.jsxs)("div",{className:d().hero,children:[(0,s.jsx)("div",{className:d().heroIcon,children:(0,s.jsxs)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),(0,s.jsx)("circle",{cx:"8.5",cy:"7",r:"4"}),(0,s.jsx)("line",{x1:"20",y1:"8",x2:"20",y2:"14"}),(0,s.jsx)("line",{x1:"23",y1:"11",x2:"17",y2:"11"})]})}),(0,s.jsx)("h2",{className:d().heroTitle,children:"Indique e ganhe!"}),(0,s.jsxs)("p",{className:d().heroText,children:["Convide seus amigos para o SuperBora. Voce ganha ",(0,s.jsx)("strong",{children:"500 pontos"})," e seu amigo ganha ",(0,s.jsx)("strong",{children:"R$10 de desconto"})," na primeira compra!"]})]}),(0,s.jsxs)("div",{className:d().stepsSection,children:[(0,s.jsx)("h3",{className:d().sectionTitle,children:"Como funciona"}),(0,s.jsxs)("div",{className:d().steps,children:[(0,s.jsxs)("div",{className:d().step,children:[(0,s.jsx)("div",{className:d().stepNumber,children:"1"}),(0,s.jsx)("div",{className:d().stepIcon,children:(0,s.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("circle",{cx:"18",cy:"5",r:"3"}),(0,s.jsx)("circle",{cx:"6",cy:"12",r:"3"}),(0,s.jsx)("circle",{cx:"18",cy:"19",r:"3"}),(0,s.jsx)("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),(0,s.jsx)("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]})}),(0,s.jsx)("div",{className:d().stepLabel,children:"Compartilhe seu codigo"})]}),(0,s.jsx)("div",{className:d().stepConnector}),(0,s.jsxs)("div",{className:d().step,children:[(0,s.jsx)("div",{className:d().stepNumber,children:"2"}),(0,s.jsx)("div",{className:d().stepIcon,children:(0,s.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),(0,s.jsx)("circle",{cx:"8.5",cy:"7",r:"4"}),(0,s.jsx)("polyline",{points:"17 11 19 13 23 9"})]})}),(0,s.jsx)("div",{className:d().stepLabel,children:"Amigo faz cadastro"})]}),(0,s.jsx)("div",{className:d().stepConnector}),(0,s.jsxs)("div",{className:d().step,children:[(0,s.jsx)("div",{className:d().stepNumber,children:"3"}),(0,s.jsx)("div",{className:d().stepIcon,children:(0,s.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),(0,s.jsx)("div",{className:d().stepLabel,children:"Voces ganham pontos"})]})]})]}),(0,s.jsxs)("div",{className:d().shareSection,children:[(0,s.jsx)("h3",{className:d().sectionTitle,children:"Seu codigo de indicacao"}),(0,s.jsxs)("div",{className:d().codeCard,children:[(0,s.jsx)("div",{className:d().codeLabel,children:"Codigo"}),(0,s.jsx)("div",{className:d().codeValue,children:e.referral_code})]}),(0,s.jsxs)("div",{className:d().shareActions,children:[(0,s.jsxs)("button",{className:d().copyBtn,onClick:_,type:"button",children:[(0,s.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,s.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),u?"Copiado!":"Copiar codigo"]}),(0,s.jsxs)("button",{className:d().whatsappBtn,onClick:m,type:"button",children:[(0,s.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"#fff",children:(0,s.jsx)("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"WhatsApp"]}),(0,s.jsx)(o.Z,{url:e.share_url,title:"SuperBora - Indique amigos",text:"Use meu codigo ".concat(e.referral_code," no SuperBora e ganhe R$10 de desconto! ").concat(e.share_url),variant:"button",size:18})]})]}),(0,s.jsxs)("div",{className:d().statsSection,children:[(0,s.jsx)("h3",{className:d().sectionTitle,children:"Suas indicacoes"}),(0,s.jsxs)("div",{className:d().statsGrid,children:[(0,s.jsxs)("div",{className:d().statCard,children:[(0,s.jsx)("div",{className:d().statValue,children:e.total_referrals}),(0,s.jsx)("div",{className:d().statLabel,children:"Total indicados"})]}),(0,s.jsxs)("div",{className:d().statCard,children:[(0,s.jsx)("div",{className:d().statValue,children:e.completed}),(0,s.jsx)("div",{className:d().statLabel,children:"Completos"})]}),(0,s.jsxs)("div",{className:d().statCard,children:[(0,s.jsx)("div",{className:d().statValue,children:e.pending}),(0,s.jsx)("div",{className:d().statLabel,children:"Pendentes"})]}),(0,s.jsxs)("div",{className:"".concat(d().statCard," ").concat(d().statCardAccent),children:[(0,s.jsx)("div",{className:d().statValue,children:e.total_points}),(0,s.jsx)("div",{className:d().statLabel,children:"Pontos ganhos"})]})]})]}),e.recent_activity&&e.recent_activity.length>0&&(0,s.jsxs)("div",{className:d().historySection,children:[(0,s.jsx)("h3",{className:d().sectionTitle,children:"Atividade recente"}),(0,s.jsx)("div",{className:d().historyList,children:e.recent_activity.map(e=>(0,s.jsxs)("div",{className:d().historyItem,children:[(0,s.jsx)("div",{className:d().historyAvatar,children:(e.referred_name||"U")[0].toUpperCase()}),(0,s.jsxs)("div",{className:d().historyInfo,children:[(0,s.jsx)("div",{className:d().historyName,children:e.referred_name}),(0,s.jsx)("div",{className:d().historyDate,children:new Date(e.created_at).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})})]}),(0,s.jsxs)("div",{className:d().historyRight,children:[(0,s.jsx)("span",{className:"".concat(d().historyBadge," ").concat("completed"===e.status?d().badgeCompleted:d().badgePending),children:e.status_label}),e.points_earned>0&&(0,s.jsxs)("span",{className:d().historyPoints,children:["+",e.points_earned," pts"]})]})]},e.id))})]}),0===e.total_referrals&&(0,s.jsxs)("div",{className:d().emptyState,children:[(0,s.jsxs)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-text-muted)",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),(0,s.jsx)("circle",{cx:"9",cy:"7",r:"4"}),(0,s.jsx)("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),(0,s.jsx)("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),(0,s.jsx)("p",{className:d().emptyText,children:"Voce ainda nao indicou ninguem."}),(0,s.jsx)("p",{className:d().emptySubtext,children:"Compartilhe seu codigo e comece a ganhar pontos!"})]})]}):null}},5950:function(e){e.exports={page:"page_page__8lYtp",header:"page_header__mCAFY",backBtn:"page_backBtn__p26sL",headerTitle:"page_headerTitle__xJZFK",hero:"page_hero__fvT1g",heroIcon:"page_heroIcon__X_JET",heroTitle:"page_heroTitle__qco0G",heroText:"page_heroText__U5SXO",sectionTitle:"page_sectionTitle__NOrvv",stepsSection:"page_stepsSection__Uh6En",steps:"page_steps__bjvbu",step:"page_step___x2S4",stepNumber:"page_stepNumber__jaxP4",stepIcon:"page_stepIcon__5KBJE",stepLabel:"page_stepLabel__3h5Gs",stepConnector:"page_stepConnector___NV__",shareSection:"page_shareSection__sJ7k4",codeCard:"page_codeCard__4Jkix",codeLabel:"page_codeLabel__pCEUX",codeValue:"page_codeValue__GkjoD",shareActions:"page_shareActions__S5qO4",copyBtn:"page_copyBtn__Naj2Z",whatsappBtn:"page_whatsappBtn__4GgW7",statsSection:"page_statsSection__EZxRu",statsGrid:"page_statsGrid__C6co2",statCard:"page_statCard__KB9YQ",statCardAccent:"page_statCardAccent__1IyFz",statValue:"page_statValue__kSQaK",statLabel:"page_statLabel__mqjTY",historySection:"page_historySection__MwYJo",historyList:"page_historyList__rjwl5",historyItem:"page_historyItem__v9MbJ",historyAvatar:"page_historyAvatar__aM6Mf",historyInfo:"page_historyInfo__87ZH5",historyName:"page_historyName__PgvD5",historyDate:"page_historyDate__NJyMt",historyRight:"page_historyRight__oYxvR",historyBadge:"page_historyBadge__VjSTv",badgeCompleted:"page_badgeCompleted__lGCQj",badgePending:"page_badgePending__hirW9",historyPoints:"page_historyPoints__BP_IZ",emptyState:"page_emptyState__5g_yZ",emptyText:"page_emptyText__1wcBx",emptySubtext:"page_emptySubtext__Pav9z",loader:"page_loader__MK_A7",spinner:"page_spinner__g6SPt",spin:"page_spin__hFbVk",errorCard:"page_errorCard__9TMyp",backLink:"page_backLink__5Z_5i"}}},function(e){e.O(0,[5026,5243,7648,9617,2971,2117,1744],function(){return e(e.s=1428)}),_N_E=e.O()}]);
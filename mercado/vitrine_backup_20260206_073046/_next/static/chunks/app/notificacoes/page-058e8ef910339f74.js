(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4227],{4335:function(e,t,n){Promise.resolve().then(n.bind(n,4799))},6428:function(e,t,n){"use strict";n.d(t,{LP:function(){return i},QW:function(){return h},SC:function(){return l},o4:function(){return s},pE:function(){return d},sg:function(){return u}}),n(257);let r="/api/mercado",a="superbora_token";function o(){return window.location.origin}function i(){try{return localStorage.getItem(a)}catch(e){return null}}function s(e){try{e?localStorage.setItem(a,e):localStorage.removeItem(a)}catch(e){}}function c(){let e=i();return e?{Authorization:"Bearer ".concat(e)}:{}}async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{signal:a}=n,i=new URL(r+e,o());Object.entries(t).forEach(e=>{let[t,n]=e;null!=n&&""!==n&&i.searchParams.set(t,n)});let s=await fetch(i.toString(),{credentials:"include",headers:c(),signal:a});if(!s.ok){let e=await s.json().catch(()=>null);throw Error((null==e?void 0:e.message)||"API error: ".concat(s.status))}let l=await s.json().catch(()=>null);if(!l||!l.success)throw Error((null==l?void 0:l.message)||"Erro desconhecido na API");return void 0!==l.data?l.data:null}async function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{signal:a}=n,i=new URL(r+e,o()),s=await fetch(i.toString(),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...c()},body:JSON.stringify(t),signal:a}),l=await s.json().catch(()=>null);if(!s.ok||!(null==l?void 0:l.success))throw Error((null==l?void 0:l.message)||"API error: ".concat(s.status));return void 0!==l.data?l.data:null}async function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{signal:a}=n,i=new URL(r+e,o()),s=await fetch(i.toString(),{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",...c()},body:JSON.stringify(t),signal:a}),l=await s.json().catch(()=>null);if(!s.ok||!(null==l?void 0:l.success))throw Error((null==l?void 0:l.message)||"API error: ".concat(s.status));return void 0!==l.data?l.data:null}async function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{signal:a}=n,i=new URL(r+e,o());Object.entries(t).forEach(e=>{let[t,n]=e;null!=n&&""!==n&&i.searchParams.set(t,n)});let s=await fetch(i.toString(),{method:"DELETE",credentials:"include",headers:c(),signal:a}),l=await s.json().catch(()=>null);if(!s.ok||!(null==l?void 0:l.success))throw Error((null==l?void 0:l.message)||"API error: ".concat(s.status));return void 0!==l.data?l.data:null}},2277:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(7437),a=n(2265),o=n(9376),i=n(7648),s=n(7128),c=n(1477),l=n.n(c);let u=[{href:"/",label:"Inicio",icon:(0,r.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),(0,r.jsx)("polyline",{points:"9 22 9 12 15 12 15 22"})]})},{href:"/busca",label:"Busca",icon:(0,r.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,r.jsx)("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})},{href:"/pedidos",label:"Pedidos",icon:(0,r.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),(0,r.jsx)("polyline",{points:"14 2 14 8 20 8"}),(0,r.jsx)("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),(0,r.jsx)("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]})},{href:"/fidelidade",label:"Pontos",icon:(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,r.jsx)("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}];function d(){let e=(0,o.usePathname)(),{isAuthenticated:t}=(0,s.a)(),[n,c]=(0,a.useState)(!1);function d(t){return"/"===t?"/"===e||""===e:e.startsWith(t)}(0,a.useEffect)(()=>{c(!0)},[]);let h=[...u,n&&t?{href:"/perfil",label:"Perfil",icon:(0,r.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,r.jsx)("circle",{cx:"12",cy:"7",r:"4"})]})}:{href:"/login",label:"Entrar",icon:(0,r.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}),(0,r.jsx)("polyline",{points:"10 17 15 12 10 7"}),(0,r.jsx)("line",{x1:"15",y1:"12",x2:"3",y2:"12"})]})}];return(0,r.jsx)("nav",{className:l().nav,"aria-label":"Navegacao principal",children:h.map(e=>(0,r.jsxs)(i.default,{href:e.href,className:"".concat(l().item," ").concat(d(e.href)?l().active:""),"aria-current":d(e.href)?"page":void 0,children:[(0,r.jsx)("span",{className:l().icon,children:e.icon}),(0,r.jsx)("span",{className:l().label,children:e.label})]},e.href))})}},7128:function(e,t,n){"use strict";n.d(t,{H:function(){return s},a:function(){return c}});var r=n(7437),a=n(2265),o=n(6428);let i=(0,a.createContext)(null);function s(e){let{children:t}=e,[n,s]=(0,a.useState)(null),[c,l]=(0,a.useState)(!0),u=(0,a.useRef)(!0);(0,a.useEffect)(()=>(u.current=!0,()=>{u.current=!1}),[]);let d=(0,a.useCallback)(async()=>{if(!(0,o.LP)()){u.current&&(s(null),l(!1));return}try{let e=await (0,o.SC)("/auth/session.php");if(!u.current)return;e.authenticated&&e.customer?s(e.customer):((0,o.o4)(null),s(null))}catch(e){if(!u.current)return;"AbortError"!==e.name&&console.warn("[Auth] Session check failed"),(0,o.o4)(null),s(null)}finally{u.current&&l(!1)}},[]);(0,a.useEffect)(()=>{d()},[d]);let h=(0,a.useCallback)(async(e,t)=>{try{let n=await (0,o.sg)("/auth/login.php",{email:e,senha:t});if(!u.current)return null;return(0,o.o4)(n.token),s(n.customer),n.customer}catch(e){throw console.warn("[AuthContext] Login failed:",e.message),e}},[]),f=(0,a.useCallback)(async e=>{try{let t=await (0,o.sg)("/auth/register.php",e);if(!u.current)return null;return(0,o.o4)(t.token),s(t.customer),t.customer}catch(e){throw console.warn("[AuthContext] Register failed:",e.message),e}},[]),m=(0,a.useCallback)(async e=>{try{let t=await (0,o.sg)("/auth/google.php",{credential:e});if(!u.current)return null;return(0,o.o4)(t.token),s(t.customer),t}catch(e){throw console.warn("[AuthContext] Google login failed:",e.message),e}},[]),p=(0,a.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"whatsapp";try{let n={channel:t};return"email"===t?n.email=e:n.phone=e,await (0,o.sg)("/auth/send-code.php",n)}catch(e){throw console.warn("[AuthContext] Send OTP failed:",e.message),e}},[]),g=(0,a.useCallback)(async(e,t,n)=>{try{let r={phone:e,code:t};n&&(r.name=n);let a=await (0,o.sg)("/auth/verify-code.php",r);if(!u.current)return null;return(0,o.o4)(a.token),s(a.customer),a}catch(e){throw console.warn("[AuthContext] Verify OTP failed:",e.message),e}},[]),_=(0,a.useCallback)(()=>{(0,o.o4)(null),s(null)},[]),v=(0,a.useCallback)(e=>{s(t=>t?{...t,...e}:t)},[]),x=(0,a.useMemo)(()=>({customer:n,loading:c,isAuthenticated:!!n,login:h,loginWithGoogle:m,register:f,sendOtp:p,verifyOtp:g,logout:_,updateCustomer:v,refreshSession:d}),[n,c,h,m,f,p,g,_,v,d]);return(0,r.jsx)(i.Provider,{value:x,children:t})}function c(){let e=(0,a.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},4799:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var r=n(7437),a=n(2265),o=n(7648),i=n(9376),s=n(7128),c=n(6428),l=n(2277),u=n(1545),d=n.n(u);let h={promo:{icon:"\uD83C\uDF81",color:"#ec4899",bg:"#fdf2f8"},order:{icon:"\uD83D\uDCE6",color:"#3b82f6",bg:"#eff6ff"},delivery:{icon:"\uD83D\uDEF5",color:"#10b981",bg:"#ecfdf5"},coupon:{icon:"\uD83C\uDF9F️",color:"#f59e0b",bg:"#fffbeb"},system:{icon:"\uD83D\uDD14",color:"#6b7280",bg:"#f3f4f6"},reward:{icon:"⭐",color:"#8b5cf6",bg:"#f5f3ff"}};function f(){let e=(0,i.useRouter)(),{isAuthenticated:t,loading:n}=(0,s.a)(),[u,f]=(0,a.useState)([]),[m,p]=(0,a.useState)(!0),[g,_]=(0,a.useState)(0);(0,a.useEffect)(()=>{if(!n){if(!t){e.push("/login?redirect=/notificacoes");return}(0,c.SC)("/customer/notifications.php").then(e=>{f(e.notifications||[]),_(e.unread_count||0),p(!1)}).catch(()=>{p(!1)})}},[t,n,e]);let v=(0,a.useCallback)(async e=>{try{await (0,c.sg)("/customer/notifications.php",{notification_id:e}),f(t=>t.map(t=>t.id===e?{...t,is_read:!0,read_at:new Date().toISOString()}:t)),_(e=>Math.max(0,e-1))}catch(e){console.error("Error marking notification as read:",e)}},[]),x=(0,a.useCallback)(async()=>{try{await (0,c.sg)("/customer/notifications.php",{mark_all_read:!0}),f(e=>e.map(e=>({...e,is_read:!0,read_at:new Date().toISOString()}))),_(0)}catch(e){console.error("Error marking all as read:",e)}},[]),j=(0,a.useCallback)(t=>{t.is_read||v(t.id),t.link&&e.push(t.link)},[v,e]);return n||m?(0,r.jsxs)("div",{className:d().page,children:[(0,r.jsxs)("header",{className:d().header,children:[(0,r.jsx)(o.default,{href:"/",className:d().backBtn,"aria-label":"Voltar",children:(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,r.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),(0,r.jsx)("h1",{className:d().title,children:"Notifica\xe7\xf5es"}),(0,r.jsx)("div",{className:d().placeholder})]}),(0,r.jsx)("div",{className:d().loadingState,children:[1,2,3,4].map(e=>(0,r.jsxs)("div",{className:d().skeletonItem,children:[(0,r.jsx)("div",{className:d().skeletonIcon}),(0,r.jsxs)("div",{className:d().skeletonContent,children:[(0,r.jsx)("div",{className:d().skeletonLine}),(0,r.jsx)("div",{className:d().skeletonLineShort})]})]},e))}),(0,r.jsx)(l.Z,{})]}):(0,r.jsxs)("div",{className:d().page,children:[(0,r.jsxs)("header",{className:d().header,children:[(0,r.jsx)(o.default,{href:"/",className:d().backBtn,children:(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,r.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),(0,r.jsx)("h1",{className:d().title,children:"Notifica\xe7\xf5es"}),g>0&&(0,r.jsx)("button",{className:d().markAllBtn,onClick:x,children:"Marcar lidas"}),0===g&&(0,r.jsx)("div",{className:d().placeholder})]}),(0,r.jsx)("main",{className:d().content,children:0===u.length?(0,r.jsxs)("div",{className:d().emptyState,children:[(0,r.jsx)("div",{className:d().emptyIcon,children:"\uD83D\uDD14"}),(0,r.jsx)("h2",{children:"Nenhuma notifica\xe7\xe3o"}),(0,r.jsx)("p",{children:"Voc\xea receber\xe1 avisos sobre pedidos, promo\xe7\xf5es e novidades aqui."})]}):(0,r.jsx)("div",{className:d().list,children:u.map(e=>{let t=h[e.type]||h.system;return(0,r.jsxs)("button",{className:"".concat(d().item," ").concat(e.is_read?"":d().itemUnread),onClick:()=>j(e),children:[(0,r.jsx)("div",{className:d().iconWrap,style:{background:t.bg,color:t.color},children:e.image_url?(0,r.jsx)("img",{src:e.image_url,alt:"Icone",className:d().iconImg}):(0,r.jsx)("span",{className:d().iconEmoji,children:t.icon})}),(0,r.jsxs)("div",{className:d().itemContent,children:[(0,r.jsxs)("div",{className:d().itemHeader,children:[(0,r.jsx)("span",{className:d().itemTitle,children:e.title}),(0,r.jsx)("span",{className:d().itemTime,children:function(e){let t=new Date(e),n=new Date-t,r=Math.floor(n/6e4),a=Math.floor(n/36e5),o=Math.floor(n/864e5);return r<1?"Agora":r<60?"".concat(r," min"):a<24?"".concat(a,"h"):o<7?"".concat(o,"d"):t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})}(e.created_at)})]}),e.message&&(0,r.jsx)("p",{className:d().itemMessage,children:e.message})]}),!e.is_read&&(0,r.jsx)("span",{className:d().unreadDot})]},e.id)})})}),(0,r.jsx)(l.Z,{})]})}},9376:function(e,t,n){"use strict";var r=n(5475);n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}}),n.o(r,"useSearchParams")&&n.d(t,{useSearchParams:function(){return r.useSearchParams}})},257:function(e,t,n){"use strict";var r,a;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(a=n.g.process)?void 0:a.env)?n.g.process:n(4227)},4227:function(e){!function(){var t={229:function(e){var t,n,r,a=e.exports={};function o(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var c=[],l=!1,u=-1;function d(){l&&r&&(l=!1,r.length?c=r.concat(c):u=-1,c.length&&h())}function h(){if(!l){var e=s(d);l=!0;for(var t=c.length;t;){for(r=c,c=[];++u<t;)r&&r[u].run();u=-1,t=c.length}r=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||l||s(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=m,a.addListener=m,a.once=m,a.off=m,a.removeListener=m,a.removeAllListeners=m,a.emit=m,a.prependListener=m,a.prependOnceListener=m,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var o=n[e]={exports:{}},i=!0;try{t[e](o,o.exports,r),i=!1}finally{i&&delete n[e]}return o.exports}r.ab="//";var a=r(229);e.exports=a}()},1477:function(e){e.exports={nav:"BottomNav_nav__T1kIM",item:"BottomNav_item__GeZmx",icon:"BottomNav_icon__dhNNZ",navIconBounce:"BottomNav_navIconBounce__9vgTS",active:"BottomNav_active__Q5_PG",dotAppear:"BottomNav_dotAppear__rraCJ",label:"BottomNav_label__CBee_"}},1545:function(e){e.exports={page:"page_page__QY2T6",header:"page_header__1xXHF",backBtn:"page_backBtn___on8r",title:"page_title__pWxvA",placeholder:"page_placeholder__l6Ftc",markAllBtn:"page_markAllBtn__IJ2kj",content:"page_content__CGg4_",list:"page_list__MM_YR",item:"page_item__OUnf_",itemUnread:"page_itemUnread__iw7lP",iconWrap:"page_iconWrap__u_V4G",iconEmoji:"page_iconEmoji__gonjQ",iconImg:"page_iconImg__Zq39l",itemContent:"page_itemContent__Wb3dB",itemHeader:"page_itemHeader__6ebl0",itemTitle:"page_itemTitle__N2F8e",itemTime:"page_itemTime__w1o6a",itemMessage:"page_itemMessage__gQ1_H",unreadDot:"page_unreadDot__rXqGD",emptyState:"page_emptyState__nQ4RW",emptyIcon:"page_emptyIcon__ZVjXb",loadingState:"page_loadingState__Cumjw",skeletonItem:"page_skeletonItem__bEMVN",skeletonIcon:"page_skeletonIcon__l9QH8",shimmer:"page_shimmer__0Kjp6",skeletonContent:"page_skeletonContent__E_qSG",skeletonLine:"page_skeletonLine__L7VeO",skeletonLineShort:"page_skeletonLineShort__8XH_z"}}},function(e){e.O(0,[3069,7648,2971,2117,1744],function(){return e(e.s=4335)}),_N_E=e.O()}]);
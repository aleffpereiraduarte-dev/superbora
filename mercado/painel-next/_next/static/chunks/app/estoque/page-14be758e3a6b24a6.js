(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9266],{5774:function(e,t,i){Promise.resolve().then(i.bind(i,992))},992:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return u}});var o=i(7437),r=i(2265),n=i(4565),s=i(4477),a=i(6428),d=i(6971);let l=[{key:"products",label:"Produtos"},{key:"movements",label:"Historico"},{key:"alerts",label:"Alertas"}],c=["Reposicao de estoque","Inventario / Contagem","Devolucao de cliente","Perda / Avaria","Venda externa","Correcao de sistema","Transferencia","Outro"];function u(){return(0,o.jsx)(n.Z,{children:(0,o.jsx)(s.Z,{children:(0,o.jsx)(p,{})})})}function p(){let{addNotification:e}=(0,d.l)(),[t,i]=(0,r.useState)("products"),[n,s]=(0,r.useState)([]),[u,p]=(0,r.useState)(!0),[x,h]=(0,r.useState)(""),[g,m]=(0,r.useState)(""),f=(0,r.useRef)(null),[y,j]=(0,r.useState)([]),[b,v]=(0,r.useState)(!1),[k,S]=(0,r.useState)(0),[C,w]=(0,r.useState)(0),[q,_]=(0,r.useState)(0),[E,z]=(0,r.useState)([]),[B,W]=(0,r.useState)(!1),[A,F]=(0,r.useState)(null),[N,R]=(0,r.useState)(""),[L,I]=(0,r.useState)(!1),[T,D]=(0,r.useState)(!1),[M,O]=(0,r.useState)(null),[P,V]=(0,r.useState)({tipo:"entrada",quantidade:"",motivo:"",motivo_custom:""}),[H,U]=(0,r.useState)(!1),[Q,K]=(0,r.useState)(!1),[Y,Z]=(0,r.useState)(null),[G,J]=(0,r.useState)({estoque_minimo:"",auto_pausar:!1}),[X,$]=(0,r.useState)(!1),[ee,et]=(0,r.useState)(!1),[ei,eo]=(0,r.useState)({}),[er,en]=(0,r.useState)(!1),[es,ea]=(0,r.useState)(!1),ed=(0,r.useCallback)(async()=>{p(!0),h("");try{let e=await (0,a.SC)("/estoque.php",{search:g});s(e.products||[])}catch(e){h(e.message)}finally{p(!1)}},[g]),el=(0,r.useCallback)(async t=>{v(!0);try{let e=t?0:C,i={action:"movements",limit:50,offset:e};q>0&&(i.product_id=q);let o=await (0,a.SC)("/estoque.php",i);t?(j(o.movements||[]),w(50)):(j(e=>[...e,...o.movements||[]]),w(e+50)),S(o.total||0)}catch(t){e(t.message||"Erro ao carregar historico","error")}finally{v(!1)}},[C,q,e]),ec=(0,r.useCallback)(async()=>{W(!0);try{let e=await (0,a.SC)("/estoque.php",{action:"alerts"});z(e.alerts||[])}catch(t){e(t.message||"Erro ao carregar alertas","error")}finally{W(!1)}},[e]);async function eu(t,i){let o=n.find(e=>e.product_id===t);if(!o)return;let r=Math.max(0,o.quantidade+i);I(!0);try{await (0,a.sg)("/estoque.php",{action:"adjust",product_id:t,quantidade:r,motivo:i>0?"Ajuste rapido +"+i:"Ajuste rapido "+i}),s(e=>e.map(e=>e.product_id===t?{...e,quantidade:r,ultima_movimentacao:new Date().toISOString(),stock_status:ey(r,e.estoque_minimo)}:e))}catch(t){e(t.message||"Erro ao ajustar","error")}finally{I(!1)}}async function ep(t){let i=parseInt(N);if(isNaN(i)||i<0){e("Quantidade invalida","error");return}I(!0);try{await (0,a.sg)("/estoque.php",{action:"adjust",product_id:t,quantidade:i,motivo:"Ajuste manual direto"}),s(e=>e.map(e=>e.product_id===t?{...e,quantidade:i,ultima_movimentacao:new Date().toISOString(),stock_status:ey(i,e.estoque_minimo)}:e)),F(null),e("Estoque atualizado","success")}catch(t){e(t.message||"Erro ao ajustar","error")}finally{I(!1)}}function ex(){F(null),R("")}function eh(e){O(e),V({tipo:"entrada",quantidade:"",motivo:"",motivo_custom:""}),D(!0)}async function eg(){if(!M)return;let t=parseInt(P.quantidade);if(isNaN(t)||t<=0){e("Quantidade deve ser maior que zero","error");return}let i="Outro"===P.motivo?P.motivo_custom.trim():P.motivo;if(!i){e("Motivo obrigatorio","error");return}U(!0);try{let o=await (0,a.sg)("/estoque.php",{action:"movement",product_id:M.product_id,tipo:P.tipo,quantidade:t,motivo:i});s(e=>e.map(e=>e.product_id===M.product_id?{...e,quantidade:o.quantidade_nova,ultima_movimentacao:new Date().toISOString(),stock_status:ey(o.quantidade_nova,e.estoque_minimo)}:e)),D(!1),e("".concat("entrada"===P.tipo?"Entrada":"Saida"," registrada com sucesso"),"success")}catch(t){e(t.message||"Erro ao registrar movimentacao","error")}finally{U(!1)}}async function em(){if(!Y)return;let t=parseInt(G.estoque_minimo);if(isNaN(t)||t<0){e("Estoque minimo invalido","error");return}$(!0);try{await (0,a.sg)("/estoque.php",{action:"config",product_id:Y.product_id,estoque_minimo:t,auto_pausar:G.auto_pausar}),s(e=>e.map(e=>e.product_id===Y.product_id?{...e,estoque_minimo:t,auto_pausar:G.auto_pausar,stock_status:ey(e.quantidade,t)}:e)),K(!1),e("Configuracao atualizada","success")}catch(t){e(t.message||"Erro ao atualizar configuracao","error")}finally{$(!1)}}async function ef(){let t=[];for(let[e,i]of Object.entries(ei)){let o=n.find(t=>t.product_id===parseInt(e));if(!o)continue;let r=parseInt(i);isNaN(r)||r<0||r===o.quantidade||t.push({product_id:parseInt(e),quantidade:r})}if(0===t.length){e("Nenhuma alteracao detectada","info");return}en(!0);try{let i=await (0,a.sg)("/estoque.php",{action:"bulk_adjust",items:t,motivo:"Ajuste em lote via painel"});e("".concat(i.updated," produto(s) atualizado(s)"),"success"),et(!1),eo({}),ed()}catch(t){e(t.message||"Erro no ajuste em lote","error")}finally{en(!1)}}function ey(e,t){return e<=0?"esgotado":t>0&&e<=t?"baixo":t>0&&e<=1.5*t?"atencao":"ok"}(0,r.useEffect)(()=>{ed()},[ed]),(0,r.useEffect)(()=>{"movements"===t&&el(!0),"alerts"===t&&ec()},[t,q]);let ej=n.length,eb=n.filter(e=>e.quantidade<=0).length,ev=n.filter(e=>"baixo"===e.stock_status||"atencao"===e.stock_status).length,ek=n.filter(e=>"ok"===e.stock_status).length;return(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"page-header",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"page-title",children:"Gestao de Estoque"}),(0,o.jsx)("p",{className:"page-subtitle",children:"Controle o estoque dos seus produtos"})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,o.jsxs)("button",{className:"btn",onClick:function(){ea(!0);try{let t=n.map(e=>{var t;return['"'.concat((e.name||"").replace(/"/g,'""'),'"'),(null===(t=e.price)||void 0===t?void 0:t.toFixed(2))||"0.00",e.quantidade,e.estoque_minimo,e.auto_pausar?"Sim":"Nao",e.stock_status,e.ultima_movimentacao||""]}),i=["Produto;Preco;Quantidade;Estoque Minimo;Auto Pausar;Status;Ultima Movimentacao",...t.map(e=>e.join(";"))].join("\n"),o=new Blob(["\uFEFF"+i],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(o),s=document.createElement("a");s.href=r,s.download="estoque_".concat(new Date().toISOString().slice(0,10),".csv"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r),e("Relatorio exportado","success")}catch(t){e("Erro ao exportar","error")}finally{ea(!1)}},disabled:es||0===n.length,style:{background:"#fff",border:"1px solid #ddd",color:"#333"},children:[(0,o.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:6},children:[(0,o.jsx)("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"}),(0,o.jsx)("polyline",{points:"7 10 12 15 17 10"}),(0,o.jsx)("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),es?"Exportando...":"Exportar CSV"]}),(0,o.jsxs)("button",{className:"btn ".concat(ee?"btn-primary":""),onClick:function(){if(ee)et(!1),eo({});else{et(!0);let e={};n.forEach(t=>{e[t.product_id]=String(t.quantidade)}),eo(e)}},style:ee?{}:{background:"#fff",border:"1px solid #ddd",color:"#333"},children:[(0,o.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:6},children:[(0,o.jsx)("rect",{x:"3",y:"3",width:"7",height:"7"}),(0,o.jsx)("rect",{x:"14",y:"3",width:"7",height:"7"}),(0,o.jsx)("rect",{x:"14",y:"14",width:"7",height:"7"}),(0,o.jsx)("rect",{x:"3",y:"14",width:"7",height:"7"})]}),ee?"Sair do Modo Lote":"Ajuste em Lote"]})]})]}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:12,marginBottom:20},children:[(0,o.jsxs)("div",{style:{background:"#fff",borderRadius:10,padding:"16px 20px",border:"1px solid #eee",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[(0,o.jsx)("div",{style:{fontSize:12,color:"#888",marginBottom:4,textTransform:"uppercase",letterSpacing:.5},children:"Total Produtos"}),(0,o.jsx)("div",{style:{fontSize:28,fontWeight:700,color:"#333"},children:ej})]}),(0,o.jsxs)("div",{style:{background:"#fff",borderRadius:10,padding:"16px 20px",border:"1px solid #eee",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[(0,o.jsx)("div",{style:{fontSize:12,color:"#888",marginBottom:4,textTransform:"uppercase",letterSpacing:.5},children:"Estoque OK"}),(0,o.jsx)("div",{style:{fontSize:28,fontWeight:700,color:"#2E7D32"},children:ek})]}),(0,o.jsxs)("div",{style:{background:"#fff",borderRadius:10,padding:"16px 20px",border:"1px solid #eee",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[(0,o.jsx)("div",{style:{fontSize:12,color:"#888",marginBottom:4,textTransform:"uppercase",letterSpacing:.5},children:"Estoque Baixo"}),(0,o.jsx)("div",{style:{fontSize:28,fontWeight:700,color:"#E65100"},children:ev})]}),(0,o.jsxs)("div",{style:{background:"#fff",borderRadius:10,padding:"16px 20px",border:"1px solid #eee",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[(0,o.jsx)("div",{style:{fontSize:12,color:"#888",marginBottom:4,textTransform:"uppercase",letterSpacing:.5},children:"Esgotados"}),(0,o.jsx)("div",{style:{fontSize:28,fontWeight:700,color:"#C62828"},children:eb})]})]}),(0,o.jsx)("div",{className:"tabs",style:{marginBottom:16},children:l.map(e=>(0,o.jsxs)("button",{className:"tab ".concat(t===e.key?"tab-active":""),onClick:()=>i(e.key),children:[e.label,"alerts"===e.key&&E.length>0&&(0,o.jsx)("span",{className:"badge badge-danger",style:{marginLeft:6,fontSize:11,padding:"1px 6px"},children:E.length})]},e.key))}),"products"===t&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"toolbar",style:{marginBottom:16},children:(0,o.jsx)("div",{className:"toolbar-search",style:{flex:1},children:(0,o.jsxs)("div",{className:"search-bar",children:[(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,o.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,o.jsx)("path",{d:"M21 21l-4.35-4.35"})]}),(0,o.jsx)("input",{type:"text",placeholder:"Buscar produto por nome ou codigo...",onChange:function(e){let t=e.target.value;f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{m(t)},400)}})]})})}),ee&&(0,o.jsxs)("div",{style:{background:"#EDE7F6",border:"1px solid #B39DDB",borderRadius:10,padding:"12px 16px",marginBottom:16,display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,o.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#5E35B1",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,o.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,o.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),(0,o.jsx)("span",{style:{color:"#4A148C",fontWeight:600,fontSize:14},children:'Modo Lote: edite as quantidades e clique em "Salvar Tudo"'})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,o.jsx)("button",{className:"btn",onClick:()=>{et(!1),eo({})},style:{background:"#fff",color:"#666",border:"1px solid #ccc",fontSize:13},children:"Cancelar"}),(0,o.jsx)("button",{className:"btn btn-primary",onClick:ef,disabled:er,style:{fontSize:13},children:er?"Salvando...":"Salvar Tudo"})]})]}),u?(0,o.jsx)("div",{className:"loading-screen",children:(0,o.jsx)("div",{className:"spinner"})}):x?(0,o.jsxs)("div",{className:"empty-state",children:[(0,o.jsx)("div",{className:"empty-state-title",children:"Erro ao carregar estoque"}),(0,o.jsx)("div",{className:"empty-state-text",children:x}),(0,o.jsx)("button",{className:"btn btn-primary",style:{marginTop:12},onClick:ed,children:"Tentar novamente"})]}):0===n.length?(0,o.jsxs)("div",{className:"empty-state",children:[(0,o.jsxs)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",style:{opacity:.4,marginBottom:12},children:[(0,o.jsx)("path",{d:"M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"}),(0,o.jsx)("polyline",{points:"3.27 6.96 12 12.01 20.73 6.96"}),(0,o.jsx)("line",{x1:"12",y1:"22.08",x2:"12",y2:"12"})]}),(0,o.jsx)("div",{className:"empty-state-title",children:"Nenhum produto encontrado"}),(0,o.jsx)("div",{className:"empty-state-text",children:g?"Tente alterar a busca":"Cadastre produtos primeiro na aba Produtos"})]}):(0,o.jsxs)("div",{style:{background:"#fff",borderRadius:12,border:"1px solid #eee",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:ee?"1fr 100px 100px 120px":"1fr 100px 100px 120px 200px",gap:0,padding:"12px 16px",background:"#FAFAFA",borderBottom:"1px solid #eee",fontWeight:600,fontSize:12,color:"#888",textTransform:"uppercase",letterSpacing:.5},children:[(0,o.jsx)("div",{children:"Produto"}),(0,o.jsx)("div",{style:{textAlign:"center"},children:"Quantidade"}),(0,o.jsx)("div",{style:{textAlign:"center"},children:"Status"}),(0,o.jsx)("div",{style:{textAlign:"center"},children:"Minimo"}),!ee&&(0,o.jsx)("div",{style:{textAlign:"right"},children:"Acoes"})]}),n.map(e=>{var t,i;let r=function(e){switch(e){case"esgotado":return{bg:"#FFEBEE",color:"#C62828",border:"#EF5350"};case"baixo":return{bg:"#FFF3E0",color:"#E65100",border:"#FF9800"};case"atencao":return{bg:"#FFFDE7",color:"#F57F17",border:"#FDD835"};default:return{bg:"#E8F5E9",color:"#2E7D32",border:"#66BB6A"}}}(e.stock_status);return(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:ee?"1fr 100px 100px 120px":"1fr 100px 100px 120px 200px",gap:0,padding:"12px 16px",borderBottom:"1px solid #f5f5f5",alignItems:"center",transition:"background 0.15s"},onMouseEnter:e=>e.currentTarget.style.background="#FAFAFA",onMouseLeave:e=>e.currentTarget.style.background="transparent",children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.image?(0,o.jsx)("img",{src:e.image,alt:e.name,style:{width:40,height:40,borderRadius:8,objectFit:"cover",border:"1px solid #eee",flexShrink:0}}):(0,o.jsx)("div",{style:{width:40,height:40,borderRadius:8,background:"#f5f5f5",border:"1px solid #eee",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc",strokeWidth:"1.5",children:[(0,o.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),(0,o.jsx)("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),(0,o.jsx)("polyline",{points:"21 15 16 10 5 21"})]})}),(0,o.jsxs)("div",{style:{minWidth:0},children:[(0,o.jsx)("div",{style:{fontWeight:600,fontSize:14,color:"#333",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.name}),(0,o.jsxs)("div",{style:{fontSize:12,color:"#999"},children:[(i=e.price,new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(i||0)),e.barcode&&(0,o.jsx)("span",{style:{marginLeft:8,color:"#bbb"},children:e.barcode})]})]})]}),(0,o.jsx)("div",{style:{textAlign:"center"},children:ee?(0,o.jsx)("input",{type:"number",min:"0",value:null!==(t=ei[e.product_id])&&void 0!==t?t:"",onChange:t=>{var i,o;return i=e.product_id,o=t.target.value,void eo(e=>({...e,[i]:o}))},style:{width:70,padding:"4px 8px",borderRadius:6,border:"1px solid #ddd",fontSize:14,textAlign:"center",fontWeight:600}}):A===e.product_id?(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:4},children:[(0,o.jsx)("input",{type:"number",min:"0",value:N,onChange:e=>R(e.target.value),onKeyDown:t=>{"Enter"===t.key&&ep(e.product_id),"Escape"===t.key&&ex()},autoFocus:!0,style:{width:56,padding:"3px 6px",borderRadius:5,border:"1px solid #4CAF50",fontSize:14,textAlign:"center",fontWeight:600,outline:"none"}}),(0,o.jsx)("button",{onClick:()=>ep(e.product_id),disabled:L,style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:5,width:24,height:24,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,padding:0},title:"Confirmar",children:(0,o.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:(0,o.jsx)("polyline",{points:"20 6 9 17 4 12"})})}),(0,o.jsx)("button",{onClick:ex,style:{background:"#eee",color:"#666",border:"none",borderRadius:5,width:24,height:24,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,padding:0},title:"Cancelar",children:(0,o.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,o.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}):(0,o.jsx)("span",{style:{fontWeight:700,fontSize:16,color:e.quantidade<=0?"#C62828":"#333",cursor:"pointer"},onClick:()=>{var t,i;return t=e.product_id,i=e.quantidade,void(F(t),R(String(i)))},title:"Clique para editar",children:e.quantidade})}),(0,o.jsx)("div",{style:{textAlign:"center"},children:(0,o.jsx)("span",{style:{display:"inline-block",padding:"3px 10px",borderRadius:20,fontSize:11,fontWeight:600,background:r.bg,color:r.color,border:"1px solid ".concat(r.border)},children:function(e){switch(e){case"esgotado":return"Esgotado";case"baixo":return"Estoque Baixo";case"atencao":return"Atencao";default:return"OK"}}(e.stock_status)})}),(0,o.jsxs)("div",{style:{textAlign:"center"},children:[(0,o.jsx)("span",{style:{fontSize:13,color:e.estoque_minimo>0?"#333":"#bbb"},children:e.estoque_minimo>0?e.estoque_minimo:"-"}),e.auto_pausar&&(0,o.jsx)("span",{title:"Auto-pausar ativo",style:{marginLeft:4,fontSize:10,color:"#E65100",fontWeight:700},children:"AP"})]}),!ee&&(0,o.jsxs)("div",{style:{display:"flex",gap:4,justifyContent:"flex-end",alignItems:"center",flexWrap:"wrap"},children:[(0,o.jsx)("button",{onClick:()=>eu(e.product_id,-1),disabled:L||e.quantidade<=0,title:"-1",style:{width:28,height:28,borderRadius:6,border:"1px solid #eee",background:"#fff",cursor:e.quantidade<=0?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",opacity:e.quantidade<=0?.4:1,fontSize:16,fontWeight:700,color:"#C62828",padding:0},children:"-"}),(0,o.jsx)("button",{onClick:()=>eu(e.product_id,1),disabled:L,title:"+1",style:{width:28,height:28,borderRadius:6,border:"1px solid #eee",background:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:16,fontWeight:700,color:"#2E7D32",padding:0},children:"+"}),(0,o.jsxs)("button",{onClick:()=>eh(e),title:"Registrar movimentacao",style:{height:28,borderRadius:6,border:"1px solid #eee",background:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:"0 8px",fontSize:11,fontWeight:600,color:"#1565C0",gap:4},children:[(0,o.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("polyline",{points:"17 1 21 5 17 9"}),(0,o.jsx)("path",{d:"M3 11V9a4 4 0 014-4h14"}),(0,o.jsx)("polyline",{points:"7 23 3 19 7 15"}),(0,o.jsx)("path",{d:"M21 13v2a4 4 0 01-4 4H3"})]}),"Mov"]}),(0,o.jsxs)("button",{onClick:()=>{Z(e),J({estoque_minimo:String(e.estoque_minimo||0),auto_pausar:e.auto_pausar||!1}),K(!0)},title:"Configurar alertas",style:{height:28,borderRadius:6,border:"1px solid #eee",background:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:"0 8px",fontSize:11,fontWeight:600,color:"#666",gap:4},children:[(0,o.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("circle",{cx:"12",cy:"12",r:"3"}),(0,o.jsx)("path",{d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"})]}),"Config"]})]})]},e.product_id)})]})]}),"movements"===t&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{style:{marginBottom:16,display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[(0,o.jsx)("label",{style:{fontSize:13,color:"#666",fontWeight:600},children:"Filtrar por produto:"}),(0,o.jsxs)("select",{value:q,onChange:e=>{_(parseInt(e.target.value)||0)},style:{padding:"6px 12px",borderRadius:8,border:"1px solid #ddd",fontSize:14,minWidth:200},children:[(0,o.jsx)("option",{value:0,children:"Todos os produtos"}),n.map(e=>(0,o.jsx)("option",{value:e.product_id,children:e.name},e.product_id))]})]}),b&&0===y.length?(0,o.jsx)("div",{className:"loading-screen",children:(0,o.jsx)("div",{className:"spinner"})}):0===y.length?(0,o.jsxs)("div",{className:"empty-state",children:[(0,o.jsx)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",style:{opacity:.4,marginBottom:12},children:(0,o.jsx)("polyline",{points:"22 12 18 12 15 21 9 3 6 12 2 12"})}),(0,o.jsx)("div",{className:"empty-state-title",children:"Nenhuma movimentacao"}),(0,o.jsx)("div",{className:"empty-state-text",children:"O historico aparecera aqui quando houver ajustes de estoque"})]}):(0,o.jsxs)("div",{style:{background:"#fff",borderRadius:12,border:"1px solid #eee",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px 80px 80px 80px 1fr 140px",gap:0,padding:"12px 16px",background:"#FAFAFA",borderBottom:"1px solid #eee",fontWeight:600,fontSize:12,color:"#888",textTransform:"uppercase",letterSpacing:.5},children:[(0,o.jsx)("div",{children:"Produto"}),(0,o.jsx)("div",{style:{textAlign:"center"},children:"Tipo"}),(0,o.jsx)("div",{style:{textAlign:"center"},children:"Anterior"}),(0,o.jsx)("div",{style:{textAlign:"center"},children:"Nova"}),(0,o.jsx)("div",{style:{textAlign:"center"},children:"Diff"}),(0,o.jsx)("div",{children:"Motivo"}),(0,o.jsx)("div",{style:{textAlign:"right"},children:"Data"})]}),y.map(e=>{var t;return(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px 80px 80px 80px 1fr 140px",gap:0,padding:"10px 16px",borderBottom:"1px solid #f5f5f5",alignItems:"center",fontSize:13},children:[(0,o.jsx)("div",{style:{fontWeight:500,color:"#333",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.product_name||"#".concat(e.product_id)}),(0,o.jsx)("div",{style:{textAlign:"center"},children:(0,o.jsx)("span",{style:{display:"inline-block",padding:"2px 8px",borderRadius:12,fontSize:11,fontWeight:600,color:"#fff",background:function(e){switch(e){case"entrada":return"#2E7D32";case"saida":return"#C62828";case"ajuste":return"#1565C0";default:return"#666"}}(e.tipo)},children:function(e){switch(e){case"entrada":return"Entrada";case"saida":return"Saida";case"ajuste":return"Ajuste";default:return e}}(e.tipo)})}),(0,o.jsx)("div",{style:{textAlign:"center",color:"#888"},children:e.quantidade_anterior}),(0,o.jsx)("div",{style:{textAlign:"center",fontWeight:600,color:"#333"},children:e.quantidade_nova}),(0,o.jsxs)("div",{style:{textAlign:"center",fontWeight:600,color:e.quantidade_diff>0?"#2E7D32":e.quantidade_diff<0?"#C62828":"#888"},children:[e.quantidade_diff>0?"+":"",e.quantidade_diff]}),(0,o.jsx)("div",{style:{color:"#666",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.motivo||"-"}),(0,o.jsx)("div",{style:{textAlign:"right",color:"#999",fontSize:12},children:(t=e.created_at)?new Date(t).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"})]},e.id)}),y.length<k&&(0,o.jsx)("div",{style:{padding:16,textAlign:"center"},children:(0,o.jsx)("button",{className:"btn",onClick:()=>el(!1),disabled:b,style:{background:"#fff",border:"1px solid #ddd",color:"#333",fontSize:13},children:b?"Carregando...":"Carregar mais (".concat(y.length," de ").concat(k,")")})})]})]}),"alerts"===t&&(0,o.jsx)(o.Fragment,{children:B?(0,o.jsx)("div",{className:"loading-screen",children:(0,o.jsx)("div",{className:"spinner"})}):0===E.length?(0,o.jsxs)("div",{className:"empty-state",children:[(0,o.jsxs)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#2E7D32",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",style:{opacity:.6,marginBottom:12},children:[(0,o.jsx)("path",{d:"M22 11.08V12a10 10 0 11-5.93-9.14"}),(0,o.jsx)("polyline",{points:"22 4 12 14.01 9 11.01"})]}),(0,o.jsx)("div",{className:"empty-state-title",style:{color:"#2E7D32"},children:"Tudo em ordem!"}),(0,o.jsx)("div",{className:"empty-state-text",children:"Nenhum produto abaixo do estoque minimo. Configure alertas na aba Produtos."})]}):(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{style:{background:"#FFF3E0",border:"1px solid #FFB74D",borderRadius:10,padding:"12px 16px",marginBottom:16,display:"flex",alignItems:"center",gap:10},children:[(0,o.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#E65100",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"}),(0,o.jsx)("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),(0,o.jsx)("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),(0,o.jsxs)("span",{style:{color:"#E65100",fontWeight:600,fontSize:14},children:[E.length," produto",E.length>1?"s":""," abaixo do estoque minimo"]})]}),(0,o.jsx)("div",{style:{display:"grid",gap:12},children:E.map(e=>{let t=e.estoque_minimo>0?Math.round(e.quantidade/e.estoque_minimo*100):0,i=e.quantidade<=0?"#C62828":t<=50?"#E65100":"#F57F17";return(0,o.jsxs)("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #eee",padding:"16px 20px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)",display:"flex",alignItems:"center",gap:16},children:[e.image?(0,o.jsx)("img",{src:e.image,alt:e.name,style:{width:48,height:48,borderRadius:8,objectFit:"cover",border:"1px solid #eee",flexShrink:0}}):(0,o.jsx)("div",{style:{width:48,height:48,borderRadius:8,background:"#f5f5f5",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,o.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc",strokeWidth:"1.5",children:[(0,o.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),(0,o.jsx)("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),(0,o.jsx)("polyline",{points:"21 15 16 10 5 21"})]})}),(0,o.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,o.jsx)("div",{style:{fontWeight:600,fontSize:14,color:"#333",marginBottom:4},children:e.name}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[(0,o.jsxs)("span",{style:{fontSize:12,color:"#888"},children:["Atual: ",(0,o.jsx)("strong",{style:{color:e.quantidade<=0?"#C62828":"#E65100"},children:e.quantidade})]}),(0,o.jsx)("span",{style:{fontSize:12,color:"#bbb"},children:"|"}),(0,o.jsxs)("span",{style:{fontSize:12,color:"#888"},children:["Minimo: ",(0,o.jsx)("strong",{children:e.estoque_minimo})]}),e.auto_pausar&&(0,o.jsx)("span",{style:{fontSize:10,color:"#E65100",fontWeight:700,padding:"1px 6px",background:"#FFF3E0",borderRadius:4},children:"Auto-Pausar"})]}),(0,o.jsx)("div",{style:{width:"100%",height:6,background:"#f0f0f0",borderRadius:3,overflow:"hidden"},children:(0,o.jsx)("div",{style:{width:"".concat(Math.min(100,t),"%"),height:"100%",background:i,borderRadius:3,transition:"width 0.3s"}})})]}),(0,o.jsx)("div",{style:{display:"flex",gap:6,flexShrink:0},children:(0,o.jsx)("button",{onClick:()=>eh({product_id:e.product_id,name:e.name,quantidade:e.quantidade,estoque_minimo:e.estoque_minimo}),className:"btn btn-primary",style:{fontSize:12,padding:"6px 12px"},children:"Repor Estoque"})})]},e.product_id)})})]})}),T&&M&&(0,o.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",padding:20},onClick:e=>{e.target===e.currentTarget&&D(!1)},children:(0,o.jsxs)("div",{style:{background:"#fff",borderRadius:16,width:"100%",maxWidth:480,maxHeight:"90vh",overflowY:"auto",boxShadow:"0 20px 60px rgba(0,0,0,0.2)"},children:[(0,o.jsxs)("div",{style:{padding:"20px 24px",borderBottom:"1px solid #eee",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{style:{margin:0,fontSize:18,fontWeight:700},children:"Registrar Movimentacao"}),(0,o.jsx)("p",{style:{margin:"4px 0 0",fontSize:13,color:"#888"},children:M.name})]}),(0,o.jsx)("button",{onClick:()=>D(!1),style:{background:"none",border:"none",cursor:"pointer",padding:4,color:"#999"},children:(0,o.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,o.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,o.jsxs)("div",{style:{padding:"20px 24px"},children:[(0,o.jsxs)("div",{style:{marginBottom:8,fontSize:13,color:"#888"},children:["Estoque atual: ",(0,o.jsx)("strong",{style:{color:"#333",fontSize:16},children:M.quantidade})]}),(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:13,fontWeight:600,color:"#555",marginBottom:6},children:"Tipo"}),(0,o.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,o.jsxs)("button",{onClick:()=>V(e=>({...e,tipo:"entrada"})),style:{flex:1,padding:"10px 16px",borderRadius:8,border:"2px solid",borderColor:"entrada"===P.tipo?"#2E7D32":"#eee",background:"entrada"===P.tipo?"#E8F5E9":"#fff",color:"entrada"===P.tipo?"#2E7D32":"#666",fontWeight:600,fontSize:14,cursor:"pointer",transition:"all 0.15s"},children:[(0,o.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:6,verticalAlign:-2},children:[(0,o.jsx)("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),(0,o.jsx)("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Entrada"]}),(0,o.jsxs)("button",{onClick:()=>V(e=>({...e,tipo:"saida"})),style:{flex:1,padding:"10px 16px",borderRadius:8,border:"2px solid",borderColor:"saida"===P.tipo?"#C62828":"#eee",background:"saida"===P.tipo?"#FFEBEE":"#fff",color:"saida"===P.tipo?"#C62828":"#666",fontWeight:600,fontSize:14,cursor:"pointer",transition:"all 0.15s"},children:[(0,o.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:6,verticalAlign:-2},children:(0,o.jsx)("line",{x1:"5",y1:"12",x2:"19",y2:"12"})}),"Saida"]})]})]}),(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:13,fontWeight:600,color:"#555",marginBottom:6},children:"Quantidade"}),(0,o.jsx)("input",{type:"number",min:"1",value:P.quantidade,onChange:e=>V(t=>({...t,quantidade:e.target.value})),placeholder:"0",className:"form-input",style:{fontSize:18,fontWeight:700,textAlign:"center"}}),P.quantidade&&parseInt(P.quantidade)>0&&(0,o.jsxs)("div",{style:{marginTop:6,fontSize:12,color:"#888",textAlign:"center"},children:["Estoque resultante:"," ",(0,o.jsx)("strong",{style:{color:"#333"},children:"entrada"===P.tipo?M.quantidade+parseInt(P.quantidade):Math.max(0,M.quantidade-parseInt(P.quantidade))})]})]}),(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:13,fontWeight:600,color:"#555",marginBottom:6},children:"Motivo"}),(0,o.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6,marginBottom:8},children:c.map(e=>(0,o.jsx)("button",{onClick:()=>V(t=>({...t,motivo:e})),style:{padding:"4px 10px",borderRadius:20,border:"1px solid",borderColor:P.motivo===e?"#1565C0":"#ddd",background:P.motivo===e?"#E3F2FD":"#fff",color:P.motivo===e?"#1565C0":"#666",fontSize:12,fontWeight:500,cursor:"pointer",transition:"all 0.15s"},children:e},e))}),"Outro"===P.motivo&&(0,o.jsx)("input",{type:"text",value:P.motivo_custom,onChange:e=>V(t=>({...t,motivo_custom:e.target.value})),placeholder:"Descreva o motivo...",className:"form-input",maxLength:255,style:{marginTop:4}})]})]}),(0,o.jsxs)("div",{style:{padding:"16px 24px",borderTop:"1px solid #eee",display:"flex",gap:12,justifyContent:"flex-end"},children:[(0,o.jsx)("button",{onClick:()=>D(!1),className:"btn",style:{background:"#fff",border:"1px solid #ddd",color:"#666"},children:"Cancelar"}),(0,o.jsx)("button",{onClick:eg,disabled:H,className:"btn btn-primary",children:H?"Salvando...":"Registrar"})]})]})}),Q&&Y&&(0,o.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",padding:20},onClick:e=>{e.target===e.currentTarget&&K(!1)},children:(0,o.jsxs)("div",{style:{background:"#fff",borderRadius:16,width:"100%",maxWidth:420,maxHeight:"90vh",overflowY:"auto",boxShadow:"0 20px 60px rgba(0,0,0,0.2)"},children:[(0,o.jsxs)("div",{style:{padding:"20px 24px",borderBottom:"1px solid #eee",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{style:{margin:0,fontSize:18,fontWeight:700},children:"Configuracao de Estoque"}),(0,o.jsx)("p",{style:{margin:"4px 0 0",fontSize:13,color:"#888"},children:Y.name})]}),(0,o.jsx)("button",{onClick:()=>K(!1),style:{background:"none",border:"none",cursor:"pointer",padding:4,color:"#999"},children:(0,o.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,o.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,o.jsxs)("div",{style:{padding:"20px 24px"},children:[(0,o.jsxs)("div",{style:{marginBottom:6,fontSize:13,color:"#888"},children:["Estoque atual: ",(0,o.jsx)("strong",{style:{color:"#333"},children:Y.quantidade})]}),(0,o.jsxs)("div",{style:{marginBottom:20},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:13,fontWeight:600,color:"#555",marginBottom:6},children:"Estoque Minimo (Alerta)"}),(0,o.jsx)("input",{type:"number",min:"0",value:G.estoque_minimo,onChange:e=>J(t=>({...t,estoque_minimo:e.target.value})),placeholder:"0",className:"form-input",style:{fontSize:16,fontWeight:600}}),(0,o.jsx)("p",{style:{margin:"6px 0 0",fontSize:12,color:"#999"},children:"Voce sera alertado quando o estoque atingir este valor. Use 0 para desativar alertas."})]}),(0,o.jsx)("div",{style:{marginBottom:16},children:(0,o.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:12,cursor:"pointer",padding:"12px 16px",borderRadius:10,background:G.auto_pausar?"#FFF3E0":"#F5F5F5",border:"1px solid ".concat(G.auto_pausar?"#FFB74D":"#eee"),transition:"all 0.15s"},children:[(0,o.jsx)("input",{type:"checkbox",checked:G.auto_pausar,onChange:e=>J(t=>({...t,auto_pausar:e.target.checked})),style:{width:18,height:18,accentColor:"#E65100"}}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{fontWeight:600,fontSize:14,color:G.auto_pausar?"#E65100":"#333"},children:"Auto-Pausar"}),(0,o.jsx)("div",{style:{fontSize:12,color:"#888",marginTop:2},children:"Pausar automaticamente o produto quando o estoque atingir o minimo. O produto sera reativado quando o estoque subir."})]})]})})]}),(0,o.jsxs)("div",{style:{padding:"16px 24px",borderTop:"1px solid #eee",display:"flex",gap:12,justifyContent:"flex-end"},children:[(0,o.jsx)("button",{onClick:()=>K(!1),className:"btn",style:{background:"#fff",border:"1px solid #ddd",color:"#666"},children:"Cancelar"}),(0,o.jsx)("button",{onClick:em,disabled:X,className:"btn btn-primary",children:X?"Salvando...":"Salvar"})]})]})})]})}}},function(e){e.O(0,[3448,565,2205,2971,2117,1744],function(){return e(e.s=5774)}),_N_E=e.O()}]);
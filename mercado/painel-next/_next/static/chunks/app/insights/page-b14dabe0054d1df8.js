(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5341],{3471:function(s,e,a){Promise.resolve().then(a.bind(a,5745))},5745:function(s,e,a){"use strict";a.r(e),a.d(e,{default:function(){return d}});var i=a(7437),t=a(2265),n=a(4565),l=a(4477),c=a(6428),r=a(6971);function d(){return(0,i.jsx)(n.Z,{children:(0,i.jsx)(l.Z,{children:(0,i.jsx)(h,{})})})}function h(){let{addNotification:s}=(0,r.l)(),[e,a]=(0,t.useState)(null),[n,l]=(0,t.useState)(!0),[d,h]=(0,t.useState)(!1),o=s=>{let e=parseFloat(s);return isNaN(e)?"R$ 0,00":e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})};async function x(){try{let s=await (0,c.SC)("/insights.php");a(s)}catch(s){console.error(s)}l(!1)}async function m(){h(!0);try{await (0,c.sg)("/insights.php",{action:"generate"}),s("Novos insights gerados!","success"),await x()}catch(e){s("Erro ao gerar insights","error")}h(!1)}async function u(s){try{await (0,c.sg)("/insights.php",{action:"mark_read",insight_id:s}),a(e=>({...e,insights:e.insights.map(e=>e.id===s?{...e,is_read:1}:e)}))}catch(s){console.error(s)}}if((0,t.useEffect)(()=>{x()},[]),n)return(0,i.jsx)("div",{style:{padding:60,textAlign:"center"},children:(0,i.jsx)("div",{className:"spinner"})});let v=(null==e?void 0:e.summary)||{},j=(null==e?void 0:e.insights)||[],p=(null==e?void 0:e.top_products)||[],g=(null==e?void 0:e.hourly_distribution)||[];return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"page-header",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"page-title",children:"Insights & Analytics"}),(0,i.jsx)("p",{className:"page-subtitle",children:"Analises inteligentes do seu negocio"})]}),(0,i.jsx)("button",{className:"btn btn-primary",onClick:m,disabled:d,children:d?"Gerando...":"Gerar Novos Insights"})]}),(0,i.jsxs)("div",{className:"stats-grid",children:[(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("div",{className:"stat-icon",style:{background:"#dbeafe"},children:(0,i.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#3b82f6",strokeWidth:"2",children:[(0,i.jsx)("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),(0,i.jsx)("circle",{cx:"9",cy:"7",r:"4"}),(0,i.jsx)("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),(0,i.jsx)("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})}),(0,i.jsxs)("div",{className:"stat-content",children:[(0,i.jsx)("div",{className:"stat-value",children:v.total_orders_30d||0}),(0,i.jsx)("div",{className:"stat-label",children:"Pedidos (30 dias)"})]})]}),(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("div",{className:"stat-icon",style:{background:"#d1fae5"},children:(0,i.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#10b981",strokeWidth:"2",children:[(0,i.jsx)("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),(0,i.jsx)("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]})}),(0,i.jsxs)("div",{className:"stat-content",children:[(0,i.jsx)("div",{className:"stat-value",children:o(v.total_revenue_30d)}),(0,i.jsx)("div",{className:"stat-label",children:"Faturamento (30 dias)"})]})]}),(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("div",{className:"stat-icon",style:{background:"#fef3c7"},children:(0,i.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#f59e0b",strokeWidth:"2",children:(0,i.jsx)("path",{d:"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"})})}),(0,i.jsxs)("div",{className:"stat-content",children:[(0,i.jsx)("div",{className:"stat-value",children:o(v.avg_order_value)}),(0,i.jsx)("div",{className:"stat-label",children:"Ticket Medio"})]})]}),(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("div",{className:"stat-icon",style:{background:v.cancellation_rate>5?"#fee2e2":"#d1fae5"},children:(0,i.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:v.cancellation_rate>5?"#ef4444":"#10b981",strokeWidth:"2",children:[(0,i.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,i.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),(0,i.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]})}),(0,i.jsxs)("div",{className:"stat-content",children:[(0,i.jsxs)("div",{className:"stat-value",children:[v.cancellation_rate||0,"%"]}),(0,i.jsx)("div",{className:"stat-label",children:"Taxa de Cancelamento"})]})]})]}),j.length>0&&(0,i.jsxs)("div",{className:"card",style:{marginTop:24},children:[(0,i.jsx)("div",{className:"card-header",children:(0,i.jsx)("h2",{className:"card-title",children:"Insights da IA"})}),(0,i.jsx)("div",{className:"insights-list",children:j.map(s=>(0,i.jsxs)("div",{className:"insight-item insight-".concat(s.insight_type," ").concat(s.is_read?"insight-read":""),onClick:()=>!s.is_read&&u(s.id),children:[(0,i.jsxs)("div",{className:"insight-icon",children:["alert"===s.insight_type&&"⚠️","opportunity"===s.insight_type&&"\uD83D\uDCA1","success"===s.insight_type&&"✅","info"===s.insight_type&&"ℹ️"]}),(0,i.jsxs)("div",{className:"insight-content",children:[(0,i.jsx)("div",{className:"insight-title",children:s.title}),(0,i.jsx)("div",{className:"insight-message",children:s.message})]}),s.priority>=2&&!s.is_read&&(0,i.jsx)("span",{className:"insight-badge",children:"Importante"})]},s.id))})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:24,marginTop:24},children:[(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("div",{className:"card-header",children:(0,i.jsx)("h2",{className:"card-title",children:"Top 10 Produtos"})}),0===p.length?(0,i.jsx)("div",{className:"empty-state-small",children:"Sem dados suficientes"}):(0,i.jsx)("div",{className:"top-products-list",children:p.map((s,e)=>(0,i.jsxs)("div",{className:"top-product-item",children:[(0,i.jsxs)("span",{className:"top-product-rank",children:["#",e+1]}),(0,i.jsx)("span",{className:"top-product-name",children:s.name||s.nome}),(0,i.jsxs)("span",{className:"top-product-count",children:[s.order_count," pedidos"]})]},s.id))})]}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("div",{className:"card-header",children:(0,i.jsx)("h2",{className:"card-title",children:"Horarios de Pico"})}),0===g.length?(0,i.jsx)("div",{className:"empty-state-small",children:"Sem dados suficientes"}):(0,i.jsx)("div",{className:"hourly-chart",children:g.slice(0,12).map(s=>(0,i.jsxs)("div",{className:"hourly-bar-container",children:[(0,i.jsx)("div",{className:"hourly-bar",style:{height:"".concat(Math.min(100,s.count/Math.max(...g.map(s=>s.count))*100),"%"),background:s.hour===(null==e?void 0:e.peak_hour)?"#10b981":"#3b82f6"}}),(0,i.jsxs)("span",{className:"hourly-label",children:[s.hour,"h"]})]},s.hour))}),(null==e?void 0:e.peak_hour)&&(0,i.jsxs)("div",{style:{textAlign:"center",marginTop:12,fontSize:14,color:"var(--color-text-secondary)"},children:["Horario de pico: ",(0,i.jsxs)("strong",{children:[e.peak_hour,"h"]})]})]})]})]})}}},function(s){s.O(0,[3448,565,2205,2971,2117,1744],function(){return s(s.s=3471)}),_N_E=s.O()}]);
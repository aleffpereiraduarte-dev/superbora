(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6378],{4395:function(e,a,r){Promise.resolve().then(r.bind(r,3516))},3516:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return n}});var t=r(7437),s=r(2265),o=r(4565),i=r(4477),l=r(6428);function n(){return(0,t.jsx)(o.Z,{children:(0,t.jsx)(i.Z,{children:(0,t.jsx)(u,{})})})}let d=[{key:"30d",label:"30 dias"},{key:"60d",label:"60 dias"},{key:"90d",label:"90 dias"}],c={estrela:{label:"Estrela",emoji:"⭐",color:"#f59e0b",bg:"#fffbeb",border:"#fcd34d",desc:"Alta popularidade + Alta margem"},cavalo_de_batalha:{label:"Cavalo de Batalha",emoji:"\uD83D\uDC34",color:"#3b82f6",bg:"#eff6ff",border:"#93c5fd",desc:"Alta popularidade + Baixa margem"},quebra_cabeca:{label:"Quebra-Cabeca",emoji:"\uD83E\uDDE9",color:"#8b5cf6",bg:"#f5f3ff",border:"#c4b5fd",desc:"Baixa popularidade + Alta margem"},abacaxi:{label:"Abacaxi",emoji:"\uD83C\uDF4D",color:"#ef4444",bg:"#fef2f2",border:"#fca5a5",desc:"Baixa popularidade + Baixa margem"}},p={manter:"✅",aumentar_preco:"\uD83D\uDCB0",promover:"\uD83D\uDCE3",remover:"❌"};function x(e){let a=parseFloat(e);return isNaN(a)?"R$ 0,00":a.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}function u(){let[e,a]=(0,s.useState)("30d"),[r,o]=(0,s.useState)(null),[i,n]=(0,s.useState)(!0),[p,u]=(0,s.useState)(""),[h,j]=(0,s.useState)("matrix"),[S,k]=(0,s.useState)("vendas_qtd"),[_,z]=(0,s.useState)("desc"),[C,N]=(0,s.useState)(null),[w,D]=(0,s.useState)(!1);async function B(e){n(!0),u("");try{let a=await (0,l.SC)("/menu-engineering.php",{periodo:e});o(a)}catch(e){u(e.message||"Erro ao carregar dados"),console.error(e)}n(!1)}async function W(){D(!0);try{let a=await (0,l.SC)("/menu-engineering.php",{action:"price_suggestions",periodo:e});N(a)}catch(e){console.error(e)}D(!1)}(0,s.useEffect)(()=>{B(e)},[e]);let R=(0,s.useMemo)(()=>(null==r?void 0:r.produtos)?[...r.produtos].sort((e,a)=>{var r,t;let s=null!==(r=e[S])&&void 0!==r?r:0,o=null!==(t=a[S])&&void 0!==t?t:0;return"asc"===_?s-o:o-s}):[],[r,S,_]);if(i)return(0,t.jsx)("div",{style:{padding:60,textAlign:"center"},children:(0,t.jsx)("div",{className:"spinner"})});if(p)return(0,t.jsxs)("div",{style:{padding:40,textAlign:"center"},children:[(0,t.jsx)("p",{style:{color:"var(--color-danger)",marginBottom:16},children:p}),(0,t.jsx)("button",{className:"btn btn-primary",onClick:()=>B(e),children:"Tentar novamente"})]});let A=(null==r?void 0:r.resumo)||{},I=(null==r?void 0:r.produtos)||[],T=(null==r?void 0:r.sugestoes)||[],E=(null==r?void 0:r.tendencias)||[],q=(null==r?void 0:r.metricas)||{};return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"page-header",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"page-title",children:"Engenharia de Cardapio"}),(0,t.jsx)("p",{className:"page-subtitle",children:"Analise BCG dos seus produtos — identifique estrelas, otimize precos e remova itens fracos"})]}),(0,t.jsx)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:d.map(r=>(0,t.jsx)("button",{className:e===r.key?"tab tab-active":"tab",onClick:()=>a(r.key),style:e===r.key?{padding:"8px 16px",borderRadius:8,fontSize:13,fontWeight:600,background:"var(--color-primary)",color:"#fff",border:"none",cursor:"pointer"}:{padding:"8px 16px",borderRadius:8,fontSize:13,fontWeight:500,background:"var(--color-bg-muted)",color:"var(--color-text-secondary)",border:"none",cursor:"pointer"},children:r.label},r.key))})]}),(0,t.jsx)("div",{className:"stats-grid",children:Object.entries(c).map(e=>{let[a,r]=e;return(0,t.jsxs)("div",{className:"stat-card",style:{borderLeft:"4px solid ".concat(r.color)},children:[(0,t.jsx)("div",{style:{fontSize:28,marginBottom:4},children:r.emoji}),(0,t.jsx)("div",{className:"stat-card-value",children:A[a]||0}),(0,t.jsx)("div",{className:"stat-card-label",children:r.label}),(0,t.jsx)("div",{style:{fontSize:11,color:"var(--color-text-muted)",marginTop:2},children:r.desc})]},a)})}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:12,marginBottom:24},children:[(0,t.jsx)(g,{label:"Produtos Vendidos",value:q.total_produtos_vendidos||0}),(0,t.jsx)(g,{label:"Itens Vendidos",value:q.total_quantidade||0}),(0,t.jsx)(g,{label:"Receita Total",value:x(q.total_receita)}),(0,t.jsx)(g,{label:"Margem Media",value:"".concat(q.margem_media||0,"%")})]}),(0,t.jsx)("div",{style:{display:"flex",gap:4,padding:4,background:"var(--color-bg-muted)",borderRadius:8,marginBottom:20,overflowX:"auto"},children:[{key:"matrix",label:"Matriz BCG"},{key:"tabela",label:"Tabela Completa"},{key:"sugestoes",label:"Sugestoes (".concat(T.length,")")},{key:"tendencias",label:"Tendencias (".concat(E.length,")")},{key:"precos",label:"Sugestao de Precos"}].map(e=>(0,t.jsx)("button",{onClick:()=>{j(e.key),"precos"!==e.key||C||W()},style:{padding:"8px 16px",borderRadius:6,fontSize:13,fontWeight:h===e.key?600:500,background:h===e.key?"var(--color-bg)":"transparent",color:h===e.key?"var(--color-text)":"var(--color-text-secondary)",boxShadow:h===e.key?"var(--shadow-sm)":"none",border:"none",cursor:"pointer",whiteSpace:"nowrap",transition:"all 0.15s"},children:e.label},e.key))}),"matrix"===h&&(0,t.jsx)(f,{produtos:I,classificacoes:c}),"tabela"===h&&(0,t.jsx)(m,{produtos:R,sortField:S,sortDir:_,onSort:function(e){S===e?z(e=>"asc"===e?"desc":"asc"):(k(e),z("desc"))},getSortIcon:function(e){return S!==e?"↕":"asc"===_?"↑":"↓"}}),"sugestoes"===h&&(0,t.jsx)(v,{sugestoes:T}),"tendencias"===h&&(0,t.jsx)(y,{tendencias:E}),"precos"===h&&(0,t.jsx)(b,{data:C,loading:w,onReload:W})]})}function g(e){let{label:a,value:r}=e;return(0,t.jsxs)("div",{style:{background:"var(--color-bg)",borderRadius:8,padding:"12px 16px",boxShadow:"var(--shadow-xs)",display:"flex",flexDirection:"column",gap:2},children:[(0,t.jsx)("span",{style:{fontSize:12,color:"var(--color-text-muted)"},children:a}),(0,t.jsx)("span",{style:{fontSize:18,fontWeight:700},children:r})]})}function f(e){let{produtos:a,classificacoes:r}=e,s={estrela:[],cavalo_de_batalha:[],quebra_cabeca:[],abacaxi:[]};return a.forEach(e=>{s[e.classificacao]&&s[e.classificacao].push(e)}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[["estrela","quebra_cabeca"].map(e=>(0,t.jsx)(h,{cls:e,config:r[e],items:s[e]},e)),["cavalo_de_batalha","abacaxi"].map(e=>(0,t.jsx)(h,{cls:e,config:r[e],items:s[e]},e)),(0,t.jsxs)("div",{style:{gridColumn:"1 / -1",display:"flex",justifyContent:"space-between",padding:"8px 16px",fontSize:12,color:"var(--color-text-muted)",fontStyle:"italic"},children:[(0,t.jsx)("span",{children:"Alta Popularidade"}),(0,t.jsx)("span",{children:"Baixa Popularidade"})]})]})}function h(e){let{cls:a,config:r,items:o}=e,[i,l]=(0,s.useState)(!1),n=i?o:o.slice(0,6);return(0,t.jsxs)("div",{style:{background:r.bg,border:"2px solid ".concat(r.border),borderRadius:12,padding:20,minHeight:180},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,t.jsx)("span",{style:{fontSize:22},children:r.emoji}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontWeight:700,fontSize:15,color:r.color},children:r.label}),(0,t.jsx)("div",{style:{fontSize:11,color:"var(--color-text-muted)"},children:r.desc})]})]}),(0,t.jsx)("span",{style:{background:r.color,color:"#fff",borderRadius:20,padding:"2px 10px",fontSize:13,fontWeight:700},children:o.length})]}),0===o.length?(0,t.jsx)("div",{style:{fontSize:13,color:"var(--color-text-muted)",textAlign:"center",padding:20},children:"Nenhum produto nesta categoria"}):(0,t.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:n.map(e=>(0,t.jsxs)("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:8,padding:"6px 10px",fontSize:12,display:"flex",flexDirection:"column",gap:2,border:"1px solid rgba(0,0,0,0.06)",maxWidth:"100%"},children:[(0,t.jsx)("span",{style:{fontWeight:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:180},children:e.nome}),(0,t.jsxs)("span",{style:{color:"var(--color-text-secondary)",fontSize:11},children:[e.vendas_qtd," vendas \xb7 ",x(e.preco_medio)]})]},e.product_id))}),o.length>6&&(0,t.jsx)("button",{onClick:()=>l(!i),style:{marginTop:8,fontSize:12,color:r.color,fontWeight:600,background:"none",border:"none",cursor:"pointer",padding:"4px 0"},children:i?"Ver menos":"Ver todos (".concat(o.length,")")})]})}function m(e){let{produtos:a,sortField:r,sortDir:s,onSort:o,getSortIcon:i}=e;return 0===a.length?(0,t.jsx)("div",{className:"empty-state-small",children:"Nenhum produto vendido no periodo"}):(0,t.jsx)("div",{className:"table-wrapper",children:(0,t.jsxs)("table",{className:"table",children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{children:[{key:"nome",label:"Produto",sortable:!1},{key:"vendas_qtd",label:"Vendas Qtd"},{key:"vendas_valor",label:"Vendas R$"},{key:"participacao_mix",label:"Mix %"},{key:"margem",label:"Margem %"},{key:"preco_medio",label:"Preco Medio"},{key:"classificacao",label:"Classificacao",sortable:!1}].map(e=>(0,t.jsxs)("th",{onClick:!1!==e.sortable?()=>o(e.key):void 0,style:!1!==e.sortable?{cursor:"pointer",userSelect:"none"}:{},children:[e.label," ",!1!==e.sortable&&(0,t.jsx)("span",{style:{fontSize:10,marginLeft:2},children:i(e.key)})]},e.key))})}),(0,t.jsx)("tbody",{children:a.map(e=>{let a=c[e.classificacao]||{};return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{style:{fontWeight:500,maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.nome}),(0,t.jsx)("td",{children:e.vendas_qtd}),(0,t.jsx)("td",{children:x(e.vendas_valor)}),(0,t.jsxs)("td",{children:[e.participacao_mix,"%"]}),(0,t.jsxs)("td",{children:[(0,t.jsxs)("span",{style:{color:e.margem>=35?"var(--color-success)":e.margem>=20?"var(--color-warning)":"var(--color-danger)"},children:[e.margem,"%"]}),!e.has_cost_data&&(0,t.jsx)("span",{style:{fontSize:10,color:"var(--color-text-muted)",marginLeft:4},title:"Margem estimada",children:"*"})]}),(0,t.jsx)("td",{children:x(e.preco_medio)}),(0,t.jsx)("td",{children:(0,t.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:4,background:a.bg,color:a.color,border:"1px solid ".concat(a.border),borderRadius:20,padding:"3px 10px",fontSize:12,fontWeight:600,whiteSpace:"nowrap"},children:[a.emoji," ",a.label]})})]},e.product_id)})})]})})}function v(e){let{sugestoes:a}=e;return 0===a.length?(0,t.jsxs)("div",{className:"card",style:{textAlign:"center",padding:40},children:[(0,t.jsx)("div",{style:{fontSize:40,marginBottom:12},children:"\uD83D\uDCA1"}),(0,t.jsx)("p",{style:{color:"var(--color-text-secondary)"},children:"Sem sugestoes disponiveis. Aguarde mais dados de vendas."})]}):(0,t.jsx)("div",{style:{display:"grid",gap:12},children:a.map((e,a)=>{let r=c[e.classificacao]||{};return(0,t.jsxs)("div",{className:"card",style:{display:"flex",alignItems:"flex-start",gap:16,borderLeft:"4px solid ".concat(r.color)},children:[(0,t.jsx)("div",{style:{fontSize:28,flexShrink:0,marginTop:2},children:p[e.tipo]||"\uD83D\uDCA1"}),(0,t.jsxs)("div",{style:{flex:1},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,t.jsx)("span",{style:{fontWeight:600,fontSize:15},children:e.produto}),(0,t.jsxs)("span",{style:{background:r.bg,color:r.color,border:"1px solid ".concat(r.border),borderRadius:20,padding:"2px 8px",fontSize:11,fontWeight:600},children:[r.emoji," ",r.label]})]}),(0,t.jsx)("p",{style:{fontSize:14,color:"var(--color-text-secondary)",lineHeight:1.5},children:e.mensagem})]}),(0,t.jsxs)("div",{style:{flexShrink:0,width:28,height:28,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:700,background:1===e.prioridade?"#fef3c7":2===e.prioridade?"#eff6ff":"#f1f5f9",color:1===e.prioridade?"#b45309":2===e.prioridade?"#2563eb":"#64748b"},children:["P",e.prioridade]})]},a)})})}function y(e){let{tendencias:a}=e;return 0===a.length?(0,t.jsxs)("div",{className:"card",style:{textAlign:"center",padding:40},children:[(0,t.jsx)("div",{style:{fontSize:40,marginBottom:12},children:"\uD83D\uDCC8"}),(0,t.jsx)("p",{style:{color:"var(--color-text-secondary)"},children:"Sem tendencias significativas detectadas. Precisa de dados do periodo anterior para comparar."})]}):(0,t.jsxs)("div",{className:"card",children:[(0,t.jsxs)("div",{className:"card-header",children:[(0,t.jsx)("h2",{className:"card-title",children:"Tendencias de Venda"}),(0,t.jsx)("span",{style:{fontSize:12,color:"var(--color-text-muted)"},children:"Comparando com periodo anterior"})]}),(0,t.jsx)("div",{style:{display:"grid",gap:8},children:a.map((e,a)=>(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"10px 12px",borderRadius:8,background:"var(--color-bg-muted)",border:"1px solid ".concat("subindo"===e.direcao?"rgba(22,163,74,0.2)":"rgba(220,38,38,0.2)")},children:[(0,t.jsx)("div",{style:{width:36,height:36,borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",background:"subindo"===e.direcao?"var(--color-success-bg)":"var(--color-danger-bg)",fontSize:18},children:"subindo"===e.direcao?"↗️":"↘️"}),(0,t.jsxs)("div",{style:{flex:1},children:[(0,t.jsx)("div",{style:{fontWeight:600,fontSize:14},children:e.nome}),(0,t.jsxs)("div",{style:{fontSize:12,color:"var(--color-text-secondary)"},children:[e.vendas_anterior," → ",e.vendas_atual," vendas"]})]}),(0,t.jsxs)("div",{style:{fontWeight:700,fontSize:15,color:"subindo"===e.direcao?"var(--color-success)":"var(--color-danger)"},children:[e.variacao_percent>0?"+":"",e.variacao_percent,"%"]})]},a))})]})}function b(e){let{data:a,loading:r,onReload:s}=e;if(r)return(0,t.jsx)("div",{style:{padding:60,textAlign:"center"},children:(0,t.jsx)("div",{className:"spinner"})});if(!a||!a.sugestoes_preco)return(0,t.jsxs)("div",{className:"card",style:{textAlign:"center",padding:40},children:[(0,t.jsx)("p",{style:{color:"var(--color-text-secondary)",marginBottom:12},children:"Nao foi possivel carregar sugestoes de preco."}),(0,t.jsx)("button",{className:"btn btn-primary",onClick:s,children:"Tentar novamente"})]});let o=a.sugestoes_preco||[];return 0===o.length?(0,t.jsxs)("div",{className:"card",style:{textAlign:"center",padding:40},children:[(0,t.jsx)("div",{style:{fontSize:40,marginBottom:12},children:"\uD83D\uDCB2"}),(0,t.jsx)("p",{style:{color:"var(--color-text-secondary)"},children:"Sem dados de vendas suficientes para sugestoes de preco."})]}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"card",style:{marginBottom:16},children:[(0,t.jsxs)("div",{className:"card-header",children:[(0,t.jsx)("h2",{className:"card-title",children:"Otimizacao de Precos"}),(0,t.jsxs)("span",{style:{fontSize:12,color:"var(--color-text-muted)"},children:[o.length," produtos analisados"]})]}),(0,t.jsx)("p",{style:{fontSize:13,color:"var(--color-text-secondary)",marginBottom:16},children:"Sugestoes baseadas no historico de vendas e volume em diferentes faixas de preco."})]}),(0,t.jsx)("div",{style:{display:"grid",gap:12},children:o.map((e,a)=>{let r=e.preco_sugerido-e.preco_atual,s=e.preco_atual>0?(r/e.preco_atual*100).toFixed(1):0,o=r>.01,i=r<-.01;return(0,t.jsxs)("div",{className:"card",style:{display:"flex",alignItems:"flex-start",gap:16},children:[(0,t.jsx)("div",{style:{width:44,height:44,borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",background:o?"#ecfdf5":i?"#fef2f2":"#f0f9ff",fontSize:22,flexShrink:0},children:o?"⬆️":i?"⬇️":"✅"}),(0,t.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,t.jsx)("div",{style:{fontWeight:600,fontSize:15,marginBottom:4},children:e.nome}),(0,t.jsxs)("div",{style:{display:"flex",gap:16,flexWrap:"wrap",marginBottom:6},children:[(0,t.jsxs)("span",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:["Atual: ",(0,t.jsx)("strong",{children:x(e.preco_atual)})]}),(o||i)&&(0,t.jsxs)("span",{style:{fontSize:13,color:o?"var(--color-success)":"var(--color-danger)"},children:["Sugerido: ",(0,t.jsx)("strong",{children:x(e.preco_sugerido)})," ","(",s>0?"+":"",s,"%)"]}),(0,t.jsxs)("span",{style:{fontSize:13,color:"var(--color-text-muted)"},children:[e.total_vendas," vendas \xb7 ",x(e.total_receita)," receita"]})]}),(0,t.jsx)("p",{style:{fontSize:13,color:"var(--color-text-secondary)",lineHeight:1.5,margin:0},children:e.sugestao}),e.tem_multiplos_precos&&(0,t.jsx)("div",{style:{marginTop:8,display:"flex",gap:6,flexWrap:"wrap"},children:e.price_points.map((e,a)=>(0,t.jsxs)("span",{style:{fontSize:11,padding:"2px 8px",borderRadius:12,background:"var(--color-bg-muted)",color:"var(--color-text-secondary)"},children:[x(e.preco)," (",e.quantidade,"x)"]},a))})]})]},a)})})]})}}},function(e){e.O(0,[3448,565,2205,2971,2117,1744],function(){return e(e.s=4395)}),_N_E=e.O()}]);
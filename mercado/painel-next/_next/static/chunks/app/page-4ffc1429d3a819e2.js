(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1931],{64:function(e,a,l){Promise.resolve().then(l.bind(l,434))},434:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return m}});var s=l(7437),i=l(2265),t=l(4565),c=l(4477),r=l(7128),n=l(6428),o=l(4084),d=l(6705);function u(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e||0)}function m(){return(0,s.jsx)(t.Z,{children:(0,s.jsx)(c.Z,{children:(0,s.jsx)(v,{})})})}function v(){var e,a,l,t,c,o,m;let{partner:v,updatePartner:h}=(0,r.a)(),[x,g]=(0,i.useState)(null),[j,y]=(0,i.useState)(null),[b,_]=(0,i.useState)(null),[N,f]=(0,i.useState)(!0),[q,k]=(0,i.useState)("");if((0,i.useEffect)(()=>{!async function(){try{let[e,a]=await Promise.all([(0,n.SC)("/stats.php"),(0,n.SC)("/chart.php")]);g(e),y(a);try{let e=await (0,n.SC)("/quality-score.php");_(e)}catch(e){try{let e=await (0,n.SC)("/analytics.php");_(function(e){var a,l,s,i,t,c;let r=parseFloat(null!==(a=null==e?void 0:e.acceptance_rate)&&void 0!==a?a:95),n=parseFloat(null!==(l=null==e?void 0:e.avg_rating)&&void 0!==l?l:4.5),o=parseFloat(null!==(s=null==e?void 0:e.avg_preparation_time)&&void 0!==s?s:20),d=parseFloat(null!==(i=null==e?void 0:e.cancellation_rate)&&void 0!==i?i:3),u=100;o>=40?u=0:o>15&&(u=100-(o-15)/25*100);let m=100;d>=10?m=0:d>2&&(m=100-(d-2)/8*100);let v=Math.round(.25*(r>=95?100:r/95*100)+.2*u+.25*Math.max(0,Math.min(100,(n-3)*50))+.15*m+15),h="C";return h=v>=85?"A":v>=70?"B":v>=55?"C":v>=40?"D":"F",{score:v,grade:h,metrics:{acceptance_rate:r,prep_time_avg:o,prep_time_target:25,delivery_time_avg:35,rating_avg:n,rating_count:null!==(t=null==e?void 0:e.total_reviews)&&void 0!==t?t:0,cancellation_rate:d,complaint_rate:0,total_orders:null!==(c=null==e?void 0:e.total_orders)&&void 0!==c?c:0},badges:[],tips:[],comparison:{vs_category_avg:"+0%",rank_in_region:1,total_in_region:1,top_percentage:100}}}(e))}catch(e){}}}catch(e){k(e.message)}finally{f(!1)}}()},[]),N)return(0,s.jsx)("div",{className:"loading-screen",children:(0,s.jsx)("div",{className:"spinner"})});if(q)return(0,s.jsxs)("div",{className:"empty-state",children:[(0,s.jsx)("div",{className:"empty-state-title",children:"Erro ao carregar dashboard"}),(0,s.jsx)("div",{className:"empty-state-text",children:q})]});let M={labels:(null==j?void 0:j.labels)||[],datasets:[{label:"Receita (R$)",data:(null==j?void 0:j.values)||[],borderColor:"#F97316",backgroundColor:"rgba(249, 115, 22, 0.08)",tension:.3,fill:!0,pointBackgroundColor:"#F97316",pointRadius:4,pointHoverRadius:6}]},C=[{label:"Pedidos Hoje",value:null!==(e=null==x?void 0:x.pedidos_hoje)&&void 0!==e?e:0,color:"#0ea5e9",bg:"#f0f9ff",icon:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"},{label:"Receita Hoje",value:u(null==x?void 0:x.receita_hoje),color:"#16a34a",bg:"#f0fdf4",icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},{label:"Pendentes",value:null!==(a=null==x?void 0:x.pendentes)&&void 0!==a?a:0,color:(null!==(l=null==x?void 0:x.pendentes)&&void 0!==l?l:0)>0?"#dc2626":"#f59e0b",bg:(null!==(t=null==x?void 0:x.pendentes)&&void 0!==t?t:0)>0?"#fef2f2":"#fffbeb",icon:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"}],w=[{label:"Total Produtos",value:null!==(c=null==x?void 0:x.total_produtos)&&void 0!==c?c:0,color:"#F97316",bg:"#FFF7ED"},{label:"Promos Ativas",value:null!==(o=null==x?void 0:x.promos_ativas)&&void 0!==o?o:0,color:"#f59e0b",bg:"#fffbeb"},{label:"Receita do Mes",value:u(null==x?void 0:x.receita_mes),color:"#16a34a",bg:"#f0fdf4"},{label:"Pedidos do Mes",value:null!==(m=null==x?void 0:x.pedidos_mes)&&void 0!==m?m:0,color:"#8b5cf6",bg:"#f5f3ff"}];async function B(){try{let e=await (0,n.sg)("/toggle-status.php",{is_open:!(null==v?void 0:v.is_open)});h({is_open:e.is_open})}catch(e){console.error("Toggle error:",e)}}return(0,s.jsxs)("div",{children:[v&&!v.is_open&&(0,s.jsxs)("div",{className:"status-banner status-banner-closed",children:[(0,s.jsx)("span",{className:"status-banner-dot dot-closed"}),(0,s.jsxs)("span",{children:["Sua loja esta ",(0,s.jsx)("strong",{children:"fechada"}),". Clientes nao podem fazer pedidos."]}),(0,s.jsx)("button",{className:"btn btn-sm btn-primary",onClick:B,children:"Abrir Loja"})]}),v&&v.is_open&&(0,s.jsxs)("div",{className:"status-banner status-banner-open",children:[(0,s.jsx)("span",{className:"status-banner-dot dot-open"}),(0,s.jsxs)("span",{children:["Sua loja esta ",(0,s.jsx)("strong",{children:"aberta"})," e recebendo pedidos."]})]}),(0,s.jsx)("div",{className:"page-header",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"page-title",children:["Ola, ",(null==v?void 0:v.nome)||(null==v?void 0:v.razao_social)||"Parceiro"]}),(0,s.jsx)("p",{className:"page-subtitle",children:"Bem-vindo ao seu painel de controle"})]})}),(0,s.jsx)("div",{style:{marginBottom:8},children:(0,s.jsx)("h2",{style:{fontSize:15,fontWeight:600,color:"#64748b",marginBottom:12,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Hoje"})}),(0,s.jsx)("div",{className:"stats-grid",style:{gridTemplateColumns:"repeat(3, 1fr)",marginBottom:28},children:C.map((e,a)=>{var l,i;return(0,s.jsxs)("div",{className:"stat-card",style:"Pendentes"===e.label&&(null!==(l=null==x?void 0:x.pendentes)&&void 0!==l?l:0)>0?{border:"2px solid #dc2626",animation:"orderPulse 2s ease-in-out infinite"}:{},children:[(0,s.jsx)("div",{className:"stat-card-icon",style:{background:e.bg,color:e.color},children:(0,s.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("path",{d:e.icon})})}),(0,s.jsx)("div",{className:"stat-card-value",style:"Pendentes"===e.label&&(null!==(i=null==x?void 0:x.pendentes)&&void 0!==i?i:0)>0?{color:"#dc2626"}:{},children:e.value}),(0,s.jsx)("div",{className:"stat-card-label",children:e.label})]},"today-".concat(a))})}),(0,s.jsx)("div",{style:{marginBottom:8},children:(0,s.jsx)("h2",{style:{fontSize:15,fontWeight:600,color:"#64748b",marginBottom:12,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Este Mes"})}),(0,s.jsx)("div",{className:"stats-grid",children:w.map((e,a)=>(0,s.jsxs)("div",{className:"stat-card",children:[(0,s.jsx)("div",{className:"stat-card-icon",style:{background:e.bg,color:e.color},children:(0,s.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[0===a&&(0,s.jsx)("path",{d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"}),1===a&&(0,s.jsx)("path",{d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A2 2 0 013 12V7a4 4 0 014-4z"}),2===a&&(0,s.jsx)("path",{d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),3===a&&(0,s.jsx)("path",{d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})]})}),(0,s.jsx)("div",{className:"stat-card-value",children:e.value}),(0,s.jsx)("div",{className:"stat-card-label",children:e.label})]},a))}),(0,s.jsxs)("div",{className:"chart-card",children:[(0,s.jsx)("div",{className:"chart-header",children:(0,s.jsx)("h2",{className:"chart-title",children:"Receita - Ultimos 7 dias"})}),(0,s.jsx)("div",{style:{height:300},children:(0,s.jsx)(d.x1,{data:M,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:e=>u(e.parsed.y)}}},scales:{y:{beginAtZero:!0,ticks:{callback:e=>"R$ "+e.toLocaleString("pt-BR")},grid:{color:"#f1f5f9"}},x:{grid:{display:!1}}}}})})]}),b&&(0,s.jsx)(p,{data:b})]})}o.kL.register(o.uw,o.f$,o.od,o.jn,o.Dx,o.u,o.De,o.Gu);let h={super_restaurant:{icon:"\uD83C\uDFC6",label:"Super Restaurante",color:"#f59e0b"},fast_delivery:{icon:"⚡",label:"Entrega Relampago",color:"#F97316"},top_rated:{icon:"⭐",label:"Mais Bem Avaliado",color:"#22c55e"},new_favorite:{icon:"\uD83D\uDC96",label:"Novo Favorito",color:"#ec4899"},eco_friendly:{icon:"\uD83C\uDF3F",label:"Eco-Friendly",color:"#10b981"},verified:{icon:"✓",label:"Verificado",color:"#6366f1"}};function p(e){var a,l,i;let{data:t}=e,{score:c,grade:r,metrics:n,badges:o,tips:d,comparison:u}=t,m=c>=80?"#16a34a":c>=60?"#f59e0b":"#dc2626",v=2*Math.PI*54,p=function(e,a,l){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return s?e<=a?"#16a34a":e<=l?"#f59e0b":"#dc2626":e>=a?"#16a34a":e>=l?"#f59e0b":"#dc2626"},x=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return Math.min(100,Math.max(0,e/a*100))};return(0,s.jsxs)("div",{className:"quality-score-card",children:[(0,s.jsxs)("div",{className:"quality-score-header",children:[(0,s.jsx)("h2",{className:"quality-score-title",children:"Indice de Qualidade"}),(0,s.jsx)("span",{className:"quality-score-period",children:"Ultimos 30 dias"})]}),(0,s.jsxs)("div",{className:"quality-widget",children:[(0,s.jsxs)("div",{className:"quality-score-circle-wrap",children:[(0,s.jsxs)("svg",{className:"quality-score-svg",viewBox:"0 0 140 140",children:[(0,s.jsx)("circle",{className:"quality-score-bg",cx:"70",cy:"70",r:54}),(0,s.jsx)("circle",{className:"quality-score-progress",cx:"70",cy:"70",r:54,stroke:m,strokeDasharray:v,strokeDashoffset:v-c/100*v,style:{animation:"scoreCircleIn 1s ease-out"}})]}),(0,s.jsxs)("div",{className:"quality-score-center",children:[(0,s.jsx)("div",{className:"quality-score-number",style:{color:m},children:c}),(0,s.jsxs)("div",{className:"quality-score-grade",style:{color:m},children:["Nota ",r]}),(0,s.jsx)("div",{className:"quality-score-label",children:c>=85?"Excelente":c>=70?"Muito Bom":c>=55?"Bom":c>=40?"Regular":"Precisa Melhorar"})]})]}),(0,s.jsxs)("div",{className:"quality-main",children:[(0,s.jsxs)("div",{className:"quality-metrics",children:[(0,s.jsxs)("div",{className:"quality-metric",children:[(0,s.jsx)("div",{className:"quality-metric-header",children:(0,s.jsx)("div",{className:"quality-metric-icon",style:{background:p(n.acceptance_rate,95,80)+"20",color:p(n.acceptance_rate,95,80)},children:(0,s.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),(0,s.jsxs)("div",{className:"quality-metric-value",style:{color:p(n.acceptance_rate,95,80)},children:[(null===(a=n.acceptance_rate)||void 0===a?void 0:a.toFixed(0))||0,"%"]}),(0,s.jsx)("div",{className:"quality-metric-label",children:"Taxa de Aceitacao"}),(0,s.jsx)("div",{className:"quality-metric-bar",children:(0,s.jsx)("div",{className:"quality-metric-bar-fill",style:{width:"".concat(x(n.acceptance_rate),"%"),background:p(n.acceptance_rate,95,80)}})})]}),(0,s.jsxs)("div",{className:"quality-metric",children:[(0,s.jsx)("div",{className:"quality-metric-header",children:(0,s.jsx)("div",{className:"quality-metric-icon",style:{background:p(n.rating_avg,4.5,4)+"20",color:p(n.rating_avg,4.5,4)},children:(0,s.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})}),(0,s.jsx)("div",{className:"quality-metric-value",style:{color:p(n.rating_avg,4.5,4)},children:(null===(l=n.rating_avg)||void 0===l?void 0:l.toFixed(1))||"0.0"}),(0,s.jsxs)("div",{className:"quality-metric-label",children:["Avaliacao (",n.rating_count||0,")"]}),(0,s.jsx)("div",{className:"quality-metric-bar",children:(0,s.jsx)("div",{className:"quality-metric-bar-fill",style:{width:"".concat(100*x(n.rating_avg,5)/100,"%"),background:p(n.rating_avg,4.5,4)}})})]}),(0,s.jsxs)("div",{className:"quality-metric",children:[(0,s.jsx)("div",{className:"quality-metric-header",children:(0,s.jsx)("div",{className:"quality-metric-icon",style:{background:p(n.prep_time_avg,20,30,!0)+"20",color:p(n.prep_time_avg,20,30,!0)},children:(0,s.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),(0,s.jsxs)("div",{className:"quality-metric-value",style:{color:p(n.prep_time_avg,20,30,!0)},children:[n.prep_time_avg||0," min"]}),(0,s.jsx)("div",{className:"quality-metric-label",children:"Tempo de Preparo"}),(0,s.jsx)("div",{className:"quality-metric-bar",children:(0,s.jsx)("div",{className:"quality-metric-bar-fill",style:{width:"".concat(Math.max(0,100-x(n.prep_time_avg,40)),"%"),background:p(n.prep_time_avg,20,30,!0)}})})]}),(0,s.jsxs)("div",{className:"quality-metric",children:[(0,s.jsx)("div",{className:"quality-metric-header",children:(0,s.jsx)("div",{className:"quality-metric-icon",style:{background:p(n.cancellation_rate,2,5,!0)+"20",color:p(n.cancellation_rate,2,5,!0)},children:(0,s.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),(0,s.jsxs)("div",{className:"quality-metric-value",style:{color:p(n.cancellation_rate,2,5,!0)},children:[(null===(i=n.cancellation_rate)||void 0===i?void 0:i.toFixed(1))||"0.0","%"]}),(0,s.jsx)("div",{className:"quality-metric-label",children:"Cancelamentos"}),(0,s.jsx)("div",{className:"quality-metric-bar",children:(0,s.jsx)("div",{className:"quality-metric-bar-fill",style:{width:"".concat(Math.max(0,100-x(n.cancellation_rate,10)),"%"),background:p(n.cancellation_rate,2,5,!0)}})})]})]}),o&&o.length>0&&(0,s.jsxs)("div",{className:"quality-badges",children:[(0,s.jsx)("div",{className:"quality-badges-title",children:"Selos Conquistados"}),(0,s.jsx)("div",{className:"quality-badges-list",children:o.map((e,a)=>{let l=h[e]||{icon:"\uD83C\uDF96️",label:e,color:"#64748b"};return(0,s.jsxs)("div",{className:"quality-badge quality-badge-".concat(e),children:[(0,s.jsx)("span",{className:"quality-badge-icon",children:l.icon}),(0,s.jsx)("span",{children:l.label})]},e)})})]}),u&&u.total_in_region>1&&(0,s.jsxs)("div",{className:"quality-comparison",children:[(0,s.jsx)("div",{className:"quality-comparison-icon",children:(0,s.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),(0,s.jsxs)("div",{className:"quality-comparison-text",children:[(0,s.jsxs)("div",{className:"quality-comparison-main",children:["Voce esta no Top ",u.top_percentage<=10?"10%":u.top_percentage<=25?"25%":u.top_percentage<=50?"50%":u.top_percentage+"%"," da regiao!"]}),(0,s.jsxs)("div",{className:"quality-comparison-sub",children:["Posicao #",u.rank_in_region," de ",u.total_in_region," estabelecimentos (",u.vs_category_avg," vs media)"]})]})]})]})]}),d&&d.length>0&&(0,s.jsx)("div",{className:"quality-tips",style:{padding:"0 24px 20px"},children:d.map((e,a)=>(0,s.jsxs)("div",{className:"quality-tip",children:[(0,s.jsx)("span",{className:"quality-tip-icon",children:"\uD83D\uDCA1"}),(0,s.jsx)("span",{className:"quality-tip-text",children:e})]},a))})]})}}},function(e){e.O(0,[7674,3448,4840,565,2205,2971,2117,1744],function(){return e(e.s=64)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4223],{5314:function(e,a,t){Promise.resolve().then(t.bind(t,2734))},2734:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return u}});var s=t(7437),l=t(2265),i=t(4565),r=t(4477),d=t(6428),c=t(4084),n=t(6705);function o(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e||0)}c.kL.register(c.uw,c.f$,c.ZL,c.jn,c.od,c.qi,c.Dx,c.u,c.De,c.Gu);let h=["Janeiro","Fevereiro","Marco","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],p=[{key:"today",label:"Hoje"},{key:"week",label:"Semana"},{key:"month",label:"Mes"}],x={primary:"rgba(37, 99, 235, 1)",primaryLight:"rgba(37, 99, 235, 0.2)",success:"rgba(22, 163, 74, 1)",successLight:"rgba(22, 163, 74, 0.2)",warning:"rgba(245, 158, 11, 1)",warningLight:"rgba(245, 158, 11, 0.2)",danger:"rgba(220, 38, 38, 1)",dangerLight:"rgba(220, 38, 38, 0.2)",purple:"rgba(139, 92, 246, 1)",purpleLight:"rgba(139, 92, 246, 0.2)",cyan:"rgba(14, 165, 233, 1)",cyanLight:"rgba(14, 165, 233, 0.2)",teal:"rgba(20, 184, 166, 1)",pink:"rgba(236, 72, 153, 1)"},m=[x.primary,x.success,x.warning,x.purple,x.cyan,x.teal,x.pink,x.danger,"#6366f1","#84cc16"];function u(){return(0,s.jsx)(i.Z,{children:(0,s.jsx)(r.Z,{children:(0,s.jsx)(v,{})})})}function v(){var e,a,t,i,r,c;let u=new Date,[v,g]=(0,l.useState)(u.getMonth()+1),[j,y]=(0,l.useState)(u.getFullYear()),[b,f]=(0,l.useState)(null),[N,_]=(0,l.useState)(!0),[k,w]=(0,l.useState)(""),[C,S]=(0,l.useState)("month"),[R,M]=(0,l.useState)(""),[W,A]=(0,l.useState)(""),[D,B]=(0,l.useState)("month"),[L,I]=(0,l.useState)(null),[T,z]=(0,l.useState)(!0),[P,F]=(0,l.useState)(""),[q,$]=(0,l.useState)(null),[E,H]=(0,l.useState)(!0);(0,l.useEffect)(()=>{let e=new Date,a=new Date(e);a.setDate(a.getDate()-30),M(a.toISOString().slice(0,10)),A(e.toISOString().slice(0,10))},[]);let V=(0,l.useMemo)(()=>{let e,a;let t=new Date;switch(C){case"7days":a=t.toISOString().slice(0,10),e=new Date(t.setDate(t.getDate()-7)).toISOString().slice(0,10);break;case"30days":a=new Date().toISOString().slice(0,10),e=new Date(new Date().setDate(new Date().getDate()-30)).toISOString().slice(0,10);break;case"custom":e=R,a=W;break;default:let s=String(v).padStart(2,"0");e="".concat(j,"-").concat(s,"-01"),a=new Date(j,v,0).toISOString().slice(0,10)}return{start:e,end:a}},[C,R,W,v,j]),O=(0,l.useCallback)(async()=>{_(!0),w("");try{let e="month"===C?{month:v,year:j}:{start_date:V.start,end_date:V.end},a=await (0,d.SC)("/reports.php",e);f(a)}catch(e){w(e.message)}finally{_(!1)}},[v,j,C,V]),Z=(0,l.useCallback)(async()=>{z(!0),F("");try{let e=await (0,d.SC)("/analytics.php",{period:D});I(e)}catch(e){F(e.message)}finally{z(!1)}},[D]),Q=(0,l.useCallback)(async()=>{H(!0);try{let e=await (0,d.SC)("/insights.php");$(e)}catch(e){console.error("Error loading insights:",e)}finally{H(!1)}},[]);(0,l.useEffect)(()=>{O()},[O]),(0,l.useEffect)(()=>{Z()},[Z]),(0,l.useEffect)(()=>{Q()},[Q]);let U=[];for(let e=u.getFullYear();e>=u.getFullYear()-3;e--)U.push(e);let J=(0,l.useMemo)(()=>{var e;return(null==b?void 0:null===(e=b.receita_por_dia)||void 0===e?void 0:e.length)?{labels:b.receita_por_dia.map(e=>{let a=new Date(e.date);return"".concat(a.getDate(),"/").concat(a.getMonth()+1)}),datasets:[{label:"Receita (R$)",data:b.receita_por_dia.map(e=>e.total),borderColor:x.primary,backgroundColor:x.primaryLight,fill:!0,tension:.4,pointRadius:3,pointHoverRadius:6}]}:null},[b]),Y=(0,l.useMemo)(()=>{if(!(null==L?void 0:L.peak_hours))return null;let e=L.peak_hours.filter(e=>e.hour>=6&&e.hour<=23),a=Math.max(...e.map(e=>e.order_count),1);return{labels:e.map(e=>e.label),datasets:[{label:"Pedidos",data:e.map(e=>e.order_count),backgroundColor:e.map(e=>{let t=e.order_count/a;return t>.7?x.danger:t>.4?x.warning:t>.2?x.success:x.primaryLight}),borderColor:e.map(e=>{let t=e.order_count/a;return t>.7?x.danger:t>.4?x.warning:t>.2?x.success:x.primary}),borderWidth:1,borderRadius:4}]}},[L]),G=(0,l.useMemo)(()=>{let e=(null==b?void 0:b.top_produtos)||(null==b?void 0:b.top_products)||[];return e.length?{labels:e.slice(0,10).map(e=>{let a=e.name||e.nome;return a.length>20?a.substring(0,20)+"...":a}),datasets:[{label:"Quantidade Vendida",data:e.slice(0,10).map(e=>e.quantity||e.quantidade||e.total_qty),backgroundColor:m.map(e=>e.replace("1)","0.7)")),borderColor:m,borderWidth:1,borderRadius:4}]}:null},[b]),K=(0,l.useMemo)(()=>{if(!L)return null;let e=L.returning_customers||0,a=(L.unique_customers||0)-e;return a+e===0?null:{labels:["Novos Clientes","Clientes Recorrentes"],datasets:[{data:[Math.max(0,a),e],backgroundColor:[x.cyanLight,x.successLight],borderColor:[x.cyan,x.success],borderWidth:2}]}},[L]),X=(0,l.useMemo)(()=>{var e;return(null==b?void 0:null===(e=b.receita_por_dia)||void 0===e?void 0:e.length)?{labels:b.receita_por_dia.map(e=>{let a=new Date(e.date);return"".concat(a.getDate(),"/").concat(a.getMonth()+1)}),datasets:[{label:"Ticket Medio (R$)",data:b.receita_por_dia.map(e=>e.pedidos>0?e.total/e.pedidos:0),borderColor:x.success,backgroundColor:x.successLight,fill:!0,tension:.4,pointRadius:3,pointHoverRadius:6}]}:null},[b]),ee=(0,l.useMemo)(()=>{var e;if(!(null==q?void 0:null===(e=q.daily_analytics)||void 0===e?void 0:e.length))return null;let a=[...q.daily_analytics].sort((e,a)=>new Date(e.date)-new Date(a.date)).slice(-30);return{labels:a.map(e=>{let a=new Date(e.date);return"".concat(a.getDate(),"/").concat(a.getMonth()+1)}),datasets:[{label:"Taxa de Cancelamento (%)",data:a.map(e=>{let a=e.orders_count||0,t=e.cancelled_count||0;return a>0?(t/a*100).toFixed(1):0}),borderColor:x.danger,backgroundColor:x.dangerLight,fill:!0,tension:.4,pointRadius:3,pointHoverRadius:6}]}},[q]),ea=(0,l.useMemo)(()=>{if(!(null==L?void 0:L.avg_rating))return null;let e=L.avg_rating,a=L.total_reviews||0;if(0===a)return null;let t=[0,0,0,0,0];for(let s=0;s<a;s++){let a=Math.round(e+(Math.random()-.5)*3);a=Math.max(1,Math.min(5,a)),t[a-1]++}return{labels:["1 estrela","2 estrelas","3 estrelas","4 estrelas","5 estrelas"],datasets:[{label:"Avaliacoes",data:t,backgroundColor:[x.dangerLight,x.warningLight,x.cyanLight,x.successLight,x.primaryLight],borderColor:[x.danger,x.warning,x.cyan,x.success,x.primary],borderWidth:2}]}},[L]),et=(0,l.useMemo)(()=>{var e;return(null==b?void 0:null===(e=b.receita_por_dia)||void 0===e?void 0:e.length)?{labels:b.receita_por_dia.map(e=>{let a=new Date(e.date);return"".concat(a.getDate(),"/").concat(a.getMonth()+1)}),datasets:[{label:"Pedidos",data:b.receita_por_dia.map(e=>e.pedidos),borderColor:x.purple,backgroundColor:x.purpleLight,fill:!0,tension:.4,pointRadius:3,pointHoverRadius:6}]}:null},[b]),es={labels:(null==b?void 0:null===(e=b.chart)||void 0===e?void 0:e.labels)||(null==b?void 0:null===(a=b.receita_por_dia)||void 0===a?void 0:a.map(e=>{let a=new Date(e.date);return"".concat(a.getDate())}))||[],datasets:[{label:"Vendas (R$)",data:(null==b?void 0:null===(t=b.chart)||void 0===t?void 0:t.values)||(null==b?void 0:null===(i=b.receita_por_dia)||void 0===i?void 0:i.map(e=>e.total))||[],backgroundColor:"rgba(37, 99, 235, 0.7)",borderColor:"#2563eb",borderWidth:1,borderRadius:4}]},el=(null==L?void 0:L.peak_hours)?{labels:L.peak_hours.filter(e=>e.hour>=6&&e.hour<=23).map(e=>e.label),datasets:[{label:"Pedidos",data:L.peak_hours.filter(e=>e.hour>=6&&e.hour<=23).map(e=>e.order_count),backgroundColor:"rgba(139, 92, 246, 0.7)",borderColor:"#8b5cf6",borderWidth:1,borderRadius:4}]}:null,ei=(0,l.useMemo)(()=>b?{receita_total:b.total_vendas,total_pedidos:b.total_pedidos,ticket_medio:b.ticket_medio,clientes_unicos:(null==L?void 0:L.unique_customers)||0}:null,[b,L]);return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"page-header",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"page-title",children:"Relatorios"}),(0,s.jsx)("p",{className:"page-subtitle",children:"Analise detalhada do seu desempenho"})]}),(0,s.jsx)("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:(0,s.jsxs)("button",{className:"btn btn-secondary",onClick:function(){var e,a;if(!b)return;let t="Data,Vendas (R$),Pedidos\n";(b.receita_por_dia||(null===(a=b.chart)||void 0===a?void 0:null===(e=a.labels)||void 0===e?void 0:e.map((e,a)=>({date:e,total:b.chart.values[a]||0,pedidos:0})))||[]).forEach(e=>{t+="".concat(e.date,",").concat(e.total,",").concat(e.pedidos||0,"\n")}),t+="\nProduto,Quantidade,Receita (R$)\n",(b.top_products||b.top_produtos||[]).forEach(e=>{t+='"'.concat(e.nome||e.name,'",').concat(e.quantidade||e.qty_sold||e.quantity||0,",").concat(e.receita||e.revenue||0,"\n")});let s=new Blob(["\uFEFF"+t],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(s),i=document.createElement("a");i.href=l;let r="month"!==C?"".concat(V.start,"_").concat(V.end):"".concat(j,"-").concat(String(v).padStart(2,"0"));i.download="relatorio-".concat(r,".csv"),i.click(),URL.revokeObjectURL(l)},disabled:!b,title:"Exportar CSV",style:{display:"inline-flex",alignItems:"center",gap:6,fontSize:13},children:[(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"})}),"CSV"]})})]}),(0,s.jsxs)("div",{className:"card",style:{marginBottom:24,padding:"16px 20px"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:16},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,s.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:[(0,s.jsx)("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),(0,s.jsx)("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),(0,s.jsx)("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),(0,s.jsx)("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),(0,s.jsx)("span",{style:{fontWeight:600,color:"var(--color-text)"},children:"Periodo:"})]}),(0,s.jsx)("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:(0,s.jsxs)("div",{className:"tabs",style:{marginBottom:0},children:[(0,s.jsx)("button",{className:"tab ".concat("7days"===C?"tab-active":""),onClick:()=>S("7days"),children:"7 Dias"}),(0,s.jsx)("button",{className:"tab ".concat("30days"===C?"tab-active":""),onClick:()=>S("30days"),children:"30 Dias"}),(0,s.jsx)("button",{className:"tab ".concat("month"===C?"tab-active":""),onClick:()=>S("month"),children:"Mes"}),(0,s.jsx)("button",{className:"tab ".concat("custom"===C?"tab-active":""),onClick:()=>S("custom"),children:"Personalizado"})]})})]}),(0,s.jsxs)("div",{style:{marginTop:16,display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:["month"===C&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("select",{className:"form-select",style:{width:"auto",minWidth:140},value:v,onChange:e=>g(parseInt(e.target.value)),children:h.map((e,a)=>(0,s.jsx)("option",{value:a+1,children:e},a))}),(0,s.jsx)("select",{className:"form-select",style:{width:"auto",minWidth:100},value:j,onChange:e=>y(parseInt(e.target.value)),children:U.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),"custom"===C&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,s.jsx)("span",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:"De:"}),(0,s.jsx)("input",{type:"date",className:"form-input",style:{width:"auto"},value:R,onChange:e=>M(e.target.value)})]}),(0,s.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,s.jsx)("span",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:"Ate:"}),(0,s.jsx)("input",{type:"date",className:"form-input",style:{width:"auto"},value:W,onChange:e=>A(e.target.value)})]})]}),("7days"===C||"30days"===C)&&(0,s.jsxs)("span",{style:{fontSize:13,color:"var(--color-text-muted)"},children:[V.start," ate ",V.end]})]})]}),N?(0,s.jsx)("div",{className:"loading-screen",children:(0,s.jsx)("div",{className:"spinner"})}):k?(0,s.jsxs)("div",{className:"empty-state",children:[(0,s.jsx)("div",{className:"empty-state-title",children:"Erro ao carregar relatorio"}),(0,s.jsx)("div",{className:"empty-state-text",children:k})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"stats-grid",children:[(0,s.jsxs)("div",{className:"stat-card",children:[(0,s.jsx)("div",{className:"stat-card-icon",style:{background:"#eff6ff",color:"#2563eb"},children:(0,s.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsx)("div",{className:"stat-card-value",children:o(null==ei?void 0:ei.receita_total)}),(0,s.jsx)("div",{className:"stat-card-label",children:"Receita Total"}),(null==b?void 0:b.comparacao_mes_anterior)&&(0,s.jsxs)("div",{style:{marginTop:4,fontSize:12,color:b.comparacao_mes_anterior.variacao_vendas_percent>=0?"var(--color-success)":"var(--color-danger)",display:"flex",alignItems:"center",gap:4},children:[b.comparacao_mes_anterior.variacao_vendas_percent>=0?"↑":"↓",Math.abs(b.comparacao_mes_anterior.variacao_vendas_percent),"% vs periodo anterior"]})]}),(0,s.jsxs)("div",{className:"stat-card",children:[(0,s.jsx)("div",{className:"stat-card-icon",style:{background:"#f0fdf4",color:"#16a34a"},children:(0,s.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),(0,s.jsx)("div",{className:"stat-card-value",children:null!==(r=null==ei?void 0:ei.total_pedidos)&&void 0!==r?r:0}),(0,s.jsx)("div",{className:"stat-card-label",children:"Total de Pedidos"}),(null==b?void 0:b.comparacao_mes_anterior)&&(0,s.jsxs)("div",{style:{marginTop:4,fontSize:12,color:b.comparacao_mes_anterior.variacao_pedidos_percent>=0?"var(--color-success)":"var(--color-danger)",display:"flex",alignItems:"center",gap:4},children:[b.comparacao_mes_anterior.variacao_pedidos_percent>=0?"↑":"↓",Math.abs(b.comparacao_mes_anterior.variacao_pedidos_percent),"% vs periodo anterior"]})]}),(0,s.jsxs)("div",{className:"stat-card",children:[(0,s.jsx)("div",{className:"stat-card-icon",style:{background:"#fffbeb",color:"#f59e0b"},children:(0,s.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"})})}),(0,s.jsx)("div",{className:"stat-card-value",children:null!==(c=null==ei?void 0:ei.clientes_unicos)&&void 0!==c?c:0}),(0,s.jsx)("div",{className:"stat-card-label",children:"Clientes Unicos"})]}),(0,s.jsxs)("div",{className:"stat-card",children:[(0,s.jsx)("div",{className:"stat-card-icon",style:{background:"#f5f3ff",color:"#8b5cf6"},children:(0,s.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),(0,s.jsx)("div",{className:"stat-card-value",children:o(null==ei?void 0:ei.ticket_medio)}),(0,s.jsx)("div",{className:"stat-card-label",children:"Ticket Medio"})]})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:24,marginBottom:24},children:[(0,s.jsxs)("div",{className:"chart-card",children:[(0,s.jsx)("div",{className:"chart-header",children:(0,s.jsx)("h2",{className:"chart-title",children:"Tendencia de Receita (Ultimos 30 dias)"})}),(0,s.jsx)("div",{style:{height:280},children:J?(0,s.jsx)(n.x1,{data:J,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:e=>o(e.parsed.y)}}},scales:{y:{beginAtZero:!0,ticks:{callback:e=>"R$ "+e.toLocaleString("pt-BR")},grid:{color:"#f1f5f9"}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:0}}}}}):(0,s.jsx)("div",{className:"empty-state",style:{padding:40},children:(0,s.jsx)("div",{className:"empty-state-text",children:"Sem dados de receita"})})})]}),(0,s.jsxs)("div",{className:"chart-card",children:[(0,s.jsx)("div",{className:"chart-header",children:(0,s.jsx)("h2",{className:"chart-title",children:"Tendencia de Pedidos"})}),(0,s.jsx)("div",{style:{height:280},children:et?(0,s.jsx)(n.x1,{data:et,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:e=>"".concat(e.parsed.y," pedidos")}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1},grid:{color:"#f1f5f9"}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:0}}}}}):(0,s.jsx)("div",{className:"empty-state",style:{padding:40},children:(0,s.jsx)("div",{className:"empty-state-text",children:"Sem dados de pedidos"})})})]})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:24,marginBottom:24},children:[(0,s.jsxs)("div",{className:"chart-card",children:[(0,s.jsxs)("div",{className:"chart-header",children:[(0,s.jsx)("h2",{className:"chart-title",children:"Pedidos por Horario"}),(0,s.jsx)("span",{style:{fontSize:12,color:"var(--color-text-muted)"},children:"Cores indicam intensidade (vermelho = pico)"})]}),(0,s.jsx)("div",{style:{height:280},children:Y?(0,s.jsx)(n.$Q,{data:Y,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:e=>"".concat(e.parsed.y," pedidos"),afterLabel:e=>{var a;let t=(null==L?void 0:null===(a=L.peak_hours)||void 0===a?void 0:a.reduce((e,a)=>e+a.order_count,0))||0,s=t>0?(e.parsed.y/t*100).toFixed(1):0;return"".concat(s,"% do total")}}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1},grid:{color:"#f1f5f9"}},x:{grid:{display:!1}}}}}):(0,s.jsx)("div",{className:"empty-state",style:{padding:40},children:(0,s.jsx)("div",{className:"empty-state-text",children:"Sem dados de horarios"})})})]}),(0,s.jsxs)("div",{className:"chart-card",children:[(0,s.jsx)("div",{className:"chart-header",children:(0,s.jsx)("h2",{className:"chart-title",children:"Top 10 Produtos"})}),(0,s.jsx)("div",{style:{height:280},children:G?(0,s.jsx)(n.$Q,{data:G,options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{afterLabel:e=>{let a=((null==b?void 0:b.top_produtos)||(null==b?void 0:b.top_products)||[])[e.dataIndex];return a?"Receita: ".concat(o(a.revenue||a.receita)):""}}}},scales:{x:{beginAtZero:!0,grid:{color:"#f1f5f9"}},y:{grid:{display:!1}}}}}):(0,s.jsx)("div",{className:"empty-state",style:{padding:40},children:(0,s.jsx)("div",{className:"empty-state-text",children:"Sem dados de produtos"})})})]})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(350px, 1fr))",gap:24,marginBottom:24},children:[(0,s.jsxs)("div",{className:"chart-card",children:[(0,s.jsxs)("div",{className:"chart-header",children:[(0,s.jsx)("h2",{className:"chart-title",children:"Retencao de Clientes"}),(0,s.jsx)("span",{style:{fontSize:12,color:"var(--color-text-muted)"},children:"Novos vs Recorrentes"})]}),(0,s.jsx)("div",{style:{height:280,display:"flex",alignItems:"center",justifyContent:"center"},children:K?(0,s.jsx)("div",{style:{width:"100%",maxWidth:280,height:"100%"},children:(0,s.jsx)(n.$I,{data:K,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{usePointStyle:!0,padding:20}},tooltip:{callbacks:{label:e=>{let a=e.dataset.data.reduce((e,a)=>e+a,0),t=a>0?(e.parsed/a*100).toFixed(1):0;return"".concat(e.label,": ").concat(e.parsed," (").concat(t,"%)")}}}}}})}):(0,s.jsx)("div",{className:"empty-state",style:{padding:40},children:(0,s.jsx)("div",{className:"empty-state-text",children:"Sem dados de clientes"})})}),L&&(0,s.jsxs)("div",{style:{textAlign:"center",marginTop:8,padding:"0 20px 16px"},children:[(0,s.jsxs)("span",{style:{fontSize:24,fontWeight:700,color:L.customer_retention>=30?"var(--color-success)":"var(--color-warning)"},children:[L.customer_retention,"%"]}),(0,s.jsx)("span",{style:{fontSize:13,color:"var(--color-text-muted)",marginLeft:8},children:"taxa de retencao"})]})]}),(0,s.jsxs)("div",{className:"chart-card",children:[(0,s.jsx)("div",{className:"chart-header",children:(0,s.jsx)("h2",{className:"chart-title",children:"Tendencia de Ticket Medio"})}),(0,s.jsx)("div",{style:{height:280},children:X?(0,s.jsx)(n.x1,{data:X,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:e=>o(e.parsed.y)}}},scales:{y:{beginAtZero:!0,ticks:{callback:e=>"R$ "+e.toLocaleString("pt-BR")},grid:{color:"#f1f5f9"}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:0}}}}}):(0,s.jsx)("div",{className:"empty-state",style:{padding:40},children:(0,s.jsx)("div",{className:"empty-state-text",children:"Sem dados de ticket medio"})})})]}),(0,s.jsxs)("div",{className:"chart-card",children:[(0,s.jsxs)("div",{className:"chart-header",children:[(0,s.jsx)("h2",{className:"chart-title",children:"Distribuicao de Avaliacoes"}),(null==L?void 0:L.avg_rating)>0&&(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"#f59e0b",stroke:"#f59e0b",strokeWidth:"2",children:(0,s.jsx)("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})}),(0,s.jsx)("span",{style:{fontWeight:600},children:L.avg_rating.toFixed(1)}),(0,s.jsxs)("span",{style:{fontSize:12,color:"var(--color-text-muted)"},children:["(",L.total_reviews," avaliacoes)"]})]})]}),(0,s.jsx)("div",{style:{height:280},children:ea?(0,s.jsx)(n.$Q,{data:ea,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:e=>"".concat(e.parsed.y," avaliacoes"),afterLabel:e=>{let a=e.dataset.data.reduce((e,a)=>e+a,0),t=a>0?(e.parsed.y/a*100).toFixed(1):0;return"".concat(t,"% do total")}}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1},grid:{color:"#f1f5f9"}},x:{grid:{display:!1}}}}}):(0,s.jsx)("div",{className:"empty-state",style:{padding:40},children:(0,s.jsx)("div",{className:"empty-state-text",children:"Sem avaliacoes no periodo"})})})]})]}),ee&&(0,s.jsxs)("div",{className:"chart-card",style:{marginBottom:24},children:[(0,s.jsxs)("div",{className:"chart-header",children:[(0,s.jsx)("h2",{className:"chart-title",children:"Taxa de Cancelamento (Tendencia)"}),L&&(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,color:L.cancellation_rate<=5?"var(--color-success)":L.cancellation_rate<=15?"var(--color-warning)":"var(--color-danger)"},children:[(0,s.jsxs)("span",{style:{fontWeight:600},children:[L.cancellation_rate,"%"]}),(0,s.jsx)("span",{style:{fontSize:12,color:"var(--color-text-muted)"},children:"atual"})]})]}),(0,s.jsx)("div",{style:{height:250},children:(0,s.jsx)(n.x1,{data:ee,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:e=>"".concat(e.parsed.y,"%")}}},scales:{y:{beginAtZero:!0,max:100,ticks:{callback:e=>e+"%"},grid:{color:"#f1f5f9"}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:0}}}}})})]}),(0,s.jsxs)("div",{className:"card",style:{marginBottom:24},children:[(0,s.jsxs)("div",{className:"card-header",style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:12},children:[(0,s.jsx)("h2",{className:"card-title",children:"Analytics Avancado"}),(0,s.jsx)("div",{className:"tabs",style:{marginBottom:0},children:p.map(e=>(0,s.jsx)("button",{className:"tab ".concat(D===e.key?"tab-active":""),onClick:()=>B(e.key),children:e.label},e.key))})]}),T?(0,s.jsx)("div",{style:{padding:40,textAlign:"center"},children:(0,s.jsx)("div",{className:"spinner"})}):P?(0,s.jsx)("div",{style:{padding:20,textAlign:"center",color:"var(--color-danger)"},children:P}):L?(0,s.jsxs)("div",{style:{padding:"0 20px 20px"},children:[(0,s.jsxs)("div",{className:"stats-grid",style:{marginBottom:24},children:[(0,s.jsxs)("div",{className:"stat-card",children:[(0,s.jsx)("div",{className:"stat-card-icon",style:{background:"#f0fdf4",color:"#16a34a"},children:(0,s.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,s.jsx)("path",{d:"M22 11.08V12a10 10 0 11-5.93-9.14"}),(0,s.jsx)("polyline",{points:"22 4 12 14.01 9 11.01"})]})}),(0,s.jsxs)("div",{className:"stat-card-value",style:{color:L.acceptance_rate>=80?"var(--color-success)":L.acceptance_rate>=50?"var(--color-warning)":"var(--color-danger)"},children:[L.acceptance_rate,"%"]}),(0,s.jsx)("div",{className:"stat-card-label",children:"Taxa de Aceitacao"})]}),(0,s.jsxs)("div",{className:"stat-card",children:[(0,s.jsx)("div",{className:"stat-card-icon",style:{background:"#eff6ff",color:"#2563eb"},children:(0,s.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,s.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,s.jsx)("polyline",{points:"12 6 12 12 16 14"})]})}),(0,s.jsx)("div",{className:"stat-card-value",children:L.avg_preparation_time>0?"".concat(L.avg_preparation_time,"min"):"--"}),(0,s.jsx)("div",{className:"stat-card-label",children:"Tempo Medio de Preparo"})]}),(0,s.jsxs)("div",{className:"stat-card",children:[(0,s.jsx)("div",{className:"stat-card-icon",style:{background:"#fef2f2",color:"#dc2626"},children:(0,s.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,s.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,s.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),(0,s.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]})}),(0,s.jsxs)("div",{className:"stat-card-value",style:{color:L.cancellation_rate<=5?"var(--color-success)":L.cancellation_rate<=15?"var(--color-warning)":"var(--color-danger)"},children:[L.cancellation_rate,"%"]}),(0,s.jsx)("div",{className:"stat-card-label",children:"Taxa de Cancelamento"})]}),(0,s.jsxs)("div",{className:"stat-card",children:[(0,s.jsx)("div",{className:"stat-card-icon",style:{background:"#fffbeb",color:"#f59e0b"},children:(0,s.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),(0,s.jsx)("div",{className:"stat-card-value",children:L.avg_rating>0?L.avg_rating.toFixed(1):"--"}),(0,s.jsxs)("div",{className:"stat-card-label",children:["Nota Media (",L.total_reviews," avaliacoes)"]})]})]}),(0,s.jsxs)("div",{className:"stats-grid",style:{marginBottom:24},children:[(0,s.jsxs)("div",{className:"stat-card",children:[(0,s.jsx)("div",{className:"stat-card-icon",style:{background:"#f0f9ff",color:"#0ea5e9"},children:(0,s.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})})}),(0,s.jsx)("div",{className:"stat-card-value",children:function(e){if(!e||0===e)return"0s";if(e<60)return"".concat(e,"s");let a=Math.floor(e/60),t=e%60;return t>0?"".concat(a,"min ").concat(t,"s"):"".concat(a,"min")}(L.avg_acceptance_time)}),(0,s.jsx)("div",{className:"stat-card-label",children:"Tempo Medio de Aceitacao"})]}),(0,s.jsxs)("div",{className:"stat-card",children:[(0,s.jsx)("div",{className:"stat-card-icon",style:{background:"#fffbeb",color:"#f59e0b"},children:(0,s.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,s.jsx)("path",{d:"M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),(0,s.jsx)("circle",{cx:"9",cy:"7",r:"4"}),(0,s.jsx)("path",{d:"M23 21v-2a4 4 0 00-3-3.87"}),(0,s.jsx)("path",{d:"M16 3.13a4 4 0 010 7.75"})]})}),(0,s.jsx)("div",{className:"stat-card-value",children:L.unique_customers}),(0,s.jsx)("div",{className:"stat-card-label",children:"Clientes Unicos"})]}),(0,s.jsxs)("div",{className:"stat-card",children:[(0,s.jsx)("div",{className:"stat-card-icon",style:{background:"#f0fdf4",color:"#16a34a"},children:(0,s.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,s.jsx)("path",{d:"M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),(0,s.jsx)("circle",{cx:"8.5",cy:"7",r:"4"}),(0,s.jsx)("polyline",{points:"17 11 19 13 23 9"})]})}),(0,s.jsxs)("div",{className:"stat-card-value",children:[L.customer_retention,"%"]}),(0,s.jsx)("div",{className:"stat-card-label",children:"Retencao de Clientes"})]}),(0,s.jsxs)("div",{className:"stat-card",children:[(0,s.jsx)("div",{className:"stat-card-icon",style:{background:"#f5f3ff",color:"#8b5cf6"},children:(0,s.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),(0,s.jsx)("div",{className:"stat-card-value",children:L.total_orders}),(0,s.jsx)("div",{className:"stat-card-label",children:"Total Pedidos (Periodo)"})]})]}),el&&(0,s.jsxs)("div",{className:"chart-card",style:{marginBottom:0},children:[(0,s.jsx)("div",{className:"chart-header",children:(0,s.jsx)("h3",{className:"chart-title",children:"Horarios de Pico"})}),(0,s.jsx)("div",{style:{height:250},children:(0,s.jsx)(n.$Q,{data:el,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:e=>"".concat(e.parsed.y," pedidos")}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1},grid:{color:"#f1f5f9"}},x:{grid:{display:!1}}}}})})]})]}):null]}),(0,s.jsxs)("div",{className:"chart-card",children:[(0,s.jsx)("div",{className:"chart-header",children:(0,s.jsx)("h2",{className:"chart-title",children:"Vendas por Dia"})}),(0,s.jsx)("div",{style:{height:300},children:(0,s.jsx)(n.$Q,{data:es,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:e=>o(e.parsed.y)}}},scales:{y:{beginAtZero:!0,ticks:{callback:e=>"R$ "+e.toLocaleString("pt-BR")},grid:{color:"#f1f5f9"}},x:{grid:{display:!1}}}}})})]}),(0,s.jsxs)("div",{className:"card",style:{marginBottom:24},children:[(0,s.jsx)("div",{className:"card-header",children:(0,s.jsx)("h2",{className:"card-title",children:"Produtos Mais Vendidos"})}),0===((null==b?void 0:b.top_products)||(null==b?void 0:b.top_produtos)||[]).length?(0,s.jsx)("div",{className:"empty-state",children:(0,s.jsx)("div",{className:"empty-state-text",children:"Sem dados de vendas neste periodo"})}):(0,s.jsx)("div",{className:"table-wrapper",style:{boxShadow:"none"},children:(0,s.jsxs)("table",{className:"table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"#"}),(0,s.jsx)("th",{children:"Produto"}),(0,s.jsx)("th",{style:{textAlign:"right"},children:"Qtd Vendida"}),(0,s.jsx)("th",{style:{textAlign:"right"},children:"Pedidos"}),(0,s.jsx)("th",{style:{textAlign:"right"},children:"Receita"})]})}),(0,s.jsx)("tbody",{children:((null==b?void 0:b.top_products)||(null==b?void 0:b.top_produtos)||[]).map((e,a)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{style:{fontWeight:600,color:"var(--color-text-muted)"},children:a+1}),(0,s.jsx)("td",{style:{fontWeight:500},children:e.nome||e.name}),(0,s.jsx)("td",{style:{textAlign:"right"},children:e.quantidade||e.qty_sold||e.quantity}),(0,s.jsx)("td",{style:{textAlign:"right"},children:e.orders||e.orders_count||"-"}),(0,s.jsx)("td",{style:{textAlign:"right",fontWeight:600},children:o(e.receita||e.revenue)})]},e.id||e.product_id||a))})]})})]}),(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:(0,s.jsx)("h2",{className:"card-title",children:"Detalhamento de Receita"})}),(null==b?void 0:b.breakdown)?(0,s.jsxs)("div",{style:{display:"grid",gap:12},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 0",borderBottom:"1px solid var(--color-border)"},children:[(0,s.jsx)("span",{children:"Receita Bruta"}),(0,s.jsx)("span",{style:{fontWeight:600},children:o(b.breakdown.receita_bruta)})]}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 0",borderBottom:"1px solid var(--color-border)",color:"var(--color-danger)"},children:[(0,s.jsx)("span",{children:"Descontos e Promocoes"}),(0,s.jsxs)("span",{style:{fontWeight:600},children:["-",o(b.breakdown.descontos)]})]}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 0",borderBottom:"1px solid var(--color-border)",color:"var(--color-danger)"},children:[(0,s.jsx)("span",{children:"Taxas da Plataforma"}),(0,s.jsxs)("span",{style:{fontWeight:600},children:["-",o(b.breakdown.taxas)]})]}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 0",borderBottom:"1px solid var(--color-border)",color:"var(--color-danger)"},children:[(0,s.jsx)("span",{children:"Cancelamentos"}),(0,s.jsxs)("span",{style:{fontWeight:600},children:["-",o(b.breakdown.cancelamentos)]})]}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 0",fontSize:18,fontWeight:700},children:[(0,s.jsx)("span",{children:"Receita Liquida"}),(0,s.jsx)("span",{style:{color:"var(--color-success)"},children:o(b.breakdown.receita_liquida)})]})]}):(0,s.jsx)("div",{className:"empty-state",children:(0,s.jsx)("div",{className:"empty-state-text",children:"Sem detalhamento disponivel"})})]})]})]})}}},function(e){e.O(0,[7674,3448,4840,565,2205,2971,2117,1744],function(){return e(e.s=5314)}),_N_E=e.O()}]);
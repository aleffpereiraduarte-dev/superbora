(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[139],{5747:function(e,t,s){Promise.resolve().then(s.bind(s,5960))},5960:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u}});var r=s(7437),n=s(2265),l=s(4565),o=s(4477),c=s(6428),a=s(6971);function i(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e||0)}function u(){return(0,r.jsx)(l.Z,{children:(0,r.jsx)(o.Z,{children:(0,r.jsx)(d,{})})})}function d(){let{addNotification:e}=(0,a.l)(),[t,s]=(0,n.useState)([]),[l,o]=(0,n.useState)(!0),[u,d]=(0,n.useState)(""),[p,h]=(0,n.useState)(""),[m,x]=(0,n.useState)("nome"),[j,v]=(0,n.useState)("asc"),[y,g]=(0,n.useState)(null),[f,b]=(0,n.useState)({}),[N,C]=(0,n.useState)(!1),_=(0,n.useRef)(null),k=(0,n.useCallback)(async()=>{o(!0),d("");try{let e=await (0,c.SC)("/prices.php");s((null==e?void 0:e.prices)||(Array.isArray(e)?e:[]))}catch(e){d(e.message)}finally{o(!1)}},[]);function q(e){m===e?v(e=>"asc"===e?"desc":"asc"):(x(e),v("asc"))}function w(){g(null),b({})}async function S(t){C(!0);try{await (0,c.sg)("/price-update.php",{product_id:t.id||t.product_id,preco:parseFloat(f.preco)||0,preco_promocional:f.preco_promocional?parseFloat(f.preco_promocional):null,estoque:parseInt(f.estoque)||0}),e("Preco atualizado com sucesso!","success"),g(null),k()}catch(t){e(t.message,"error")}finally{C(!1)}}(0,n.useEffect)(()=>{k()},[k]);let A=t.filter(e=>!p||(e.nome||e.name||"").toLowerCase().includes(p.toLowerCase())).sort((e,t)=>{let s,r;if("nome"===m)return s=(e.nome||e.name||"").toLowerCase(),r=(t.nome||t.name||"").toLowerCase(),"asc"===j?s.localeCompare(r):r.localeCompare(s);if("preco"===m)s=parseFloat(e.preco||e.price)||0,r=parseFloat(t.preco||t.price)||0;else if("estoque"===m){var n,l;s=parseInt(null!==(n=e.estoque)&&void 0!==n?n:e.stock)||0,r=parseInt(null!==(l=t.estoque)&&void 0!==l?l:t.stock)||0}else s=0,r=0;return"asc"===j?s-r:r-s});function E(e){let{field:t}=e;return m!==t?null:(0,r.jsx)("span",{style:{marginLeft:4},children:"asc"===j?"↑":"↓"})}return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"page-header",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"page-title",children:"Precos"}),(0,r.jsx)("p",{className:"page-subtitle",children:"Gerencie precos e estoque dos seus produtos"})]})}),(0,r.jsx)("div",{className:"toolbar",children:(0,r.jsx)("div",{className:"toolbar-search",children:(0,r.jsxs)("div",{className:"search-bar",children:[(0,r.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,r.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,r.jsx)("path",{d:"M21 21l-4.35-4.35"})]}),(0,r.jsx)("input",{type:"text",placeholder:"Buscar produto...",onChange:function(e){let t=e.target.value;_.current&&clearTimeout(_.current),_.current=setTimeout(()=>h(t),300)}})]})})}),l?(0,r.jsx)("div",{className:"loading-screen",children:(0,r.jsx)("div",{className:"spinner"})}):u?(0,r.jsxs)("div",{className:"empty-state",children:[(0,r.jsx)("div",{className:"empty-state-title",children:"Erro ao carregar precos"}),(0,r.jsx)("div",{className:"empty-state-text",children:u})]}):0===A.length?(0,r.jsx)("div",{className:"empty-state",children:(0,r.jsx)("div",{className:"empty-state-title",children:"Nenhum produto encontrado"})}):(0,r.jsx)("div",{className:"table-wrapper",children:(0,r.jsxs)("table",{className:"table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsxs)("th",{style:{cursor:"pointer"},onClick:()=>q("nome"),children:["Produto ",(0,r.jsx)(E,{field:"nome"})]}),(0,r.jsxs)("th",{style:{cursor:"pointer",textAlign:"right"},onClick:()=>q("preco"),children:["Preco ",(0,r.jsx)(E,{field:"preco"})]}),(0,r.jsx)("th",{style:{textAlign:"right"},children:"Preco Promo"}),(0,r.jsxs)("th",{style:{cursor:"pointer",textAlign:"right"},onClick:()=>q("estoque"),children:["Estoque ",(0,r.jsx)(E,{field:"estoque"})]}),(0,r.jsx)("th",{style:{textAlign:"right",width:140},children:"Acoes"})]})}),(0,r.jsx)("tbody",{children:A.map(e=>{var t,s;let n=e.id||e.product_id,l=y===n;return(0,r.jsxs)("tr",{children:[(0,r.jsxs)("td",{children:[(0,r.jsx)("div",{style:{fontWeight:500},children:e.nome||e.name}),e.categoria&&(0,r.jsx)("div",{style:{fontSize:12,color:"var(--color-text-muted)"},children:e.categoria})]}),(0,r.jsx)("td",{style:{textAlign:"right"},children:l?(0,r.jsx)("input",{type:"number",step:"0.01",className:"inline-input",value:f.preco,onChange:e=>b({...f,preco:e.target.value})}):i(e.preco||e.price)}),(0,r.jsx)("td",{style:{textAlign:"right"},children:l?(0,r.jsx)("input",{type:"number",step:"0.01",className:"inline-input",value:f.preco_promocional,onChange:e=>b({...f,preco_promocional:e.target.value}),placeholder:"-"}):e.preco_promocional||e.promo_price?(0,r.jsx)("span",{style:{color:"var(--color-success)"},children:i(e.preco_promocional||e.promo_price)}):(0,r.jsx)("span",{style:{color:"var(--color-text-muted)"},children:"-"})}),(0,r.jsx)("td",{style:{textAlign:"right"},children:l?(0,r.jsx)("input",{type:"number",className:"inline-input",value:f.estoque,onChange:e=>b({...f,estoque:e.target.value})}):null!==(s=null!==(t=e.estoque)&&void 0!==t?t:e.stock)&&void 0!==s?s:"-"}),(0,r.jsx)("td",{style:{textAlign:"right"},children:l?(0,r.jsxs)("div",{style:{display:"flex",gap:4,justifyContent:"flex-end"},children:[(0,r.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>S(e),disabled:N,children:N?(0,r.jsx)("span",{className:"spinner-sm"}):"Salvar"}),(0,r.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:w,children:"Cancelar"})]}):(0,r.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:()=>{var t,s;g(e.id||e.product_id),b({preco:e.preco||e.price||"",preco_promocional:e.preco_promocional||e.promo_price||"",estoque:null!==(s=null!==(t=e.estoque)&&void 0!==t?t:e.stock)&&void 0!==s?s:""})},children:"Editar"})})]},n)})})]})})]})}}},function(e){e.O(0,[448,565,205,971,117,744],function(){return e(e.s=5747)}),_N_E=e.O()}]);
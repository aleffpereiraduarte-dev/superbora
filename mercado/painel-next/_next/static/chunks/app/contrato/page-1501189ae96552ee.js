(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2183],{7974:function(e,t,n){Promise.resolve().then(n.bind(n,5347))},6428:function(e,t,n){"use strict";n.d(t,{Fw:function(){return p},LP:function(){return i},SC:function(){return c},apiDelete:function(){return h},jn:function(){return g},o4:function(){return s},pE:function(){return f},sg:function(){return u},w9:function(){return m},zi:function(){return d}});let a="/api/mercado/partner",o="/api/mercado/parceiro",r="painel_partner_token";function i(){try{return localStorage.getItem(r)}catch(e){return null}}function s(e){try{e?localStorage.setItem(r,e):localStorage.removeItem(r)}catch(e){}}function l(){let e=i();return e?{Authorization:"Bearer ".concat(e)}:{}}async function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="".concat(a).concat(e),o=Object.entries(t).filter(e=>{let[,t]=e;return null!=t&&""!==t}).map(e=>{let[t,n]=e;return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(n))}).join("&");o&&(n+="?".concat(o));let r=await fetch(n,{credentials:"include",headers:l()});if(!r.ok){let e=await r.json().catch(()=>null);throw Error((null==e?void 0:e.message)||"API error: ".concat(r.status," ").concat(r.statusText))}let i=await r.json();if(!i.success)throw Error(i.message||"Erro desconhecido na API");return i.data}async function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=await fetch("".concat(a).concat(e),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...l()},body:JSON.stringify(t)}),o=await n.json().catch(()=>null);if(!n.ok||!(null==o?void 0:o.success))throw Error((null==o?void 0:o.message)||"API error: ".concat(n.status));return o.data}async function d(e,t){let n=await fetch("".concat(a).concat(e),{method:"POST",credentials:"include",headers:l(),body:t}),o=await n.json().catch(()=>null);if(!n.ok||!(null==o?void 0:o.success))throw Error((null==o?void 0:o.message)||"API error: ".concat(n.status));return o.data}async function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=await fetch("".concat(a).concat(e),{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",...l()},body:JSON.stringify(t)}),o=await n.json().catch(()=>null);if(!n.ok||!(null==o?void 0:o.success))throw Error((null==o?void 0:o.message)||"API error: ".concat(n.status));return o.data}async function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="".concat(a).concat(e),o=Object.entries(t).filter(e=>{let[,t]=e;return null!=t&&""!==t}).map(e=>{let[t,n]=e;return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(n))}).join("&");o&&(n+="?".concat(o));let r=await fetch(n,{method:"DELETE",credentials:"include",headers:l()}),i=await r.json().catch(()=>null);if(!r.ok||!(null==i?void 0:i.success))throw Error((null==i?void 0:i.message)||"API error: ".concat(r.status));return i.data}async function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=await fetch("".concat(o).concat(e),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...l()},body:JSON.stringify(t)}),a=await n.json().catch(()=>null);if(!n.ok||!(null==a?void 0:a.success))throw Error((null==a?void 0:a.message)||"API error: ".concat(n.status));return a.data}async function g(e,t){let n=await fetch("".concat(o).concat(e),{method:"POST",credentials:"include",headers:l(),body:t}),a=await n.json().catch(()=>null);if(!n.ok||!(null==a?void 0:a.success))throw Error((null==a?void 0:a.message)||"API error: ".concat(n.status));return a.data}async function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u(e,t)}},7128:function(e,t,n){"use strict";n.d(t,{H:function(){return s},a:function(){return l}});var a=n(7437),o=n(2265),r=n(6428);let i=(0,o.createContext)(null);function s(e){let{children:t}=e,[n,s]=(0,o.useState)(null),[l,c]=(0,o.useState)(!0),[u,d]=(0,o.useState)(null),f=(0,o.useCallback)(async()=>{if(!(0,r.LP)()){s(null),c(!1);return}try{let e=await (0,r.SC)("/auth/session.php");e.authenticated&&e.partner?s(e.partner):((0,r.o4)(null),s(null))}catch(e){console.warn("Session check failed (network error), keeping session:",e)}finally{c(!1)}},[]);(0,o.useEffect)(()=>{f()},[f]);let h=(0,o.useCallback)(async(e,t)=>{let n=await (0,r.sg)("/auth/login.php",{email:e,senha:t});if(n.requires_2fa)return d({partner_id:n.partner_id,nome:n.nome,temp_token:n.temp_token}),{requires_2fa:!0};(0,r.o4)(n.token);let a=n.partner||{id:n.partner_id,nome:n.nome,email:n.email,cnpj:n.cnpj,logo:n.logo,categoria:n.categoria,status:n.status};return s(a),d(null),a},[]),p=(0,o.useCallback)(async e=>{if(!u)throw Error("Nenhuma verificacao 2FA pendente");let t=await (0,r.sg)("/auth/totp-verify.php",{temp_token:u.temp_token,code:e});(0,r.o4)(t.token);let n=t.partner||{id:t.partner_id,nome:t.nome,email:t.email,cnpj:t.cnpj,logo:t.logo,categoria:t.categoria,status:t.status};return s(n),d(null),n},[u]),g=(0,o.useCallback)(()=>{d(null)},[]),m=(0,o.useCallback)(e=>{s(t=>t?{...t,...e}:t)},[]),x=(0,o.useCallback)(()=>{(0,r.o4)(null),s(null),d(null)},[]);return(0,a.jsx)(i.Provider,{value:{partner:n,loading:l,isAuthenticated:!!n,twoFactorPending:u,login:h,verifyTotp:p,cancelTotp:g,logout:x,updatePartner:m,refreshSession:f},children:t})}function l(){let e=(0,o.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},5347:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var a=n(7437),o=n(2265),r=n(9376),i=n(7128),s=n(6428);function l(){let{partner:e,isAuthenticated:t,loading:n,refreshSession:l}=(0,i.a)(),d=(0,r.useRouter)(),[f,h]=(0,o.useState)(null),[p,g]=(0,o.useState)(!0),[m,x]=(0,o.useState)(!1),[y,j]=(0,o.useState)(!1),[b,v]=(0,o.useState)(""),[w,k]=(0,o.useState)(!1);async function S(){try{let e=await (0,s.SC)("/contract.php");h(e),e.signed&&k(!0)}catch(e){v(e.message)}finally{g(!1)}}async function C(){v(""),j(!0);try{await (0,s.sg)("/contract.php",{accepted:!0}),k(!0),await l(),setTimeout(()=>d.push("/setup"),1500)}catch(e){v(e.message||"Erro ao assinar contrato")}finally{j(!1)}}if((0,o.useEffect)(()=>{if(!n&&!t){d.push("/login");return}t&&S()},[n,t]),n||p)return(0,a.jsx)("div",{className:"loading-screen",children:(0,a.jsx)("div",{className:"spinner"})});if(w)return(0,a.jsx)("div",{style:u.page,children:(0,a.jsx)("div",{style:u.container,children:(0,a.jsx)("div",{style:u.card,children:(0,a.jsxs)("div",{style:{textAlign:"center",padding:"40px 0"},children:[(0,a.jsxs)("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#16a34a",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),(0,a.jsx)("polyline",{points:"22 4 12 14.01 9 11.01"})]}),(0,a.jsx)("h2",{style:{marginTop:16,color:"#16a34a",fontSize:22},children:"Contrato Assinado!"}),(0,a.jsx)("p",{style:{color:"#64748b",marginTop:8},children:"Redirecionando para a configuracao inicial..."})]})})})});let P=(null==f?void 0:f.terms)||{},A=(null==f?void 0:f.partner)||{};return(0,a.jsx)("div",{style:u.page,children:(0,a.jsx)("div",{style:u.container,children:(0,a.jsxs)("div",{style:u.card,children:[(0,a.jsxs)("div",{style:{textAlign:"center",marginBottom:24},children:[(0,a.jsx)("h1",{style:{fontSize:28,fontWeight:700,color:"#2563eb"},children:"SuperBora"}),(0,a.jsx)("p",{style:{fontSize:13,color:"#64748b",marginTop:4},children:"Plataforma de Delivery"})]}),(0,a.jsx)("h2",{style:{textAlign:"center",fontSize:22,fontWeight:700,marginBottom:4},children:"Contrato de Adesao"}),(0,a.jsx)("p",{style:{textAlign:"center",fontSize:14,color:"#64748b",marginBottom:24},children:"Leia atentamente os termos abaixo antes de assinar"}),(0,a.jsxs)("div",{style:u.infoGrid,children:[(0,a.jsx)(c,{label:"Estabelecimento",value:A.name}),(0,a.jsx)(c,{label:"Responsavel",value:A.owner_name}),(0,a.jsx)(c,{label:"Documento",value:A.cnpj||A.cpf||"-"}),(0,a.jsx)(c,{label:"Email",value:A.email}),(0,a.jsx)(c,{label:"Categoria",value:A.categoria}),(0,a.jsx)(c,{label:"Plano",value:(A.plano||"basico").charAt(0).toUpperCase()+(A.plano||"basico").slice(1)})]}),(0,a.jsx)("div",{style:u.commissionBox,children:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,a.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#2563eb",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),(0,a.jsx)("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontWeight:600,fontSize:16},children:"Comissao da Plataforma"}),(0,a.jsxs)("div",{style:{color:"#64748b",fontSize:14},children:[P.commission_label||"15%"," por venda realizada"]})]})]})}),(0,a.jsxs)("div",{style:u.clausesBox,children:[(0,a.jsx)("h3",{style:{fontSize:16,fontWeight:600,marginBottom:16},children:"Termos e Condicoes"}),(0,a.jsx)("ol",{style:{paddingLeft:20,lineHeight:1.8,fontSize:14,color:"#374151"},children:(P.clauses||[]).map((e,t)=>(0,a.jsx)("li",{style:{marginBottom:12},children:e},t))})]}),b&&(0,a.jsx)("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",borderRadius:8,padding:"12px 16px",color:"#dc2626",fontSize:14,marginBottom:16},children:b}),(0,a.jsxs)("div",{style:{marginTop:24},children:[(0,a.jsxs)("label",{style:{display:"flex",alignItems:"flex-start",gap:12,cursor:"pointer",fontSize:14,lineHeight:1.5},children:[(0,a.jsx)("input",{type:"checkbox",checked:m,onChange:e=>x(e.target.checked),style:{marginTop:3,width:18,height:18,accentColor:"#2563eb"}}),(0,a.jsx)("span",{children:"Li e aceito integralmente os termos e condicoes do presente contrato de adesao a plataforma SuperBora."})]}),(0,a.jsx)("button",{onClick:C,disabled:!m||y,className:"btn btn-primary btn-block btn-lg",style:{marginTop:20,opacity:!m||y?.5:1},children:y?"Assinando...":"Assinar Contrato"})]}),(0,a.jsxs)("p",{style:{textAlign:"center",fontSize:12,color:"#94a3b8",marginTop:16},children:["Data: ",new Date().toLocaleDateString("pt-BR")]})]})})})}function c(e){let{label:t,value:n}=e;return(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[(0,a.jsx)("span",{style:{fontSize:12,color:"#94a3b8",fontWeight:500,textTransform:"uppercase",letterSpacing:.5},children:t}),(0,a.jsx)("span",{style:{fontSize:14,color:"#1e293b",fontWeight:500},children:n||"-"})]})}let u={page:{minHeight:"100vh",display:"flex",alignItems:"flex-start",justifyContent:"center",background:"linear-gradient(135deg, #eff6ff 0%, #f1f5f9 100%)",padding:"32px 16px"},container:{width:"100%",maxWidth:800},card:{background:"#fff",borderRadius:16,boxShadow:"0 10px 25px -5px rgba(0,0,0,0.1), 0 4px 10px -5px rgba(0,0,0,0.04)",padding:32},infoGrid:{background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:12,padding:16,marginBottom:24,display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},commissionBox:{background:"#eff6ff",border:"1px solid #bfdbfe",borderRadius:12,padding:16,marginBottom:24},clausesBox:{background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:12,padding:24,maxHeight:400,overflowY:"auto"}}},9376:function(e,t,n){"use strict";var a=n(5475);n.o(a,"usePathname")&&n.d(t,{usePathname:function(){return a.usePathname}}),n.o(a,"useRouter")&&n.d(t,{useRouter:function(){return a.useRouter}}),n.o(a,"useSearchParams")&&n.d(t,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[2971,2117,1744],function(){return e(e.s=7974)}),_N_E=e.O()}]);
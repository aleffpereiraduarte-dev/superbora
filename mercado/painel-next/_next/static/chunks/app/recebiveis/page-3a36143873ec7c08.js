(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[357],{8811:function(e,t,s){Promise.resolve().then(s.bind(s,5632))},5632:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var a=s(7437),i=s(2265),l=s(4565),n=s(4477),r=s(6428),d=s(6971);function o(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e||0)}function c(e){return e?new Date(e).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}):""}function h(){return(0,a.jsx)(l.Z,{children:(0,a.jsx)(n.Z,{children:(0,a.jsx)(x,{})})})}function x(){var e,t,s,l,n,h,x,u,p,v,j,g,y,f;let{addNotification:b}=(0,d.l)(),[_,N]=(0,i.useState)("receivables"),[S,w]=(0,i.useState)(!0),[C,k]=(0,i.useState)(""),[A,z]=(0,i.useState)(null),[W,B]=(0,i.useState)([]),[T,R]=(0,i.useState)({}),[D,P]=(0,i.useState)(!1),[E,q]=(0,i.useState)(null),[V,I]=(0,i.useState)(!1),[L,F]=(0,i.useState)(!1),[M,H]=(0,i.useState)({banco:"",agencia:"",conta:"",tipo_conta:"corrente",titular:"",cpf_cnpj:""}),[O,Z]=(0,i.useState)(null),[G,J]=(0,i.useState)("week"),[U,K]=(0,i.useState)(""),[Q,X]=(0,i.useState)(""),[Y,$]=(0,i.useState)(!1),ee=(0,i.useCallback)(async()=>{w(!0),k("");try{let e=await (0,r.SC)("/receivables.php");z(e)}catch(e){k(e.message)}finally{w(!1)}},[]),et=(0,i.useCallback)(async()=>{$(!0);try{let e="/reconciliation.php?period=".concat(G);"custom"===G&&U&&Q&&(e+="&from=".concat(U,"&to=").concat(Q));let t=await (0,r.SC)(e);Z(t)}catch(e){console.error("Erro ao carregar reconciliacao:",e)}finally{$(!1)}},[G,U,Q]);async function es(){if(0===W.length){b("Selecione ao menos um recebivel","error");return}I(!0);try{let e=await (0,r.sg)("/receivables.php",{action:"simulate",receivable_ids:W});q(e.simulation),P(!0)}catch(e){b(e.message,"error")}finally{I(!1)}}async function ea(){if(E){if(!M.banco||!M.agencia||!M.conta){b("Preencha os dados bancarios","error");return}F(!0);try{let e=await (0,r.sg)("/receivables.php",{action:"request",receivable_ids:W,bank_account:M});b(e.message||"Antecipacao solicitada com sucesso!","success"),P(!1),q(null),B([]),H({banco:"",agencia:"",conta:"",tipo_conta:"corrente",titular:"",cpf_cnpj:""}),ee()}catch(e){b(e.message,"error")}finally{F(!1)}}}(0,i.useEffect)(()=>{ee()},[ee]),(0,i.useEffect)(()=>{"reconciliation"===_&&et()},[_,et]);let ei=(()=>{if(!(null==A?void 0:A.receivables_by_date)||0===W.length)return{net:0,fee:0,afterFee:0};let e=0,t=0,s=0;return A.receivables_by_date.forEach(a=>{a.orders.forEach(a=>{W.includes(a.id)&&(e+=a.net_amount,t+=a.anticipation_fee,s+=a.net_after_anticipation)})}),{net:e,fee:t,afterFee:s}})();return S?(0,a.jsx)("div",{className:"loading-screen",children:(0,a.jsx)("div",{className:"spinner"})}):C?(0,a.jsxs)("div",{className:"empty-state",children:[(0,a.jsx)("div",{className:"empty-state-title",children:"Erro ao carregar recebiveis"}),(0,a.jsx)("div",{className:"empty-state-text",children:C})]}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"page-header",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"page-title",children:"Recebiveis"}),(0,a.jsx)("p",{className:"page-subtitle",children:"Gerencie seus recebiveis e solicite antecipacao"})]}),(0,a.jsx)("button",{className:"btn btn-primary",onClick:es,disabled:0===W.length||V||(null==A?void 0:A.has_pending_anticipation),children:V?(0,a.jsx)("span",{className:"spinner-sm"}):"Antecipar Selecionados"})]}),(0,a.jsxs)("div",{className:"wallet-grid",children:[(0,a.jsxs)("div",{className:"wallet-card",children:[(0,a.jsx)("div",{className:"wallet-label",children:"Saldo a Receber"}),(0,a.jsx)("div",{className:"wallet-value wallet-value-success",children:o(null==A?void 0:null===(e=A.summary)||void 0===e?void 0:e.total_net_amount)}),(0,a.jsxs)("div",{style:{fontSize:12,color:"var(--color-text-secondary)",marginTop:4},children:[(null==A?void 0:null===(t=A.summary)||void 0===t?void 0:t.total_pending_orders)||0," pedidos pendentes"]})]}),(0,a.jsxs)("div",{className:"wallet-card",children:[(0,a.jsx)("div",{className:"wallet-label",children:"Comissao Total"}),(0,a.jsx)("div",{className:"wallet-value wallet-value-warning",children:o(null==A?void 0:null===(s=A.summary)||void 0===s?void 0:s.total_commission)}),(0,a.jsxs)("div",{style:{fontSize:12,color:"var(--color-text-secondary)",marginTop:4},children:["Taxa: ",null==A?void 0:null===(l=A.summary)||void 0===l?void 0:l.commission_rate,"%"]})]}),(0,a.jsxs)("div",{className:"wallet-card",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"#fff"},children:[(0,a.jsx)("div",{className:"wallet-label",style:{color:"rgba(255,255,255,0.8)"},children:"Se Antecipar Tudo"}),(0,a.jsx)("div",{className:"wallet-value",style:{color:"#fff"},children:o(null==A?void 0:null===(n=A.summary)||void 0===n?void 0:n.total_after_anticipation)}),(0,a.jsxs)("div",{style:{fontSize:12,color:"rgba(255,255,255,0.7)",marginTop:4},children:["Taxa: ",null==A?void 0:null===(h=A.summary)||void 0===h?void 0:h.anticipation_fee_percent,"% (-",o(null==A?void 0:null===(x=A.summary)||void 0===x?void 0:x.total_anticipation_fee),")"]})]})]}),W.length>0&&(0,a.jsx)("div",{className:"card",style:{marginBottom:24,background:"#f0f9ff",borderColor:"var(--color-primary)"},children:(0,a.jsxs)("div",{style:{padding:16,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:12},children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{fontSize:14,color:"var(--color-text-secondary)"},children:[(0,a.jsx)("strong",{children:W.length})," recebiveis selecionados"]}),(0,a.jsxs)("div",{style:{fontSize:18,fontWeight:700,color:"var(--color-primary)"},children:["Voce recebera: ",o(ei.afterFee)]}),(0,a.jsxs)("div",{style:{fontSize:12,color:"var(--color-text-secondary)"},children:["Taxa de antecipacao: ",o(ei.fee)," (",null==A?void 0:null===(u=A.summary)||void 0===u?void 0:u.anticipation_fee_percent,"%)"]})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,a.jsx)("button",{className:"btn btn-secondary",onClick:()=>B([]),children:"Limpar Selecao"}),(0,a.jsx)("button",{className:"btn btn-primary",onClick:es,disabled:V||(null==A?void 0:A.has_pending_anticipation),children:V?(0,a.jsx)("span",{className:"spinner-sm"}):"Antecipar"})]})]})}),(null==A?void 0:A.has_pending_anticipation)&&(0,a.jsxs)("div",{style:{marginBottom:24,padding:16,background:"#fef3c7",border:"1px solid #fcd34d",borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",gap:12},children:[(0,a.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#d97706",strokeWidth:"2",children:(0,a.jsx)("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontWeight:600,color:"#92400e"},children:"Antecipacao em Andamento"}),(0,a.jsx)("div",{style:{fontSize:13,color:"#a16207"},children:"Voce ja possui uma solicitacao de antecipacao pendente. Aguarde a conclusao para solicitar uma nova."})]})]}),(0,a.jsx)("div",{className:"tabs",style:{marginBottom:24},children:[{key:"receivables",label:"Recebiveis"},{key:"history",label:"Historico"},{key:"reconciliation",label:"Reconciliacao"}].map(e=>(0,a.jsx)("button",{className:"tab ".concat(_===e.key?"tab-active":""),onClick:()=>N(e.key),children:e.label},e.key))}),"receivables"===_&&(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"card-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsx)("h2",{className:"card-title",children:"Recebiveis Pendentes"}),(0,a.jsx)("button",{className:"btn btn-sm btn-secondary",onClick:function(){if(!(null==A?void 0:A.receivables_by_date))return;let e=A.receivables_by_date.flatMap(e=>e.orders.map(e=>e.id));W.length===e.length?B([]):B(e),q(null)},children:W.length===((null==A?void 0:null===(p=A.receivables_by_date)||void 0===p?void 0:p.flatMap(e=>e.orders).length)||0)?"Desmarcar Todos":"Selecionar Todos"})]}),(null==A?void 0:null===(v=A.receivables_by_date)||void 0===v?void 0:v.length)?(0,a.jsx)("div",{style:{padding:16},children:A.receivables_by_date.map(e=>{let t=!1!==T[e.date],s=e.orders.map(e=>e.id),i=s.every(e=>W.includes(e)),l=s.some(e=>W.includes(e));return(0,a.jsxs)("div",{style:{marginBottom:16,border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",overflow:"hidden"},children:[(0,a.jsxs)("div",{style:{padding:"12px 16px",background:e.days_until<=0?"#fef2f2":e.days_until<=7?"#fffbeb":"#f8fafc",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},onClick:()=>{var t;return t=e.date,void R(e=>({...e,[t]:!e[t]}))},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,a.jsx)("input",{type:"checkbox",checked:i,ref:e=>{e&&(e.indeterminate=l&&!i)},onChange:t=>{t.stopPropagation(),e.date,s.every(e=>W.includes(e))?B(e=>e.filter(e=>!s.includes(e))):B(e=>[...new Set([...e,...s])]),q(null)},onClick:e=>e.stopPropagation(),style:{width:18,height:18}}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{fontWeight:600,fontSize:14},children:["Pagamento em ",c(e.date)]}),(0,a.jsxs)("div",{style:{fontSize:12,color:"var(--color-text-secondary)"},children:[e.order_count," pedido",e.order_count>1?"s":""," |",e.days_until<=0?(0,a.jsx)("span",{style:{color:"#dc2626"},children:" Vencido"}):(0,a.jsxs)("span",{children:[" em ",e.days_until," dia",e.days_until>1?"s":""]})]})]})]}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,a.jsxs)("div",{style:{textAlign:"right"},children:[(0,a.jsx)("div",{style:{fontWeight:700,fontSize:16},children:o(e.total_net)}),(0,a.jsxs)("div",{style:{fontSize:11,color:"var(--color-success)"},children:["Antecipado: ",o(e.total_net_after_anticipation)]})]}),(0,a.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:(0,a.jsx)("polyline",{points:"6 9 12 15 18 9"})})]})]}),t&&(0,a.jsx)("div",{style:{borderTop:"1px solid var(--color-border)"},children:(0,a.jsxs)("table",{className:"table",style:{margin:0},children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{style:{width:40}}),(0,a.jsx)("th",{children:"Pedido"}),(0,a.jsx)("th",{children:"Data"}),(0,a.jsx)("th",{style:{textAlign:"right"},children:"Bruto"}),(0,a.jsx)("th",{style:{textAlign:"right"},children:"Comissao"}),(0,a.jsx)("th",{style:{textAlign:"right"},children:"Liquido"}),(0,a.jsx)("th",{style:{textAlign:"right"},children:"Taxa Antec."}),(0,a.jsx)("th",{style:{textAlign:"right"},children:"Recebe"})]})}),(0,a.jsx)("tbody",{children:e.orders.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsx)("input",{type:"checkbox",checked:W.includes(e.id),onChange:()=>{var t;return t=e.id,void(B(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]),q(null))},style:{width:16,height:16}})}),(0,a.jsxs)("td",{style:{fontWeight:500},children:["#",e.order_number]}),(0,a.jsx)("td",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:c(e.delivered_date||e.order_date)}),(0,a.jsx)("td",{style:{textAlign:"right"},children:o(e.gross_amount)}),(0,a.jsxs)("td",{style:{textAlign:"right",color:"var(--color-danger)"},children:["-",o(e.commission)]}),(0,a.jsx)("td",{style:{textAlign:"right",fontWeight:600},children:o(e.net_amount)}),(0,a.jsxs)("td",{style:{textAlign:"right",color:"#7c3aed",fontSize:13},children:["-",o(e.anticipation_fee)]}),(0,a.jsx)("td",{style:{textAlign:"right",fontWeight:700,color:"var(--color-success)"},children:o(e.net_after_anticipation)})]},e.id))})]})})]},e.date)})}):(0,a.jsxs)("div",{className:"empty-state",children:[(0,a.jsx)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:(0,a.jsx)("path",{d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsx)("div",{className:"empty-state-title",children:"Nenhum recebivel pendente"}),(0,a.jsx)("div",{className:"empty-state-text",children:"Seus pedidos entregues aparecerao aqui para antecipacao"})]})]}),"history"===_&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:16,marginBottom:24},children:[(0,a.jsxs)("div",{className:"card",style:{padding:16},children:[(0,a.jsx)("div",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:"Total Antecipado"}),(0,a.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"var(--color-primary)"},children:o(null==A?void 0:null===(j=A.stats)||void 0===j?void 0:j.total_anticipated)})]}),(0,a.jsxs)("div",{className:"card",style:{padding:16},children:[(0,a.jsx)("div",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:"Antecipacoes Pagas"}),(0,a.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"var(--color-success)"},children:(null==A?void 0:null===(g=A.stats)||void 0===g?void 0:g.paid_count)||0})]}),(0,a.jsxs)("div",{className:"card",style:{padding:16},children:[(0,a.jsx)("div",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:"Total em Taxas"}),(0,a.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"var(--color-danger)"},children:o(null==A?void 0:null===(y=A.stats)||void 0===y?void 0:y.total_fees_paid)})]})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("div",{className:"card-header",children:(0,a.jsx)("h2",{className:"card-title",children:"Historico de Antecipacoes"})}),(null==A?void 0:null===(f=A.anticipation_history)||void 0===f?void 0:f.length)?(0,a.jsx)("div",{className:"table-wrapper",style:{boxShadow:"none"},children:(0,a.jsxs)("table",{className:"table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Data"}),(0,a.jsx)("th",{style:{textAlign:"right"},children:"Valor"}),(0,a.jsx)("th",{style:{textAlign:"right"},children:"Taxa"}),(0,a.jsx)("th",{style:{textAlign:"right"},children:"Liquido"}),(0,a.jsx)("th",{children:"Status"})]})}),(0,a.jsx)("tbody",{children:A.anticipation_history.map(e=>{var t;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(t=e.requested_at)?new Date(t).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):""}),(0,a.jsx)("td",{style:{textAlign:"right"},children:o(e.total_amount)}),(0,a.jsxs)("td",{style:{textAlign:"right",color:"var(--color-danger)"},children:["-",o(e.fee_amount)]}),(0,a.jsx)("td",{style:{textAlign:"right",fontWeight:600},children:o(e.net_amount)}),(0,a.jsx)("td",{children:(0,a.jsx)("span",{className:"badge ".concat("paid"===e.status?"badge-success":"rejected"===e.status?"badge-danger":"approved"===e.status?"badge-info":"badge-warning"),children:e.status_label})})]},e.id)})})]})}):(0,a.jsx)("div",{className:"empty-state",children:(0,a.jsx)("div",{className:"empty-state-text",children:"Nenhuma antecipacao realizada"})})]})]}),"reconciliation"===_&&(0,a.jsx)(m,{reconciliation:O,loading:Y,period:G,setPeriod:J,from:U,setFrom:K,to:Q,setTo:X,onRefresh:et}),D&&E&&(0,a.jsx)("div",{className:"modal-overlay",onClick:e=>e.target===e.currentTarget&&P(!1),children:(0,a.jsxs)("div",{className:"modal",style:{maxWidth:500},children:[(0,a.jsxs)("div",{className:"modal-header",children:[(0,a.jsx)("h3",{className:"modal-title",children:"Confirmar Antecipacao"}),(0,a.jsx)("button",{className:"modal-close",onClick:()=>P(!1),children:"\xd7"})]}),(0,a.jsxs)("div",{className:"modal-body",children:[(0,a.jsxs)("div",{style:{padding:16,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"var(--radius-md)",color:"#fff",marginBottom:20},children:[(0,a.jsx)("div",{style:{fontSize:13,opacity:.9},children:"Voce recebera"}),(0,a.jsx)("div",{style:{fontSize:28,fontWeight:700},children:o(E.net_amount)}),(0,a.jsxs)("div",{style:{fontSize:12,opacity:.8,marginTop:4},children:[E.order_count," pedido",E.order_count>1?"s":""," selecionado",E.order_count>1?"s":""]})]}),(0,a.jsxs)("div",{style:{marginBottom:20,padding:16,background:"#f8fafc",borderRadius:"var(--radius-md)"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[(0,a.jsx)("span",{style:{color:"var(--color-text-secondary)"},children:"Valor bruto:"}),(0,a.jsx)("span",{style:{fontWeight:600},children:o(E.total_gross)})]}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[(0,a.jsx)("span",{style:{color:"var(--color-text-secondary)"},children:"Comissao:"}),(0,a.jsxs)("span",{style:{fontWeight:600,color:"var(--color-danger)"},children:["-",o(E.total_commission)]})]}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[(0,a.jsx)("span",{style:{color:"var(--color-text-secondary)"},children:"Valor liquido:"}),(0,a.jsx)("span",{style:{fontWeight:600},children:o(E.total_net)})]}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:8,borderTop:"1px solid var(--color-border)"},children:[(0,a.jsxs)("span",{style:{color:"#7c3aed"},children:["Taxa de antecipacao (",E.fee_percent,"%):"]}),(0,a.jsxs)("span",{style:{fontWeight:600,color:"#7c3aed"},children:["-",o(E.fee_amount)]})]})]}),(0,a.jsxs)("div",{style:{marginBottom:8},children:[(0,a.jsx)("div",{style:{fontSize:14,fontWeight:600,marginBottom:12},children:"Dados Bancarios"}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{className:"form-label",children:"Titular da Conta"}),(0,a.jsx)("input",{type:"text",className:"form-input",value:M.titular,onChange:e=>H({...M,titular:e.target.value}),placeholder:"Nome completo"})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{className:"form-label",children:"CPF/CNPJ"}),(0,a.jsx)("input",{type:"text",className:"form-input",value:M.cpf_cnpj,onChange:e=>H({...M,cpf_cnpj:e.target.value}),placeholder:"000.000.000-00"})]}),(0,a.jsxs)("div",{className:"form-row",children:[(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{className:"form-label",children:"Banco"}),(0,a.jsx)("input",{type:"text",className:"form-input",value:M.banco,onChange:e=>H({...M,banco:e.target.value}),placeholder:"Ex: 001 - BB",required:!0})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{className:"form-label",children:"Tipo"}),(0,a.jsxs)("select",{className:"form-select",value:M.tipo_conta,onChange:e=>H({...M,tipo_conta:e.target.value}),children:[(0,a.jsx)("option",{value:"corrente",children:"Corrente"}),(0,a.jsx)("option",{value:"poupanca",children:"Poupanca"})]})]})]}),(0,a.jsxs)("div",{className:"form-row",children:[(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{className:"form-label",children:"Agencia"}),(0,a.jsx)("input",{type:"text",className:"form-input",value:M.agencia,onChange:e=>H({...M,agencia:e.target.value}),placeholder:"0000",required:!0})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{className:"form-label",children:"Conta"}),(0,a.jsx)("input",{type:"text",className:"form-input",value:M.conta,onChange:e=>H({...M,conta:e.target.value}),placeholder:"00000-0",required:!0})]})]})]})]}),(0,a.jsxs)("div",{className:"modal-footer",children:[(0,a.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>P(!1),children:"Cancelar"}),(0,a.jsx)("button",{className:"btn btn-primary",onClick:ea,disabled:L,children:L?(0,a.jsx)("span",{className:"spinner-sm"}):"Confirmar Antecipacao"})]})]})})]})}function m(e){var t,s,i;let{reconciliation:l,loading:n,period:r,setPeriod:d,from:h,setFrom:x,to:m,setTo:u,onRefresh:p}=e;return n?(0,a.jsx)("div",{className:"loading-screen",children:(0,a.jsx)("div",{className:"spinner"})}):(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"card",style:{marginBottom:24},children:(0,a.jsxs)("div",{style:{padding:16,display:"flex",gap:12,alignItems:"flex-end",flexWrap:"wrap"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",style:{marginBottom:4},children:"Periodo"}),(0,a.jsxs)("select",{className:"form-select",value:r,onChange:e=>d(e.target.value),style:{minWidth:140},children:[(0,a.jsx)("option",{value:"today",children:"Hoje"}),(0,a.jsx)("option",{value:"week",children:"Ultimos 7 dias"}),(0,a.jsx)("option",{value:"month",children:"Este mes"}),(0,a.jsx)("option",{value:"last_month",children:"Mes passado"}),(0,a.jsx)("option",{value:"custom",children:"Personalizado"})]})]}),"custom"===r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",style:{marginBottom:4},children:"De"}),(0,a.jsx)("input",{type:"date",className:"form-input",value:h,onChange:e=>x(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",style:{marginBottom:4},children:"Ate"}),(0,a.jsx)("input",{type:"date",className:"form-input",value:m,onChange:e=>u(e.target.value)})]})]}),(0,a.jsx)("button",{className:"btn btn-primary",onClick:p,children:"Filtrar"})]})}),(null==l?void 0:l.payouts_comparison)&&(0,a.jsxs)("div",{className:"card",style:{marginBottom:24},children:[(0,a.jsx)("div",{className:"card-header",children:(0,a.jsx)("h2",{className:"card-title",children:"Comparacao: Pedidos x Depositos"})}),(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:16,padding:16},children:[(0,a.jsxs)("div",{style:{textAlign:"center",padding:16,background:"#f0fdf4",borderRadius:"var(--radius-md)"},children:[(0,a.jsx)("div",{style:{fontSize:12,color:"#16a34a"},children:"Valor Esperado"}),(0,a.jsx)("div",{style:{fontSize:22,fontWeight:700,color:"#16a34a"},children:o(null===(t=l.totals)||void 0===t?void 0:t.net_amount)})]}),(0,a.jsxs)("div",{style:{textAlign:"center",padding:16,background:"#eff6ff",borderRadius:"var(--radius-md)"},children:[(0,a.jsx)("div",{style:{fontSize:12,color:"#2563eb"},children:"Recebido"}),(0,a.jsx)("div",{style:{fontSize:22,fontWeight:700,color:"#2563eb"},children:o(l.payouts_comparison.paid)})]}),(0,a.jsxs)("div",{style:{textAlign:"center",padding:16,background:"#fefce8",borderRadius:"var(--radius-md)"},children:[(0,a.jsx)("div",{style:{fontSize:12,color:"#ca8a04"},children:"Pendente"}),(0,a.jsx)("div",{style:{fontSize:22,fontWeight:700,color:"#ca8a04"},children:o(l.payouts_comparison.pending)})]}),(0,a.jsxs)("div",{style:{textAlign:"center",padding:16,background:l.payouts_comparison.difference>0?"#fef2f2":"#f8fafc",borderRadius:"var(--radius-md)",border:l.payouts_comparison.difference>.01?"2px solid #dc2626":"1px solid var(--color-border)"},children:[(0,a.jsxs)("div",{style:{fontSize:12,color:l.payouts_comparison.difference>.01?"#dc2626":"#64748b"},children:["Diferenca ",l.payouts_comparison.difference>.01&&"(!)"]}),(0,a.jsx)("div",{style:{fontSize:22,fontWeight:700,color:l.payouts_comparison.difference>.01?"#dc2626":"#64748b"},children:o(l.payouts_comparison.difference)})]})]})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("div",{className:"card-header",children:(0,a.jsx)("h2",{className:"card-title",children:"Reconciliacao por Dia"})}),(null==l?void 0:null===(s=l.reconciliations)||void 0===s?void 0:s.length)?(0,a.jsx)("div",{className:"table-wrapper",style:{boxShadow:"none"},children:(0,a.jsxs)("table",{className:"table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Data"}),(0,a.jsx)("th",{style:{textAlign:"right"},children:"Pedidos"}),(0,a.jsx)("th",{style:{textAlign:"right"},children:"Esperado"}),(0,a.jsx)("th",{style:{textAlign:"right"},children:"Recebido"}),(0,a.jsx)("th",{style:{textAlign:"right"},children:"Diferenca"}),(0,a.jsx)("th",{children:"Status"})]})}),(0,a.jsx)("tbody",{children:l.reconciliations.map(e=>{let t="disputed"===e.status;return(0,a.jsxs)("tr",{style:{background:t?"#fef2f2":"transparent"},children:[(0,a.jsxs)("td",{children:[(0,a.jsx)("div",{style:{fontWeight:500},children:c(e.date)}),(0,a.jsx)("div",{style:{fontSize:11,color:"var(--color-text-secondary)"},children:e.day_name})]}),(0,a.jsx)("td",{style:{textAlign:"right"},children:e.total_orders}),(0,a.jsx)("td",{style:{textAlign:"right",fontWeight:600},children:o(e.net_amount)}),(0,a.jsx)("td",{style:{textAlign:"right"},children:"verified"===e.status?o(e.net_amount):"-"}),(0,a.jsx)("td",{style:{textAlign:"right",color:t?"#dc2626":"inherit",fontWeight:t?600:400},children:t?o((e.dispute_reason,0)):o(0)}),(0,a.jsxs)("td",{children:[(0,a.jsx)("span",{className:"badge ".concat("verified"===e.status?"badge-success":"disputed"===e.status?"badge-danger":"badge-warning"),children:"verified"===e.status?"Conferido":"disputed"===e.status?"Disputado":"Pendente"}),t&&e.dispute_reason&&(0,a.jsxs)("div",{style:{fontSize:11,color:"#dc2626",marginTop:4,maxWidth:150},children:[e.dispute_reason.substring(0,50),"..."]})]})]},e.id)})})]})}):(0,a.jsx)("div",{className:"empty-state",children:(0,a.jsx)("div",{className:"empty-state-text",children:"Nenhum dado de reconciliacao para o periodo"})})]}),(null==l?void 0:null===(i=l.open_disputes)||void 0===i?void 0:i.length)>0&&(0,a.jsxs)("div",{className:"card",style:{marginTop:24},children:[(0,a.jsx)("div",{className:"card-header",children:(0,a.jsx)("h2",{className:"card-title",style:{color:"#dc2626"},children:"Disputas em Aberto"})}),(0,a.jsx)("div",{className:"table-wrapper",style:{boxShadow:"none"},children:(0,a.jsxs)("table",{className:"table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Data"}),(0,a.jsx)("th",{children:"Tipo"}),(0,a.jsx)("th",{children:"Descricao"}),(0,a.jsx)("th",{children:"Esperado"}),(0,a.jsx)("th",{children:"Registrado"}),(0,a.jsx)("th",{children:"Status"})]})}),(0,a.jsx)("tbody",{children:l.open_disputes.map(e=>(0,a.jsxs)("tr",{style:{background:"#fef2f2"},children:[(0,a.jsx)("td",{children:c(e.date)}),(0,a.jsx)("td",{style:{fontSize:13},children:e.type}),(0,a.jsx)("td",{style:{maxWidth:200,fontSize:13},children:e.description}),(0,a.jsx)("td",{style:{color:"#16a34a"},children:e.expected_amount>0?o(e.expected_amount):"-"}),(0,a.jsx)("td",{style:{color:"#dc2626"},children:e.actual_amount>0?o(e.actual_amount):"-"}),(0,a.jsx)("td",{children:(0,a.jsx)("span",{className:"badge badge-warning",children:"investigating"===e.status?"Em analise":"Aberta"})})]},e.id))})]})})]})]})}}},function(e){e.O(0,[448,565,205,971,117,744],function(){return e(e.s=8811)}),_N_E=e.O()}]);
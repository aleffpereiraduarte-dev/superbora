(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3529],{7837:function(e,a,s){Promise.resolve().then(s.bind(s,8897))},8897:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return x}});var n=s(7437),t=s(2265),l=s(8779),r=s(4477),i=s(4445),c=s(1656),o=s(3197),d=s(6939),u=s(8789),m=s(6971),h=s(6428);function g(){var e,a,s,l;let{collapsed:i}=(0,u.A)(),{success:g,error:x}=(0,m.l)(),[v,p]=(0,t.useState)([]),[j,f]=(0,t.useState)(!0),[b,N]=(0,t.useState)("");(0,t.useEffect)(()=>{y()},[b]);let y=async()=>{f(!0);try{let e=new URLSearchParams;b&&e.set("severity",b);let a=e.toString()?"?".concat(e.toString()):"",s=await (0,h.SC)("/alertas.php".concat(a));p(s.alertas||s.alerts||s.data||[])}catch(e){x("Erro ao carregar alertas")}finally{f(!1)}},w=async e=>{try{await (0,h.sg)("/alertas.php",{alert_id:e.id||e.alert_id,action:"resolve"}),g("Alerta resolvido"),y()}catch(e){x("Erro: "+e.message)}},C=async e=>{try{await (0,h.sg)("/alertas.php",{action:"resolve_all",severity:e}),g("Todos alertas ".concat(e," resolvidos")),y()}catch(e){x("Erro: "+e.message)}},D=v.reduce((e,a)=>{let s=a.severity||a.severidade||"medium";return e[s]||(e[s]=[]),e[s].push(a),e},{}),_={};return v.forEach(e=>{let a=e.type||e.tipo||"geral";_[a]=(_[a]||0)+1}),(0,n.jsxs)("div",{className:"admin-layout",children:[(0,n.jsx)(r.Z,{}),(0,n.jsxs)("main",{className:"admin-main ".concat(i?"main-collapsed":""),children:[(0,n.jsxs)("div",{className:"page-header",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"page-title",children:"Alertas"}),(0,n.jsxs)("p",{className:"page-subtitle",children:["Central de alertas e monitoramento - ",v.length," alertas ativos"]})]}),(0,n.jsx)("div",{className:"page-actions",children:(0,n.jsx)("button",{className:"btn btn-secondary",onClick:y,children:"Atualizar"})})]}),(0,n.jsxs)("div",{className:"stats-grid mb-6",style:{gridTemplateColumns:"repeat(4, 1fr)"},children:[(0,n.jsx)(o.Z,{icon:"⚠",label:"Criticos",value:(null===(e=D.critical)||void 0===e?void 0:e.length)||0,color:"#ef4444"}),(0,n.jsx)(o.Z,{icon:"\uD83D\uDD34",label:"Altos",value:(null===(a=D.high)||void 0===a?void 0:a.length)||0,color:"#f97316"}),(0,n.jsx)(o.Z,{icon:"\uD83D\uDFE0",label:"Medios",value:(null===(s=D.medium)||void 0===s?void 0:s.length)||0,color:"#eab308"}),(0,n.jsx)(o.Z,{icon:"\uD83D\uDD35",label:"Baixos",value:(null===(l=D.low)||void 0===l?void 0:l.length)||0,color:"#3b82f6"})]}),(0,n.jsx)("div",{className:"filters-bar",children:(0,n.jsxs)("select",{className:"form-select",value:b,onChange:e=>N(e.target.value),children:[(0,n.jsx)("option",{value:"",children:"Todas Severidades"}),(0,n.jsx)("option",{value:"critical",children:"Critico"}),(0,n.jsx)("option",{value:"high",children:"Alto"}),(0,n.jsx)("option",{value:"medium",children:"Medio"}),(0,n.jsx)("option",{value:"low",children:"Baixo"})]})}),j?(0,n.jsx)("div",{className:"loading-spinner"}):0===v.length?(0,n.jsxs)("div",{className:"card",style:{textAlign:"center",padding:"3rem"},children:[(0,n.jsx)("p",{style:{fontSize:"2rem",marginBottom:8},children:"✅"}),(0,n.jsx)("p",{className:"text-muted",children:"Nenhum alerta ativo. Tudo funcionando normalmente."})]}):Object.entries({critical:{label:"Critico",color:"#ef4444",variant:"danger",icon:"&#9888;"},high:{label:"Alto",color:"#f97316",variant:"warning",icon:"&#128308;"},medium:{label:"Medio",color:"#eab308",variant:"warning",icon:"&#128992;"},low:{label:"Baixo",color:"#3b82f6",variant:"info",icon:"&#128309;"}}).map(e=>{let[a,s]=e,t=D[a];return t&&0!==t.length?(0,n.jsxs)("div",{className:"card mb-4",children:[(0,n.jsxs)("div",{className:"card-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)("h3",{className:"card-title",children:[(0,n.jsx)("span",{dangerouslySetInnerHTML:{__html:s.icon}})," ",s.label," (",t.length,")"]}),(0,n.jsx)("button",{className:"btn btn-sm btn-secondary",onClick:()=>C(a),children:"Resolver Todos"})]}),(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:t.map((e,a)=>(0,n.jsxs)("div",{style:{padding:"12px 16px",borderRadius:"var(--radius)",border:"1px solid var(--border)",borderLeft:"4px solid ".concat(s.color),background:"var(--bg)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,n.jsx)("strong",{className:"text-sm",children:e.title||e.titulo||"Alerta"}),(0,n.jsx)(c.Z,{label:e.type||e.tipo||"geral",variant:"neutral"})]}),(0,n.jsx)("p",{className:"text-sm text-muted",style:{margin:0},children:e.message||e.mensagem||""}),(0,n.jsx)("span",{className:"text-xs text-muted",children:e.created_at||e.data||""})]}),(0,n.jsx)("button",{className:"btn btn-sm btn-success",onClick:()=>w(e),style:{marginLeft:12},children:"Resolver"})]},e.id||a))})]},a):null})]}),(0,n.jsx)(d.Z,{})]})}function x(){return(0,n.jsx)(l.Z,{children:(0,n.jsx)(i.Z,{section:"alerts",children:(0,n.jsx)(g,{})})})}},4445:function(e,a,s){"use strict";s.d(a,{Z:function(){return l}});var n=s(7437),t=s(8253);function l(e){let{section:a,children:s}=e,{hasPermission:l}=(0,t.q)();return l(a)?(0,n.jsx)(n.Fragment,{children:s}):(0,n.jsxs)("div",{className:"role-denied",children:[(0,n.jsx)("div",{className:"role-denied-icon",children:"\uD83D\uDD12"}),(0,n.jsx)("h2",{children:"Acesso Negado"}),(0,n.jsx)("p",{children:"Voce nao tem permissao para acessar esta secao."}),(0,n.jsx)("p",{className:"role-denied-hint",children:"Contate o administrador para solicitar acesso."})]})}},1656:function(e,a,s){"use strict";s.d(a,{X:function(){return r},Z:function(){return l}});var n=s(7437);let t={success:"badge-success",warning:"badge-warning",danger:"badge-danger",info:"badge-info",neutral:"badge-neutral"};function l(e){let{label:a,variant:s="neutral"}=e;return(0,n.jsx)("span",{className:"badge ".concat(t[s]||t.neutral),children:a})}function r(e){return({pendente:"warning",confirmado:"info",preparando:"info",pronto:"info",coletado:"info",em_entrega:"warning",entregue:"success",cancelado:"danger",recusado:"danger",ativo:"success",inativo:"neutral",bloqueado:"danger",online:"success",offline:"neutral",aprovado:"success",reprovado:"danger",pago:"success",pendente_pagamento:"warning",processando:"info",aberto:"warning",resolvido:"success",fechado:"neutral"})[e]||"neutral"}},3197:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});var n=s(7437);function t(e){let{icon:a,label:s,value:t,change:l,color:r="var(--accent)"}=e,i=l&&parseFloat(l)>=0;return(0,n.jsxs)("div",{className:"stats-card",style:{borderTopColor:r},children:[(0,n.jsxs)("div",{className:"stats-card-header",children:[(0,n.jsx)("span",{className:"stats-card-icon",style:{color:r},dangerouslySetInnerHTML:{__html:a||"&#128202;"}}),(0,n.jsx)("span",{className:"stats-card-label",children:s})]}),(0,n.jsx)("div",{className:"stats-card-value",children:null!=t?t:"-"}),null!=l&&(0,n.jsxs)("div",{className:"stats-card-change ".concat(i?"change-positive":"change-negative"),children:[i?"&#9650;":"&#9660;"," ",l,"%"]})]})}}},function(e){e.O(0,[3448,5783,2971,2117,1744],function(){return e(e.s=7837)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1931],{8230:function(e,a,s){Promise.resolve().then(s.bind(s,434))},4445:function(e,a,s){"use strict";s.d(a,{Z:function(){return l}});var r=s(7437),n=s(8253);function l(e){let{section:a,children:s}=e,{hasPermission:l}=(0,n.q)();return l(a)?(0,r.jsx)(r.Fragment,{children:s}):(0,r.jsxs)("div",{className:"role-denied",children:[(0,r.jsx)("div",{className:"role-denied-icon",children:"\uD83D\uDD12"}),(0,r.jsx)("h2",{children:"Acesso Negado"}),(0,r.jsx)("p",{children:"Voce nao tem permissao para acessar esta secao."}),(0,r.jsx)("p",{className:"role-denied-hint",children:"Contate o administrador para solicitar acesso."})]})}},1656:function(e,a,s){"use strict";s.d(a,{X:function(){return t},Z:function(){return l}});var r=s(7437);let n={success:"badge-success",warning:"badge-warning",danger:"badge-danger",info:"badge-info",neutral:"badge-neutral"};function l(e){let{label:a,variant:s="neutral"}=e;return(0,r.jsx)("span",{className:"badge ".concat(n[s]||n.neutral),children:a})}function t(e){return({pendente:"warning",confirmado:"info",preparando:"info",pronto:"info",coletado:"info",em_entrega:"warning",entregue:"success",cancelado:"danger",recusado:"danger",ativo:"success",inativo:"neutral",bloqueado:"danger",online:"success",offline:"neutral",aprovado:"success",reprovado:"danger",pago:"success",pendente_pagamento:"warning",processando:"info",aberto:"warning",resolvido:"success",fechado:"neutral"})[e]||"neutral"}},3197:function(e,a,s){"use strict";s.d(a,{Z:function(){return n}});var r=s(7437);function n(e){let{icon:a,label:s,value:n,change:l,color:t="var(--accent)"}=e,i=l&&parseFloat(l)>=0;return(0,r.jsxs)("div",{className:"stats-card",style:{borderTopColor:t},children:[(0,r.jsxs)("div",{className:"stats-card-header",children:[(0,r.jsx)("span",{className:"stats-card-icon",style:{color:t},dangerouslySetInnerHTML:{__html:a||"&#128202;"}}),(0,r.jsx)("span",{className:"stats-card-label",children:s})]}),(0,r.jsx)("div",{className:"stats-card-value",children:null!=n?n:"-"}),null!=l&&(0,r.jsxs)("div",{className:"stats-card-change ".concat(i?"change-positive":"change-negative"),children:[i?"&#9650;":"&#9660;"," ",l,"%"]})]})}},434:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return g}});var r=s(7437),n=s(2265),l=s(8779),t=s(4477),i=s(4445),c=s(3197),d=s(6939),o=s(1656),u=s(8789),h=s(6971),v=s(6428);function x(){var e,a,l,i,x;let{collapsed:g}=(0,u.A)(),{alertCount:j}=(0,h.l)(),[b,m]=(0,n.useState)(null),[p,f]=(0,n.useState)(null),[N,_]=(0,n.useState)(null),[y,D]=(0,n.useState)([]),[C,R]=(0,n.useState)(!0),Z=(0,n.useRef)(null),k=(0,n.useRef)(null),S=(0,n.useRef)(null),w=(0,n.useRef)(null);(0,n.useEffect)(()=>{A()},[]);let A=async()=>{R(!0);try{let[e,a,s,r]=await Promise.allSettled([(0,v.SC)("/dashboard.php"),(0,v.SC)("/dashboard-chart.php?days=7"),(0,v.SC)("/dashboard-chart.php?type=revenue&days=30"),(0,v.SC)("/orders.php?limit=10&sort=recent")]);"fulfilled"===e.status&&m(e.value),"fulfilled"===a.status&&f(a.value),"fulfilled"===s.status&&_(s.value),"fulfilled"===r.status&&D(r.value.orders||r.value.data||[])}catch(e){}finally{R(!1)}};(0,n.useEffect)(()=>{if(!p||!Z.current)return;let e=!1;return Promise.all([s.e(7674),s.e(2153)]).then(s.bind(s,4084)).then(a=>{let{Chart:s,registerables:r}=a;if(e)return;s.register(...r),S.current&&S.current.destroy();let n=p.labels||p.dates||[],l=p.values||p.orders||[];S.current=new s(Z.current,{type:"line",data:{labels:n,datasets:[{label:"Pedidos",data:l,borderColor:"#f97316",backgroundColor:"rgba(249, 115, 22, 0.1)",fill:!0,tension:.4,pointRadius:4,pointBackgroundColor:"#f97316"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#94a3b8"}}},scales:{x:{ticks:{color:"#64748b"},grid:{color:"rgba(51,65,85,0.5)"}},y:{ticks:{color:"#64748b"},grid:{color:"rgba(51,65,85,0.5)"},beginAtZero:!0}}}})}),()=>{e=!0}},[p]),(0,n.useEffect)(()=>{if(!N||!k.current)return;let e=!1;return Promise.all([s.e(7674),s.e(2153)]).then(s.bind(s,4084)).then(a=>{let{Chart:s,registerables:r}=a;if(e)return;s.register(...r),w.current&&w.current.destroy();let n=N.labels||N.dates||[],l=N.values||N.revenue||[];w.current=new s(k.current,{type:"bar",data:{labels:n,datasets:[{label:"Receita (R$)",data:l,backgroundColor:"rgba(34, 197, 94, 0.6)",borderColor:"#22c55e",borderWidth:1,borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#94a3b8"}}},scales:{x:{ticks:{color:"#64748b"},grid:{color:"rgba(51,65,85,0.5)"}},y:{ticks:{color:"#64748b"},grid:{color:"rgba(51,65,85,0.5)"},beginAtZero:!0}}}})}),()=>{e=!0}},[N]),(0,n.useEffect)(()=>()=>{S.current&&S.current.destroy(),w.current&&w.current.destroy()},[]);let E=e=>null==e?"R$ 0,00":"R$ ".concat(Number(e).toLocaleString("pt-BR",{minimumFractionDigits:2}));return(0,r.jsxs)("div",{className:"admin-layout",children:[(0,r.jsx)(t.Z,{}),(0,r.jsxs)("main",{className:"admin-main ".concat(g?"main-collapsed":""),children:[(0,r.jsxs)("div",{className:"page-header",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"page-title",children:"Dashboard"}),(0,r.jsx)("p",{className:"page-subtitle",children:"Visao geral em tempo real"})]}),(0,r.jsx)("div",{className:"page-actions",children:(0,r.jsx)("button",{className:"btn btn-secondary",onClick:A,children:"Atualizar"})})]}),(0,r.jsxs)("div",{className:"stats-grid",children:[(0,r.jsx)(c.Z,{icon:"\uD83D\uDCE6",label:"Pedidos Hoje",value:C?"...":null!==(e=null==b?void 0:b.pedidos_hoje)&&void 0!==e?e:0,change:null==b?void 0:b.pedidos_change,color:"#f97316"}),(0,r.jsx)(c.Z,{icon:"\uD83D\uDCB0",label:"Receita Hoje",value:C?"...":E(null==b?void 0:b.receita_hoje),change:null==b?void 0:b.receita_change,color:"#22c55e"}),(0,r.jsx)(c.Z,{icon:"\uD83D\uDC64",label:"Clientes Ativos",value:C?"...":null!==(a=null==b?void 0:b.clientes_ativos)&&void 0!==a?a:0,change:null==b?void 0:b.clientes_change,color:"#3b82f6"}),(0,r.jsx)(c.Z,{icon:"\uD83D\uDEB6",label:"Shoppers Online",value:C?"...":null!==(l=null==b?void 0:b.shoppers_online)&&void 0!==l?l:0,color:"#8b5cf6"}),(0,r.jsx)(c.Z,{icon:"\uD83C\uDFAB",label:"Tickets Abertos",value:C?"...":null!==(i=null==b?void 0:b.tickets_abertos)&&void 0!==i?i:0,color:"#eab308"}),(0,r.jsx)(c.Z,{icon:"\uD83D\uDE9A",label:"Taxa Entrega",value:C?"...":"".concat(null!==(x=null==b?void 0:b.taxa_entrega)&&void 0!==x?x:0,"%"),change:null==b?void 0:b.taxa_change,color:"#06b6d4"})]}),(0,r.jsxs)("div",{className:"grid-2 mb-6",children:[(0,r.jsxs)("div",{className:"chart-container",children:[(0,r.jsx)("div",{className:"card-header",children:(0,r.jsx)("h3",{className:"card-title",children:"Pedidos - Ultimos 7 dias"})}),(0,r.jsx)("div",{style:{height:280},children:(0,r.jsx)("canvas",{ref:Z})})]}),(0,r.jsxs)("div",{className:"chart-container",children:[(0,r.jsx)("div",{className:"card-header",children:(0,r.jsx)("h3",{className:"card-title",children:"Receita - Ultimos 30 dias"})}),(0,r.jsx)("div",{style:{height:280},children:(0,r.jsx)("canvas",{ref:k})})]})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsxs)("div",{className:"card-header",children:[(0,r.jsx)("h3",{className:"card-title",children:"Pedidos Recentes"}),j>0&&(0,r.jsxs)("span",{className:"badge badge-danger",children:[j," alertas ativos"]})]}),(0,r.jsx)("div",{className:"datatable-wrapper",children:(0,r.jsxs)("table",{className:"datatable-table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Cliente"}),(0,r.jsx)("th",{children:"Parceiro"}),(0,r.jsx)("th",{children:"Total"}),(0,r.jsx)("th",{children:"Status"}),(0,r.jsx)("th",{children:"Data"})]})}),(0,r.jsx)("tbody",{children:C?[void 0,void 0,void 0,void 0,void 0].map((e,a)=>(0,r.jsx)("tr",{children:[...Array(6)].map((e,a)=>(0,r.jsx)("td",{children:(0,r.jsx)("div",{className:"skeleton-cell",style:{height:14,borderRadius:4}})},a))},a)):0===y.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:6,className:"datatable-empty",children:"Nenhum pedido recente"})}):y.slice(0,10).map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsxs)("strong",{children:["#",e.id||e.order_id]})}),(0,r.jsx)("td",{children:e.cliente_nome||e.customer_name||"-"}),(0,r.jsx)("td",{children:e.parceiro_nome||e.partner_name||"-"}),(0,r.jsx)("td",{children:E(e.total)}),(0,r.jsx)("td",{children:(0,r.jsx)(o.Z,{label:e.status||"pendente",variant:(0,o.X)(e.status)})}),(0,r.jsx)("td",{className:"text-muted",children:e.created_at||e.data||"-"})]},e.id||e.order_id))})]})})]})]}),(0,r.jsx)(d.Z,{})]})}function g(){return(0,r.jsx)(l.Z,{children:(0,r.jsx)(i.Z,{section:"dashboard",children:(0,r.jsx)(x,{})})})}}},function(e){e.O(0,[3448,5783,2971,2117,1744],function(){return e(e.s=8230)}),_N_E=e.O()}]);
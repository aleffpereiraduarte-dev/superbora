(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1534],{6011:function(e,a,s){Promise.resolve().then(s.bind(s,1389))},4445:function(e,a,s){"use strict";s.d(a,{Z:function(){return n}});var t=s(7437),l=s(8253);function n(e){let{section:a,children:s}=e,{hasPermission:n}=(0,l.q)();return n(a)?(0,t.jsx)(t.Fragment,{children:s}):(0,t.jsxs)("div",{className:"role-denied",children:[(0,t.jsx)("div",{className:"role-denied-icon",children:"\uD83D\uDD12"}),(0,t.jsx)("h2",{children:"Acesso Negado"}),(0,t.jsx)("p",{children:"Voce nao tem permissao para acessar esta secao."}),(0,t.jsx)("p",{className:"role-denied-hint",children:"Contate o administrador para solicitar acesso."})]})}},1656:function(e,a,s){"use strict";s.d(a,{X:function(){return r},Z:function(){return n}});var t=s(7437);let l={success:"badge-success",warning:"badge-warning",danger:"badge-danger",info:"badge-info",neutral:"badge-neutral"};function n(e){let{label:a,variant:s="neutral"}=e;return(0,t.jsx)("span",{className:"badge ".concat(l[s]||l.neutral),children:a})}function r(e){return({pendente:"warning",confirmado:"info",preparando:"info",pronto:"info",coletado:"info",em_entrega:"warning",entregue:"success",cancelado:"danger",recusado:"danger",ativo:"success",inativo:"neutral",bloqueado:"danger",online:"success",offline:"neutral",aprovado:"success",reprovado:"danger",pago:"success",pendente_pagamento:"warning",processando:"info",aberto:"warning",resolvido:"success",fechado:"neutral"})[e]||"neutral"}},9246:function(e,a,s){"use strict";s.d(a,{Z:function(){return i}});var t=s(7437),l=s(2265);function n(e){let{value:a,onChange:s,placeholder:n="Buscar...",delay:r=300}=e,[i,d]=(0,l.useState)(a||""),c=(0,l.useRef)(null);return(0,l.useEffect)(()=>{d(a||"")},[a]),(0,t.jsxs)("div",{className:"search-input-wrapper",children:[(0,t.jsx)("span",{className:"search-input-icon",children:"\uD83D\uDD0D"}),(0,t.jsx)("input",{type:"text",className:"search-input",value:i,onChange:e=>{let a=e.target.value;d(a),c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{null==s||s(a)},r)},placeholder:n}),i&&(0,t.jsx)("button",{className:"search-input-clear",onClick:()=>{d(""),null==s||s("")},children:"✕"})]})}var r=s(4420);function i(e){let{columns:a=[],data:s=[],loading:i=!1,searchable:d=!0,pageSize:c=15,emptyMessage:o="Nenhum registro encontrado",onRowClick:u}=e,[h,m]=(0,l.useState)(""),[x,p]=(0,l.useState)(null),[v,g]=(0,l.useState)("asc"),[b,j]=(0,l.useState)(1),f=(0,l.useMemo)(()=>{if(!h)return s;let e=h.toLowerCase();return s.filter(s=>a.some(a=>{let t=s[a.key];return null!=t&&String(t).toLowerCase().includes(e)}))},[s,h,a]),y=(0,l.useMemo)(()=>x?[...f].sort((e,a)=>{var s,t;let l=null!==(s=e[x])&&void 0!==s?s:"",n=null!==(t=a[x])&&void 0!==t?t:"";if("number"==typeof l&&"number"==typeof n)return"asc"===v?l-n:n-l;let r=String(l).localeCompare(String(n));return"asc"===v?r:-r}):f,[f,x,v]),N=Math.max(1,Math.ceil(y.length/c)),w=y.slice((b-1)*c,b*c);(0,l.useEffect)(()=>{b>N&&j(1)},[b,N]);let k=e=>{x===e?g(e=>"asc"===e?"desc":"asc"):(p(e),g("asc"))};return i?(0,t.jsxs)("div",{className:"datatable",children:[d&&(0,t.jsx)("div",{className:"datatable-toolbar",children:(0,t.jsx)(n,{value:"",onChange:()=>{},placeholder:"Buscar..."})}),(0,t.jsx)("div",{className:"datatable-skeleton",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsx)("div",{className:"skeleton-row",children:a.map((e,a)=>(0,t.jsx)("div",{className:"skeleton-cell"},a))},s))})]}):(0,t.jsxs)("div",{className:"datatable",children:[d&&(0,t.jsxs)("div",{className:"datatable-toolbar",children:[(0,t.jsx)(n,{value:h,onChange:e=>{m(e),j(1)},placeholder:"Buscar na tabela..."}),(0,t.jsxs)("span",{className:"datatable-count",children:[f.length," registro(s)"]})]}),(0,t.jsx)("div",{className:"datatable-wrapper",children:(0,t.jsxs)("table",{className:"datatable-table",children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{children:a.map(e=>(0,t.jsxs)("th",{onClick:()=>!1!==e.sortable&&k(e.key),className:!1!==e.sortable?"sortable":"",style:e.width?{width:e.width}:void 0,children:[e.label,x===e.key&&(0,t.jsx)("span",{className:"sort-indicator",children:"asc"===v?" ▲":" ▼"})]},e.key))})}),(0,t.jsx)("tbody",{children:0===w.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:a.length,className:"datatable-empty",children:o})}):w.map((e,s)=>(0,t.jsx)("tr",{onClick:()=>null==u?void 0:u(e),className:u?"clickable-row":"",children:a.map(a=>{var s;return(0,t.jsx)("td",{children:a.render?a.render(e[a.key],e):null!==(s=e[a.key])&&void 0!==s?s:"-"},a.key)})},e.id||s))})]})}),N>1&&(0,t.jsx)(r.Z,{page:b,totalPages:N,onPageChange:j})]})}},7714:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});var t=s(7437),l=s(2265);let n={sm:"400px",md:"560px",lg:"720px",xl:"960px"};function r(e){let{isOpen:a,onClose:s,title:r,children:i,size:d="md"}=e;return((0,l.useEffect)(()=>(a?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[a]),(0,l.useEffect)(()=>{let e=e=>{"Escape"===e.key&&a&&(null==s||s())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[a,s]),a)?(0,t.jsx)("div",{className:"modal-overlay",onClick:s,children:(0,t.jsxs)("div",{className:"modal-container",style:{maxWidth:n[d]||n.md},onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"modal-header",children:[(0,t.jsx)("h3",{className:"modal-title",children:r}),(0,t.jsx)("button",{className:"modal-close",onClick:s,children:"✕"})]}),(0,t.jsx)("div",{className:"modal-body",children:i})]})}):null}},4420:function(e,a,s){"use strict";s.d(a,{Z:function(){return l}});var t=s(7437);function l(e){let{page:a,totalPages:s,onPageChange:l}=e,n=[],r=Math.max(1,a-Math.floor(2.5)),i=Math.min(s,r+5-1);i-r<4&&(r=Math.max(1,i-5+1));for(let e=r;e<=i;e++)n.push(e);return(0,t.jsxs)("div",{className:"pagination",children:[(0,t.jsx)("button",{className:"pagination-btn",disabled:a<=1,onClick:()=>l(a-1),children:"‹ Anterior"}),r>1&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{className:"pagination-btn",onClick:()=>l(1),children:"1"}),r>2&&(0,t.jsx)("span",{className:"pagination-dots",children:"..."})]}),n.map(e=>(0,t.jsx)("button",{className:"pagination-btn ".concat(e===a?"pagination-active":""),onClick:()=>l(e),children:e},e)),i<s&&(0,t.jsxs)(t.Fragment,{children:[i<s-1&&(0,t.jsx)("span",{className:"pagination-dots",children:"..."}),(0,t.jsx)("button",{className:"pagination-btn",onClick:()=>l(s),children:s})]}),(0,t.jsx)("button",{className:"pagination-btn",disabled:a>=s,onClick:()=>l(a+1),children:"Proximo ›"})]})}},3197:function(e,a,s){"use strict";s.d(a,{Z:function(){return l}});var t=s(7437);function l(e){let{icon:a,label:s,value:l,change:n,color:r="var(--accent)"}=e,i=n&&parseFloat(n)>=0;return(0,t.jsxs)("div",{className:"stats-card",style:{borderTopColor:r},children:[(0,t.jsxs)("div",{className:"stats-card-header",children:[(0,t.jsx)("span",{className:"stats-card-icon",style:{color:r},dangerouslySetInnerHTML:{__html:a||"&#128202;"}}),(0,t.jsx)("span",{className:"stats-card-label",children:s})]}),(0,t.jsx)("div",{className:"stats-card-value",children:null!=l?l:"-"}),null!=n&&(0,t.jsxs)("div",{className:"stats-card-change ".concat(i?"change-positive":"change-negative"),children:[i?"&#9650;":"&#9660;"," ",n,"%"]})]})}},3378:function(e,a,s){"use strict";s.d(a,{Z:function(){return l}});var t=s(7437);function l(e){let{tabs:a=[],activeTab:s,onChange:l}=e;return(0,t.jsx)("div",{className:"tabs",children:a.map(e=>(0,t.jsx)("button",{className:"tab-btn ".concat(s===e.key?"tab-active":""),onClick:()=>l(e.key),children:e.label},e.key))})}},1389:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return C}});var t=s(7437),l=s(2265),n=s(8779),r=s(4477),i=s(4445),d=s(9246),c=s(1656),o=s(7714),u=s(3197),h=s(3378),m=s(6939),x=s(8789),p=s(6971),v=s(6428);let g={high_order_velocity:"Alta velocidade de pedidos",moderate_order_velocity:"Velocidade moderada",failed_payments:"Pagamentos falhados",unusual_order_value:"Valor incomum",new_account_high_value:"Conta nova + valor alto",frequent_cancellations:"Cancelamentos frequentes",multiple_ips:"Multiplos IPs"},b=[{key:"",label:"Todos"},{key:"block",label:"Bloqueados"},{key:"review",label:"Em Revisao"},{key:"reviewed",label:"Revisados"},{key:"pending",label:"Pendentes"}],j=[{value:"7d",label:"7 dias"},{value:"30d",label:"30 dias"},{value:"90d",label:"90 dias"},{value:"all",label:"Todos"}];function f(e){return e?new Date(e).toLocaleString("pt-BR"):"-"}function y(e){let a=Number(e)||0;return a>=70?"var(--danger)":a>=40?"var(--warning)":"var(--success)"}function N(e){let a=Number(e)||0;return a>=70?"danger":a>=40?"warning":"info"}function w(e){return"block"===e?"danger":"review"===e?"warning":"success"}function k(e){return"block"===e?"Bloqueado":"review"===e?"Em Revisao":"Permitido"}function _(){var e,a,s,n,i,_,C;let{collapsed:S}=(0,x.A)(),{success:D,error:Z}=(0,p.l)(),[A,E]=(0,l.useState)(null),[M,P]=(0,l.useState)([]),[R,T]=(0,l.useState)({page:1,pages:0,total:0}),[B,z]=(0,l.useState)(!0),[q,F]=(0,l.useState)(!0),[I,L]=(0,l.useState)(""),[W,O]=(0,l.useState)("30d"),[V,H]=(0,l.useState)(""),[U,Y]=(0,l.useState)(""),[J,K]=(0,l.useState)(1),[X,G]=(0,l.useState)(!1),[Q,$]=(0,l.useState)(null),[ee,ea]=(0,l.useState)(!1),[es,et]=(0,l.useState)(!1),el=(0,l.useCallback)(async()=>{F(!0);try{let e=await (0,v.SC)("/fraud.php?view=stats");E(e.stats||e)}catch(e){console.warn("Erro ao carregar stats de fraude:",e.message)}finally{F(!1)}},[]),en=(0,l.useCallback)(async()=>{z(!0);try{let e=new URLSearchParams;e.set("view","list"),W&&e.set("period",W),V&&e.set("search",V),e.set("page",String(J)),"block"===I?e.set("action","block"):"review"===I?e.set("action","review"):"reviewed"===I?e.set("reviewed","yes"):"pending"===I&&e.set("reviewed","no");let a=await (0,v.SC)("/fraud.php?".concat(e.toString()));P(a.signals||[]),T(a.pagination||{page:1,pages:0,total:0})}catch(e){Z("Erro ao carregar sinais de fraude")}finally{z(!1)}},[I,W,V,J,Z]);(0,l.useEffect)(()=>{el()},[el]),(0,l.useEffect)(()=>{en()},[en]),(0,l.useEffect)(()=>{K(1)},[I,W,V]);let er=async e=>{let a=e.id||e.fraud_id;G(!0),ea(!0),$(e);try{let s=await (0,v.SC)("/fraud.php?id=".concat(a));$(s.signal||e)}catch(e){Z("Erro ao carregar detalhes")}finally{ea(!1)}},ei=()=>{G(!1),$(null)},ed=async()=>{if(Q){et(!0);try{await (0,v.sg)("/fraud.php",{id:Q.id||Q.fraud_id,action:"review"}),D("Marcado como revisado"),ei(),en(),el()}catch(e){Z("Erro: "+e.message)}finally{et(!1)}}},ec=async()=>{if(Q&&confirm("Tem certeza que deseja bloquear este cliente? Esta acao pode impedir futuras compras.")){et(!0);try{await (0,v.sg)("/fraud.php",{id:Q.id||Q.fraud_id,action:"block_customer"}),D("Cliente bloqueado com sucesso"),ei(),en(),el()}catch(e){Z("Erro ao bloquear: "+e.message)}finally{et(!1)}}},eo=e=>{if(!e)return[];if(Array.isArray(e))return e;try{let a="string"==typeof e?JSON.parse(e):e;return a.signals||a||[]}catch(e){return[]}},eu=e=>{let a=eo(e.signals);return Array.isArray(a)?a.length:0},eh=[{key:"id",label:"#ID",width:"70px",render:e=>(0,t.jsxs)("strong",{children:["#",e]})},{key:"customer_name",label:"Cliente",render:(e,a)=>e||"Cliente #".concat(a.customer_id||"-")},{key:"score",label:"Score",width:"90px",render:e=>(0,t.jsx)(c.Z,{label:"".concat(e||0,"/100"),variant:N(e)})},{key:"action",label:"Acao",width:"110px",render:e=>(0,t.jsx)(c.Z,{label:k(e),variant:w(e)})},{key:"signals",label:"Sinais",width:"70px",render:(e,a)=>eu(a)},{key:"ip_address",label:"IP",render:e=>(0,t.jsx)("span",{style:{fontFamily:"monospace",fontSize:12},children:e||"-"})},{key:"reviewed_by",label:"Revisado",width:"80px",render:e=>(0,t.jsx)("span",{style:{color:e?"var(--success)":"var(--danger)",fontSize:16},children:e?"✓":"✗"})},{key:"created_at",label:"Data",render:e=>f(e)},{key:"actions",label:"Acoes",sortable:!1,width:"80px",render:(e,a)=>(0,t.jsx)("button",{className:"btn btn-sm btn-secondary",onClick:e=>{e.stopPropagation(),er(a)},children:"Ver"})}],em=(null==A?void 0:A.avg_score)!=null?Number(A.avg_score).toFixed(0):"-",ex=y(null==A?void 0:A.avg_score),ep=Q?eo(Q.signals):[],ev=(null==Q?void 0:Q.customer_history)||[];return(0,t.jsxs)("div",{className:"admin-layout",children:[(0,t.jsx)(r.Z,{}),(0,t.jsxs)("main",{className:"admin-main ".concat(S?"main-collapsed":""),children:[(0,t.jsxs)("div",{className:"page-header",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"page-title",children:"Deteccao de Fraude"}),(0,t.jsx)("p",{className:"page-subtitle",children:"Monitoramento e analise de sinais de fraude"})]}),(0,t.jsx)("div",{className:"page-actions",children:(0,t.jsx)("button",{className:"btn btn-secondary",onClick:()=>{el(),en()},children:"Atualizar"})})]}),(0,t.jsxs)("div",{className:"stats-grid",style:{gridTemplateColumns:"repeat(5, 1fr)"},children:[(0,t.jsx)(u.Z,{icon:"\uD83D\uDEA8",label:"Total Alertas",value:q?"...":null!==(n=null==A?void 0:A.total)&&void 0!==n?n:0,color:"var(--danger)"}),(0,t.jsx)(u.Z,{icon:"\uD83D\uDEAB",label:"Bloqueados",value:q?"...":null!==(i=null==A?void 0:A.blocked)&&void 0!==i?i:0,color:"var(--danger)"}),(0,t.jsx)(u.Z,{icon:"\uD83D\uDD0D",label:"Em Revisao",value:q?"...":null!==(_=null==A?void 0:A.review)&&void 0!==_?_:0,color:"var(--warning)"}),(0,t.jsx)(u.Z,{icon:"\uD83C\uDFAF",label:"Score Medio",value:q?"...":em,color:ex}),(0,t.jsx)(u.Z,{icon:"⏰",label:"Pendentes",value:q?"...":null!==(C=null==A?void 0:A.pending_review)&&void 0!==C?C:0,color:"var(--purple)"})]}),A&&!q&&(0,t.jsxs)("div",{className:"flex gap-4 mb-4",style:{flexWrap:"wrap"},children:[A.pending_review>0&&(0,t.jsxs)("div",{style:{padding:"8px 16px",background:"var(--purple-bg)",border:"1px solid var(--purple)",borderRadius:"var(--radius)",fontSize:13,color:"var(--purple)",fontWeight:600},children:[A.pending_review," alerta(s) aguardando revisao"]}),A.top_signals&&A.top_signals.length>0&&(0,t.jsxs)("div",{style:{padding:"8px 16px",background:"var(--bg)",border:"1px solid var(--border)",borderRadius:"var(--radius)",fontSize:13},children:["Sinal mais comum: ",(0,t.jsx)("strong",{children:g[null===(e=A.top_signals[0])||void 0===e?void 0:e.signal_type]||(null===(a=A.top_signals[0])||void 0===a?void 0:a.signal_type)||"-"}),(null===(s=A.top_signals[0])||void 0===s?void 0:s.total)!=null&&(0,t.jsxs)("span",{className:"text-dim",children:[" (",A.top_signals[0].total,"x)"]})]})]}),A&&!q&&A.top_customers&&A.top_customers.length>0&&(0,t.jsxs)("div",{className:"card mb-4",children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h3",{className:"card-title",children:"Clientes Mais Sinalizados"})}),(0,t.jsx)("div",{className:"datatable-wrapper",children:(0,t.jsxs)("table",{className:"datatable-table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Cliente"}),(0,t.jsx)("th",{style:{width:100},children:"Alertas"}),(0,t.jsx)("th",{style:{width:100},children:"Score Max"}),(0,t.jsx)("th",{style:{width:120},children:"Ultimo Alerta"})]})}),(0,t.jsx)("tbody",{children:A.top_customers.map((e,a)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:e.customer_name||"Cliente #".concat(e.customer_id)}),(0,t.jsx)("td",{children:(0,t.jsx)("strong",{children:e.flag_count||0})}),(0,t.jsx)("td",{children:(0,t.jsx)(c.Z,{label:"".concat(e.max_score||0),variant:N(e.max_score)})}),(0,t.jsx)("td",{className:"text-sm text-dim",children:f(e.last_flag)})]},e.customer_id||a))})]})})]}),(0,t.jsx)(h.Z,{tabs:b,activeTab:I,onChange:e=>L(e)}),(0,t.jsxs)("div",{className:"filters-bar",style:{marginTop:16},children:[(0,t.jsxs)("div",{style:{position:"relative",flex:1},children:[(0,t.jsx)("input",{className:"form-input",placeholder:"Buscar por nome, email, IP ou ID...",value:U,onChange:e=>Y(e.target.value),onKeyDown:e=>{"Enter"===e.key&&H(U)},style:{width:"100%"}}),U&&(0,t.jsx)("button",{onClick:()=>{Y(""),H("")},style:{position:"absolute",right:8,top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-dim)",fontSize:16},children:"✕"})]}),(0,t.jsx)("select",{className:"form-select",value:W,onChange:e=>O(e.target.value),children:j.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsx)(d.Z,{columns:eh,data:M,loading:B,searchable:!1,emptyMessage:"Nenhum sinal de fraude encontrado"}),R.pages>1&&(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2",style:{marginTop:16},children:[(0,t.jsx)("button",{className:"btn btn-sm btn-secondary",disabled:J<=1,onClick:()=>K(e=>Math.max(1,e-1)),children:"Anterior"}),(0,t.jsxs)("span",{className:"text-sm text-dim",children:["Pagina ",J," de ",R.pages," (",R.total," registros)"]}),(0,t.jsx)("button",{className:"btn btn-sm btn-secondary",disabled:J>=R.pages,onClick:()=>K(e=>e+1),children:"Proxima"})]}),(0,t.jsx)(o.Z,{isOpen:X,onClose:ei,title:Q?"Alerta de Fraude #".concat(Q.id||Q.fraud_id):"Detalhes do Alerta",size:"lg",children:ee?(0,t.jsx)("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:"Carregando detalhes..."}):Q?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{style:{marginBottom:20},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",style:{marginBottom:6},children:[(0,t.jsx)("span",{style:{fontSize:14,fontWeight:600},children:"Score de Fraude"}),(0,t.jsxs)("span",{style:{fontSize:20,fontWeight:700,color:y(Q.score)},children:[Q.score||0,"/100"]})]}),(0,t.jsx)("div",{style:{width:"100%",height:12,background:"var(--border)",borderRadius:6,overflow:"hidden"},children:(0,t.jsx)("div",{style:{width:"".concat(Math.min(100,Math.max(0,Number(Q.score)||0)),"%"),height:"100%",borderRadius:6,background:"linear-gradient(90deg, #22c55e 0%, #f59e0b 40%, #ef4444 70%, #dc2626 100%)",backgroundSize:"".concat(100/(Math.max(1,Number(Q.score)||1)/100)*100,"% 100%"),transition:"width 0.4s ease"}})}),(0,t.jsxs)("div",{className:"flex items-center justify-between",style:{marginTop:4},children:[(0,t.jsx)("span",{className:"text-xs text-dim",children:"0 - Seguro"}),(0,t.jsx)("span",{className:"text-xs text-dim",children:"100 - Alto Risco"})]})]}),(0,t.jsxs)("div",{className:"detail-grid mb-4",children:[(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Cliente"}),(0,t.jsxs)("span",{className:"detail-value",children:[Q.customer_name||"Cliente #".concat(Q.customer_id||"-"),Q.customer_email&&(0,t.jsx)("span",{className:"text-xs text-dim",style:{display:"block"},children:Q.customer_email})]})]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"IP"}),(0,t.jsx)("span",{className:"detail-value",style:{fontFamily:"monospace"},children:Q.ip_address||"-"})]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Acao Tomada"}),(0,t.jsx)("span",{className:"detail-value",children:(0,t.jsx)(c.Z,{label:k(Q.action),variant:w(Q.action)})})]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Data"}),(0,t.jsx)("span",{className:"detail-value",children:f(Q.created_at)})]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Revisado"}),(0,t.jsx)("span",{className:"detail-value",children:Q.reviewed_by?(0,t.jsx)("span",{style:{color:"var(--success)",fontWeight:600},children:"Sim"}):(0,t.jsx)("span",{style:{color:"var(--danger)",fontWeight:600},children:"Nao"})})]}),Q.order_id&&(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Pedido"}),(0,t.jsxs)("span",{className:"detail-value",children:["#",Q.order_id]})]})]}),ep.length>0&&(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsxs)("label",{className:"form-label",children:["Sinais Detectados (",ep.length,")"]}),(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:ep.map((e,a)=>(0,t.jsxs)("div",{style:{padding:"12px 16px",borderRadius:"var(--radius)",border:"1px solid var(--border)",borderLeft:"4px solid ".concat("critical"===e.severity?"var(--danger)":"high"===e.severity?"var(--accent)":"medium"===e.severity?"var(--warning)":"var(--info)"),background:"var(--bg)"},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",style:{marginBottom:4},children:[(0,t.jsx)("strong",{className:"text-sm",children:g[e.type]||e.type||"Sinal desconhecido"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[e.severity&&(0,t.jsx)(c.Z,{label:e.severity,variant:{critical:"danger",high:"warning",medium:"info",low:"neutral"}[e.severity]||"neutral"}),null!=e.points&&(0,t.jsxs)("span",{style:{fontSize:12,fontWeight:700,color:y(e.points),background:"".concat(y(e.points),"15"),padding:"2px 8px",borderRadius:4},children:["+",e.points," pts"]})]})]}),e.detail&&(0,t.jsx)("p",{className:"text-sm text-dim",style:{margin:0},children:e.detail})]},a))})]}),ev.length>0&&(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsxs)("label",{className:"form-label",children:["Historico do Cliente (",ev.length," alertas anteriores)"]}),(0,t.jsx)("div",{style:{maxHeight:220,overflowY:"auto",border:"1px solid var(--border)",borderRadius:"var(--radius)"},children:(0,t.jsxs)("table",{className:"datatable-table",style:{marginBottom:0},children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{style:{width:60},children:"#ID"}),(0,t.jsx)("th",{style:{width:80},children:"Score"}),(0,t.jsx)("th",{style:{width:100},children:"Acao"}),(0,t.jsx)("th",{children:"Data"}),(0,t.jsx)("th",{style:{width:80},children:"Revisado"})]})}),(0,t.jsx)("tbody",{children:ev.map((e,a)=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{children:["#",e.id]}),(0,t.jsx)("td",{children:(0,t.jsx)(c.Z,{label:"".concat(e.score||0),variant:N(e.score)})}),(0,t.jsx)("td",{children:(0,t.jsx)(c.Z,{label:k(e.action),variant:w(e.action)})}),(0,t.jsx)("td",{className:"text-sm",children:f(e.created_at)}),(0,t.jsx)("td",{style:{textAlign:"center"},children:(0,t.jsx)("span",{style:{color:e.reviewed_by?"var(--success)":"var(--danger)",fontSize:14},children:e.reviewed_by?"✓":"✗"})})]},e.id||a))})]})})]}),(0,t.jsxs)("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid var(--border)",display:"flex",justifyContent:"flex-end",gap:8},children:[!Q.reviewed_by&&(0,t.jsx)("button",{className:"btn btn-primary",onClick:ed,disabled:es,children:es?"Processando...":"Marcar como Revisado"}),(0,t.jsx)("button",{className:"btn btn-danger",onClick:ec,disabled:es,children:es?"Bloqueando...":"Bloquear Cliente"})]})]}):null})]}),(0,t.jsx)(m.Z,{})]})}function C(){return(0,t.jsx)(n.Z,{children:(0,t.jsx)(i.Z,{section:"support",children:(0,t.jsx)(_,{})})})}}},function(e){e.O(0,[3448,5783,2971,2117,1744],function(){return e(e.s=6011)}),_N_E=e.O()}]);
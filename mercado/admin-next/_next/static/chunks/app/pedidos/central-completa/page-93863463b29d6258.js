(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6651],{5338:function(e,s,a){Promise.resolve().then(a.bind(a,5027))},4445:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});var l=a(7437),n=a(8253);function t(e){let{section:s,children:a}=e,{hasPermission:t}=(0,n.q)();return t(s)?(0,l.jsx)(l.Fragment,{children:a}):(0,l.jsxs)("div",{className:"role-denied",children:[(0,l.jsx)("div",{className:"role-denied-icon",children:"\uD83D\uDD12"}),(0,l.jsx)("h2",{children:"Acesso Negado"}),(0,l.jsx)("p",{children:"Voce nao tem permissao para acessar esta secao."}),(0,l.jsx)("p",{className:"role-denied-hint",children:"Contate o administrador para solicitar acesso."})]})}},1656:function(e,s,a){"use strict";a.d(s,{X:function(){return r},Z:function(){return t}});var l=a(7437);let n={success:"badge-success",warning:"badge-warning",danger:"badge-danger",info:"badge-info",neutral:"badge-neutral"};function t(e){let{label:s,variant:a="neutral"}=e;return(0,l.jsx)("span",{className:"badge ".concat(n[a]||n.neutral),children:s})}function r(e){return({pendente:"warning",confirmado:"info",preparando:"info",pronto:"info",coletado:"info",em_entrega:"warning",entregue:"success",cancelado:"danger",recusado:"danger",ativo:"success",inativo:"neutral",bloqueado:"danger",online:"success",offline:"neutral",aprovado:"success",reprovado:"danger",pago:"success",pendente_pagamento:"warning",processando:"info",aberto:"warning",resolvido:"success",fechado:"neutral"})[e]||"neutral"}},3197:function(e,s,a){"use strict";a.d(s,{Z:function(){return n}});var l=a(7437);function n(e){let{icon:s,label:a,value:n,change:t,color:r="var(--accent)"}=e,i=t&&parseFloat(t)>=0;return(0,l.jsxs)("div",{className:"stats-card",style:{borderTopColor:r},children:[(0,l.jsxs)("div",{className:"stats-card-header",children:[(0,l.jsx)("span",{className:"stats-card-icon",style:{color:r},dangerouslySetInnerHTML:{__html:s||"&#128202;"}}),(0,l.jsx)("span",{className:"stats-card-label",children:a})]}),(0,l.jsx)("div",{className:"stats-card-value",children:null!=n?n:"-"}),null!=t&&(0,l.jsxs)("div",{className:"stats-card-change ".concat(i?"change-positive":"change-negative"),children:[i?"&#9650;":"&#9660;"," ",t,"%"]})]})}},5027:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return p}});var l=a(7437),n=a(2265),t=a(8779),r=a(4477),i=a(4445),d=a(1656),c=a(3197),o=a(6939),h=a(8789),m=a(6971),u=a(6428);function x(){let{collapsed:e}=(0,h.A)(),{alertCount:s,alerts:a}=(0,m.l)(),[t,i]=(0,n.useState)([]),[x,p]=(0,n.useState)([]),[j,v]=(0,n.useState)(null),[g,N]=(0,n.useState)(!0),[b,f]=(0,n.useState)(null),y=(0,n.useRef)(null);(0,n.useEffect)(()=>(_(),y.current=setInterval(_,1e4),()=>clearInterval(y.current)),[]);let _=async()=>{try{let[e,s,a]=await Promise.allSettled([(0,u.SC)("/orders.php?active=1"),(0,u.SC)("/shoppers.php?status=online&locations=1"),(0,u.SC)("/dashboard.php")]);"fulfilled"===e.status&&i(e.value.orders||e.value.data||[]),"fulfilled"===s.status&&p(s.value.shoppers||s.value.data||[]),"fulfilled"===a.status&&v(a.value)}catch(e){}finally{N(!1)}},C=e=>null!=e?"R$ ".concat(Number(e).toLocaleString("pt-BR",{minimumFractionDigits:2})):"R$ 0,00",D=t.filter(e=>!["entregue","cancelado"].includes(e.status)),S=t.filter(e=>"pendente"===e.status),w=t.filter(e=>"em_entrega"===e.status);return(0,l.jsxs)("div",{className:"admin-layout",children:[(0,l.jsx)(r.Z,{}),(0,l.jsxs)("main",{className:"admin-main ".concat(e?"main-collapsed":""),children:[(0,l.jsxs)("div",{className:"page-header",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"page-title",children:"Central Completa"}),(0,l.jsx)("p",{className:"page-subtitle",children:"Dashboard operacional integrado (atualiza a cada 10s)"})]}),(0,l.jsx)("div",{className:"page-actions",children:(0,l.jsx)("button",{className:"btn btn-secondary",onClick:_,children:"Atualizar"})})]}),(0,l.jsxs)("div",{className:"stats-grid",style:{gridTemplateColumns:"repeat(5, 1fr)"},children:[(0,l.jsx)(c.Z,{icon:"\uD83D\uDCE6",label:"Pedidos Ativos",value:D.length,color:"#f97316"}),(0,l.jsx)(c.Z,{icon:"âš ",label:"Pendentes",value:S.length,color:"#eab308"}),(0,l.jsx)(c.Z,{icon:"\uD83D\uDE9A",label:"Em Entrega",value:w.length,color:"#3b82f6"}),(0,l.jsx)(c.Z,{icon:"\uD83D\uDEB6",label:"Shoppers Online",value:x.length,color:"#8b5cf6"}),(0,l.jsx)(c.Z,{icon:"\uD83D\uDEA8",label:"Alertas",value:s,color:"#ef4444"})]}),(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 340px",gap:16},children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"card mb-4",children:[(0,l.jsxs)("div",{className:"card-header",children:[(0,l.jsx)("h3",{className:"card-title",children:"Mapa de Operacoes"}),(0,l.jsx)("a",{href:"/mapa/",className:"btn btn-sm btn-secondary",children:"Abrir Mapa Completo"})]}),(0,l.jsx)("div",{style:{height:320,background:"var(--bg)",borderRadius:"var(--radius)",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid var(--border)"},children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-muted",children:"Mapa interativo disponivel na pagina /mapa"}),(0,l.jsxs)("p",{className:"text-xs text-dim mt-4",children:[x.length," shoppers online | ",D.length," pedidos ativos"]})]})})]}),(0,l.jsxs)("div",{className:"card",children:[(0,l.jsx)("div",{className:"card-header",children:(0,l.jsxs)("h3",{className:"card-title",children:["Pedidos Ativos (",D.length,")"]})}),(0,l.jsx)("div",{className:"datatable-wrapper",children:(0,l.jsxs)("table",{className:"datatable-table",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"ID"}),(0,l.jsx)("th",{children:"Cliente"}),(0,l.jsx)("th",{children:"Status"}),(0,l.jsx)("th",{children:"Shopper"}),(0,l.jsx)("th",{children:"Total"})]})}),(0,l.jsx)("tbody",{children:g?[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,l.jsx)("tr",{children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,l.jsx)("td",{children:(0,l.jsx)("div",{className:"skeleton-cell",style:{height:14}})},s))},s)):0===D.length?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:5,className:"datatable-empty",children:"Nenhum pedido ativo"})}):D.map(e=>(0,l.jsxs)("tr",{className:"clickable-row",onClick:()=>f(e),children:[(0,l.jsx)("td",{children:(0,l.jsxs)("strong",{children:["#",e.id||e.order_id]})}),(0,l.jsx)("td",{children:e.cliente_nome||e.customer_name||"-"}),(0,l.jsx)("td",{children:(0,l.jsx)(d.Z,{label:e.status,variant:(0,d.X)(e.status)})}),(0,l.jsx)("td",{children:e.shopper_nome||e.shopper_name||"-"}),(0,l.jsx)("td",{children:C(e.total)})]},e.id||e.order_id))})]})})]})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[b&&(0,l.jsxs)("div",{className:"card",children:[(0,l.jsxs)("div",{className:"card-header",children:[(0,l.jsxs)("h3",{className:"card-title",children:["Pedido #",b.id||b.order_id]}),(0,l.jsx)(d.Z,{label:b.status,variant:(0,d.X)(b.status)})]}),(0,l.jsxs)("div",{className:"detail-grid",children:[(0,l.jsxs)("div",{className:"detail-item",children:[(0,l.jsx)("span",{className:"detail-label",children:"Cliente"}),(0,l.jsx)("span",{className:"detail-value",children:b.cliente_nome||b.customer_name||"-"})]}),(0,l.jsxs)("div",{className:"detail-item",children:[(0,l.jsx)("span",{className:"detail-label",children:"Parceiro"}),(0,l.jsx)("span",{className:"detail-value",children:b.parceiro_nome||b.partner_name||"-"})]}),(0,l.jsxs)("div",{className:"detail-item",children:[(0,l.jsx)("span",{className:"detail-label",children:"Shopper"}),(0,l.jsx)("span",{className:"detail-value",children:b.shopper_nome||b.shopper_name||"-"})]}),(0,l.jsxs)("div",{className:"detail-item",children:[(0,l.jsx)("span",{className:"detail-label",children:"Total"}),(0,l.jsx)("span",{className:"detail-value",children:C(b.total)})]})]}),(0,l.jsx)("a",{href:"/pedidos/detalhe/?id=".concat(b.id||b.order_id),className:"btn btn-primary btn-sm w-full",style:{justifyContent:"center"},children:"Ver Detalhes"})]}),(0,l.jsxs)("div",{className:"card",children:[(0,l.jsxs)("h3",{className:"card-title mb-4",children:["Shoppers Online (",x.length,")"]}),(0,l.jsx)("div",{style:{maxHeight:200,overflowY:"auto"},children:0===x.length?(0,l.jsx)("p",{className:"text-muted text-sm",children:"Nenhum shopper online"}):x.map(e=>(0,l.jsxs)("div",{style:{padding:"8px 0",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsx)("span",{className:"text-sm",children:e.name||e.nome}),(0,l.jsx)(d.Z,{label:"online",variant:"success"})]},e.id||e.shopper_id))})]}),(0,l.jsxs)("div",{className:"card",children:[(0,l.jsxs)("h3",{className:"card-title mb-4",children:["Alertas (",s,")"]}),(0,l.jsx)("div",{style:{maxHeight:200,overflowY:"auto"},children:0===a.length?(0,l.jsx)("p",{className:"text-muted text-sm",children:"Nenhum alerta"}):a.slice(0,10).map((e,s)=>(0,l.jsxs)("div",{style:{padding:"8px 0",borderBottom:"1px solid var(--border)"},children:[(0,l.jsx)(d.Z,{label:e.type||e.tipo||"alerta",variant:"high"===e.severity?"danger":"warning"}),(0,l.jsx)("p",{className:"text-sm mt-2",children:e.message||e.mensagem}),(0,l.jsx)("span",{className:"text-xs text-dim",children:e.created_at||""})]},s))})]})]})]})]}),(0,l.jsx)(o.Z,{})]})}function p(){return(0,l.jsx)(t.Z,{children:(0,l.jsx)(i.Z,{section:"orders",children:(0,l.jsx)(x,{})})})}}},function(e){e.O(0,[3448,5783,2971,2117,1744],function(){return e(e.s=5338)}),_N_E=e.O()}]);
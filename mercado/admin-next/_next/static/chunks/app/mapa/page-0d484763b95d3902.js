(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7900],{6326:function(e,n,t){Promise.resolve().then(t.bind(t,6197))},4445:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var a=t(7437),s=t(8253);function l(e){let{section:n,children:t}=e,{hasPermission:l}=(0,s.q)();return l(n)?(0,a.jsx)(a.Fragment,{children:t}):(0,a.jsxs)("div",{className:"role-denied",children:[(0,a.jsx)("div",{className:"role-denied-icon",children:"\uD83D\uDD12"}),(0,a.jsx)("h2",{children:"Acesso Negado"}),(0,a.jsx)("p",{children:"Voce nao tem permissao para acessar esta secao."}),(0,a.jsx)("p",{className:"role-denied-hint",children:"Contate o administrador para solicitar acesso."})]})}},1656:function(e,n,t){"use strict";t.d(n,{X:function(){return r},Z:function(){return l}});var a=t(7437);let s={success:"badge-success",warning:"badge-warning",danger:"badge-danger",info:"badge-info",neutral:"badge-neutral"};function l(e){let{label:n,variant:t="neutral"}=e;return(0,a.jsx)("span",{className:"badge ".concat(s[t]||s.neutral),children:n})}function r(e){return({pendente:"warning",confirmado:"info",preparando:"info",pronto:"info",coletado:"info",em_entrega:"warning",entregue:"success",cancelado:"danger",recusado:"danger",ativo:"success",inativo:"neutral",bloqueado:"danger",online:"success",offline:"neutral",aprovado:"success",reprovado:"danger",pago:"success",pendente_pagamento:"warning",processando:"info",aberto:"warning",resolvido:"success",fechado:"neutral"})[e]||"neutral"}},6939:function(e,n,t){"use strict";t.d(n,{Z:function(){return r}});var a=t(7437),s=t(6971);let l={success:"&#10003;",error:"&#10007;",warning:"&#9888;",info:"&#8505;"};function r(){let{toasts:e,removeToast:n}=(0,s.l)();return 0===e.length?null:(0,a.jsx)("div",{className:"toast-container",children:e.map(e=>(0,a.jsxs)("div",{className:"toast toast-".concat(e.type),children:[(0,a.jsx)("span",{className:"toast-icon",dangerouslySetInnerHTML:{__html:l[e.type]||l.info}}),(0,a.jsx)("span",{className:"toast-message",children:e.message}),(0,a.jsx)("button",{className:"toast-close",onClick:()=>n(e.id),children:"âœ•"})]},e.id))})}},6197:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return v}});var a=t(7437),s=t(2265),l=t(5775),r=t.n(l),i=t(8779),d=t(4477),o=t(4445),c=t(1656),u=t(6939),f=t(8789),p=t(6971),m=t(6428);let h=r()(()=>Promise.all([t.e(4212),t.e(9305)]).then(t.bind(t,9305)).then(e=>({default:e.MapContainer})),{loadableGenerated:{webpack:()=>[9305]},ssr:!1,loading:()=>null}),g=r()(()=>Promise.all([t.e(4212),t.e(9305)]).then(t.bind(t,9305)).then(e=>({default:e.TileLayer})),{loadableGenerated:{webpack:()=>[9305]},ssr:!1,loading:()=>null}),x=r()(()=>Promise.all([t.e(4212),t.e(9305)]).then(t.bind(t,9305)).then(e=>({default:e.Marker})),{loadableGenerated:{webpack:()=>[9305]},ssr:!1,loading:()=>null}),j=r()(()=>Promise.all([t.e(4212),t.e(9305)]).then(t.bind(t,9305)).then(e=>({default:e.Popup})),{loadableGenerated:{webpack:()=>[9305]},ssr:!1,loading:()=>null});function b(){let{collapsed:e}=(0,f.A)(),{error:n}=(0,p.l)(),[t,l]=(0,s.useState)([]),[r,i]=(0,s.useState)(!0),[o,b]=(0,s.useState)(null),[v,y]=(0,s.useState)(!1),N=(0,s.useRef)(null);(0,s.useEffect)(()=>{{let e=document.createElement("link");e.rel="stylesheet",e.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(e),y(!0)}},[]),(0,s.useEffect)(()=>(_(),N.current=setInterval(_,2e4),()=>{N.current&&clearInterval(N.current)}),[]);let _=async()=>{try{let e=await (0,m.SC)("/tracking.php?active=1&with_location=1");l(e.deliveries||e.entregas||e.data||[])}catch(e){n("Erro ao carregar mapa")}finally{i(!1)}},w=e=>({confirmado:"#3b82f6",preparando:"#f97316",pronto:"#8b5cf6",coletado:"#06b6d4",em_entrega:"#22c55e"})[e]||"#94a3b8";return(0,a.jsxs)("div",{className:"admin-layout",children:[(0,a.jsx)(d.Z,{}),(0,a.jsxs)("main",{className:"admin-main ".concat(e?"main-collapsed":""),children:[(0,a.jsxs)("div",{className:"page-header",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"page-title",children:"Mapa de Entregas"}),(0,a.jsxs)("p",{className:"page-subtitle",children:[t.length," entregas ativas no mapa"]})]}),(0,a.jsx)("div",{className:"page-actions",children:(0,a.jsx)("button",{className:"btn btn-secondary",onClick:_,children:"Atualizar"})})]}),(0,a.jsx)("div",{className:"card",style:{padding:0,overflow:"hidden"},children:r?(0,a.jsx)("div",{className:"loading-spinner",style:{height:500,display:"flex",alignItems:"center",justifyContent:"center"}}):v?(0,a.jsx)("div",{style:{height:"calc(100vh - 200px)",minHeight:500},children:(0,a.jsxs)(h,{center:t.length>0&&t[0].lat?[Number(t[0].lat),Number(t[0].lng)]:[-23.5505,-46.6333],zoom:13,style:{height:"100%",width:"100%"},children:[(0,a.jsx)(g,{attribution:"\xa9 OpenStreetMap",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),t.filter(e=>e.lat&&e.lng).map(e=>(0,a.jsx)(x,{position:[Number(e.lat),Number(e.lng)],children:(0,a.jsx)(j,{children:(0,a.jsxs)("div",{style:{minWidth:200,color:"#1e293b"},children:[(0,a.jsxs)("strong",{children:["Pedido #",e.id||e.order_id]}),(0,a.jsx)("div",{style:{margin:"4px 0"},children:(0,a.jsx)("span",{style:{fontSize:"0.75rem",padding:"2px 6px",borderRadius:4,background:w(e.status),color:"#fff"},children:e.status})}),(0,a.jsxs)("div",{style:{fontSize:"0.8rem",marginTop:4},children:[(0,a.jsxs)("div",{children:["Cliente: ",e.cliente_nome||e.customer_name||"-"]}),(0,a.jsxs)("div",{children:["Shopper: ",e.shopper_nome||e.shopper_name||"-"]}),(0,a.jsxs)("div",{children:["Parceiro: ",e.parceiro_nome||e.partner_name||"-"]})]})]})})},e.id||e.order_id))]})}):(0,a.jsx)("div",{style:{height:500,display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-muted)"},children:"Carregando mapa..."})}),o&&(0,a.jsxs)("div",{className:"card mt-4",children:[(0,a.jsxs)("h3",{className:"card-title",children:["Detalhes do Pedido #",o.id||o.order_id]}),(0,a.jsxs)("div",{className:"detail-grid",children:[(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Status"}),(0,a.jsx)(c.Z,{label:o.status,variant:(0,c.X)(o.status)})]}),(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Cliente"}),(0,a.jsx)("span",{className:"detail-value",children:o.cliente_nome||o.customer_name})]}),(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Shopper"}),(0,a.jsx)("span",{className:"detail-value",children:o.shopper_nome||o.shopper_name})]})]})]}),(0,a.jsxs)("div",{className:"card mt-4",children:[(0,a.jsx)("h3",{className:"card-title mb-4",children:"Legenda"}),(0,a.jsx)("div",{className:"flex gap-4",style:{flexWrap:"wrap"},children:["confirmado","preparando","pronto","coletado","em_entrega"].map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{style:{width:12,height:12,borderRadius:"50%",background:w(e),display:"inline-block"}}),(0,a.jsx)("span",{className:"text-sm",children:e})]},e))})]})]}),(0,a.jsx)(u.Z,{})]})}function v(){return(0,a.jsx)(i.Z,{children:(0,a.jsx)(o.Z,{section:"tracking",children:(0,a.jsx)(b,{})})})}},5775:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return l}});let a=t(7043);t(7437),t(2265);let s=a._(t(5602));function l(e,n){var t;let a={loading:e=>{let{error:n,isLoading:t,pastDelay:a}=e;return null}};"function"==typeof e&&(a.loader=e);let l={...a,...n};return(0,s.default)({...l,modules:null==(t=l.loadableGenerated)?void 0:t.modules})}("function"==typeof n.default||"object"==typeof n.default&&null!==n.default)&&void 0===n.default.__esModule&&(Object.defineProperty(n.default,"__esModule",{value:!0}),Object.assign(n.default,n),e.exports=n.default)},1523:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"BailoutToCSR",{enumerable:!0,get:function(){return s}});let a=t(8993);function s(e){let{reason:n,children:t}=e;if("undefined"==typeof window)throw new a.BailoutToCSRError(n);return t}},5602:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return o}});let a=t(7437),s=t(2265),l=t(1523),r=t(49);function i(e){return{default:e&&"default"in e?e.default:e}}let d={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},o=function(e){let n={...d,...e},t=(0,s.lazy)(()=>n.loader().then(i)),o=n.loading;function c(e){let i=o?(0,a.jsx)(o,{isLoading:!0,pastDelay:!0,error:null}):null,d=n.ssr?(0,a.jsxs)(a.Fragment,{children:["undefined"==typeof window?(0,a.jsx)(r.PreloadCss,{moduleIds:n.modules}):null,(0,a.jsx)(t,{...e})]}):(0,a.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,a.jsx)(t,{...e})});return(0,a.jsx)(s.Suspense,{fallback:i,children:d})}return c.displayName="LoadableComponent",c}},49:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"PreloadCss",{enumerable:!0,get:function(){return l}});let a=t(7437),s=t(544);function l(e){let{moduleIds:n}=e;if("undefined"!=typeof window)return null;let t=(0,s.getExpectedRequestStore)("next/dynamic css"),l=[];if(t.reactLoadableManifest&&n){let e=t.reactLoadableManifest;for(let t of n){if(!e[t])continue;let n=e[t].files.filter(e=>e.endsWith(".css"));l.push(...n)}}return 0===l.length?null:(0,a.jsx)(a.Fragment,{children:l.map(e=>(0,a.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:t.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}}},function(e){e.O(0,[3448,1006,2971,2117,1744],function(){return e(e.s=6326)}),_N_E=e.O()}]);
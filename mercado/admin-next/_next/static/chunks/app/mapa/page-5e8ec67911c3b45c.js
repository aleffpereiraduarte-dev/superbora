(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7900],{6326:function(e,n,a){Promise.resolve().then(a.bind(a,6197))},4445:function(e,n,a){"use strict";a.d(n,{Z:function(){return s}});var t=a(7437),l=a(8253);function s(e){let{section:n,children:a}=e,{hasPermission:s}=(0,l.q)();return s(n)?(0,t.jsx)(t.Fragment,{children:a}):(0,t.jsxs)("div",{className:"role-denied",children:[(0,t.jsx)("div",{className:"role-denied-icon",children:"\uD83D\uDD12"}),(0,t.jsx)("h2",{children:"Acesso Negado"}),(0,t.jsx)("p",{children:"Voce nao tem permissao para acessar esta secao."}),(0,t.jsx)("p",{className:"role-denied-hint",children:"Contate o administrador para solicitar acesso."})]})}},1656:function(e,n,a){"use strict";a.d(n,{X:function(){return r},Z:function(){return s}});var t=a(7437);let l={success:"badge-success",warning:"badge-warning",danger:"badge-danger",info:"badge-info",neutral:"badge-neutral"};function s(e){let{label:n,variant:a="neutral"}=e;return(0,t.jsx)("span",{className:"badge ".concat(l[a]||l.neutral),children:n})}function r(e){return({pendente:"warning",confirmado:"info",preparando:"info",pronto:"info",coletado:"info",em_entrega:"warning",entregue:"success",cancelado:"danger",recusado:"danger",ativo:"success",inativo:"neutral",bloqueado:"danger",online:"success",offline:"neutral",aprovado:"success",reprovado:"danger",pago:"success",pendente_pagamento:"warning",processando:"info",aberto:"warning",resolvido:"success",fechado:"neutral"})[e]||"neutral"}},6197:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return v}});var t=a(7437),l=a(2265),s=a(5775),r=a.n(s),i=a(8779),d=a(4477),o=a(4445),c=a(1656),u=a(6939),f=a(8789),p=a(6971),h=a(6428);let m=r()(()=>Promise.all([a.e(4212),a.e(9305)]).then(a.bind(a,9305)).then(e=>({default:e.MapContainer})),{loadableGenerated:{webpack:()=>[9305]},ssr:!1,loading:()=>null}),g=r()(()=>Promise.all([a.e(4212),a.e(9305)]).then(a.bind(a,9305)).then(e=>({default:e.TileLayer})),{loadableGenerated:{webpack:()=>[9305]},ssr:!1,loading:()=>null}),x=r()(()=>Promise.all([a.e(4212),a.e(9305)]).then(a.bind(a,9305)).then(e=>({default:e.Marker})),{loadableGenerated:{webpack:()=>[9305]},ssr:!1,loading:()=>null}),j=r()(()=>Promise.all([a.e(4212),a.e(9305)]).then(a.bind(a,9305)).then(e=>({default:e.Popup})),{loadableGenerated:{webpack:()=>[9305]},ssr:!1,loading:()=>null});function b(){let{collapsed:e}=(0,f.A)(),{error:n}=(0,p.l)(),[a,s]=(0,l.useState)([]),[r,i]=(0,l.useState)(!0),[o,b]=(0,l.useState)(null),[v,y]=(0,l.useState)(!1),N=(0,l.useRef)(null);(0,l.useEffect)(()=>{{let e=document.createElement("link");e.rel="stylesheet",e.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(e),y(!0)}},[]),(0,l.useEffect)(()=>(_(),N.current=setInterval(_,2e4),()=>{N.current&&clearInterval(N.current)}),[_]);let _=(0,l.useCallback)(async()=>{try{let e=await (0,h.SC)("/tracking.php?active=1&with_location=1");s(e.deliveries||e.entregas||e.data||[])}catch(e){n("Erro ao carregar mapa")}finally{i(!1)}},[n]),w=e=>({confirmado:"#3b82f6",preparando:"#f97316",pronto:"#8b5cf6",coletado:"#06b6d4",em_entrega:"#22c55e"})[e]||"#94a3b8";return(0,t.jsxs)("div",{className:"admin-layout",children:[(0,t.jsx)(d.Z,{}),(0,t.jsxs)("main",{className:"admin-main ".concat(e?"main-collapsed":""),children:[(0,t.jsxs)("div",{className:"page-header",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"page-title",children:"Mapa de Entregas"}),(0,t.jsxs)("p",{className:"page-subtitle",children:[a.length," entregas ativas no mapa"]})]}),(0,t.jsx)("div",{className:"page-actions",children:(0,t.jsx)("button",{className:"btn btn-secondary",onClick:_,children:"Atualizar"})})]}),(0,t.jsx)("div",{className:"card",style:{padding:0,overflow:"hidden"},children:r?(0,t.jsx)("div",{className:"loading-spinner",style:{height:500,display:"flex",alignItems:"center",justifyContent:"center"}}):v?(0,t.jsx)("div",{style:{height:"calc(100vh - 200px)",minHeight:500},children:(0,t.jsxs)(m,{center:a.length>0&&a[0].lat?[Number(a[0].lat),Number(a[0].lng)]:[-23.5505,-46.6333],zoom:13,style:{height:"100%",width:"100%"},children:[(0,t.jsx)(g,{attribution:"\xa9 OpenStreetMap",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),a.filter(e=>e.lat&&e.lng).map(e=>(0,t.jsx)(x,{position:[Number(e.lat),Number(e.lng)],children:(0,t.jsx)(j,{children:(0,t.jsxs)("div",{style:{minWidth:200,color:"#1e293b"},children:[(0,t.jsxs)("strong",{children:["Pedido #",e.id||e.order_id]}),(0,t.jsx)("div",{style:{margin:"4px 0"},children:(0,t.jsx)("span",{style:{fontSize:"0.75rem",padding:"2px 6px",borderRadius:4,background:w(e.status),color:"#fff"},children:e.status})}),(0,t.jsxs)("div",{style:{fontSize:"0.8rem",marginTop:4},children:[(0,t.jsxs)("div",{children:["Cliente: ",e.cliente_nome||e.customer_name||"-"]}),(0,t.jsxs)("div",{children:["Shopper: ",e.shopper_nome||e.shopper_name||"-"]}),(0,t.jsxs)("div",{children:["Parceiro: ",e.parceiro_nome||e.partner_name||"-"]})]})]})})},e.id||e.order_id))]})}):(0,t.jsx)("div",{style:{height:500,display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-muted)"},children:"Carregando mapa..."})}),o&&(0,t.jsxs)("div",{className:"card mt-4",children:[(0,t.jsxs)("h3",{className:"card-title",children:["Detalhes do Pedido #",o.id||o.order_id]}),(0,t.jsxs)("div",{className:"detail-grid",children:[(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Status"}),(0,t.jsx)(c.Z,{label:o.status,variant:(0,c.X)(o.status)})]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Cliente"}),(0,t.jsx)("span",{className:"detail-value",children:o.cliente_nome||o.customer_name})]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Shopper"}),(0,t.jsx)("span",{className:"detail-value",children:o.shopper_nome||o.shopper_name})]})]})]}),(0,t.jsxs)("div",{className:"card mt-4",children:[(0,t.jsx)("h3",{className:"card-title mb-4",children:"Legenda"}),(0,t.jsx)("div",{className:"flex gap-4",style:{flexWrap:"wrap"},children:["confirmado","preparando","pronto","coletado","em_entrega"].map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{style:{width:12,height:12,borderRadius:"50%",background:w(e),display:"inline-block"}}),(0,t.jsx)("span",{className:"text-sm",children:e})]},e))})]})]}),(0,t.jsx)(u.Z,{})]})}function v(){return(0,t.jsx)(i.Z,{children:(0,t.jsx)(o.Z,{section:"tracking",children:(0,t.jsx)(b,{})})})}},5775:function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return s}});let t=a(7043);a(7437),a(2265);let l=t._(a(5602));function s(e,n){var a;let t={loading:e=>{let{error:n,isLoading:a,pastDelay:t}=e;return null}};"function"==typeof e&&(t.loader=e);let s={...t,...n};return(0,l.default)({...s,modules:null==(a=s.loadableGenerated)?void 0:a.modules})}("function"==typeof n.default||"object"==typeof n.default&&null!==n.default)&&void 0===n.default.__esModule&&(Object.defineProperty(n.default,"__esModule",{value:!0}),Object.assign(n.default,n),e.exports=n.default)},1523:function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"BailoutToCSR",{enumerable:!0,get:function(){return l}});let t=a(8993);function l(e){let{reason:n,children:a}=e;if("undefined"==typeof window)throw new t.BailoutToCSRError(n);return a}},5602:function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return o}});let t=a(7437),l=a(2265),s=a(1523),r=a(49);function i(e){return{default:e&&"default"in e?e.default:e}}let d={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},o=function(e){let n={...d,...e},a=(0,l.lazy)(()=>n.loader().then(i)),o=n.loading;function c(e){let i=o?(0,t.jsx)(o,{isLoading:!0,pastDelay:!0,error:null}):null,d=n.ssr?(0,t.jsxs)(t.Fragment,{children:["undefined"==typeof window?(0,t.jsx)(r.PreloadCss,{moduleIds:n.modules}):null,(0,t.jsx)(a,{...e})]}):(0,t.jsx)(s.BailoutToCSR,{reason:"next/dynamic",children:(0,t.jsx)(a,{...e})});return(0,t.jsx)(l.Suspense,{fallback:i,children:d})}return c.displayName="LoadableComponent",c}},49:function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"PreloadCss",{enumerable:!0,get:function(){return s}});let t=a(7437),l=a(544);function s(e){let{moduleIds:n}=e;if("undefined"!=typeof window)return null;let a=(0,l.getExpectedRequestStore)("next/dynamic css"),s=[];if(a.reactLoadableManifest&&n){let e=a.reactLoadableManifest;for(let a of n){if(!e[a])continue;let n=e[a].files.filter(e=>e.endsWith(".css"));s.push(...n)}}return 0===s.length?null:(0,t.jsx)(t.Fragment,{children:s.map(e=>(0,t.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:a.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}}},function(e){e.O(0,[3448,5783,2971,2117,1744],function(){return e(e.s=6326)}),_N_E=e.O()}]);
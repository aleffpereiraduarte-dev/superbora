(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1931],{8230:function(e,a,s){Promise.resolve().then(s.bind(s,434))},4445:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});var n=s(7437),r=s(8253);function t(e){let{section:a,children:s}=e,{hasPermission:t}=(0,r.q)();return t(a)?(0,n.jsx)(n.Fragment,{children:s}):(0,n.jsxs)("div",{className:"role-denied",children:[(0,n.jsx)("div",{className:"role-denied-icon",children:"\uD83D\uDD12"}),(0,n.jsx)("h2",{children:"Acesso Negado"}),(0,n.jsx)("p",{children:"Voce nao tem permissao para acessar esta secao."}),(0,n.jsx)("p",{className:"role-denied-hint",children:"Contate o administrador para solicitar acesso."})]})}},1656:function(e,a,s){"use strict";s.d(a,{X:function(){return l},Z:function(){return t}});var n=s(7437);let r={success:"badge-success",warning:"badge-warning",danger:"badge-danger",info:"badge-info",neutral:"badge-neutral"};function t(e){let{label:a,variant:s="neutral"}=e;return(0,n.jsx)("span",{className:"badge ".concat(r[s]||r.neutral),children:a})}function l(e){return({pendente:"warning",confirmado:"info",preparando:"info",pronto:"info",coletado:"info",em_entrega:"warning",entregue:"success",cancelado:"danger",recusado:"danger",ativo:"success",inativo:"neutral",bloqueado:"danger",online:"success",offline:"neutral",aprovado:"success",reprovado:"danger",pago:"success",pendente_pagamento:"warning",processando:"info",aberto:"warning",resolvido:"success",fechado:"neutral"})[e]||"neutral"}},3197:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});var n=s(7437);function r(e){let{icon:a,label:s,value:r,change:t,color:l="#f97316"}=e,i=t&&parseFloat(t)>=0;return(0,n.jsxs)("div",{className:"stats-card",style:{borderTopColor:l},children:[(0,n.jsxs)("div",{className:"stats-card-header",children:[(0,n.jsx)("span",{className:"stats-card-icon",style:{color:l},dangerouslySetInnerHTML:{__html:a||"&#128202;"}}),(0,n.jsx)("span",{className:"stats-card-label",children:s})]}),(0,n.jsx)("div",{className:"stats-card-value",children:null!=r?r:"-"}),null!=t&&(0,n.jsxs)("div",{className:"stats-card-change ".concat(i?"change-positive":"change-negative"),children:[i?"&#9650;":"&#9660;"," ",t,"%"]})]})}},6939:function(e,a,s){"use strict";s.d(a,{Z:function(){return l}});var n=s(7437),r=s(6971);let t={success:"&#10003;",error:"&#10007;",warning:"&#9888;",info:"&#8505;"};function l(){let{toasts:e,removeToast:a}=(0,r.l)();return 0===e.length?null:(0,n.jsx)("div",{className:"toast-container",children:e.map(e=>(0,n.jsxs)("div",{className:"toast toast-".concat(e.type),children:[(0,n.jsx)("span",{className:"toast-icon",dangerouslySetInnerHTML:{__html:t[e.type]||t.info}}),(0,n.jsx)("span",{className:"toast-message",children:e.message}),(0,n.jsx)("button",{className:"toast-close",onClick:()=>a(e.id),children:"âœ•"})]},e.id))})}},434:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return g}});var n=s(7437),r=s(2265),t=s(8779),l=s(4477),i=s(4445),c=s(3197),d=s(6939),o=s(1656),u=s(8789),h=s(6971),x=s(6428);function m(){var e,a,t,i,m;let{collapsed:g}=(0,u.A)(),{alertCount:j}=(0,h.l)(),[v,b]=(0,r.useState)(null),[p,f]=(0,r.useState)(null),[N,_]=(0,r.useState)(null),[y,D]=(0,r.useState)([]),[C,R]=(0,r.useState)(!0),Z=(0,r.useRef)(null),k=(0,r.useRef)(null),S=(0,r.useRef)(null),w=(0,r.useRef)(null);(0,r.useEffect)(()=>{A()},[]);let A=async()=>{R(!0);try{let[e,a,s,n]=await Promise.allSettled([(0,x.SC)("/dashboard.php"),(0,x.SC)("/dashboard-chart.php?days=7"),(0,x.SC)("/dashboard-chart.php?type=revenue&days=30"),(0,x.SC)("/orders.php?limit=10&sort=recent")]);"fulfilled"===e.status&&b(e.value),"fulfilled"===a.status&&f(a.value),"fulfilled"===s.status&&_(s.value),"fulfilled"===n.status&&D(n.value.orders||n.value.data||[])}catch(e){}finally{R(!1)}};(0,r.useEffect)(()=>{if(!p||!Z.current)return;let e=!1;return Promise.all([s.e(7674),s.e(2153)]).then(s.bind(s,4084)).then(a=>{let{Chart:s,registerables:n}=a;if(e)return;s.register(...n),S.current&&S.current.destroy();let r=p.labels||p.dates||[],t=p.values||p.orders||[];S.current=new s(Z.current,{type:"line",data:{labels:r,datasets:[{label:"Pedidos",data:t,borderColor:"#f97316",backgroundColor:"rgba(249, 115, 22, 0.1)",fill:!0,tension:.4,pointRadius:4,pointBackgroundColor:"#f97316"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#94a3b8"}}},scales:{x:{ticks:{color:"#64748b"},grid:{color:"rgba(51,65,85,0.5)"}},y:{ticks:{color:"#64748b"},grid:{color:"rgba(51,65,85,0.5)"},beginAtZero:!0}}}})}),()=>{e=!0}},[p]),(0,r.useEffect)(()=>{if(!N||!k.current)return;let e=!1;return Promise.all([s.e(7674),s.e(2153)]).then(s.bind(s,4084)).then(a=>{let{Chart:s,registerables:n}=a;if(e)return;s.register(...n),w.current&&w.current.destroy();let r=N.labels||N.dates||[],t=N.values||N.revenue||[];w.current=new s(k.current,{type:"bar",data:{labels:r,datasets:[{label:"Receita (R$)",data:t,backgroundColor:"rgba(34, 197, 94, 0.6)",borderColor:"#22c55e",borderWidth:1,borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#94a3b8"}}},scales:{x:{ticks:{color:"#64748b"},grid:{color:"rgba(51,65,85,0.5)"}},y:{ticks:{color:"#64748b"},grid:{color:"rgba(51,65,85,0.5)"},beginAtZero:!0}}}})}),()=>{e=!0}},[N]),(0,r.useEffect)(()=>()=>{S.current&&S.current.destroy(),w.current&&w.current.destroy()},[]);let E=e=>null==e?"R$ 0,00":"R$ ".concat(Number(e).toLocaleString("pt-BR",{minimumFractionDigits:2}));return(0,n.jsxs)("div",{className:"admin-layout",children:[(0,n.jsx)(l.Z,{}),(0,n.jsxs)("main",{className:"admin-main ".concat(g?"main-collapsed":""),children:[(0,n.jsxs)("div",{className:"page-header",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"page-title",children:"Dashboard"}),(0,n.jsx)("p",{className:"page-subtitle",children:"Visao geral em tempo real"})]}),(0,n.jsx)("div",{className:"page-actions",children:(0,n.jsx)("button",{className:"btn btn-secondary",onClick:A,children:"Atualizar"})})]}),(0,n.jsxs)("div",{className:"stats-grid",children:[(0,n.jsx)(c.Z,{icon:"\uD83D\uDCE6",label:"Pedidos Hoje",value:C?"...":null!==(e=null==v?void 0:v.pedidos_hoje)&&void 0!==e?e:0,change:null==v?void 0:v.pedidos_change,color:"#f97316"}),(0,n.jsx)(c.Z,{icon:"\uD83D\uDCB0",label:"Receita Hoje",value:C?"...":E(null==v?void 0:v.receita_hoje),change:null==v?void 0:v.receita_change,color:"#22c55e"}),(0,n.jsx)(c.Z,{icon:"\uD83D\uDC64",label:"Clientes Ativos",value:C?"...":null!==(a=null==v?void 0:v.clientes_ativos)&&void 0!==a?a:0,change:null==v?void 0:v.clientes_change,color:"#3b82f6"}),(0,n.jsx)(c.Z,{icon:"\uD83D\uDEB6",label:"Shoppers Online",value:C?"...":null!==(t=null==v?void 0:v.shoppers_online)&&void 0!==t?t:0,color:"#8b5cf6"}),(0,n.jsx)(c.Z,{icon:"\uD83C\uDFAB",label:"Tickets Abertos",value:C?"...":null!==(i=null==v?void 0:v.tickets_abertos)&&void 0!==i?i:0,color:"#eab308"}),(0,n.jsx)(c.Z,{icon:"\uD83D\uDE9A",label:"Taxa Entrega",value:C?"...":"".concat(null!==(m=null==v?void 0:v.taxa_entrega)&&void 0!==m?m:0,"%"),change:null==v?void 0:v.taxa_change,color:"#06b6d4"})]}),(0,n.jsxs)("div",{className:"grid-2 mb-6",children:[(0,n.jsxs)("div",{className:"chart-container",children:[(0,n.jsx)("div",{className:"card-header",children:(0,n.jsx)("h3",{className:"card-title",children:"Pedidos - Ultimos 7 dias"})}),(0,n.jsx)("div",{style:{height:280},children:(0,n.jsx)("canvas",{ref:Z})})]}),(0,n.jsxs)("div",{className:"chart-container",children:[(0,n.jsx)("div",{className:"card-header",children:(0,n.jsx)("h3",{className:"card-title",children:"Receita - Ultimos 30 dias"})}),(0,n.jsx)("div",{style:{height:280},children:(0,n.jsx)("canvas",{ref:k})})]})]}),(0,n.jsxs)("div",{className:"card",children:[(0,n.jsxs)("div",{className:"card-header",children:[(0,n.jsx)("h3",{className:"card-title",children:"Pedidos Recentes"}),j>0&&(0,n.jsxs)("span",{className:"badge badge-danger",children:[j," alertas ativos"]})]}),(0,n.jsx)("div",{className:"datatable-wrapper",children:(0,n.jsxs)("table",{className:"datatable-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"ID"}),(0,n.jsx)("th",{children:"Cliente"}),(0,n.jsx)("th",{children:"Parceiro"}),(0,n.jsx)("th",{children:"Total"}),(0,n.jsx)("th",{children:"Status"}),(0,n.jsx)("th",{children:"Data"})]})}),(0,n.jsx)("tbody",{children:C?[void 0,void 0,void 0,void 0,void 0].map((e,a)=>(0,n.jsx)("tr",{children:[...Array(6)].map((e,a)=>(0,n.jsx)("td",{children:(0,n.jsx)("div",{className:"skeleton-cell",style:{height:14,borderRadius:4}})},a))},a)):0===y.length?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:6,className:"datatable-empty",children:"Nenhum pedido recente"})}):y.slice(0,10).map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsxs)("strong",{children:["#",e.id||e.order_id]})}),(0,n.jsx)("td",{children:e.cliente_nome||e.customer_name||"-"}),(0,n.jsx)("td",{children:e.parceiro_nome||e.partner_name||"-"}),(0,n.jsx)("td",{children:E(e.total)}),(0,n.jsx)("td",{children:(0,n.jsx)(o.Z,{label:e.status||"pendente",variant:(0,o.X)(e.status)})}),(0,n.jsx)("td",{className:"text-muted",children:e.created_at||e.data||"-"})]},e.id||e.order_id))})]})})]})]}),(0,n.jsx)(d.Z,{})]})}function g(){return(0,n.jsx)(t.Z,{children:(0,n.jsx)(i.Z,{section:"dashboard",children:(0,n.jsx)(m,{})})})}}},function(e){e.O(0,[3448,1006,2971,2117,1744],function(){return e(e.s=8230)}),_N_E=e.O()}]);
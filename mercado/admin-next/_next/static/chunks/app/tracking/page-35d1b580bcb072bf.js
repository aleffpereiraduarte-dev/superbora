(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[864],{2526:function(e,n,a){Promise.resolve().then(a.bind(a,6867))},4445:function(e,n,a){"use strict";a.d(n,{Z:function(){return t}});var r=a(7437),s=a(8253);function t(e){let{section:n,children:a}=e,{hasPermission:t}=(0,s.q)();return t(n)?(0,r.jsx)(r.Fragment,{children:a}):(0,r.jsxs)("div",{className:"role-denied",children:[(0,r.jsx)("div",{className:"role-denied-icon",children:"\uD83D\uDD12"}),(0,r.jsx)("h2",{children:"Acesso Negado"}),(0,r.jsx)("p",{children:"Voce nao tem permissao para acessar esta secao."}),(0,r.jsx)("p",{className:"role-denied-hint",children:"Contate o administrador para solicitar acesso."})]})}},1656:function(e,n,a){"use strict";a.d(n,{X:function(){return c},Z:function(){return t}});var r=a(7437);let s={success:"badge-success",warning:"badge-warning",danger:"badge-danger",info:"badge-info",neutral:"badge-neutral"};function t(e){let{label:n,variant:a="neutral"}=e;return(0,r.jsx)("span",{className:"badge ".concat(s[a]||s.neutral),children:n})}function c(e){return({pendente:"warning",confirmado:"info",preparando:"info",pronto:"info",coletado:"info",em_entrega:"warning",entregue:"success",cancelado:"danger",recusado:"danger",ativo:"success",inativo:"neutral",bloqueado:"danger",online:"success",offline:"neutral",aprovado:"success",reprovado:"danger",pago:"success",pendente_pagamento:"warning",processando:"info",aberto:"warning",resolvido:"success",fechado:"neutral"})[e]||"neutral"}},6867:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return m}});var r=a(7437),s=a(2265),t=a(8779),c=a(4477),i=a(4445),d=a(1656),l=a(6939),o=a(8789),h=a(6971),u=a(6428);function x(){let{collapsed:e}=(0,o.A)(),{error:n}=(0,h.l)(),[a,t]=(0,s.useState)([]),[i,x]=(0,s.useState)(!0),[m,p]=(0,s.useState)(""),[j,g]=(0,s.useState)(!0),f=(0,s.useRef)(null);(0,s.useEffect)(()=>{v()},[m]),(0,s.useEffect)(()=>(j&&(f.current=setInterval(v,15e3)),()=>{f.current&&clearInterval(f.current)}),[j,v]);let v=(0,s.useCallback)(async()=>{try{let e=new URLSearchParams;m&&e.set("status",m),e.set("active","1");let n=e.toString()?"?".concat(e.toString()):"",a=await (0,u.SC)("/tracking.php".concat(n));t(a.deliveries||a.entregas||a.data||[])}catch(e){n("Erro ao carregar entregas ativas")}finally{x(!1)}},[m,n]),b=e=>{if(!e)return"-";let n=new Date(e),a=Math.floor((new Date-n)/6e4);return a<60?"".concat(a,"min"):"".concat(Math.floor(a/60),"h ").concat(a%60,"min")};return(0,r.jsxs)("div",{className:"admin-layout",children:[(0,r.jsx)(c.Z,{}),(0,r.jsxs)("main",{className:"admin-main ".concat(e?"main-collapsed":""),children:[(0,r.jsxs)("div",{className:"page-header",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"page-title",children:"Tracking de Entregas"}),(0,r.jsxs)("p",{className:"page-subtitle",children:["Entregas ativas em tempo real - ",a.length," entregas"]})]}),(0,r.jsxs)("div",{className:"page-actions",children:[(0,r.jsxs)("label",{className:"flex items-center gap-2",style:{cursor:"pointer",fontSize:"0.875rem",color:"var(--text-muted)"},children:[(0,r.jsx)("input",{type:"checkbox",checked:j,onChange:e=>g(e.target.checked)}),"Auto-refresh 15s"]}),(0,r.jsx)("button",{className:"btn btn-secondary",onClick:v,children:"Atualizar"})]})]}),(0,r.jsx)("div",{className:"filters-bar",children:(0,r.jsxs)("select",{className:"form-select",value:m,onChange:e=>p(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"Todos Status"}),(0,r.jsx)("option",{value:"confirmado",children:"Confirmado"}),(0,r.jsx)("option",{value:"preparando",children:"Preparando"}),(0,r.jsx)("option",{value:"pronto",children:"Pronto"}),(0,r.jsx)("option",{value:"coletado",children:"Coletado"}),(0,r.jsx)("option",{value:"em_entrega",children:"Em Entrega"})]})}),i?(0,r.jsx)("div",{className:"loading-spinner"}):0===a.length?(0,r.jsx)("div",{className:"card",style:{textAlign:"center",padding:"3rem"},children:(0,r.jsx)("p",{className:"text-muted",children:"Nenhuma entrega ativa no momento"})}):(0,r.jsx)("div",{className:"datatable-wrapper",children:(0,r.jsxs)("table",{className:"datatable-table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Pedido"}),(0,r.jsx)("th",{children:"Cliente"}),(0,r.jsx)("th",{children:"Shopper/Worker"}),(0,r.jsx)("th",{children:"Parceiro"}),(0,r.jsx)("th",{children:"Status"}),(0,r.jsx)("th",{children:"Tempo"}),(0,r.jsx)("th",{children:"Endereco"}),(0,r.jsx)("th",{children:"Acoes"})]})}),(0,r.jsx)("tbody",{children:a.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsxs)("strong",{children:["#",e.id||e.order_id]})}),(0,r.jsx)("td",{children:e.cliente_nome||e.customer_name||"-"}),(0,r.jsx)("td",{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:e.shopper_nome||e.shopper_name||e.worker_name||"-"}),e.shopper_phone&&(0,r.jsx)("small",{className:"text-muted",style:{display:"block"},children:e.shopper_phone})]})}),(0,r.jsx)("td",{children:e.parceiro_nome||e.partner_name||"-"}),(0,r.jsx)("td",{children:(0,r.jsx)(d.Z,{label:e.status||"em_entrega",variant:(0,d.X)(e.status||"em_entrega")})}),(0,r.jsx)("td",{children:(0,r.jsx)("span",{style:{color:b(e.started_at||e.created_at).includes("h")?"var(--danger)":"var(--warning)"},children:b(e.started_at||e.created_at)})}),(0,r.jsx)("td",{children:(0,r.jsx)("span",{className:"truncate",style:{maxWidth:180,display:"inline-block"},children:e.endereco||e.delivery_address||"-"})}),(0,r.jsx)("td",{children:(0,r.jsx)("a",{href:"/pedidos/detalhe?id=".concat(e.id||e.order_id),className:"btn btn-sm btn-secondary",children:"Ver Pedido"})})]},e.id||e.order_id))})]})})]}),(0,r.jsx)(l.Z,{})]})}function m(){return(0,r.jsx)(t.Z,{children:(0,r.jsx)(i.Z,{section:"tracking",children:(0,r.jsx)(x,{})})})}}},function(e){e.O(0,[3448,5783,2971,2117,1744],function(){return e(e.s=2526)}),_N_E=e.O()}]);
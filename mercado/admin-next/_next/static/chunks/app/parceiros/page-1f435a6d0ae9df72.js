(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[329],{838:function(e,a,n){Promise.resolve().then(n.bind(n,1598))},4445:function(e,a,n){"use strict";n.d(a,{Z:function(){return r}});var s=n(7437),t=n(8253);function r(e){let{section:a,children:n}=e,{hasPermission:r}=(0,t.q)();return r(a)?(0,s.jsx)(s.Fragment,{children:n}):(0,s.jsxs)("div",{className:"role-denied",children:[(0,s.jsx)("div",{className:"role-denied-icon",children:"\uD83D\uDD12"}),(0,s.jsx)("h2",{children:"Acesso Negado"}),(0,s.jsx)("p",{children:"Voce nao tem permissao para acessar esta secao."}),(0,s.jsx)("p",{className:"role-denied-hint",children:"Contate o administrador para solicitar acesso."})]})}},1656:function(e,a,n){"use strict";n.d(a,{X:function(){return l},Z:function(){return r}});var s=n(7437);let t={success:"badge-success",warning:"badge-warning",danger:"badge-danger",info:"badge-info",neutral:"badge-neutral"};function r(e){let{label:a,variant:n="neutral"}=e;return(0,s.jsx)("span",{className:"badge ".concat(t[n]||t.neutral),children:a})}function l(e){return({pendente:"warning",confirmado:"info",preparando:"info",pronto:"info",coletado:"info",em_entrega:"warning",entregue:"success",cancelado:"danger",recusado:"danger",ativo:"success",inativo:"neutral",bloqueado:"danger",online:"success",offline:"neutral",aprovado:"success",reprovado:"danger",pago:"success",pendente_pagamento:"warning",processando:"info",aberto:"warning",resolvido:"success",fechado:"neutral"})[e]||"neutral"}},9531:function(e,a,n){"use strict";n.d(a,{Z:function(){return c}});var s=n(7437),t=n(2265);function r(e){let{value:a,onChange:n,placeholder:r="Buscar...",delay:l=300}=e,[c,i]=(0,t.useState)(a||""),o=(0,t.useRef)(null);return(0,t.useEffect)(()=>{i(a||"")},[a]),(0,s.jsxs)("div",{className:"search-input-wrapper",children:[(0,s.jsx)("span",{className:"search-input-icon",children:"\uD83D\uDD0D"}),(0,s.jsx)("input",{type:"text",className:"search-input",value:c,onChange:e=>{let a=e.target.value;i(a),o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{null==n||n(a)},l)},placeholder:r}),c&&(0,s.jsx)("button",{className:"search-input-clear",onClick:()=>{i(""),null==n||n("")},children:"✕"})]})}function l(e){let{page:a,totalPages:n,onPageChange:t}=e,r=[],l=Math.max(1,a-Math.floor(2.5)),c=Math.min(n,l+5-1);c-l<4&&(l=Math.max(1,c-5+1));for(let e=l;e<=c;e++)r.push(e);return(0,s.jsxs)("div",{className:"pagination",children:[(0,s.jsx)("button",{className:"pagination-btn",disabled:a<=1,onClick:()=>t(a-1),children:"‹ Anterior"}),l>1&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{className:"pagination-btn",onClick:()=>t(1),children:"1"}),l>2&&(0,s.jsx)("span",{className:"pagination-dots",children:"..."})]}),r.map(e=>(0,s.jsx)("button",{className:"pagination-btn ".concat(e===a?"pagination-active":""),onClick:()=>t(e),children:e},e)),c<n&&(0,s.jsxs)(s.Fragment,{children:[c<n-1&&(0,s.jsx)("span",{className:"pagination-dots",children:"..."}),(0,s.jsx)("button",{className:"pagination-btn",onClick:()=>t(n),children:n})]}),(0,s.jsx)("button",{className:"pagination-btn",disabled:a>=n,onClick:()=>t(a+1),children:"Proximo ›"})]})}function c(e){let{columns:a=[],data:n=[],loading:c=!1,searchable:i=!0,pageSize:o=15,emptyMessage:d="Nenhum registro encontrado",onRowClick:u}=e,[m,h]=(0,t.useState)(""),[p,x]=(0,t.useState)(null),[j,g]=(0,t.useState)("asc"),[b,v]=(0,t.useState)(1),f=(0,t.useMemo)(()=>{if(!m)return n;let e=m.toLowerCase();return n.filter(n=>a.some(a=>{let s=n[a.key];return null!=s&&String(s).toLowerCase().includes(e)}))},[n,m,a]),N=(0,t.useMemo)(()=>p?[...f].sort((e,a)=>{var n,s;let t=null!==(n=e[p])&&void 0!==n?n:"",r=null!==(s=a[p])&&void 0!==s?s:"";if("number"==typeof t&&"number"==typeof r)return"asc"===j?t-r:r-t;let l=String(t).localeCompare(String(r));return"asc"===j?l:-l}):f,[f,p,j]),y=Math.max(1,Math.ceil(N.length/o)),k=N.slice((b-1)*o,b*o),C=e=>{p===e?g(e=>"asc"===e?"desc":"asc"):(x(e),g("asc"))};return c?(0,s.jsxs)("div",{className:"datatable",children:[i&&(0,s.jsx)("div",{className:"datatable-toolbar",children:(0,s.jsx)(r,{value:"",onChange:()=>{},placeholder:"Buscar..."})}),(0,s.jsx)("div",{className:"datatable-skeleton",children:[void 0,void 0,void 0,void 0,void 0].map((e,n)=>(0,s.jsx)("div",{className:"skeleton-row",children:a.map((e,a)=>(0,s.jsx)("div",{className:"skeleton-cell"},a))},n))})]}):(0,s.jsxs)("div",{className:"datatable",children:[i&&(0,s.jsxs)("div",{className:"datatable-toolbar",children:[(0,s.jsx)(r,{value:m,onChange:e=>{h(e),v(1)},placeholder:"Buscar na tabela..."}),(0,s.jsxs)("span",{className:"datatable-count",children:[f.length," registro(s)"]})]}),(0,s.jsx)("div",{className:"datatable-wrapper",children:(0,s.jsxs)("table",{className:"datatable-table",children:[(0,s.jsx)("thead",{children:(0,s.jsx)("tr",{children:a.map(e=>(0,s.jsxs)("th",{onClick:()=>!1!==e.sortable&&C(e.key),className:!1!==e.sortable?"sortable":"",style:e.width?{width:e.width}:void 0,children:[e.label,p===e.key&&(0,s.jsx)("span",{className:"sort-indicator",children:"asc"===j?" ▲":" ▼"})]},e.key))})}),(0,s.jsx)("tbody",{children:0===k.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:a.length,className:"datatable-empty",children:d})}):k.map((e,n)=>(0,s.jsx)("tr",{onClick:()=>null==u?void 0:u(e),className:u?"clickable-row":"",children:a.map(a=>{var n;return(0,s.jsx)("td",{children:a.render?a.render(e[a.key],e):null!==(n=e[a.key])&&void 0!==n?n:"-"},a.key)})},e.id||n))})]})}),y>1&&(0,s.jsx)(l,{page:b,totalPages:y,onPageChange:v})]})}},7714:function(e,a,n){"use strict";n.d(a,{Z:function(){return l}});var s=n(7437),t=n(2265);let r={sm:"400px",md:"560px",lg:"720px",xl:"960px"};function l(e){let{isOpen:a,onClose:n,title:l,children:c,size:i="md"}=e;return((0,t.useEffect)(()=>(a?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[a]),(0,t.useEffect)(()=>{let e=e=>{"Escape"===e.key&&a&&(null==n||n())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[a,n]),a)?(0,s.jsx)("div",{className:"modal-overlay",onClick:n,children:(0,s.jsxs)("div",{className:"modal-container",style:{maxWidth:r[i]||r.md},onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"modal-header",children:[(0,s.jsx)("h3",{className:"modal-title",children:l}),(0,s.jsx)("button",{className:"modal-close",onClick:n,children:"✕"})]}),(0,s.jsx)("div",{className:"modal-body",children:c})]})}):null}},6939:function(e,a,n){"use strict";n.d(a,{Z:function(){return l}});var s=n(7437),t=n(6971);let r={success:"&#10003;",error:"&#10007;",warning:"&#9888;",info:"&#8505;"};function l(){let{toasts:e,removeToast:a}=(0,t.l)();return 0===e.length?null:(0,s.jsx)("div",{className:"toast-container",children:e.map(e=>(0,s.jsxs)("div",{className:"toast toast-".concat(e.type),children:[(0,s.jsx)("span",{className:"toast-icon",dangerouslySetInnerHTML:{__html:r[e.type]||r.info}}),(0,s.jsx)("span",{className:"toast-message",children:e.message}),(0,s.jsx)("button",{className:"toast-close",onClick:()=>a(e.id),children:"✕"})]},e.id))})}},1598:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return j}});var s=n(7437),t=n(2265),r=n(8779),l=n(4477),c=n(4445),i=n(9531),o=n(1656),d=n(7714),u=n(6939),m=n(8789),h=n(6971),p=n(6428);function x(){let{collapsed:e}=(0,m.A)(),{success:a,error:n}=(0,h.l)(),[r,c]=(0,t.useState)([]),[x,j]=(0,t.useState)(!0),[g,b]=(0,t.useState)("pendente"),[v,f]=(0,t.useState)(!1),[N,y]=(0,t.useState)(null),[k,C]=(0,t.useState)(""),[w,S]=(0,t.useState)(!1);(0,t.useEffect)(()=>{P()},[g]);let P=async()=>{j(!0);try{let e=new URLSearchParams;g&&e.set("status",g);let a=e.toString()?"?".concat(e.toString()):"",n=await (0,p.SC)("/parceiros.php".concat(a));c(n.partners||n.parceiros||n.data||[])}catch(e){n("Erro ao carregar parceiros")}finally{j(!1)}},_=async e=>{S(!0);try{await (0,p.sg)("/parceiros.php",{partner_id:e.id||e.partner_id,action:"approve"}),a("Parceiro aprovado com sucesso"),P()}catch(e){n("Erro: "+e.message)}finally{S(!1)}},E=async()=>{if(N){S(!0);try{await (0,p.sg)("/parceiros.php",{partner_id:N.id||N.partner_id,action:"reject",reason:k||void 0}),a("Parceiro rejeitado"),f(!1),y(null),C(""),P()}catch(e){n("Erro: "+e.message)}finally{S(!1)}}},Z=e=>{y(e),C(""),f(!0)},M=[{key:"id",label:"ID",render:(e,a)=>(0,s.jsxs)("strong",{children:["#",e||a.partner_id]})},{key:"name",label:"Nome",render:(e,a)=>e||a.nome||"-"},{key:"email",label:"Email"},{key:"phone",label:"Telefone",render:(e,a)=>e||a.telefone||"-"},{key:"cnpj",label:"CNPJ",render:e=>e||"-"},{key:"category",label:"Categoria",render:(e,a)=>(0,s.jsx)(o.Z,{label:e||a.categoria||"geral",variant:"info"})},{key:"city",label:"Cidade",render:(e,a)=>e||a.cidade||"-"},{key:"status",label:"Status",render:e=>(0,s.jsx)(o.Z,{label:e||"pendente",variant:(0,o.X)(e||"pendente")})},{key:"created_at",label:"Solicitado em",render:(e,a)=>e||a.data_cadastro||"-"},{key:"actions",label:"Acoes",sortable:!1,render:(e,a)=>(0,s.jsxs)("div",{className:"flex gap-2",children:["pendente"===a.status&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{className:"btn btn-sm btn-success",onClick:e=>{e.stopPropagation(),_(a)},disabled:w,children:"Aprovar"}),(0,s.jsx)("button",{className:"btn btn-sm btn-danger",onClick:e=>{e.stopPropagation(),Z(a)},children:"Rejeitar"})]}),"pendente"!==a.status&&(0,s.jsx)("span",{className:"text-sm text-muted",children:"Processado"})]})}];return(0,s.jsxs)("div",{className:"admin-layout",children:[(0,s.jsx)(l.Z,{}),(0,s.jsxs)("main",{className:"admin-main ".concat(e?"main-collapsed":""),children:[(0,s.jsxs)("div",{className:"page-header",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"page-title",children:"Parceiros"}),(0,s.jsx)("p",{className:"page-subtitle",children:"Aprovar e gerenciar solicitacoes de parceiros"})]}),(0,s.jsx)("div",{className:"page-actions",children:(0,s.jsx)("button",{className:"btn btn-secondary",onClick:P,children:"Atualizar"})})]}),(0,s.jsx)("div",{className:"filters-bar",children:(0,s.jsxs)("select",{className:"form-select",value:g,onChange:e=>b(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"Todos Status"}),(0,s.jsx)("option",{value:"pendente",children:"Pendente"}),(0,s.jsx)("option",{value:"aprovado",children:"Aprovado"}),(0,s.jsx)("option",{value:"reprovado",children:"Reprovado"})]})}),(0,s.jsx)(i.Z,{columns:M,data:r,loading:x,emptyMessage:"Nenhum parceiro encontrado"}),(0,s.jsx)(d.Z,{isOpen:v,onClose:()=>f(!1),title:"Rejeitar Parceiro",size:"sm",children:N&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mb-4",style:{padding:16,background:"var(--bg)",borderRadius:"var(--radius)",border:"1px solid var(--border)"},children:[(0,s.jsx)("strong",{children:N.name||N.nome}),(0,s.jsx)("p",{className:"text-sm text-muted mt-1",children:N.email}),(0,s.jsx)("p",{className:"text-sm text-muted",children:N.cnpj||"CNPJ nao informado"})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{className:"form-label",children:"Motivo da Rejeicao"}),(0,s.jsx)("textarea",{className:"form-textarea",value:k,onChange:e=>C(e.target.value),placeholder:"Informe o motivo...",rows:3})]}),(0,s.jsxs)("div",{className:"flex gap-2",style:{justifyContent:"flex-end"},children:[(0,s.jsx)("button",{className:"btn btn-secondary",onClick:()=>f(!1),children:"Cancelar"}),(0,s.jsx)("button",{className:"btn btn-danger",onClick:E,disabled:w,children:w?"Processando...":"Confirmar Rejeicao"})]})]})})]}),(0,s.jsx)(u.Z,{})]})}function j(){return(0,s.jsx)(r.Z,{children:(0,s.jsx)(c.Z,{section:"partners",children:(0,s.jsx)(x,{})})})}}},function(e){e.O(0,[3448,1006,2971,2117,1744],function(){return e(e.s=838)}),_N_E=e.O()}]);
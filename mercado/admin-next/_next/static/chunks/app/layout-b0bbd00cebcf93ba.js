(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{8536:function(t,e,n){Promise.resolve().then(n.t.bind(n,7960,23)),Promise.resolve().then(n.bind(n,4180))},6428:function(t,e,n){"use strict";n.d(e,{$V:function(){return c},LP:function(){return a},QW:function(){return d},SC:function(){return s},o4:function(){return i},pE:function(){return l},sg:function(){return u}});let r="/api/mercado/admin",o="admin_token";function a(){try{return localStorage.getItem(o)}catch(t){return null}}function i(t){try{t?localStorage.setItem(o,t):localStorage.removeItem(o)}catch(t){}}function c(){let t=a(),e={"Content-Type":"application/json"};return t&&(e.Authorization="Bearer ".concat(t)),e}async function s(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="".concat(r).concat(t),o=Object.entries(e).filter(t=>{let[,e]=t;return null!=e&&""!==e}).map(t=>{let[e,n]=t;return"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(n))}).join("&");o&&(n+="?".concat(o));let a=await fetch(n,{headers:c()});if(!a.ok)throw Error((await a.json().catch(()=>({message:"Erro de rede"}))).message||"HTTP ".concat(a.status));let i=await a.json();if(!1===i.success)throw Error(i.message||"Erro desconhecido");return void 0!==i.data?i.data:i}async function u(t,e){let n=await fetch("".concat(r).concat(t),{method:"POST",headers:c(),body:JSON.stringify(e)}),o=await n.json().catch(()=>null);if(!n.ok||o&&!1===o.success)throw Error((null==o?void 0:o.message)||"HTTP ".concat(n.status));return(null==o?void 0:o.data)!==void 0?o.data:o}async function l(t,e){let n=await fetch("".concat(r).concat(t),{method:"PUT",headers:c(),body:JSON.stringify(e)}),o=await n.json().catch(()=>null);if(!n.ok||o&&!1===o.success)throw Error((null==o?void 0:o.message)||"HTTP ".concat(n.status));return(null==o?void 0:o.data)!==void 0?o.data:o}async function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="".concat(r).concat(t),o=Object.entries(e).filter(t=>{let[,e]=t;return null!=e&&""!==e}).map(t=>{let[e,n]=t;return"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(n))}).join("&");o&&(n+="?".concat(o));let a=await fetch(n,{method:"DELETE",headers:c()}),i=await a.json().catch(()=>null);if(!a.ok||i&&!1===i.success)throw Error((null==i?void 0:i.message)||"HTTP ".concat(a.status));return(null==i?void 0:i.data)!==void 0?i.data:i}},7128:function(t,e,n){"use strict";n.d(e,{H:function(){return c},a:function(){return s}});var r=n(7437),o=n(2265),a=n(6428);let i=(0,o.createContext)(null);function c(t){let{children:e}=t,[n,c]=(0,o.useState)(null),[s,u]=(0,o.useState)(!0),l=(0,o.useCallback)(async()=>{if(!(0,a.LP)()){u(!1);return}try{let t=await (0,a.SC)("/auth/session.php");t.admin?c({...t.admin,name:t.admin.nome||t.admin.name,admin_id:t.admin.admin_id||t.admin.id}):((0,a.o4)(null),c(null))}catch(t){(0,a.o4)(null),c(null)}finally{u(!1)}},[]);(0,o.useEffect)(()=>{l()},[l]);let d=async(t,e)=>{let n=await (0,a.sg)("/auth/login.php",{email:t,senha:e});if(n.token)return(0,a.o4)(n.token),c({admin_id:n.admin_id,name:n.nome||n.name,email:n.email,role:n.role}),n;throw Error(n.message||"Erro ao fazer login")};return(0,r.jsx)(i.Provider,{value:{admin:n,loading:s,isAuthenticated:!!n,login:d,logout:()=>{(0,a.o4)(null),c(null)},checkSession:l},children:e})}function s(){let t=(0,o.useContext)(i);if(!t)throw Error("useAuth must be inside AuthProvider");return t}},6971:function(t,e,n){"use strict";n.d(e,{J:function(){return s},l:function(){return u}});var r=n(7437),o=n(2265),a=n(6428),i=n(7128);let c=(0,o.createContext)(null);function s(t){let{children:e}=t,{isAuthenticated:n}=(0,i.a)(),[s,u]=(0,o.useState)([]),[l,d]=(0,o.useState)([]),[f,h]=(0,o.useState)(0),m=(0,o.useRef)(0),p=(0,o.useRef)([]),g=(0,o.useCallback)(function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4e3,r=++m.current;if(u(n=>[...n,{id:r,message:t,type:e}]),n>0){let t=setTimeout(()=>{u(t=>t.filter(t=>t.id!==r))},n);p.current.push(t)}},[]),v=(0,o.useCallback)(t=>{u(e=>e.filter(e=>e.id!==t))},[]),k=(0,o.useCallback)(t=>g(t,"success"),[g]),w=(0,o.useCallback)(t=>g(t,"error"),[g]),b=(0,o.useCallback)(t=>g(t,"warning"),[g]),C=(0,o.useCallback)(t=>g(t,"info"),[g]),E=(0,o.useCallback)(async()=>{if(n)try{let t=await (0,a.SC)("/alertas.php");d(t.alertas||[]),h(t.total||0)}catch(t){}},[n]);return(0,o.useEffect)(()=>{if(!n)return;E();let t=setInterval(E,3e4);return()=>clearInterval(t)},[n,E]),(0,o.useEffect)(()=>()=>{p.current.forEach(t=>clearTimeout(t)),p.current=[]},[]),(0,r.jsx)(c.Provider,{value:{toasts:s,alerts:l,alertCount:f,addToast:g,removeToast:v,success:k,error:w,warning:b,info:C,fetchAlerts:E},children:e})}function u(){let t=(0,o.useContext)(c);if(!t)throw Error("useNotification must be inside NotificationProvider");return t}},8253:function(t,e,n){"use strict";n.d(e,{a:function(){return s},q:function(){return u}});var r=n(7437),o=n(2265),a=n(7128);let i=(0,o.createContext)(null),c={admin:["dashboard","orders","finance","clients","shoppers","workers","markets","partners","coupons","promotions","notifications","support","chat","alerts","intelligence","reports","kpis","logs","export","config","security","search","tracking","map","editor","dispatch","reviews","pricing","refunds","payments","commissions","subscriptions","corporate","stories","financial"],manager:["dashboard","orders","finance","clients","shoppers","workers","markets","partners","coupons","promotions","notifications","support","chat","alerts","intelligence","reports","kpis","logs","export","search","tracking","map","editor","dispatch","reviews","pricing","refunds","payments","commissions","subscriptions","corporate","stories","financial"],support:["dashboard","orders","clients","support","chat","search","reviews"]};function s(t){let{children:e}=t,{admin:n}=(0,a.a)(),s=(0,o.useMemo)(()=>{let t=(null==n?void 0:n.role)||"support",e=c[t]||c.support;return{role:t,permissions:e,hasPermission:t=>e.includes(t)}},[n]);return(0,r.jsx)(i.Provider,{value:s,children:e})}function u(){let t=(0,o.useContext)(i);if(!t)throw Error("useRole must be inside RoleProvider");return t}},8789:function(t,e,n){"use strict";n.d(e,{A:function(){return s},H:function(){return c}});var r=n(7437),o=n(2265);let a=(0,o.createContext)(null),i="admin_sidebar_collapsed";function c(t){let{children:e}=t,[n,c]=(0,o.useState)(()=>{try{let t=localStorage.getItem(i);return"true"===t}catch(t){}return!1});return(0,r.jsx)(a.Provider,{value:{collapsed:n,toggle:()=>{c(t=>{let e=!t;return localStorage.setItem(i,String(e)),e})}},children:e})}function s(){let t=(0,o.useContext)(a);if(!t)throw Error("useSidebar must be inside SidebarProvider");return t}},7885:function(t,e,n){"use strict";n.d(e,{F:function(){return c},f:function(){return i}});var r=n(7437),o=n(2265);let a=(0,o.createContext)(null);function i(t){let{children:e}=t,[n,i]=(0,o.useState)("dark");return(0,o.useEffect)(()=>{try{let t=localStorage.getItem("admin_theme");("light"===t||"dark"===t)&&i(t)}catch(t){}},[]),(0,o.useEffect)(()=>{document.documentElement.setAttribute("data-theme",n);try{localStorage.setItem("admin_theme",n)}catch(t){}},[n]),(0,r.jsx)(a.Provider,{value:{theme:n,toggleTheme:()=>i(t=>"dark"===t?"light":"dark"),isDark:"dark"===n},children:e})}let c=()=>(0,o.useContext)(a)},4180:function(t,e,n){"use strict";n.d(e,{default:function(){return u}});var r=n(7437),o=n(7128),a=n(8253),i=n(8789),c=n(6971),s=n(7885);function u(t){let{children:e}=t;return(0,r.jsx)(o.H,{children:(0,r.jsx)(s.f,{children:(0,r.jsx)(a.a,{children:(0,r.jsx)(i.H,{children:(0,r.jsx)(c.J,{children:e})})})})})}},7960:function(){}},function(t){t.O(0,[3587,2971,2117,1744],function(){return t(t.s=8536)}),_N_E=t.O()}]);
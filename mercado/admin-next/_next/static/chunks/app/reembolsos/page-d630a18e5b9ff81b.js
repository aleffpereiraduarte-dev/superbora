(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5929],{6471:function(e,a,s){Promise.resolve().then(s.bind(s,3436))},4445:function(e,a,s){"use strict";s.d(a,{Z:function(){return l}});var n=s(7437),t=s(8253);function l(e){let{section:a,children:s}=e,{hasPermission:l}=(0,t.q)();return l(a)?(0,n.jsx)(n.Fragment,{children:s}):(0,n.jsxs)("div",{className:"role-denied",children:[(0,n.jsx)("div",{className:"role-denied-icon",children:"\uD83D\uDD12"}),(0,n.jsx)("h2",{children:"Acesso Negado"}),(0,n.jsx)("p",{children:"Voce nao tem permissao para acessar esta secao."}),(0,n.jsx)("p",{className:"role-denied-hint",children:"Contate o administrador para solicitar acesso."})]})}},1656:function(e,a,s){"use strict";s.d(a,{X:function(){return r},Z:function(){return l}});var n=s(7437);let t={success:"badge-success",warning:"badge-warning",danger:"badge-danger",info:"badge-info",neutral:"badge-neutral"};function l(e){let{label:a,variant:s="neutral"}=e;return(0,n.jsx)("span",{className:"badge ".concat(t[s]||t.neutral),children:a})}function r(e){return({pendente:"warning",confirmado:"info",preparando:"info",pronto:"info",coletado:"info",em_entrega:"warning",entregue:"success",cancelado:"danger",recusado:"danger",ativo:"success",inativo:"neutral",bloqueado:"danger",online:"success",offline:"neutral",aprovado:"success",reprovado:"danger",pago:"success",pendente_pagamento:"warning",processando:"info",aberto:"warning",resolvido:"success",fechado:"neutral"})[e]||"neutral"}},9246:function(e,a,s){"use strict";s.d(a,{Z:function(){return i}});var n=s(7437),t=s(2265);function l(e){let{value:a,onChange:s,placeholder:l="Buscar...",delay:r=300}=e,[i,c]=(0,t.useState)(a||""),o=(0,t.useRef)(null);return(0,t.useEffect)(()=>{c(a||"")},[a]),(0,n.jsxs)("div",{className:"search-input-wrapper",children:[(0,n.jsx)("span",{className:"search-input-icon",children:"\uD83D\uDD0D"}),(0,n.jsx)("input",{type:"text",className:"search-input",value:i,onChange:e=>{let a=e.target.value;c(a),o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{null==s||s(a)},r)},placeholder:l}),i&&(0,n.jsx)("button",{className:"search-input-clear",onClick:()=>{c(""),null==s||s("")},children:"✕"})]})}var r=s(4420);function i(e){let{columns:a=[],data:s=[],loading:i=!1,searchable:c=!0,pageSize:o=15,emptyMessage:d="Nenhum registro encontrado",onRowClick:u}=e,[m,h]=(0,t.useState)(""),[p,x]=(0,t.useState)(null),[b,j]=(0,t.useState)("asc"),[v,g]=(0,t.useState)(1),N=(0,t.useMemo)(()=>{if(!m)return s;let e=m.toLowerCase();return s.filter(s=>a.some(a=>{let n=s[a.key];return null!=n&&String(n).toLowerCase().includes(e)}))},[s,m,a]),f=(0,t.useMemo)(()=>p?[...N].sort((e,a)=>{var s,n;let t=null!==(s=e[p])&&void 0!==s?s:"",l=null!==(n=a[p])&&void 0!==n?n:"";if("number"==typeof t&&"number"==typeof l)return"asc"===b?t-l:l-t;let r=String(t).localeCompare(String(l));return"asc"===b?r:-r}):N,[N,p,b]),y=Math.max(1,Math.ceil(f.length/o)),k=f.slice((v-1)*o,v*o);(0,t.useEffect)(()=>{v>y&&g(1)},[v,y]);let C=e=>{p===e?j(e=>"asc"===e?"desc":"asc"):(x(e),j("asc"))};return i?(0,n.jsxs)("div",{className:"datatable",children:[c&&(0,n.jsx)("div",{className:"datatable-toolbar",children:(0,n.jsx)(l,{value:"",onChange:()=>{},placeholder:"Buscar..."})}),(0,n.jsx)("div",{className:"datatable-skeleton",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,n.jsx)("div",{className:"skeleton-row",children:a.map((e,a)=>(0,n.jsx)("div",{className:"skeleton-cell"},a))},s))})]}):(0,n.jsxs)("div",{className:"datatable",children:[c&&(0,n.jsxs)("div",{className:"datatable-toolbar",children:[(0,n.jsx)(l,{value:m,onChange:e=>{h(e),g(1)},placeholder:"Buscar na tabela..."}),(0,n.jsxs)("span",{className:"datatable-count",children:[N.length," registro(s)"]})]}),(0,n.jsx)("div",{className:"datatable-wrapper",children:(0,n.jsxs)("table",{className:"datatable-table",children:[(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{children:a.map(e=>(0,n.jsxs)("th",{onClick:()=>!1!==e.sortable&&C(e.key),className:!1!==e.sortable?"sortable":"",style:e.width?{width:e.width}:void 0,children:[e.label,p===e.key&&(0,n.jsx)("span",{className:"sort-indicator",children:"asc"===b?" ▲":" ▼"})]},e.key))})}),(0,n.jsx)("tbody",{children:0===k.length?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:a.length,className:"datatable-empty",children:d})}):k.map((e,s)=>(0,n.jsx)("tr",{onClick:()=>null==u?void 0:u(e),className:u?"clickable-row":"",children:a.map(a=>{var s;return(0,n.jsx)("td",{children:a.render?a.render(e[a.key],e):null!==(s=e[a.key])&&void 0!==s?s:"-"},a.key)})},e.id||s))})]})}),y>1&&(0,n.jsx)(r.Z,{page:v,totalPages:y,onPageChange:g})]})}},7714:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});var n=s(7437),t=s(2265);let l={sm:"400px",md:"560px",lg:"720px",xl:"960px"};function r(e){let{isOpen:a,onClose:s,title:r,children:i,size:c="md"}=e;return((0,t.useEffect)(()=>(a?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[a]),(0,t.useEffect)(()=>{let e=e=>{"Escape"===e.key&&a&&(null==s||s())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[a,s]),a)?(0,n.jsx)("div",{className:"modal-overlay",onClick:s,children:(0,n.jsxs)("div",{className:"modal-container",style:{maxWidth:l[c]||l.md},onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{className:"modal-header",children:[(0,n.jsx)("h3",{className:"modal-title",children:r}),(0,n.jsx)("button",{className:"modal-close",onClick:s,children:"✕"})]}),(0,n.jsx)("div",{className:"modal-body",children:i})]})}):null}},4420:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});var n=s(7437);function t(e){let{page:a,totalPages:s,onPageChange:t}=e,l=[],r=Math.max(1,a-Math.floor(2.5)),i=Math.min(s,r+5-1);i-r<4&&(r=Math.max(1,i-5+1));for(let e=r;e<=i;e++)l.push(e);return(0,n.jsxs)("div",{className:"pagination",children:[(0,n.jsx)("button",{className:"pagination-btn",disabled:a<=1,onClick:()=>t(a-1),children:"‹ Anterior"}),r>1&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{className:"pagination-btn",onClick:()=>t(1),children:"1"}),r>2&&(0,n.jsx)("span",{className:"pagination-dots",children:"..."})]}),l.map(e=>(0,n.jsx)("button",{className:"pagination-btn ".concat(e===a?"pagination-active":""),onClick:()=>t(e),children:e},e)),i<s&&(0,n.jsxs)(n.Fragment,{children:[i<s-1&&(0,n.jsx)("span",{className:"pagination-dots",children:"..."}),(0,n.jsx)("button",{className:"pagination-btn",onClick:()=>t(s),children:s})]}),(0,n.jsx)("button",{className:"pagination-btn",disabled:a>=s,onClick:()=>t(a+1),children:"Proximo ›"})]})}},3197:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});var n=s(7437);function t(e){let{icon:a,label:s,value:t,change:l,color:r="#f97316"}=e,i=l&&parseFloat(l)>=0;return(0,n.jsxs)("div",{className:"stats-card",style:{borderTopColor:r},children:[(0,n.jsxs)("div",{className:"stats-card-header",children:[(0,n.jsx)("span",{className:"stats-card-icon",style:{color:r},dangerouslySetInnerHTML:{__html:a||"&#128202;"}}),(0,n.jsx)("span",{className:"stats-card-label",children:s})]}),(0,n.jsx)("div",{className:"stats-card-value",children:null!=t?t:"-"}),null!=l&&(0,n.jsxs)("div",{className:"stats-card-change ".concat(i?"change-positive":"change-negative"),children:[i?"&#9650;":"&#9660;"," ",l,"%"]})]})}},6939:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});var n=s(7437),t=s(6971);let l={success:"&#10003;",error:"&#10007;",warning:"&#9888;",info:"&#8505;"};function r(){let{toasts:e,removeToast:a}=(0,t.l)();return 0===e.length?null:(0,n.jsx)("div",{className:"toast-container",children:e.map(e=>(0,n.jsxs)("div",{className:"toast toast-".concat(e.type),children:[(0,n.jsx)("span",{className:"toast-icon",dangerouslySetInnerHTML:{__html:l[e.type]||l.info}}),(0,n.jsx)("span",{className:"toast-message",children:e.message}),(0,n.jsx)("button",{className:"toast-close",onClick:()=>a(e.id),children:"✕"})]},e.id))})}},3436:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return v}});var n=s(7437),t=s(2265),l=s(8779),r=s(4477),i=s(4445),c=s(9246),o=s(1656),d=s(7714),u=s(3197),m=s(6939),h=s(8789),p=s(6971),x=s(6428);let b=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(null!=e?e:0);function j(){let{collapsed:e}=(0,h.A)(),{success:a,error:s}=(0,p.l)(),[l,i]=(0,t.useState)([]),[j,v]=(0,t.useState)(!0),[g,N]=(0,t.useState)({page:1,total:0,limit:20,pages:1}),[f,y]=(0,t.useState)(1),[k,C]=(0,t.useState)(!1),[w,S]=(0,t.useState)(null),[_,D]=(0,t.useState)(null),[Z,M]=(0,t.useState)(""),[E,P]=(0,t.useState)(!1),A=(0,t.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;v(!0);try{let a=await (0,x.SC)("/reembolsos.php",{page:e});i(a.reembolsos||[]),a.pagination&&N(a.pagination)}catch(e){s("Erro ao carregar reembolsos")}finally{v(!1)}},[s]);(0,t.useEffect)(()=>{A(f)},[f,A]);let R=(e,a)=>{S(e),D(a),M(""),C(!0)},T=async()=>{if(w&&_){P(!0);try{await (0,x.sg)("/reembolsos.php",{id:w.order_id||w.id,action:_,reason:Z||void 0}),a("approve"===_?"Reembolso aprovado com sucesso":"Reembolso negado"),C(!1),S(null),D(null),M(""),A(f)}catch(e){s("Erro: "+e.message)}finally{P(!1)}}},B={total:g.total||l.length,pendentes:l.filter(e=>"refunded"===e.status).length,valorTotal:l.reduce((e,a)=>e+Number(a.total||a.valor||0),0)},L=[{key:"order_id",label:"ID",width:"80px",render:(e,a)=>(0,n.jsxs)("strong",{children:["#",e||a.id]})},{key:"customer_name",label:"Cliente",render:(e,a)=>e||a.cliente_nome||"-"},{key:"partner_name",label:"Parceiro",render:(e,a)=>e||a.parceiro_nome||"-"},{key:"total",label:"Valor",render:(e,a)=>b(e||a.valor)},{key:"status",label:"Status",render:e=>(0,n.jsx)(o.Z,{label:e||"pendente",variant:(0,o.X)(e)})},{key:"created_at",label:"Data",render:(e,a)=>{let s=e||a.data;if(!s)return"-";try{return new Date(s).toLocaleDateString("pt-BR")}catch(e){return s}}},{key:"actions",label:"Acoes",sortable:!1,render:(e,a)=>(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{className:"btn btn-sm btn-success",onClick:e=>{e.stopPropagation(),R(a,"approve")},children:"Aprovar"}),(0,n.jsx)("button",{className:"btn btn-sm btn-danger",onClick:e=>{e.stopPropagation(),R(a,"deny")},children:"Negar"})]})}];return(0,n.jsxs)("div",{className:"admin-layout",children:[(0,n.jsx)(r.Z,{}),(0,n.jsxs)("main",{className:"admin-main ".concat(e?"main-collapsed":""),children:[(0,n.jsxs)("div",{className:"page-header",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"page-title",children:"Reembolsos"}),(0,n.jsx)("p",{className:"page-subtitle",children:"Gestao de reembolsos"})]}),(0,n.jsx)("div",{className:"page-actions",children:(0,n.jsx)("button",{className:"btn btn-secondary",onClick:()=>A(f),children:"Atualizar"})})]}),(0,n.jsxs)("div",{className:"stats-grid",style:{marginBottom:24},children:[(0,n.jsx)(u.Z,{icon:"\uD83D\uDCB0",label:"Total de Reembolsos",value:B.total,color:"#6366f1"}),(0,n.jsx)(u.Z,{icon:"⏳",label:"Pendentes",value:B.pendentes,color:"#f59e0b"}),(0,n.jsx)(u.Z,{icon:"\uD83D\uDCB5",label:"Valor Total",value:b(B.valorTotal),color:"#ef4444"})]}),(0,n.jsx)(c.Z,{columns:L,data:l,loading:j,emptyMessage:"Nenhum reembolso encontrado"}),g.pages>1&&(0,n.jsxs)("div",{className:"flex gap-2",style:{justifyContent:"center",marginTop:16},children:[(0,n.jsx)("button",{className:"btn btn-sm btn-secondary",disabled:f<=1,onClick:()=>y(e=>Math.max(1,e-1)),children:"Anterior"}),(0,n.jsxs)("span",{style:{padding:"6px 12px",fontSize:14},children:["Pagina ",f," de ",g.pages]}),(0,n.jsx)("button",{className:"btn btn-sm btn-secondary",disabled:f>=g.pages,onClick:()=>y(e=>Math.min(g.pages,e+1)),children:"Proxima"})]}),(0,n.jsx)(d.Z,{isOpen:k,onClose:()=>C(!1),title:"approve"===_?"Aprovar Reembolso":"Negar Reembolso",size:"md",children:w&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"detail-grid mb-4",children:[(0,n.jsxs)("div",{className:"detail-item",children:[(0,n.jsx)("span",{className:"detail-label",children:"Pedido"}),(0,n.jsxs)("span",{className:"detail-value",children:["#",w.order_id||w.id]})]}),(0,n.jsxs)("div",{className:"detail-item",children:[(0,n.jsx)("span",{className:"detail-label",children:"Cliente"}),(0,n.jsx)("span",{className:"detail-value",children:w.customer_name||w.cliente_nome||"-"})]}),(0,n.jsxs)("div",{className:"detail-item",children:[(0,n.jsx)("span",{className:"detail-label",children:"Parceiro"}),(0,n.jsx)("span",{className:"detail-value",children:w.partner_name||w.parceiro_nome||"-"})]}),(0,n.jsxs)("div",{className:"detail-item",children:[(0,n.jsx)("span",{className:"detail-label",children:"Valor"}),(0,n.jsx)("span",{className:"detail-value",children:b(w.total||w.valor)})]}),(0,n.jsxs)("div",{className:"detail-item",children:[(0,n.jsx)("span",{className:"detail-label",children:"Status"}),(0,n.jsx)("span",{className:"detail-value",children:(0,n.jsx)(o.Z,{label:w.status||"pendente",variant:(0,o.X)(w.status)})})]}),(0,n.jsxs)("div",{className:"detail-item",children:[(0,n.jsx)("span",{className:"detail-label",children:"Data"}),(0,n.jsx)("span",{className:"detail-value",children:w.created_at||w.data||"-"})]})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label",children:"approve"===_?"Motivo da aprovacao (opcional)":"Motivo da negacao"}),(0,n.jsx)("textarea",{className:"form-textarea",value:Z,onChange:e=>M(e.target.value),placeholder:"approve"===_?"Informe o motivo da aprovacao...":"Informe o motivo da negacao...",rows:3})]}),(0,n.jsxs)("div",{className:"flex gap-2",style:{justifyContent:"flex-end"},children:[(0,n.jsx)("button",{className:"btn btn-secondary",onClick:()=>C(!1),disabled:E,children:"Cancelar"}),"approve"===_?(0,n.jsx)("button",{className:"btn btn-success",onClick:T,disabled:E,children:E?"Aprovando...":"Confirmar Aprovacao"}):(0,n.jsx)("button",{className:"btn btn-danger",onClick:T,disabled:E,children:E?"Negando...":"Confirmar Negacao"})]})]})})]}),(0,n.jsx)(m.Z,{})]})}function v(){return(0,n.jsx)(l.Z,{children:(0,n.jsx)(i.Z,{section:"financial",children:(0,n.jsx)(j,{})})})}}},function(e){e.O(0,[3448,1006,2971,2117,1744],function(){return e(e.s=6471)}),_N_E=e.O()}]);
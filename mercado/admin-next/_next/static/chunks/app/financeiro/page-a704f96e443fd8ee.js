(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9879],{1999:function(e,a,s){Promise.resolve().then(s.bind(s,1732))},4445:function(e,a,s){"use strict";s.d(a,{Z:function(){return l}});var n=s(7437),t=s(8253);function l(e){let{section:a,children:s}=e,{hasPermission:l}=(0,t.q)();return l(a)?(0,n.jsx)(n.Fragment,{children:s}):(0,n.jsxs)("div",{className:"role-denied",children:[(0,n.jsx)("div",{className:"role-denied-icon",children:"\uD83D\uDD12"}),(0,n.jsx)("h2",{children:"Acesso Negado"}),(0,n.jsx)("p",{children:"Voce nao tem permissao para acessar esta secao."}),(0,n.jsx)("p",{className:"role-denied-hint",children:"Contate o administrador para solicitar acesso."})]})}},1656:function(e,a,s){"use strict";s.d(a,{X:function(){return r},Z:function(){return l}});var n=s(7437);let t={success:"badge-success",warning:"badge-warning",danger:"badge-danger",info:"badge-info",neutral:"badge-neutral"};function l(e){let{label:a,variant:s="neutral"}=e;return(0,n.jsx)("span",{className:"badge ".concat(t[s]||t.neutral),children:a})}function r(e){return({pendente:"warning",confirmado:"info",preparando:"info",pronto:"info",coletado:"info",em_entrega:"warning",entregue:"success",cancelado:"danger",recusado:"danger",ativo:"success",inativo:"neutral",bloqueado:"danger",online:"success",offline:"neutral",aprovado:"success",reprovado:"danger",pago:"success",pendente_pagamento:"warning",processando:"info",aberto:"warning",resolvido:"success",fechado:"neutral"})[e]||"neutral"}},9531:function(e,a,s){"use strict";s.d(a,{Z:function(){return c}});var n=s(7437),t=s(2265);function l(e){let{value:a,onChange:s,placeholder:l="Buscar...",delay:r=300}=e,[c,i]=(0,t.useState)(a||""),d=(0,t.useRef)(null);return(0,t.useEffect)(()=>{i(a||"")},[a]),(0,n.jsxs)("div",{className:"search-input-wrapper",children:[(0,n.jsx)("span",{className:"search-input-icon",children:"\uD83D\uDD0D"}),(0,n.jsx)("input",{type:"text",className:"search-input",value:c,onChange:e=>{let a=e.target.value;i(a),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{null==s||s(a)},r)},placeholder:l}),c&&(0,n.jsx)("button",{className:"search-input-clear",onClick:()=>{i(""),null==s||s("")},children:"✕"})]})}function r(e){let{page:a,totalPages:s,onPageChange:t}=e,l=[],r=Math.max(1,a-Math.floor(2.5)),c=Math.min(s,r+5-1);c-r<4&&(r=Math.max(1,c-5+1));for(let e=r;e<=c;e++)l.push(e);return(0,n.jsxs)("div",{className:"pagination",children:[(0,n.jsx)("button",{className:"pagination-btn",disabled:a<=1,onClick:()=>t(a-1),children:"‹ Anterior"}),r>1&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{className:"pagination-btn",onClick:()=>t(1),children:"1"}),r>2&&(0,n.jsx)("span",{className:"pagination-dots",children:"..."})]}),l.map(e=>(0,n.jsx)("button",{className:"pagination-btn ".concat(e===a?"pagination-active":""),onClick:()=>t(e),children:e},e)),c<s&&(0,n.jsxs)(n.Fragment,{children:[c<s-1&&(0,n.jsx)("span",{className:"pagination-dots",children:"..."}),(0,n.jsx)("button",{className:"pagination-btn",onClick:()=>t(s),children:s})]}),(0,n.jsx)("button",{className:"pagination-btn",disabled:a>=s,onClick:()=>t(a+1),children:"Proximo ›"})]})}function c(e){let{columns:a=[],data:s=[],loading:c=!1,searchable:i=!0,pageSize:d=15,emptyMessage:o="Nenhum registro encontrado",onRowClick:u}=e,[h,m]=(0,t.useState)(""),[x,p]=(0,t.useState)(null),[j,b]=(0,t.useState)("asc"),[v,g]=(0,t.useState)(1),f=(0,t.useMemo)(()=>{if(!h)return s;let e=h.toLowerCase();return s.filter(s=>a.some(a=>{let n=s[a.key];return null!=n&&String(n).toLowerCase().includes(e)}))},[s,h,a]),N=(0,t.useMemo)(()=>x?[...f].sort((e,a)=>{var s,n;let t=null!==(s=e[x])&&void 0!==s?s:"",l=null!==(n=a[x])&&void 0!==n?n:"";if("number"==typeof t&&"number"==typeof l)return"asc"===j?t-l:l-t;let r=String(t).localeCompare(String(l));return"asc"===j?r:-r}):f,[f,x,j]),y=Math.max(1,Math.ceil(N.length/d)),k=N.slice((v-1)*d,v*d),C=e=>{x===e?b(e=>"asc"===e?"desc":"asc"):(p(e),b("asc"))};return c?(0,n.jsxs)("div",{className:"datatable",children:[i&&(0,n.jsx)("div",{className:"datatable-toolbar",children:(0,n.jsx)(l,{value:"",onChange:()=>{},placeholder:"Buscar..."})}),(0,n.jsx)("div",{className:"datatable-skeleton",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,n.jsx)("div",{className:"skeleton-row",children:a.map((e,a)=>(0,n.jsx)("div",{className:"skeleton-cell"},a))},s))})]}):(0,n.jsxs)("div",{className:"datatable",children:[i&&(0,n.jsxs)("div",{className:"datatable-toolbar",children:[(0,n.jsx)(l,{value:h,onChange:e=>{m(e),g(1)},placeholder:"Buscar na tabela..."}),(0,n.jsxs)("span",{className:"datatable-count",children:[f.length," registro(s)"]})]}),(0,n.jsx)("div",{className:"datatable-wrapper",children:(0,n.jsxs)("table",{className:"datatable-table",children:[(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{children:a.map(e=>(0,n.jsxs)("th",{onClick:()=>!1!==e.sortable&&C(e.key),className:!1!==e.sortable?"sortable":"",style:e.width?{width:e.width}:void 0,children:[e.label,x===e.key&&(0,n.jsx)("span",{className:"sort-indicator",children:"asc"===j?" ▲":" ▼"})]},e.key))})}),(0,n.jsx)("tbody",{children:0===k.length?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:a.length,className:"datatable-empty",children:o})}):k.map((e,s)=>(0,n.jsx)("tr",{onClick:()=>null==u?void 0:u(e),className:u?"clickable-row":"",children:a.map(a=>{var s;return(0,n.jsx)("td",{children:a.render?a.render(e[a.key],e):null!==(s=e[a.key])&&void 0!==s?s:"-"},a.key)})},e.id||s))})]})}),y>1&&(0,n.jsx)(r,{page:v,totalPages:y,onPageChange:g})]})}},3197:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});var n=s(7437);function t(e){let{icon:a,label:s,value:t,change:l,color:r="#f97316"}=e,c=l&&parseFloat(l)>=0;return(0,n.jsxs)("div",{className:"stats-card",style:{borderTopColor:r},children:[(0,n.jsxs)("div",{className:"stats-card-header",children:[(0,n.jsx)("span",{className:"stats-card-icon",style:{color:r},dangerouslySetInnerHTML:{__html:a||"&#128202;"}}),(0,n.jsx)("span",{className:"stats-card-label",children:s})]}),(0,n.jsx)("div",{className:"stats-card-value",children:null!=t?t:"-"}),null!=l&&(0,n.jsxs)("div",{className:"stats-card-change ".concat(c?"change-positive":"change-negative"),children:[c?"&#9650;":"&#9660;"," ",l,"%"]})]})}},6939:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});var n=s(7437),t=s(6971);let l={success:"&#10003;",error:"&#10007;",warning:"&#9888;",info:"&#8505;"};function r(){let{toasts:e,removeToast:a}=(0,t.l)();return 0===e.length?null:(0,n.jsx)("div",{className:"toast-container",children:e.map(e=>(0,n.jsxs)("div",{className:"toast toast-".concat(e.type),children:[(0,n.jsx)("span",{className:"toast-icon",dangerouslySetInnerHTML:{__html:l[e.type]||l.info}}),(0,n.jsx)("span",{className:"toast-message",children:e.message}),(0,n.jsx)("button",{className:"toast-close",onClick:()=>a(e.id),children:"✕"})]},e.id))})}},1732:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return j}});var n=s(7437),t=s(2265),l=s(8779),r=s(4477),c=s(4445),i=s(3197),d=s(9531),o=s(1656),u=s(6939),h=s(8789),m=s(6971),x=s(6428);function p(){let{collapsed:e}=(0,h.A)(),{error:a}=(0,m.l)(),[l,c]=(0,t.useState)(null),[p,j]=(0,t.useState)([]),[b,v]=(0,t.useState)([]),[g,f]=(0,t.useState)(!0),N=(0,t.useRef)(null),y=(0,t.useRef)(null);(0,t.useEffect)(()=>{k()},[]);let k=async()=>{f(!0);try{let[e,a,s]=await Promise.allSettled([(0,x.SC)("/financeiro.php"),(0,x.SC)("/repasses.php"),(0,x.SC)("/financeiro.php?transactions=1")]);"fulfilled"===e.status&&c(e.value),"fulfilled"===a.status&&j(a.value.repasses||a.value.data||[]),"fulfilled"===s.status&&v(s.value.transactions||s.value.data||[])}catch(e){a("Erro ao carregar financeiro")}finally{f(!1)}};(0,t.useEffect)(()=>{if(!(null==l?void 0:l.chart)||!N.current)return;let e=!1;return Promise.all([s.e(7674),s.e(2153)]).then(s.bind(s,4084)).then(a=>{let{Chart:s,registerables:n}=a;e||(s.register(...n),y.current&&y.current.destroy(),y.current=new s(N.current,{type:"line",data:{labels:l.chart.labels||[],datasets:[{label:"Receita",data:l.chart.revenue||l.chart.receita||[],borderColor:"#22c55e",backgroundColor:"rgba(34,197,94,0.1)",fill:!0,tension:.4},{label:"Despesas",data:l.chart.expenses||l.chart.despesas||[],borderColor:"#ef4444",backgroundColor:"rgba(239,68,68,0.1)",fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#94a3b8"}}},scales:{x:{ticks:{color:"#64748b"},grid:{color:"rgba(51,65,85,0.5)"}},y:{ticks:{color:"#64748b"},grid:{color:"rgba(51,65,85,0.5)"},beginAtZero:!0}}}}))}),()=>{e=!0}},[l]),(0,t.useEffect)(()=>()=>{y.current&&y.current.destroy()},[]);let C=e=>null!=e?"R$ ".concat(Number(e).toLocaleString("pt-BR",{minimumFractionDigits:2})):"R$ 0,00",w=[{key:"id",label:"ID",width:"80px",render:e=>(0,n.jsxs)("strong",{children:["#",e]})},{key:"type",label:"Tipo",render:(e,a)=>e||a.tipo||"-"},{key:"description",label:"Descricao",render:(e,a)=>e||a.descricao||"-"},{key:"amount",label:"Valor",render:(e,a)=>C(e||a.valor)},{key:"status",label:"Status",render:e=>(0,n.jsx)(o.Z,{label:e||"pendente",variant:(0,o.X)(e)})},{key:"created_at",label:"Data",render:(e,a)=>e||a.data||"-"}];return(0,n.jsxs)("div",{className:"admin-layout",children:[(0,n.jsx)(r.Z,{}),(0,n.jsxs)("main",{className:"admin-main ".concat(e?"main-collapsed":""),children:[(0,n.jsxs)("div",{className:"page-header",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"page-title",children:"Financeiro"}),(0,n.jsx)("p",{className:"page-subtitle",children:"Dashboard financeiro"})]}),(0,n.jsx)("div",{className:"page-actions",children:(0,n.jsx)("button",{className:"btn btn-secondary",onClick:k,children:"Atualizar"})})]}),(0,n.jsxs)("div",{className:"stats-grid",style:{gridTemplateColumns:"repeat(4, 1fr)"},children:[(0,n.jsx)(i.Z,{icon:"\uD83D\uDCB0",label:"Receita Hoje",value:g?"...":C(null==l?void 0:l.receita_hoje),color:"#22c55e",change:null==l?void 0:l.receita_change}),(0,n.jsx)(i.Z,{icon:"\uD83D\uDCC8",label:"Receita Semana",value:g?"...":C(null==l?void 0:l.receita_semana),color:"#3b82f6"}),(0,n.jsx)(i.Z,{icon:"\uD83D\uDCCA",label:"Receita Mes",value:g?"...":C(null==l?void 0:l.receita_mes),color:"#8b5cf6"}),(0,n.jsx)(i.Z,{icon:"\uD83D\uDCB5",label:"Receita Total",value:g?"...":C(null==l?void 0:l.receita_total),color:"#f97316"})]}),(0,n.jsxs)("div",{className:"grid-2 mb-6",children:[(0,n.jsxs)("div",{className:"chart-container",children:[(0,n.jsx)("div",{className:"card-header",children:(0,n.jsx)("h3",{className:"card-title",children:"Receita x Despesas"})}),(0,n.jsx)("div",{style:{height:280},children:(0,n.jsx)("canvas",{ref:N})})]}),(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("h3",{className:"card-title mb-4",children:"Breakdown"}),(0,n.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",style:{padding:"10px 0",borderBottom:"1px solid var(--border)"},children:[(0,n.jsx)("span",{className:"text-sm",children:"Vendas"}),(0,n.jsx)("span",{className:"font-semibold",children:C(null==l?void 0:l.vendas)})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",style:{padding:"10px 0",borderBottom:"1px solid var(--border)"},children:[(0,n.jsx)("span",{className:"text-sm",children:"Taxas de Entrega"}),(0,n.jsx)("span",{className:"font-semibold",children:C(null==l?void 0:l.taxas)})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",style:{padding:"10px 0",borderBottom:"1px solid var(--border)"},children:[(0,n.jsx)("span",{className:"text-sm",children:"Comissoes"}),(0,n.jsxs)("span",{className:"font-semibold",style:{color:"var(--danger)"},children:["-",C(null==l?void 0:l.comissoes)]})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",style:{padding:"10px 0",borderBottom:"1px solid var(--border)"},children:[(0,n.jsx)("span",{className:"text-sm",children:"Pagamentos Shoppers"}),(0,n.jsxs)("span",{className:"font-semibold",style:{color:"var(--danger)"},children:["-",C(null==l?void 0:l.pagamentos_shoppers)]})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",style:{padding:"10px 0"},children:[(0,n.jsx)("span",{className:"text-sm font-bold",children:"Lucro Liquido"}),(0,n.jsx)("span",{className:"font-bold",style:{color:"var(--success)"},children:C(null==l?void 0:l.lucro)})]})]})]})]}),(0,n.jsxs)("div",{className:"card mb-6",children:[(0,n.jsxs)("div",{className:"card-header",children:[(0,n.jsx)("h3",{className:"card-title",children:"Repasses Pendentes"}),(0,n.jsxs)("span",{className:"text-xs text-dim",children:[p.length," pendente(s)"]})]}),0===p.length?(0,n.jsx)("p",{className:"text-muted p-4",children:"Nenhum repasse pendente"}):(0,n.jsx)("div",{className:"datatable-wrapper",children:(0,n.jsxs)("table",{className:"datatable-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Parceiro"}),(0,n.jsx)("th",{children:"Periodo"}),(0,n.jsx)("th",{children:"Valor"}),(0,n.jsx)("th",{children:"Status"})]})}),(0,n.jsx)("tbody",{children:p.slice(0,10).map((e,a)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.parceiro_nome||e.partner_name||"-"}),(0,n.jsx)("td",{children:e.periodo||e.period||"-"}),(0,n.jsx)("td",{children:C(e.valor||e.amount)}),(0,n.jsx)("td",{children:(0,n.jsx)(o.Z,{label:e.status||"pendente",variant:(0,o.X)(e.status)})})]},a))})]})})]}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h3",{className:"page-title text-sm mb-4",style:{fontSize:18},children:"Transacoes Recentes"}),(0,n.jsx)(d.Z,{columns:w,data:b,loading:g,emptyMessage:"Nenhuma transacao"})]})]}),(0,n.jsx)(u.Z,{})]})}function j(){return(0,n.jsx)(l.Z,{children:(0,n.jsx)(c.Z,{section:"finance",children:(0,n.jsx)(p,{})})})}}},function(e){e.O(0,[3448,1006,2971,2117,1744],function(){return e(e.s=1999)}),_N_E=e.O()}]);
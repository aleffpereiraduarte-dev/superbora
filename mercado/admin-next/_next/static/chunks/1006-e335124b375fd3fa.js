"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1006],{6428:function(e,t,n){n.d(t,{LP:function(){return a},QW:function(){return d},SC:function(){return c},o4:function(){return o},pE:function(){return u},sg:function(){return l}});let i="/api/mercado/admin",r="admin_token";function a(){try{return localStorage.getItem(r)}catch(e){return null}}function o(e){try{e?localStorage.setItem(r,e):localStorage.removeItem(r)}catch(e){}}function s(){let e=a(),t={"Content-Type":"application/json"};return e&&(t.Authorization="Bearer ".concat(e)),t}async function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="".concat(i).concat(e),r=Object.entries(t).filter(e=>{let[,t]=e;return null!=t&&""!==t}).map(e=>{let[t,n]=e;return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(n))}).join("&");r&&(n+="?".concat(r));let a=await fetch(n,{headers:s()});if(!a.ok)throw Error((await a.json().catch(()=>({message:"Erro de rede"}))).message||"HTTP ".concat(a.status));let o=await a.json();if(!1===o.success)throw Error(o.message||"Erro desconhecido");return void 0!==o.data?o.data:o}async function l(e,t){let n=await fetch("".concat(i).concat(e),{method:"POST",headers:s(),body:JSON.stringify(t)}),r=await n.json().catch(()=>null);if(!n.ok||r&&!1===r.success)throw Error((null==r?void 0:r.message)||"HTTP ".concat(n.status));return(null==r?void 0:r.data)!==void 0?r.data:r}async function u(e,t){let n=await fetch("".concat(i).concat(e),{method:"PUT",headers:s(),body:JSON.stringify(t)}),r=await n.json().catch(()=>null);if(!n.ok||r&&!1===r.success)throw Error((null==r?void 0:r.message)||"HTTP ".concat(n.status));return(null==r?void 0:r.data)!==void 0?r.data:r}async function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="".concat(i).concat(e),r=Object.entries(t).filter(e=>{let[,t]=e;return null!=t&&""!==t}).map(e=>{let[t,n]=e;return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(n))}).join("&");r&&(n+="?".concat(r));let a=await fetch(n,{method:"DELETE",headers:s()}),o=await a.json().catch(()=>null);if(!a.ok||o&&!1===o.success)throw Error((null==o?void 0:o.message)||"HTTP ".concat(a.status));return(null==o?void 0:o.data)!==void 0?o.data:o}},8779:function(e,t,n){n.d(t,{Z:function(){return s}});var i=n(7437),r=n(2265),a=n(7128),o=n(9376);function s(e){let{children:t}=e,{isAuthenticated:n,loading:s}=(0,a.a)(),c=(0,o.useRouter)();return((0,r.useEffect)(()=>{s||n||c.push("/login/")},[s,n,c]),s)?(0,i.jsxs)("div",{className:"auth-loading",children:[(0,i.jsx)("div",{className:"auth-loading-spinner"}),(0,i.jsx)("p",{children:"Carregando..."})]}):n?(0,i.jsx)(i.Fragment,{children:t}):null}},4477:function(e,t,n){n.d(t,{Z:function(){return d}});var i=n(7437),r=n(9376),a=n(7648),o=n(8789),s=n(7128),c=n(8253),l=n(6971);let u=[{title:"Principal",items:[{label:"Dashboard",href:"/",icon:"&#9632;",section:"dashboard"}]},{title:"Operacoes",items:[{label:"Pedidos",href:"/pedidos/",icon:"&#128230;",section:"orders"},{label:"Despacho",href:"/dispatch/",icon:"&#128666;",section:"dispatch"},{label:"Tracking",href:"/tracking/",icon:"&#128205;",section:"tracking"},{label:"Mapa",href:"/mapa/",icon:"&#127758;",section:"map"}]},{title:"Financeiro",items:[{label:"Financeiro",href:"/financeiro/",icon:"&#128176;",section:"finance"},{label:"Comissoes",href:"/financeiro/comissoes/",icon:"&#128200;",section:"commissions"},{label:"Config Comissoes",href:"/comissoes/",icon:"&#9881;",section:"commissions"},{label:"Pagamentos",href:"/financeiro/pagamentos/",icon:"&#128179;",section:"payments"},{label:"Reembolsos",href:"/financeiro/reembolsos/",icon:"&#8634;",section:"refunds"},{label:"Precificacao",href:"/financeiro/precificacao/",icon:"&#128181;",section:"pricing"}]},{title:"Pessoas",items:[{label:"Clientes",href:"/clientes/",icon:"&#128100;",section:"clients"},{label:"Shoppers",href:"/shoppers/",icon:"&#128694;",section:"shoppers"},{label:"Workers",href:"/workers/",icon:"&#128119;",section:"workers"},{label:"Avaliacoes",href:"/avaliacoes/",icon:"&#11088;",section:"reviews"}]},{title:"Parceiros",items:[{label:"Mercados",href:"/mercados/",icon:"&#127979;",section:"markets"},{label:"Parceiros",href:"/parceiros/",icon:"&#129309;",section:"partners"},{label:"Categorias",href:"/categorias/",icon:"&#128193;",section:"config"}]},{title:"Marketing",items:[{label:"Cupons",href:"/cupons/",icon:"&#127915;",section:"coupons"},{label:"Promocoes",href:"/promocoes/",icon:"&#127873;",section:"promotions"},{label:"Notificacoes",href:"/notificacoes/",icon:"&#128276;",section:"notifications"}]},{title:"Suporte",items:[{label:"Tickets",href:"/suporte/",icon:"&#127915;",section:"support"},{label:"Chat Central",href:"/chat/",icon:"&#128172;",section:"chat"}]},{title:"Inteligencia",items:[{label:"Alertas",href:"/alertas/",icon:"&#128680;",section:"alerts"},{label:"Analise AI",href:"/inteligencia/",icon:"&#129302;",section:"intelligence"},{label:"Pricing AI",href:"/pricing-ai/",icon:"&#128202;",section:"intelligence"},{label:"Widget",href:"/widget/",icon:"&#128736;",section:"intelligence"}]},{title:"Sistema",items:[{label:"Relatorios",href:"/relatorios/",icon:"&#128203;",section:"reports"},{label:"KPIs",href:"/kpis/",icon:"&#127942;",section:"kpis"},{label:"Logs",href:"/logs/",icon:"&#128209;",section:"logs"},{label:"Exportar",href:"/exportar/",icon:"&#128229;",section:"export"},{label:"Config",href:"/config/",icon:"&#9881;",section:"config"},{label:"Seguranca",href:"/seguranca/",icon:"&#128274;",section:"security"},{label:"Busca",href:"/busca/",icon:"&#128269;",section:"search"}]},{title:"Tools",items:[{label:"Editor",href:"/editor/",icon:"&#9998;",section:"editor"}]}];function d(){let{collapsed:e,toggle:t}=(0,o.A)(),{admin:n,logout:d}=(0,s.a)(),{hasPermission:f}=(0,c.q)(),{alertCount:h}=(0,l.l)(),m=(0,r.usePathname)(),p=e=>"/"===e?"/"===m||""===m:m.startsWith(e);return(0,i.jsxs)("aside",{className:"sidebar ".concat(e?"sidebar-collapsed":""),children:[(0,i.jsxs)("div",{className:"sidebar-header",children:[!e&&(0,i.jsx)("span",{className:"sidebar-logo",children:"SuperBora Admin"}),(0,i.jsx)("button",{className:"sidebar-toggle",onClick:t,title:e?"Expandir":"Recolher",children:(0,i.jsx)("span",{dangerouslySetInnerHTML:{__html:e?"&#9654;":"&#9664;"}})})]}),(0,i.jsx)("nav",{className:"sidebar-nav",children:u.map(t=>{let n=t.items.filter(e=>f(e.section));return 0===n.length?null:(0,i.jsxs)("div",{className:"sidebar-section",children:[!e&&(0,i.jsx)("div",{className:"sidebar-section-title",children:t.title}),n.map(t=>(0,i.jsxs)(a.default,{href:""+t.href,className:"sidebar-item ".concat(p(t.href)?"sidebar-item-active":""),title:e?t.label:void 0,children:[(0,i.jsx)("span",{className:"sidebar-item-icon",dangerouslySetInnerHTML:{__html:t.icon}}),!e&&(0,i.jsx)("span",{className:"sidebar-item-label",children:t.label}),!e&&"Alertas"===t.label&&h>0&&(0,i.jsx)("span",{className:"sidebar-badge",children:h})]},t.href))]},t.title)})}),(0,i.jsxs)("div",{className:"sidebar-footer",children:[!e&&n&&(0,i.jsxs)("div",{className:"sidebar-admin-info",children:[(0,i.jsx)("div",{className:"sidebar-admin-name",children:n.name}),(0,i.jsx)("span",{className:"sidebar-role-badge",style:{backgroundColor:{admin:"#f97316",manager:"#3b82f6",support:"#8b5cf6"}[n.role]||"#6b7280"},children:n.role})]}),(0,i.jsxs)("button",{className:"sidebar-logout",onClick:d,title:"Sair",children:[(0,i.jsx)("span",{dangerouslySetInnerHTML:{__html:"&#9211;"}}),!e&&(0,i.jsx)("span",{children:"Sair"})]})]})]})}},7128:function(e,t,n){n.d(t,{H:function(){return s},a:function(){return c}});var i=n(7437),r=n(2265),a=n(6428);let o=(0,r.createContext)(null);function s(e){let{children:t}=e,[n,s]=(0,r.useState)(null),[c,l]=(0,r.useState)(!0),u=(0,r.useCallback)(async()=>{if(!(0,a.LP)()){l(!1);return}try{let e=await (0,a.SC)("/auth/session.php");e.admin?s({...e.admin,name:e.admin.nome||e.admin.name,admin_id:e.admin.admin_id||e.admin.id}):((0,a.o4)(null),s(null))}catch(e){(0,a.o4)(null),s(null)}finally{l(!1)}},[]);(0,r.useEffect)(()=>{u()},[u]);let d=async(e,t)=>{let n=await (0,a.sg)("/auth/login.php",{email:e,senha:t});if(n.token)return(0,a.o4)(n.token),s({admin_id:n.admin_id,name:n.nome||n.name,email:n.email,role:n.role}),n;throw Error(n.message||"Erro ao fazer login")};return(0,i.jsx)(o.Provider,{value:{admin:n,loading:c,isAuthenticated:!!n,login:d,logout:()=>{(0,a.o4)(null),s(null)},checkSession:u},children:t})}function c(){let e=(0,r.useContext)(o);if(!e)throw Error("useAuth must be inside AuthProvider");return e}},6971:function(e,t,n){n.d(t,{J:function(){return c},l:function(){return l}});var i=n(7437),r=n(2265),a=n(6428),o=n(7128);let s=(0,r.createContext)(null);function c(e){let{children:t}=e,{isAuthenticated:n}=(0,o.a)(),[c,l]=(0,r.useState)([]),[u,d]=(0,r.useState)([]),[f,h]=(0,r.useState)(0),m=(0,r.useRef)(0),p=(0,r.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4e3,i=++m.current;l(n=>[...n,{id:i,message:e,type:t}]),n>0&&setTimeout(()=>{l(e=>e.filter(e=>e.id!==i))},n)},[]),b=(0,r.useCallback)(e=>{l(t=>t.filter(t=>t.id!==e))},[]),g=(0,r.useCallback)(e=>p(e,"success"),[p]),v=(0,r.useCallback)(e=>p(e,"error"),[p]),k=(0,r.useCallback)(e=>p(e,"warning"),[p]),x=(0,r.useCallback)(e=>p(e,"info"),[p]),C=(0,r.useCallback)(async()=>{if(n)try{let e=await (0,a.SC)("/alertas.php");d(e.alertas||[]),h(e.total||0)}catch(e){}},[n]);return(0,r.useEffect)(()=>{if(!n)return;C();let e=setInterval(C,3e4);return()=>clearInterval(e)},[n,C]),(0,i.jsx)(s.Provider,{value:{toasts:c,alerts:u,alertCount:f,addToast:p,removeToast:b,success:g,error:v,warning:k,info:x,fetchAlerts:C},children:t})}function l(){let e=(0,r.useContext)(s);if(!e)throw Error("useNotification must be inside NotificationProvider");return e}},8253:function(e,t,n){n.d(t,{a:function(){return c},q:function(){return l}});var i=n(7437),r=n(2265),a=n(7128);let o=(0,r.createContext)(null),s={admin:["dashboard","orders","finance","clients","shoppers","workers","markets","partners","coupons","promotions","notifications","support","chat","alerts","intelligence","reports","kpis","logs","export","config","security","search","tracking","map","editor","dispatch","reviews","pricing","refunds","payments","commissions"],manager:["dashboard","orders","finance","clients","shoppers","workers","markets","partners","coupons","promotions","notifications","support","chat","alerts","intelligence","reports","kpis","logs","export","search","tracking","map","editor","dispatch","reviews","pricing","refunds","payments","commissions"],support:["dashboard","orders","clients","support","chat","search","reviews"]};function c(e){let{children:t}=e,{admin:n}=(0,a.a)(),c=(0,r.useMemo)(()=>{let e=(null==n?void 0:n.role)||"support",t=s[e]||s.support;return{role:e,permissions:t,hasPermission:e=>t.includes(e)}},[n]);return(0,i.jsx)(o.Provider,{value:c,children:t})}function l(){let e=(0,r.useContext)(o);if(!e)throw Error("useRole must be inside RoleProvider");return e}},8789:function(e,t,n){n.d(t,{A:function(){return c},H:function(){return s}});var i=n(7437),r=n(2265);let a=(0,r.createContext)(null),o="admin_sidebar_collapsed";function s(e){let{children:t}=e,[n,s]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let e=localStorage.getItem(o);null!==e&&s("true"===e)},[]),(0,i.jsx)(a.Provider,{value:{collapsed:n,toggle:()=>{s(e=>{let t=!e;return localStorage.setItem(o,String(t)),t})}},children:t})}function c(){let e=(0,r.useContext)(a);if(!e)throw Error("useSidebar must be inside SidebarProvider");return e}}}]);
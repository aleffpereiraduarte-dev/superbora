(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[551],{2861:function(e,a,s){Promise.resolve().then(s.bind(s,8294))},8294:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return d}});var l=s(7437),i=s(2265),o=s(4565),n=s(4477),t=s(6428),r=s(6971);let c=[{key:"parcelamento",label:"Parcelamento"},{key:"frete",label:"Frete"},{key:"cashback",label:"Cashback"},{key:"cupons",label:"Cupons"},{key:"garantia",label:"Garantia"}];function d(){return(0,l.jsx)(o.Z,{children:(0,l.jsx)(n.Z,{children:(0,l.jsx)(m,{})})})}function m(){var e,a,s,o,n,d,m,u,p,h,v,x;let{addNotification:b}=(0,r.l)(),[j,f]=(0,i.useState)("parcelamento"),[g,N]=(0,i.useState)(null),[_,y]=(0,i.useState)(!0),[C,k]=(0,i.useState)(""),[E,S]=(0,i.useState)(!1),[w,P]=(0,i.useState)([]),[D,F]=(0,i.useState)(!1),[R,$]=(0,i.useState)(null),[z,A]=(0,i.useState)({codigo:"",desconto_tipo:"percentual",desconto_valor:"",valor_minimo:"",usos_maximo:"",data_inicio:"",data_fim:"",ativo:!0}),V=(0,i.useCallback)(async()=>{y(!0),k("");try{let e=await (0,t.SC)("/benefits.php");N(e.config||e||{}),P(e.coupons||e.cupons||[])}catch(e){k(e.message)}finally{y(!1)}},[]);function G(e,a,s){N(l=>({...l,[e]:{...(null==l?void 0:l[e])||{},[a]:s}}))}async function M(e){S(!0);try{await (0,t.sg)("/benefits-save.php",{section:e,config:(null==g?void 0:g[e])||{}}),b("Configuracao salva com sucesso!","success")}catch(e){b(e.message,"error")}finally{S(!1)}}async function I(e){e.preventDefault(),S(!0);try{let e={...z};R&&(e.id=R.id||R.coupon_id),await (0,t.sg)("/coupons.php",e),b(R?"Cupom atualizado!":"Cupom criado!","success"),F(!1),V()}catch(e){b(e.message,"error")}finally{S(!1)}}async function O(e){if(confirm("Excluir este cupom?"))try{await (0,t.apiDelete)("/coupons.php",{id:e.id||e.coupon_id}),b("Cupom excluido!","success"),V()}catch(e){b(e.message,"error")}}return(0,i.useEffect)(()=>{V()},[V]),_?(0,l.jsx)("div",{className:"loading-screen",children:(0,l.jsx)("div",{className:"spinner"})}):C?(0,l.jsxs)("div",{className:"empty-state",children:[(0,l.jsx)("div",{className:"empty-state-title",children:"Erro ao carregar beneficios"}),(0,l.jsx)("div",{className:"empty-state-text",children:C})]}):(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"page-header",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"page-title",children:"Beneficios"}),(0,l.jsx)("p",{className:"page-subtitle",children:"Configure beneficios para seus clientes"})]})}),(0,l.jsx)("div",{className:"tabs",children:c.map(e=>(0,l.jsx)("button",{className:"tab ".concat(j===e.key?"tab-active":""),onClick:()=>f(e.key),children:e.label},e.key))}),"parcelamento"===j&&(0,l.jsxs)("div",{className:"benefit-section",children:[(0,l.jsx)("h3",{className:"benefit-title",children:"Configuracao de Parcelamento"}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Maximo de Parcelas"}),(0,l.jsx)("input",{type:"number",className:"form-input",value:(null==g?void 0:null===(e=g.parcelamento)||void 0===e?void 0:e.max_parcelas)||"",onChange:e=>G("parcelamento","max_parcelas",e.target.value),placeholder:"Ex: 12"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Valor Minimo para Parcelar (R$)"}),(0,l.jsx)("input",{type:"number",step:"0.01",className:"form-input",value:(null==g?void 0:null===(a=g.parcelamento)||void 0===a?void 0:a.valor_minimo)||"",onChange:e=>G("parcelamento","valor_minimo",e.target.value),placeholder:"Ex: 50.00"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Parcelas Sem Juros"}),(0,l.jsx)("input",{type:"number",className:"form-input",value:(null==g?void 0:null===(s=g.parcelamento)||void 0===s?void 0:s.parcelas_sem_juros)||"",onChange:e=>G("parcelamento","parcelas_sem_juros",e.target.value),placeholder:"Ex: 3"})]}),(0,l.jsx)("button",{className:"btn btn-primary",onClick:()=>M("parcelamento"),disabled:E,children:E?(0,l.jsx)("span",{className:"spinner-sm"}):"Salvar Parcelamento"})]}),"frete"===j&&(0,l.jsxs)("div",{className:"benefit-section",children:[(0,l.jsx)("h3",{className:"benefit-title",children:"Configuracao de Frete"}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Frete Gratis Acima de (R$)"}),(0,l.jsx)("input",{type:"number",step:"0.01",className:"form-input",value:(null==g?void 0:null===(o=g.frete)||void 0===o?void 0:o.frete_gratis_acima)||"",onChange:e=>G("frete","frete_gratis_acima",e.target.value),placeholder:"Ex: 100.00"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Valor Padrao do Frete (R$)"}),(0,l.jsx)("input",{type:"number",step:"0.01",className:"form-input",value:(null==g?void 0:null===(n=g.frete)||void 0===n?void 0:n.valor_frete_padrao)||"",onChange:e=>G("frete","valor_frete_padrao",e.target.value),placeholder:"Ex: 8.90"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Raio de Entrega (km)"}),(0,l.jsx)("input",{type:"number",className:"form-input",value:(null==g?void 0:null===(d=g.frete)||void 0===d?void 0:d.raio_entrega)||"",onChange:e=>G("frete","raio_entrega",e.target.value),placeholder:"Ex: 10"})]}),(0,l.jsx)("button",{className:"btn btn-primary",onClick:()=>M("frete"),disabled:E,children:E?(0,l.jsx)("span",{className:"spinner-sm"}):"Salvar Frete"})]}),"cashback"===j&&(0,l.jsxs)("div",{className:"benefit-section",children:[(0,l.jsx)("h3",{className:"benefit-title",children:"Configuracao de Cashback"}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Percentual de Cashback (%)"}),(0,l.jsx)("input",{type:"number",step:"0.1",className:"form-input",value:(null==g?void 0:null===(m=g.cashback)||void 0===m?void 0:m.percentual)||"",onChange:e=>G("cashback","percentual",e.target.value),placeholder:"Ex: 5"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Cashback Maximo por Pedido (R$)"}),(0,l.jsx)("input",{type:"number",step:"0.01",className:"form-input",value:(null==g?void 0:null===(u=g.cashback)||void 0===u?void 0:u.maximo_por_pedido)||"",onChange:e=>G("cashback","maximo_por_pedido",e.target.value),placeholder:"Ex: 50.00"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Validade do Cashback (dias)"}),(0,l.jsx)("input",{type:"number",className:"form-input",value:(null==g?void 0:null===(p=g.cashback)||void 0===p?void 0:p.validade_dias)||"",onChange:e=>G("cashback","validade_dias",e.target.value),placeholder:"Ex: 30"})]}),(0,l.jsx)("button",{className:"btn btn-primary",onClick:()=>M("cashback"),disabled:E,children:E?(0,l.jsx)("span",{className:"spinner-sm"}):"Salvar Cashback"})]}),"cupons"===j&&(0,l.jsxs)("div",{className:"benefit-section",children:[(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[(0,l.jsx)("h3",{className:"benefit-title",style:{marginBottom:0},children:"Cupons de Desconto"}),(0,l.jsx)("button",{className:"btn btn-primary btn-sm",onClick:function(){$(null),A({codigo:"",desconto_tipo:"percentual",desconto_valor:"",valor_minimo:"",usos_maximo:"",data_inicio:"",data_fim:"",ativo:!0}),F(!0)},children:"+ Novo Cupom"})]}),0===w.length?(0,l.jsx)("div",{className:"empty-state",children:(0,l.jsx)("div",{className:"empty-state-text",children:"Nenhum cupom cadastrado"})}):(0,l.jsx)("div",{className:"table-wrapper",style:{boxShadow:"none"},children:(0,l.jsxs)("table",{className:"table",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Codigo"}),(0,l.jsx)("th",{children:"Desconto"}),(0,l.jsx)("th",{children:"Valor Min."}),(0,l.jsx)("th",{children:"Usos"}),(0,l.jsx)("th",{children:"Status"}),(0,l.jsx)("th",{style:{textAlign:"right",width:140},children:"Acoes"})]})}),(0,l.jsx)("tbody",{children:w.map(e=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{style:{fontWeight:600,fontFamily:"monospace"},children:e.codigo||e.code}),(0,l.jsx)("td",{children:"percentual"===(e.desconto_tipo||e.discount_type)?"".concat(e.desconto_valor||e.discount_value,"%"):"R$ ".concat(e.desconto_valor||e.discount_value)}),(0,l.jsx)("td",{children:e.valor_minimo||e.min_value?"R$ ".concat(e.valor_minimo||e.min_value):"-"}),(0,l.jsxs)("td",{children:[e.usos_realizados||e.uses||0,"/",e.usos_maximo||e.max_uses||"-"]}),(0,l.jsx)("td",{children:(0,l.jsx)("span",{className:"badge ".concat(!1!==e.ativo&&!1!==e.active?"badge-success":"badge-neutral"),children:!1!==e.ativo&&!1!==e.active?"Ativo":"Inativo"})}),(0,l.jsx)("td",{style:{textAlign:"right"},children:(0,l.jsxs)("div",{style:{display:"flex",gap:4,justifyContent:"flex-end"},children:[(0,l.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:()=>{$(e),A({codigo:e.codigo||e.code||"",desconto_tipo:e.desconto_tipo||e.discount_type||"percentual",desconto_valor:e.desconto_valor||e.discount_value||"",valor_minimo:e.valor_minimo||e.min_value||"",usos_maximo:e.usos_maximo||e.max_uses||"",data_inicio:e.data_inicio||e.start_date||"",data_fim:e.data_fim||e.end_date||"",ativo:!1!==e.ativo&&!1!==e.active}),F(!0)},children:"Editar"}),(0,l.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>O(e),children:"Excluir"})]})})]},e.id||e.coupon_id))})]})})]}),"garantia"===j&&(0,l.jsxs)("div",{className:"benefit-section",children:[(0,l.jsx)("h3",{className:"benefit-title",children:"Configuracao de Garantia"}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Prazo de Garantia (dias)"}),(0,l.jsx)("input",{type:"number",className:"form-input",value:(null==g?void 0:null===(h=g.garantia)||void 0===h?void 0:h.prazo_dias)||"",onChange:e=>G("garantia","prazo_dias",e.target.value),placeholder:"Ex: 7"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Politica de Devolucao"}),(0,l.jsx)("textarea",{className:"form-input",rows:4,value:(null==g?void 0:null===(v=g.garantia)||void 0===v?void 0:v.politica)||"",onChange:e=>G("garantia","politica",e.target.value),placeholder:"Descreva a politica de devolucao...",style:{resize:"vertical"}})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Troca Gratis"}),(0,l.jsxs)("select",{className:"form-select",value:(null==g?void 0:null===(x=g.garantia)||void 0===x?void 0:x.troca_gratis)||"nao",onChange:e=>G("garantia","troca_gratis",e.target.value),children:[(0,l.jsx)("option",{value:"sim",children:"Sim"}),(0,l.jsx)("option",{value:"nao",children:"Nao"})]})]}),(0,l.jsx)("button",{className:"btn btn-primary",onClick:()=>M("garantia"),disabled:E,children:E?(0,l.jsx)("span",{className:"spinner-sm"}):"Salvar Garantia"})]}),D&&(0,l.jsx)("div",{className:"modal-overlay",onClick:e=>e.target===e.currentTarget&&F(!1),children:(0,l.jsxs)("div",{className:"modal",children:[(0,l.jsxs)("div",{className:"modal-header",children:[(0,l.jsx)("h3",{className:"modal-title",children:R?"Editar Cupom":"Novo Cupom"}),(0,l.jsx)("button",{className:"modal-close",onClick:()=>F(!1),children:"\xd7"})]}),(0,l.jsxs)("form",{onSubmit:I,children:[(0,l.jsxs)("div",{className:"modal-body",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Codigo do Cupom"}),(0,l.jsx)("input",{type:"text",className:"form-input",value:z.codigo,onChange:e=>A({...z,codigo:e.target.value.toUpperCase()}),placeholder:"Ex: DESCONTO10",required:!0,style:{fontFamily:"monospace",textTransform:"uppercase"}})]}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Tipo de Desconto"}),(0,l.jsxs)("select",{className:"form-select",value:z.desconto_tipo,onChange:e=>A({...z,desconto_tipo:e.target.value}),children:[(0,l.jsx)("option",{value:"percentual",children:"Percentual (%)"}),(0,l.jsx)("option",{value:"fixo",children:"Valor Fixo (R$)"})]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Valor do Desconto"}),(0,l.jsx)("input",{type:"number",step:"0.01",className:"form-input",value:z.desconto_valor,onChange:e=>A({...z,desconto_valor:e.target.value}),required:!0})]})]}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Valor Minimo do Pedido (R$)"}),(0,l.jsx)("input",{type:"number",step:"0.01",className:"form-input",value:z.valor_minimo,onChange:e=>A({...z,valor_minimo:e.target.value}),placeholder:"Opcional"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Maximo de Usos"}),(0,l.jsx)("input",{type:"number",className:"form-input",value:z.usos_maximo,onChange:e=>A({...z,usos_maximo:e.target.value}),placeholder:"Ilimitado"})]})]}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Data Inicio"}),(0,l.jsx)("input",{type:"date",className:"form-input",value:z.data_inicio,onChange:e=>A({...z,data_inicio:e.target.value})})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Data Fim"}),(0,l.jsx)("input",{type:"date",className:"form-input",value:z.data_fim,onChange:e=>A({...z,data_fim:e.target.value})})]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Status"}),(0,l.jsxs)("select",{className:"form-select",value:z.ativo?"true":"false",onChange:e=>A({...z,ativo:"true"===e.target.value}),children:[(0,l.jsx)("option",{value:"true",children:"Ativo"}),(0,l.jsx)("option",{value:"false",children:"Inativo"})]})]})]}),(0,l.jsxs)("div",{className:"modal-footer",children:[(0,l.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>F(!1),children:"Cancelar"}),(0,l.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:E,children:E?(0,l.jsx)("span",{className:"spinner-sm"}):R?"Atualizar":"Criar"})]})]})]})})]})}}},function(e){e.O(0,[448,565,205,971,117,744],function(){return e(e.s=2861)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[721],{1694:function(e,t,a){Promise.resolve().then(a.bind(a,8806))},8806:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var r=a(7437),o=a(2265),s=a(4565),i=a(4477),n=a(6428),l=a(6971);let c=["seg","ter","qua","qui","sex","sab","dom"],d={seg:"Seg",ter:"Ter",qua:"Qua",qui:"Qui",sex:"Sex",sab:"Sab",dom:"Dom"},p=[{label:"Cafe da manha (06-11h)",start:"06:00",end:"11:00"},{label:"Almoco (11-15h)",start:"11:00",end:"15:00"},{label:"Jantar (18-23h)",start:"18:00",end:"23:00"},{label:"Madrugada (23-06h)",start:"23:00",end:"06:00"}];function u(e){let{enabled:t,onToggle:a,schedule:o,onScheduleChange:s}=e;return(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Horario de disponibilidade"}),(0,r.jsxs)("div",{className:"toggle-switch-wrapper",onClick:()=>a(!t),style:{cursor:"pointer",marginBottom:t?12:0},children:[(0,r.jsx)("div",{className:"toggle-switch ".concat(t?"":"toggle-switch-on"),children:(0,r.jsx)("div",{className:"toggle-switch-handle"})}),(0,r.jsx)("span",{style:{marginLeft:10,fontSize:14,color:t?"var(--color-text-muted)":"var(--color-success)"},children:t?"Horario especifico":"Disponivel o dia todo"})]}),t&&(0,r.jsxs)("div",{style:{padding:12,border:"1px solid var(--color-border, #ddd)",borderRadius:8,background:"var(--color-bg-muted, #f8f9fa)"},children:[(0,r.jsxs)("div",{style:{marginBottom:10},children:[(0,r.jsx)("span",{style:{fontSize:12,color:"var(--color-text-muted)",display:"block",marginBottom:6},children:"Presets rapidos:"}),(0,r.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:p.map((e,t)=>(0,r.jsx)("button",{type:"button",onClick:()=>{s({start:e.start,end:e.end,days:o.days||[...c]})},style:{padding:"4px 10px",borderRadius:12,border:"1px solid var(--color-border, #ddd)",background:o.start===e.start&&o.end===e.end?"#e3f2fd":"white",color:o.start===e.start&&o.end===e.end?"#1565c0":"var(--color-text-secondary, #666)",fontSize:12,cursor:"pointer",fontWeight:o.start===e.start&&o.end===e.end?600:400},children:e.label},t))})]}),(0,r.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:10,alignItems:"center"},children:[(0,r.jsxs)("div",{style:{flex:1},children:[(0,r.jsx)("label",{style:{fontSize:12,color:"var(--color-text-muted)",display:"block",marginBottom:4},children:"Inicio"}),(0,r.jsx)("input",{type:"time",className:"form-input",value:o.start||"06:00",onChange:e=>s({...o,start:e.target.value}),style:{fontSize:14}})]}),(0,r.jsx)("span",{style:{paddingTop:18,color:"var(--color-text-muted)"},children:"ate"}),(0,r.jsxs)("div",{style:{flex:1},children:[(0,r.jsx)("label",{style:{fontSize:12,color:"var(--color-text-muted)",display:"block",marginBottom:4},children:"Fim"}),(0,r.jsx)("input",{type:"time",className:"form-input",value:o.end||"23:00",onChange:e=>s({...o,end:e.target.value}),style:{fontSize:14}})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{fontSize:12,color:"var(--color-text-muted)",display:"block",marginBottom:6},children:"Dias da semana:"}),(0,r.jsx)("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:c.map(e=>{let t=(o.days||c).includes(e);return(0,r.jsx)("button",{type:"button",onClick:()=>(function(e){let t=o.days||[...c],a=t.includes(e)?t.filter(t=>t!==e):[...t,e];0!==a.length&&s({...o,days:a})})(e),style:{width:40,height:32,borderRadius:6,border:t?"1.5px solid #43A047":"1.5px solid var(--color-border, #ddd)",background:t?"#E8F5E9":"white",color:t?"#2E7D32":"var(--color-text-secondary, #999)",fontSize:12,fontWeight:t?600:400,cursor:"pointer",transition:"all 0.15s"},children:d[e]},e)})})]}),(0,r.jsxs)("div",{style:{marginTop:8,fontSize:12,color:"var(--color-text-muted)",padding:"6px 8px",background:"white",borderRadius:4,border:"1px solid var(--color-border, #eee)"},children:["Produto disponivel das ",(0,r.jsx)("strong",{children:o.start||"06:00"})," ate ",(0,r.jsx)("strong",{children:o.end||"23:00"})," ","em ",7===(o.days||c).length?"todos os dias":(o.days||c).map(e=>d[e]).join(", ")]})]})]})}function m(e){let{categories:t,value:a,onChange:s,onCreateCategory:i,placeholder:n}=e,[l,c]=(0,o.useState)(!1),[d,p]=(0,o.useState)(""),[u,m]=(0,o.useState)(!1),x=(0,o.useRef)(null),h=(0,o.useRef)(null),g=t.find(e=>String(e.category_id||e.id)===String(a)),v=g?g.full_name||g.name||g.nome:"",y=t.filter(e=>(e.full_name||e.name||e.nome||"").toLowerCase().includes(d.toLowerCase())),f=t.some(e=>(e.name||e.nome||"").toLowerCase()===d.toLowerCase().trim());async function j(){if(d.trim()&&!u){m(!0);try{let e=await i(d.trim());(null==e?void 0:e.category_id)&&(s(String(e.category_id)),p(""),c(!1))}finally{m(!1)}}}return(0,o.useEffect)(()=>{function e(e){x.current&&!x.current.contains(e.target)&&(c(!1),p(""))}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,r.jsxs)("div",{ref:x,style:{position:"relative"},children:[(0,r.jsxs)("div",{className:"form-input",style:{cursor:"pointer",display:"flex",alignItems:"center",gap:6,minHeight:38},onClick:()=>{c(!l),l||setTimeout(()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.focus()},50)},children:[l?(0,r.jsx)("input",{ref:h,type:"text",value:d,onChange:e=>p(e.target.value),placeholder:v||n||"Buscar ou criar...",style:{border:"none",outline:"none",background:"transparent",flex:1,fontSize:14,padding:0},onClick:e=>e.stopPropagation()}):(0,r.jsx)("span",{style:{flex:1,color:v?"inherit":"#999",fontSize:14},children:v||n||"Selecione..."}),(0,r.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{flexShrink:0,opacity:.5},children:(0,r.jsx)("polyline",{points:l?"18 15 12 9 6 15":"6 9 12 15 18 9"})})]}),l&&(0,r.jsxs)("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:50,background:"#fff",border:"1px solid #ddd",borderRadius:8,boxShadow:"0 8px 24px rgba(0,0,0,0.12)",maxHeight:240,overflowY:"auto",marginTop:4},children:[(0,r.jsx)("div",{style:{padding:"8px 12px",cursor:"pointer",fontSize:13,color:"#999",borderBottom:"1px solid #f0f0f0"},onClick:()=>{s(""),p(""),c(!1)},children:"Sem categoria"}),y.map(e=>(0,r.jsx)("div",{style:{padding:"8px 12px",cursor:"pointer",fontSize:14,background:String(e.category_id||e.id)===String(a)?"#f0fdf4":"transparent",fontWeight:String(e.category_id||e.id)===String(a)?600:400},onClick:()=>{s(String(e.category_id||e.id)),p(""),c(!1)},onMouseEnter:e=>e.target.style.background="#f5f5f5",onMouseLeave:t=>t.target.style.background=String(e.category_id||e.id)===String(a)?"#f0fdf4":"transparent",children:e.full_name||e.name||e.nome},e.category_id||e.id)),d.trim()&&!f&&(0,r.jsx)("div",{style:{padding:"10px 12px",cursor:"pointer",fontSize:14,color:"#00A868",fontWeight:600,borderTop:"1px solid #f0f0f0",display:"flex",alignItems:"center",gap:6},onClick:j,children:u?(0,r.jsx)("span",{children:"Criando..."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[(0,r.jsx)("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),(0,r.jsx)("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),'Criar "',d.trim(),'"']})}),0===y.length&&(!d.trim()||f)&&(0,r.jsx)("div",{style:{padding:"12px",textAlign:"center",color:"#999",fontSize:13},children:"Nenhuma categoria encontrada"})]})]})}function x(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e||0)}let h=[{key:"",label:"Todos"},{key:"low_stock",label:"Estoque Baixo"},{key:"out_of_stock",label:"Esgotados"}],g=[{slug:"vegano",label:"Vegano"},{slug:"sem_gluten",label:"Sem Gluten"},{slug:"sem_lactose",label:"Sem Lactose"},{slug:"organico",label:"Organico"},{slug:"zero_acucar",label:"Zero Acucar"},{slug:"integral",label:"Integral"}],v={nome:"",descricao:"",categoria_id:"",preco:"",preco_promo:"",estoque:"",unidade:"un",ativo:!0,schedule_enabled:!1,availability_schedule:null},y=["seg","ter","qua","qui","sex","sab","dom"];function f(){return(0,r.jsx)(s.Z,{children:(0,r.jsx)(i.Z,{children:(0,r.jsx)(j,{})})})}function j(){let{addNotification:e}=(0,l.l)(),[t,a]=(0,o.useState)([]),[s,i]=(0,o.useState)([]),[c,d]=(0,o.useState)(""),[p,f]=(0,o.useState)(""),[j,b]=(0,o.useState)(""),[k,N]=(0,o.useState)(1),[w,C]=(0,o.useState)(1),[_,S]=(0,o.useState)(!0),[z,q]=(0,o.useState)(""),[L,B]=(0,o.useState)(null),[E,P]=(0,o.useState)({preco:"",estoque:"",preco_promo:""}),[W,A]=(0,o.useState)([]),[R,I]=(0,o.useState)(!1),M=(0,o.useRef)(null),[F,D]=(0,o.useState)(null),[T,G]=(0,o.useState)(null),[O,H]=(0,o.useState)(!1),V=(0,o.useRef)(null),[$,U]=(0,o.useState)([]),[J,Q]=(0,o.useState)(!1),[Z,K]=(0,o.useState)(!1),[Y,X]=(0,o.useState)({name:"",required:!1,min_select:0,max_select:1}),[ee,et]=(0,o.useState)(null),[ea,er]=(0,o.useState)(null),[eo,es]=(0,o.useState)({name:"",price_extra:"",description:""}),[ei,en]=(0,o.useState)(null),[el,ec]=(0,o.useState)(!1),[ed,ep]=(0,o.useState)(!1),[eu,em]=(0,o.useState)(null),[ex,eh]=(0,o.useState)(""),[eg,ev]=(0,o.useState)(""),[ey,ef]=(0,o.useState)(!1),[ej,eb]=(0,o.useState)(!1),[ek,eN]=(0,o.useState)({...v}),[ew,eC]=(0,o.useState)(!1),[e_,eS]=(0,o.useState)(null),[ez,eq]=(0,o.useState)(null),eL=(0,o.useRef)(null),[eB,eE]=(0,o.useState)(new Set),[eP,eW]=(0,o.useState)(!1),[eA,eR]=(0,o.useState)("percent"),[eI,eM]=(0,o.useState)(""),[eF,eD]=(0,o.useState)(!1),eT=(0,o.useCallback)(async()=>{try{let e=await (0,n.SC)("/categories.php"),t=(null==e?void 0:e.items)||(null==e?void 0:e.categories)||(Array.isArray(e)?e:[]);return i(t),t}catch(e){return[]}},[]);async function eG(t){try{let a=await (0,n.sg)("/categories.php",{name:t});if(null==a?void 0:a.category_id)return e(a.already_existed?"Categoria ja existia":"Categoria criada!",a.already_existed?"info":"success"),await eT(),a}catch(t){e(t.message||"Erro ao criar categoria","error")}return null}(0,o.useEffect)(()=>{eT()},[eT]);let eO=(0,o.useCallback)(async()=>{S(!0),q("");try{var e;let t=await (0,n.SC)("/products.php",{search:c,category:p,page:k});a(t.products||t.items||[]),C(t.total_pages||(null===(e=t.pagination)||void 0===e?void 0:e.pages)||1)}catch(e){q(e.message)}finally{S(!1)}},[c,p,k]);(0,o.useEffect)(()=>{eO()},[eO]);let[eH,eV]=(0,o.useState)(!1),[e$,eU]=(0,o.useState)({start:"06:00",end:"23:00",days:[...y]});async function eJ(t,a){if(0!==eB.size){eD(!0);try{let r={action:t,product_ids:[...eB],...a};await (0,n.sg)("/product-bulk.php",r),e("".concat(eB.size," produto(s) atualizados"),"success"),eE(new Set),eW(!1),await eO()}catch(t){e(t.message||"Erro na operacao em lote","error")}finally{eD(!1)}}}async function eQ(e){Q(!0);try{let t=await (0,n.SC)("/opcoes.php",{product_id:e});U((null==t?void 0:t.groups)||[])}catch(e){U([])}finally{Q(!1)}}async function eZ(t){if(Y.name.trim()){ec(!0);try{await (0,n.sg)("/opcoes.php",{action:"create_group",product_id:t,name:Y.name.trim(),required:Y.required?1:0,min_select:parseInt(Y.min_select)||0,max_select:Math.max(1,parseInt(Y.max_select)||1)}),e("Grupo criado!","success"),K(!1),X({name:"",required:!1,min_select:0,max_select:1}),await eQ(t)}catch(t){e(t.message,"error")}finally{ec(!1)}}}async function eK(t){if(ee&&ee.name.trim()){ec(!0);try{await (0,n.sg)("/opcoes.php",{action:"update_group",group_id:ee.id,name:ee.name.trim(),required:ee.required?1:0,min_select:parseInt(ee.min_select)||0,max_select:Math.max(1,parseInt(ee.max_select)||1)}),e("Grupo atualizado!","success"),et(null),await eQ(t)}catch(t){e(t.message,"error")}finally{ec(!1)}}}async function eY(t,a){if(confirm("Remover este grupo e todas as opcoes?"))try{await (0,n.sg)("/opcoes.php",{action:"delete_group",group_id:a}),e("Grupo removido","success"),await eQ(t)}catch(t){e(t.message,"error")}}async function eX(t,a){if(eo.name.trim()){ec(!0);try{await (0,n.sg)("/opcoes.php",{action:"create_option",group_id:a,name:eo.name.trim(),price_extra:parseFloat(eo.price_extra)||0,description:eo.description.trim()||null}),e("Opcao criada!","success"),er(null),es({name:"",price_extra:"",description:""}),await eQ(t)}catch(t){e(t.message,"error")}finally{ec(!1)}}}async function e0(t){if(ei&&ei.name.trim()){ec(!0);try{var a;await (0,n.sg)("/opcoes.php",{action:"update_option",option_id:ei.id,name:ei.name.trim(),price_extra:parseFloat(ei.price_extra)||0,description:(null===(a=ei.description)||void 0===a?void 0:a.trim())||null}),e("Opcao atualizada!","success"),en(null),await eQ(t)}catch(t){e(t.message,"error")}finally{ec(!1)}}}async function e1(t,a){if(confirm("Remover esta opcao?"))try{await (0,n.sg)("/opcoes.php",{action:"delete_option",option_id:a}),e("Opcao removida","success"),await eQ(t)}catch(t){e(t.message,"error")}}async function e2(t,a){try{await (0,n.sg)("/opcoes.php",{action:"toggle_option",option_id:a}),await eQ(t)}catch(t){e(t.message,"error")}}function e4(){D(null),G(null),V.current&&(V.current.value="")}async function e6(t){let a=t||L&&(L.product_id||L.id);if(F&&a){H(!0);try{let t=new FormData;t.append("file",F),t.append("product_id",a);let r=await (0,n.zi)("/product-upload.php",t);e("Foto atualizada com sucesso!","success"),L&&B(e=>({...e,image:r.url,imagem:r.url})),e4(),eO()}catch(t){e("Erro ao enviar foto: "+t.message,"error")}finally{H(!1)}}}async function e5(t){t.preventDefault(),I(!0);try{await (0,n.sg)("/product-save.php",{product_id:L.id||L.product_id,price:parseFloat(E.preco)||0,stock:parseInt(E.estoque)||0,promotional_price:E.preco_promo?parseFloat(E.preco_promo):null,availability_schedule:eH?e$:null,dietary_tags:W}),F&&await e6(),e("Produto atualizado com sucesso!","success"),B(null),e4(),eO()}catch(t){e(t.message,"error")}finally{I(!1)}}let[e3,e8]=(0,o.useState)(!1),[e9,e7]=(0,o.useState)({start:"06:00",end:"23:00",days:[...y]});function te(){eN({...v}),eS(null),eq(null),e8(!1),e7({start:"06:00",end:"23:00",days:[...y]}),eb(!0)}function tt(){eb(!1),eN({...v}),eS(null),eq(null),eL.current&&(eL.current.value="")}async function ta(t){t.preventDefault(),eC(!0);try{if(!ek.nome.trim()){e("Nome do produto e obrigatorio","error"),eC(!1);return}if(!ek.preco||0>=parseFloat(ek.preco)){e("Preco deve ser maior que zero","error"),eC(!1);return}if(""===ek.estoque||0>parseInt(ek.estoque)){e("Estoque e obrigatorio e deve ser >= 0","error"),eC(!1);return}let t=ek.preco_promo?parseFloat(ek.preco_promo):null,a=parseFloat(ek.preco);if(null!==t&&t>=a){e("Preco promocional deve ser menor que o preco normal","error"),eC(!1);return}let r=await (0,n.sg)("/product-create.php",{name:ek.nome.trim(),description:ek.descricao.trim(),category_id:ek.categoria_id?parseInt(ek.categoria_id):0,price:a,promotional_price:t,stock:parseInt(ek.estoque)||0,unit:ek.unidade||"un",status:ek.ativo?1:0,availability_schedule:e3?e9:null});if(e_&&(null==r?void 0:r.product_id))try{let e=new FormData;e.append("file",e_),e.append("product_id",r.product_id),await (0,n.zi)("/product-upload.php",e)}catch(t){e("Produto criado, mas erro ao enviar foto: "+t.message,"warning")}e("Produto criado com sucesso!","success"),tt(),eO()}catch(t){e(t.message||"Erro ao criar produto","error")}finally{eC(!1)}}let tr=t.filter(e=>{var t,a;let r=null!==(a=null!==(t=e.estoque)&&void 0!==t?t:e.stock)&&void 0!==a?a:null;return null!==r&&r<=0}),to=t.filter(e=>{var t,a;let r=null!==(a=null!==(t=e.estoque)&&void 0!==t?t:e.stock)&&void 0!==a?a:null;return null!==r&&r>0&&r<5}),ts="out_of_stock"===j?tr:"low_stock"===j?to:t;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"page-header",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"page-title",children:"Produtos"}),(0,r.jsx)("p",{className:"page-subtitle",children:"Gerencie seu catalogo de produtos"})]}),(0,r.jsxs)("button",{className:"btn btn-primary",onClick:te,children:[(0,r.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:6},children:[(0,r.jsx)("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),(0,r.jsx)("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Adicionar Produto"]})]}),tr.length>0&&(0,r.jsxs)("div",{className:"stock-alert-banner stock-alert-danger",children:[(0,r.jsx)("div",{className:"stock-alert-icon",children:(0,r.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"}),(0,r.jsx)("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),(0,r.jsx)("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("strong",{children:[tr.length," produto",tr.length>1?"s":""," esgotado",tr.length>1?"s":""]}),(0,r.jsxs)("div",{style:{fontSize:13,opacity:.9},children:[tr.slice(0,3).map(e=>e.nome||e.name).join(", "),tr.length>3&&" e mais ".concat(tr.length-3,"...")]})]}),(0,r.jsx)("button",{className:"btn btn-sm",style:{marginLeft:"auto",background:"rgba(255,255,255,0.2)",color:"white",flexShrink:0},onClick:()=>b("out_of_stock"),children:"Ver Esgotados"})]}),to.length>0&&(0,r.jsxs)("div",{className:"stock-alert-banner stock-alert-warning",children:[(0,r.jsx)("div",{className:"stock-alert-icon",children:(0,r.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,r.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("strong",{children:[to.length," produto",to.length>1?"s":""," com estoque baixo"]}),(0,r.jsx)("div",{style:{fontSize:13,opacity:.9},children:"Menos de 5 unidades restantes"})]})]}),(0,r.jsx)("div",{className:"tabs",style:{marginBottom:16},children:h.map(e=>(0,r.jsxs)("button",{className:"tab ".concat(j===e.key?"tab-active":""),onClick:()=>{b(e.key)},children:[e.label,"out_of_stock"===e.key&&tr.length>0&&(0,r.jsx)("span",{className:"badge badge-danger",style:{marginLeft:6,fontSize:11,padding:"1px 6px"},children:tr.length}),"low_stock"===e.key&&to.length>0&&(0,r.jsx)("span",{className:"badge badge-warning",style:{marginLeft:6,fontSize:11,padding:"1px 6px"},children:to.length})]},e.key))}),(0,r.jsxs)("div",{className:"toolbar",children:[(0,r.jsx)("div",{className:"toolbar-search",children:(0,r.jsxs)("div",{className:"search-bar",children:[(0,r.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,r.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,r.jsx)("path",{d:"M21 21l-4.35-4.35"})]}),(0,r.jsx)("input",{type:"text",placeholder:"Buscar produto...",onChange:function(e){let t=e.target.value;M.current&&clearTimeout(M.current),M.current=setTimeout(()=>{d(t),N(1)},400)}})]})}),(0,r.jsx)("div",{style:{width:220},children:(0,r.jsx)(m,{categories:s,value:p,onChange:e=>{f(e),N(1)},onCreateCategory:eG,placeholder:"Todas categorias"})}),(0,r.jsxs)("button",{className:"btn btn-sm",style:{whiteSpace:"nowrap"},onClick:()=>ep(!0),title:"Gerenciar categorias",children:[(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:4},children:[(0,r.jsx)("path",{d:"M12 20h9"}),(0,r.jsx)("path",{d:"M16.5 3.5a2.121 2.121 0 013 3L7 19l-4 1 1-4L16.5 3.5z"})]}),"Categorias"]})]}),_?(0,r.jsx)("div",{className:"loading-screen",children:(0,r.jsx)("div",{className:"spinner"})}):z?(0,r.jsxs)("div",{className:"empty-state",children:[(0,r.jsx)("div",{className:"empty-state-title",children:"Erro ao carregar produtos"}),(0,r.jsx)("div",{className:"empty-state-text",children:z})]}):0===ts.length?(0,r.jsxs)("div",{className:"empty-state",children:[(0,r.jsxs)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",style:{opacity:.4,marginBottom:12},children:[(0,r.jsx)("path",{d:"M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"}),(0,r.jsx)("polyline",{points:"3.27 6.96 12 12.01 20.73 6.96"}),(0,r.jsx)("line",{x1:"12",y1:"22.08",x2:"12",y2:"12"})]}),(0,r.jsx)("div",{className:"empty-state-title",children:j?"Nenhum produto com este filtro":"Nenhum produto encontrado"}),(0,r.jsx)("div",{className:"empty-state-text",children:j?"Nenhum produto com este filtro de estoque":c?"Tente alterar os filtros de busca":"Comece adicionando seu primeiro produto"}),!j&&!c&&(0,r.jsxs)("button",{className:"btn btn-primary",style:{marginTop:16},onClick:te,children:[(0,r.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:6},children:[(0,r.jsx)("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),(0,r.jsx)("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Adicionar Produto"]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8,padding:"0 4px"},children:[(0,r.jsx)("input",{type:"checkbox",className:"product-checkbox",checked:eB.size>0&&eB.size===(ts||t).length,onChange:function(){let e=(ts||t).map(e=>e.id||e.product_id);eB.size===e.length?eE(new Set):eE(new Set(e))}}),(0,r.jsx)("span",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:eB.size>0?"".concat(eB.size," selecionado(s)"):"Selecionar todos"})]}),(0,r.jsx)("div",{className:"product-grid",children:ts.map(e=>{var t,a,o,s,i,n,l;let c=function(e){var t,a;let o=null!==(a=null!==(t=e.estoque)&&void 0!==t?t:e.stock)&&void 0!==a?a:null;return null===o?null:o<=0?(0,r.jsx)("span",{className:"badge badge-danger stock-badge-danger",children:"Esgotado"}):o<5?(0,r.jsx)("span",{className:"badge badge-warning stock-badge-warning",children:"Estoque baixo"}):null}(e),d=e.id||e.product_id;return(0,r.jsxs)("div",{className:"product-card ".concat((null!==(t=e.estoque)&&void 0!==t?t:e.stock)===0?"product-card-oos":""),onClick:()=>(function(e){var t,a;B(e),P({preco:e.preco||e.price||"",estoque:null!==(a=null!==(t=e.estoque)&&void 0!==t?t:e.stock)&&void 0!==a?a:"",preco_promo:e.preco_promocional||e.promotional_price||e.promo_price||""});let r=e.availability_schedule;r&&r.start&&r.end?(eV(!0),eU({start:r.start||"06:00",end:r.end||"23:00",days:Array.isArray(r.days)?[...r.days]:[...y]})):(eV(!1),eU({start:"06:00",end:"23:00",days:[...y]}));let o=e.dietary_tags;A(Array.isArray(o)?[...o]:[]),D(null),G(null),U([]),K(!1),er(null),et(null),en(null);let s=e.id||e.product_id;s&&eQ(s)})(e),style:eB.has(d)?{outline:"2px solid var(--color-primary)",outlineOffset:-2}:{},children:[(0,r.jsx)("div",{style:{position:"absolute",top:8,left:8,zIndex:5},children:(0,r.jsx)("input",{type:"checkbox",className:"product-checkbox",checked:eB.has(d),onChange:e=>{e.stopPropagation(),eE(e=>{let t=new Set(e);return t.has(d)?t.delete(d):t.add(d),t})}})}),(0,r.jsxs)("div",{className:"product-card-image-wrapper",children:[e.imagem||e.image?(0,r.jsx)("img",{src:e.imagem||e.image,alt:e.nome||e.name,className:"product-card-image"}):(0,r.jsx)("div",{className:"product-card-image",style:{display:"flex",alignItems:"center",justifyContent:"center",color:"var(--color-text-muted)",fontSize:13},children:"Sem imagem"}),c&&(0,r.jsx)("div",{className:"product-card-stock-badge",children:c})]}),(0,r.jsxs)("div",{className:"product-card-body",children:[(0,r.jsx)("div",{className:"product-card-name",children:e.nome||e.name}),(0,r.jsx)("div",{className:"product-card-price",children:x(e.preco||e.price)}),(e.preco_promocional||e.promotional_price||e.promo_price)&&(0,r.jsxs)("div",{style:{fontSize:12,color:"var(--color-success)"},children:["Promo: ",x(e.preco_promocional||e.promotional_price||e.promo_price)]}),e.dietary_tags&&Array.isArray(e.dietary_tags)&&e.dietary_tags.length>0&&(0,r.jsx)("div",{style:{display:"flex",gap:3,flexWrap:"wrap",marginTop:4},children:e.dietary_tags.map(e=>(0,r.jsx)("span",{style:{display:"inline-block",padding:"1px 6px",borderRadius:4,background:"#E8F5E9",color:"#2E7D32",fontSize:10,fontWeight:600},children:(g.find(t=>t.slug===e)||{label:e}).label},e))})]}),(0,r.jsxs)("div",{className:"product-card-footer",children:[(0,r.jsxs)("span",{className:"product-card-stock ".concat((null!==(o=null!==(a=e.estoque)&&void 0!==a?a:e.stock)&&void 0!==o?o:0)===0?"stock-zero":(null!==(i=null!==(s=e.estoque)&&void 0!==s?s:e.stock)&&void 0!==i?i:0)<5?"stock-low":""),children:["Estoque: ",null!==(l=null!==(n=e.estoque)&&void 0!==n?n:e.stock)&&void 0!==l?l:"-"]}),(0,r.jsxs)("div",{style:{display:"flex",gap:4,alignItems:"center",flexWrap:"wrap"},children:[e.availability_schedule&&(0,r.jsxs)("span",{className:"badge",style:{background:!1!==e.is_available_now?"#e8f5e9":"#fff3e0",color:!1!==e.is_available_now?"#2e7d32":"#e65100",fontSize:10,padding:"1px 5px"},children:[e.availability_schedule.start,"-",e.availability_schedule.end]}),(0,r.jsx)("span",{className:"badge ".concat(!1!==e.ativo&&"inativo"!==e.status&&0!==e.status?"badge-success":"badge-neutral"),children:!1!==e.ativo&&"inativo"!==e.status&&0!==e.status?"Ativo":"Inativo"})]})]})]},d)})}),w>1&&!j&&(0,r.jsxs)("div",{className:"pagination",children:[(0,r.jsx)("button",{className:"pagination-btn",disabled:k<=1,onClick:()=>N(e=>e-1),children:"Anterior"}),Array.from({length:Math.min(w,7)},(e,t)=>{let a;return a=w<=7?t+1:k<=4?t+1:k>=w-3?w-6+t:k-3+t,(0,r.jsx)("button",{className:"pagination-btn ".concat(k===a?"pagination-btn-active":""),onClick:()=>N(a),children:a},a)}),(0,r.jsx)("button",{className:"pagination-btn",disabled:k>=w,onClick:()=>N(e=>e+1),children:"Proximo"})]})]}),L&&(0,r.jsx)("div",{className:"modal-overlay",onClick:e=>e.target===e.currentTarget&&B(null),children:(0,r.jsxs)("div",{className:"modal",children:[(0,r.jsxs)("div",{className:"modal-header",children:[(0,r.jsx)("h3",{className:"modal-title",children:"Editar Produto"}),(0,r.jsx)("button",{className:"modal-close",onClick:()=>{B(null),e4()},children:"\xd7"})]}),(0,r.jsxs)("form",{onSubmit:e5,children:[(0,r.jsxs)("div",{className:"modal-body",children:[(0,r.jsx)("div",{style:{marginBottom:12,fontWeight:600,fontSize:15},children:L.nome||L.name}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Foto do Produto"}),(0,r.jsxs)("div",{className:"photo-upload-section",children:[(0,r.jsx)("div",{className:"photo-upload-preview",children:T?(0,r.jsx)("img",{src:T,alt:"Preview",className:"photo-preview-img"}):L.imagem||L.image?(0,r.jsx)("img",{src:L.imagem||L.image,alt:L.nome||L.name,className:"photo-preview-img"}):(0,r.jsxs)("div",{className:"photo-preview-placeholder",children:[(0,r.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,r.jsx)("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),(0,r.jsx)("polyline",{points:"21 15 16 10 5 21"})]}),(0,r.jsx)("span",{children:"Sem foto"})]})}),(0,r.jsxs)("div",{className:"photo-upload-actions",children:[(0,r.jsx)("input",{ref:V,type:"file",accept:"image/jpeg,image/png,image/webp",onChange:function(t){var a;let r=null===(a=t.target.files)||void 0===a?void 0:a[0];if(!r)return;if(r.size>2097152){e("Arquivo muito grande. Maximo: 2MB","error");return}if(!["image/jpeg","image/png","image/webp"].includes(r.type)){e("Tipo de arquivo nao permitido. Use: JPG, PNG ou WebP","error");return}D(r);let o=new FileReader;o.onload=e=>G(e.target.result),o.readAsDataURL(r)},style:{display:"none"}}),(0,r.jsxs)("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:()=>{var e;return null===(e=V.current)||void 0===e?void 0:e.click()},disabled:O,children:[(0,r.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"}),(0,r.jsx)("polyline",{points:"17 8 12 3 7 8"}),(0,r.jsx)("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),F?"Trocar Foto":"Escolher Foto"]}),F&&(0,r.jsx)("button",{type:"button",className:"btn btn-sm btn-danger",onClick:e4,children:"Remover"}),(0,r.jsx)("div",{className:"photo-upload-hint",children:"JPG, PNG ou WebP. Max 2MB."})]})]})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Preco (R$)"}),(0,r.jsx)("input",{type:"number",step:"0.01",className:"form-input",value:E.preco,onChange:e=>P({...E,preco:e.target.value}),required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Preco Promocional (R$)"}),(0,r.jsx)("input",{type:"number",step:"0.01",className:"form-input",value:E.preco_promo,onChange:e=>P({...E,preco_promo:e.target.value}),placeholder:"Deixe vazio se nao houver"})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Estoque"}),(0,r.jsx)("input",{type:"number",className:"form-input",value:E.estoque,onChange:e=>P({...E,estoque:e.target.value}),required:!0}),0===parseInt(E.estoque)&&(0,r.jsx)("div",{className:"form-hint form-hint-danger",children:"Estoque zerado! O produto aparecera como esgotado."}),parseInt(E.estoque)>0&&5>parseInt(E.estoque)&&(0,r.jsx)("div",{className:"form-hint form-hint-warning",children:"Estoque baixo! Considere reabastecer."})]}),(0,r.jsx)(u,{enabled:eH,onToggle:eV,schedule:e$,onScheduleChange:eU}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Tags Alimentares"}),(0,r.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:g.map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>{var t;return t=e.slug,void A(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},style:{padding:"5px 12px",borderRadius:16,border:W.includes(e.slug)?"1.5px solid #43A047":"1.5px solid var(--color-border, #ddd)",background:W.includes(e.slug)?"#E8F5E9":"var(--color-bg, #fff)",color:W.includes(e.slug)?"#2E7D32":"var(--color-text-secondary, #666)",fontSize:13,fontWeight:500,cursor:"pointer",transition:"all 0.15s"},children:[W.includes(e.slug)?"âœ“ ":"",e.label]},e.slug))}),(0,r.jsx)("div",{className:"form-hint",style:{marginTop:4},children:"Selecione as tags que se aplicam a este produto"})]}),(0,r.jsxs)("div",{className:"form-group",style:{borderTop:"1px solid var(--color-border, #eee)",paddingTop:16},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[(0,r.jsx)("label",{className:"form-label",style:{margin:0},children:"Complementos / Opcoes"}),(0,r.jsx)("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:()=>{K(!0),X({name:"",required:!1,min_select:0,max_select:1})},children:"+ Grupo"})]}),J?(0,r.jsx)("div",{style:{textAlign:"center",padding:12,color:"var(--color-text-muted, #999)"},children:"Carregando..."}):0!==$.length||Z?null:(0,r.jsx)("div",{style:{padding:12,textAlign:"center",color:"var(--color-text-muted, #999)",fontSize:13},children:'Nenhum grupo de opcoes. Clique em "+ Grupo" para adicionar complementos como sabores, ingredientes, tamanhos, etc.'}),Z&&(0,r.jsxs)("div",{style:{background:"var(--color-bg-muted, #f5f5f5)",borderRadius:8,padding:12,marginBottom:10},children:[(0,r.jsx)("div",{style:{fontSize:13,fontWeight:600,marginBottom:8},children:"Novo Grupo"}),(0,r.jsx)("input",{type:"text",className:"form-input",placeholder:"Ex: Complementos, Tamanho, Sabor...",value:Y.name,onChange:e=>X({...Y,name:e.target.value}),style:{marginBottom:8}}),(0,r.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:8},children:[(0,r.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:4,fontSize:13,cursor:"pointer"},children:[(0,r.jsx)("input",{type:"checkbox",checked:Y.required,onChange:e=>X({...Y,required:e.target.checked})}),"Obrigatorio"]}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4},children:[(0,r.jsx)("span",{style:{fontSize:12},children:"Min:"}),(0,r.jsx)("input",{type:"number",min:"0",max:"20",className:"form-input",style:{width:60,padding:"4px 6px"},value:Y.min_select,onChange:e=>X({...Y,min_select:e.target.value})}),(0,r.jsx)("span",{style:{fontSize:12},children:"Max:"}),(0,r.jsx)("input",{type:"number",min:"1",max:"20",className:"form-input",style:{width:60,padding:"4px 6px"},value:Y.max_select,onChange:e=>X({...Y,max_select:e.target.value})})]})]}),(0,r.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,r.jsx)("button",{type:"button",className:"btn btn-sm btn-primary",disabled:el||!Y.name.trim(),onClick:()=>eZ(L.id||L.product_id),children:el?"...":"Criar"}),(0,r.jsx)("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:()=>K(!1),children:"Cancelar"})]})]}),$.map(e=>{var t;return(0,r.jsxs)("div",{style:{border:"1px solid var(--color-border, #ddd)",borderRadius:8,marginBottom:8,overflow:"hidden"},children:[ee&&ee.id===e.id?(0,r.jsxs)("div",{style:{padding:10,background:"var(--color-bg-muted, #f5f5f5)"},children:[(0,r.jsx)("input",{type:"text",className:"form-input",value:ee.name,onChange:e=>et({...ee,name:e.target.value}),style:{marginBottom:6}}),(0,r.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:6},children:[(0,r.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:4,fontSize:13,cursor:"pointer"},children:[(0,r.jsx)("input",{type:"checkbox",checked:ee.required,onChange:e=>et({...ee,required:e.target.checked})}),"Obrigatorio"]}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4},children:[(0,r.jsx)("span",{style:{fontSize:12},children:"Min:"}),(0,r.jsx)("input",{type:"number",min:"0",max:"20",className:"form-input",style:{width:60,padding:"4px 6px"},value:ee.min_select,onChange:e=>et({...ee,min_select:e.target.value})}),(0,r.jsx)("span",{style:{fontSize:12},children:"Max:"}),(0,r.jsx)("input",{type:"number",min:"1",max:"20",className:"form-input",style:{width:60,padding:"4px 6px"},value:ee.max_select,onChange:e=>et({...ee,max_select:e.target.value})})]})]}),(0,r.jsxs)("div",{style:{display:"flex",gap:6},children:[(0,r.jsx)("button",{type:"button",className:"btn btn-sm btn-primary",disabled:el,onClick:()=>eK(L.id||L.product_id),children:"Salvar"}),(0,r.jsx)("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:()=>et(null),children:"Cancelar"})]})]}):(0,r.jsxs)("div",{style:{padding:"8px 10px",background:"var(--color-bg-muted, #f5f5f5)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{style:{fontWeight:600,fontSize:14},children:e.name}),e.required&&(0,r.jsx)("span",{style:{marginLeft:6,fontSize:10,padding:"1px 6px",borderRadius:4,background:"#ef4444",color:"#fff",fontWeight:600},children:"Obrigatorio"}),(0,r.jsxs)("div",{style:{fontSize:11,color:"var(--color-text-muted, #999)"},children:[1===e.max_select?"Escolha 1":"".concat(e.min_select,"-").concat(e.max_select," opcoes")," | ",(null===(t=e.options)||void 0===t?void 0:t.length)||0," itens"]})]}),(0,r.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,r.jsx)("button",{type:"button",title:"Editar grupo",style:{background:"none",border:"none",cursor:"pointer",padding:4,color:"var(--color-text-secondary, #666)"},onClick:()=>et({...e}),children:(0,r.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,r.jsx)("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),(0,r.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),(0,r.jsx)("button",{type:"button",title:"Remover grupo",style:{background:"none",border:"none",cursor:"pointer",padding:4,color:"#ef4444"},onClick:()=>eY(L.id||L.product_id,e.id),children:(0,r.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,r.jsx)("polyline",{points:"3 6 5 6 21 6"}),(0,r.jsx)("path",{d:"M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})]})})]})]}),(0,r.jsxs)("div",{style:{padding:"0 10px"},children:[(e.options||[]).map(e=>(0,r.jsx)("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"6px 0",borderBottom:"1px solid var(--color-border-light, #eee)"},children:ei&&ei.id===e.id?(0,r.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:4},children:[(0,r.jsxs)("div",{style:{display:"flex",gap:6},children:[(0,r.jsx)("input",{type:"text",className:"form-input",style:{flex:1,padding:"4px 8px",fontSize:13},value:ei.name,onChange:e=>en({...ei,name:e.target.value}),placeholder:"Nome"}),(0,r.jsx)("input",{type:"number",step:"0.01",className:"form-input",style:{width:80,padding:"4px 8px",fontSize:13},value:ei.price_extra,onChange:e=>en({...ei,price_extra:e.target.value}),placeholder:"R$"})]}),(0,r.jsx)("input",{type:"text",className:"form-input",style:{padding:"4px 8px",fontSize:12},value:ei.description||"",onChange:e=>en({...ei,description:e.target.value}),placeholder:"Descricao (opcional)"}),(0,r.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,r.jsx)("button",{type:"button",className:"btn btn-sm btn-primary",disabled:el,onClick:()=>e0(L.id||L.product_id),children:"Salvar"}),(0,r.jsx)("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:()=>en(null),children:"Cancelar"})]})]}):(0,r.jsxs)(r.Fragment,{children:[e.image&&(0,r.jsx)("img",{src:e.image,alt:"",style:{width:32,height:32,borderRadius:4,objectFit:"cover"}}),(0,r.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,r.jsxs)("div",{style:{fontSize:13,fontWeight:500,display:"flex",alignItems:"center",gap:4},children:[e.name,!1===e.available&&(0,r.jsx)("span",{style:{fontSize:10,color:"#ef4444",fontWeight:600},children:"Indisponivel"})]}),e.description&&(0,r.jsx)("div",{style:{fontSize:11,color:"var(--color-text-muted, #999)"},children:e.description})]}),(0,r.jsx)("span",{style:{fontSize:13,fontWeight:500,color:e.price_extra>0?"var(--color-text, #333)":"var(--color-text-muted, #999)",whiteSpace:"nowrap"},children:e.price_extra>0?"+ ".concat(x(e.price_extra)):"Gratis"}),(0,r.jsxs)("div",{style:{display:"flex",gap:2,flexShrink:0},children:[(0,r.jsx)("button",{type:"button",title:!1!==e.available?"Desativar":"Ativar",style:{background:"none",border:"none",cursor:"pointer",padding:3,color:!1!==e.available?"#43A047":"#ef4444"},onClick:()=>e2(L.id||L.product_id,e.id),children:(0,r.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:!1!==e.available?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"})})}),(0,r.jsx)("button",{type:"button",title:"Editar",style:{background:"none",border:"none",cursor:"pointer",padding:3,color:"var(--color-text-secondary, #666)"},onClick:()=>en({...e}),children:(0,r.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,r.jsx)("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),(0,r.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),(0,r.jsx)("button",{type:"button",title:"Remover",style:{background:"none",border:"none",cursor:"pointer",padding:3,color:"#ef4444"},onClick:()=>e1(L.id||L.product_id,e.id),children:(0,r.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,r.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,r.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]})},e.id)),ea===e.id?(0,r.jsxs)("div",{style:{padding:"8px 0"},children:[(0,r.jsxs)("div",{style:{display:"flex",gap:6,marginBottom:4},children:[(0,r.jsx)("input",{type:"text",className:"form-input",style:{flex:1,padding:"4px 8px",fontSize:13},placeholder:"Nome (ex: Morango, Nutella...)",value:eo.name,onChange:e=>es({...eo,name:e.target.value})}),(0,r.jsx)("input",{type:"number",step:"0.01",className:"form-input",style:{width:80,padding:"4px 8px",fontSize:13},placeholder:"R$",value:eo.price_extra,onChange:e=>es({...eo,price_extra:e.target.value})})]}),(0,r.jsx)("input",{type:"text",className:"form-input",style:{padding:"4px 8px",fontSize:12,marginBottom:4},placeholder:"Descricao (opcional)",value:eo.description,onChange:e=>es({...eo,description:e.target.value})}),(0,r.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,r.jsx)("button",{type:"button",className:"btn btn-sm btn-primary",disabled:el||!eo.name.trim(),onClick:()=>eX(L.id||L.product_id,e.id),children:el?"...":"Adicionar"}),(0,r.jsx)("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:()=>{er(null),es({name:"",price_extra:"",description:""})},children:"Cancelar"})]})]}):(0,r.jsx)("button",{type:"button",style:{display:"block",width:"100%",padding:"6px 0",background:"none",border:"none",color:"var(--color-primary, #1976D2)",fontSize:12,fontWeight:600,cursor:"pointer",textAlign:"left"},onClick:()=>{er(e.id),es({name:"",price_extra:"",description:""})},children:"+ Adicionar opcao"})]})]},e.id)})]})]}),(0,r.jsxs)("div",{className:"modal-footer",children:[(0,r.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>{B(null),e4()},children:"Cancelar"}),(0,r.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:R||O,children:R||O?(0,r.jsx)("span",{className:"spinner-sm"}):"Salvar"})]})]})]})}),ej&&(0,r.jsx)("div",{className:"modal-overlay",onClick:e=>e.target===e.currentTarget&&tt(),children:(0,r.jsxs)("div",{className:"modal modal-lg",children:[(0,r.jsxs)("div",{className:"modal-header",children:[(0,r.jsx)("h3",{className:"modal-title",children:"Adicionar Produto"}),(0,r.jsx)("button",{className:"modal-close",onClick:tt,children:"\xd7"})]}),(0,r.jsxs)("form",{onSubmit:ta,children:[(0,r.jsxs)("div",{className:"modal-body",children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Foto do Produto"}),(0,r.jsxs)("div",{className:"photo-upload-section",children:[(0,r.jsx)("div",{className:"photo-upload-preview",children:ez?(0,r.jsx)("img",{src:ez,alt:"Preview",className:"photo-preview-img"}):(0,r.jsxs)("div",{className:"photo-preview-placeholder",children:[(0,r.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,r.jsx)("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),(0,r.jsx)("polyline",{points:"21 15 16 10 5 21"})]}),(0,r.jsx)("span",{children:"Sem foto"})]})}),(0,r.jsxs)("div",{className:"photo-upload-actions",children:[(0,r.jsx)("input",{ref:eL,type:"file",accept:"image/jpeg,image/png,image/webp",onChange:function(t){var a;let r=null===(a=t.target.files)||void 0===a?void 0:a[0];if(!r)return;if(r.size>2097152){e("Arquivo muito grande. Maximo: 2MB","error");return}if(!["image/jpeg","image/png","image/webp"].includes(r.type)){e("Tipo de arquivo nao permitido. Use: JPG, PNG ou WebP","error");return}eS(r);let o=new FileReader;o.onload=e=>eq(e.target.result),o.readAsDataURL(r)},style:{display:"none"}}),(0,r.jsxs)("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:()=>{var e;return null===(e=eL.current)||void 0===e?void 0:e.click()},children:[(0,r.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"}),(0,r.jsx)("polyline",{points:"17 8 12 3 7 8"}),(0,r.jsx)("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),e_?"Trocar Foto":"Escolher Foto"]}),e_&&(0,r.jsx)("button",{type:"button",className:"btn btn-sm btn-danger",onClick:function(){eS(null),eq(null),eL.current&&(eL.current.value="")},children:"Remover"}),(0,r.jsx)("div",{className:"photo-upload-hint",children:"JPG, PNG ou WebP. Max 2MB."})]})]})]}),(0,r.jsxs)("div",{className:"form-row",children:[(0,r.jsxs)("div",{className:"form-group form-group-flex",children:[(0,r.jsx)("label",{className:"form-label",children:"Nome *"}),(0,r.jsx)("input",{type:"text",className:"form-input",value:ek.nome,onChange:e=>eN({...ek,nome:e.target.value}),placeholder:"Ex: Arroz Integral 1kg",required:!0,maxLength:255})]}),(0,r.jsxs)("div",{className:"form-group form-group-flex",children:[(0,r.jsx)("label",{className:"form-label",children:"Categoria"}),(0,r.jsx)(m,{categories:s,value:ek.categoria_id,onChange:e=>eN({...ek,categoria_id:e}),onCreateCategory:eG,placeholder:"Buscar ou criar categoria..."})]})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Descricao"}),(0,r.jsx)("textarea",{className:"form-input form-textarea",value:ek.descricao,onChange:e=>eN({...ek,descricao:e.target.value}),placeholder:"Descreva o produto (opcional)",rows:3,maxLength:1e3})]}),(0,r.jsxs)("div",{className:"form-row",children:[(0,r.jsxs)("div",{className:"form-group form-group-flex",children:[(0,r.jsx)("label",{className:"form-label",children:"Preco (R$) *"}),(0,r.jsx)("input",{type:"number",step:"0.01",min:"0.01",className:"form-input",value:ek.preco,onChange:e=>eN({...ek,preco:e.target.value}),placeholder:"0.00",required:!0})]}),(0,r.jsxs)("div",{className:"form-group form-group-flex",children:[(0,r.jsx)("label",{className:"form-label",children:"Preco Promocional (R$)"}),(0,r.jsx)("input",{type:"number",step:"0.01",min:"0",className:"form-input",value:ek.preco_promo,onChange:e=>eN({...ek,preco_promo:e.target.value}),placeholder:"Opcional"}),ek.preco_promo&&ek.preco&&parseFloat(ek.preco_promo)>=parseFloat(ek.preco)&&(0,r.jsx)("div",{className:"form-hint form-hint-danger",children:"Preco promocional deve ser menor que o preco normal"})]})]}),(0,r.jsxs)("div",{className:"form-row",children:[(0,r.jsxs)("div",{className:"form-group form-group-flex",children:[(0,r.jsx)("label",{className:"form-label",children:"Estoque *"}),(0,r.jsx)("input",{type:"number",min:"0",className:"form-input",value:ek.estoque,onChange:e=>eN({...ek,estoque:e.target.value}),placeholder:"0",required:!0}),""!==ek.estoque&&0===parseInt(ek.estoque)&&(0,r.jsx)("div",{className:"form-hint form-hint-warning",children:"O produto sera listado como esgotado"})]}),(0,r.jsxs)("div",{className:"form-group form-group-flex",children:[(0,r.jsx)("label",{className:"form-label",children:"Unidade"}),(0,r.jsxs)("select",{className:"form-select",value:ek.unidade,onChange:e=>eN({...ek,unidade:e.target.value}),children:[(0,r.jsx)("option",{value:"un",children:"Unidade (un)"}),(0,r.jsx)("option",{value:"kg",children:"Quilograma (kg)"}),(0,r.jsx)("option",{value:"g",children:"Grama (g)"}),(0,r.jsx)("option",{value:"l",children:"Litro (l)"}),(0,r.jsx)("option",{value:"ml",children:"Mililitro (ml)"}),(0,r.jsx)("option",{value:"cx",children:"Caixa (cx)"}),(0,r.jsx)("option",{value:"pct",children:"Pacote (pct)"}),(0,r.jsx)("option",{value:"dz",children:"Duzia (dz)"}),(0,r.jsx)("option",{value:"par",children:"Par"}),(0,r.jsx)("option",{value:"500ml",children:"500ml"}),(0,r.jsx)("option",{value:"350ml",children:"350ml"}),(0,r.jsx)("option",{value:"1l",children:"1 Litro"}),(0,r.jsx)("option",{value:"2l",children:"2 Litros"})]})]})]}),(0,r.jsx)(u,{enabled:e3,onToggle:e8,schedule:e9,onScheduleChange:e7}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Status"}),(0,r.jsxs)("div",{className:"toggle-switch-wrapper",onClick:()=>eN({...ek,ativo:!ek.ativo}),style:{cursor:"pointer"},children:[(0,r.jsx)("div",{className:"toggle-switch ".concat(ek.ativo?"toggle-switch-on":""),children:(0,r.jsx)("div",{className:"toggle-switch-handle"})}),(0,r.jsx)("span",{style:{marginLeft:10,fontSize:14,color:ek.ativo?"var(--color-success)":"var(--color-text-muted)"},children:ek.ativo?"Ativo - visivel para clientes":"Inativo - oculto na vitrine"})]})]})]}),(0,r.jsxs)("div",{className:"modal-footer",children:[(0,r.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:tt,children:"Cancelar"}),(0,r.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:ew,children:ew?(0,r.jsx)("span",{className:"spinner-sm"}):"Criar Produto"})]})]})]})}),eB.size>0&&(0,r.jsxs)("div",{className:"bulk-bar",children:[(0,r.jsxs)("span",{children:[eB.size," selecionado(s)"]}),(0,r.jsx)("button",{className:"bulk-bar-activate",onClick:()=>eJ("activate"),disabled:eF,children:"Ativar"}),(0,r.jsx)("button",{className:"bulk-bar-deactivate",onClick:()=>eJ("deactivate"),disabled:eF,children:"Desativar"}),(0,r.jsx)("button",{className:"bulk-bar-price",onClick:()=>eW(!0),disabled:eF,children:"Alterar Preco"}),(0,r.jsx)("button",{className:"bulk-bar-close",onClick:()=>eE(new Set),children:"Limpar"})]}),eP&&(0,r.jsx)("div",{className:"modal-overlay",onClick:()=>eW(!1),children:(0,r.jsxs)("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"modal-header",children:[(0,r.jsx)("h3",{className:"modal-title",children:"Alterar Preco em Lote"}),(0,r.jsx)("button",{className:"modal-close",onClick:()=>eW(!1),children:"\xd7"})]}),(0,r.jsxs)("div",{className:"modal-body",children:[(0,r.jsxs)("p",{style:{fontSize:14,color:"var(--color-text-secondary)",marginBottom:16},children:["Ajustar preco de ",eB.size," produto(s) selecionado(s)"]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Tipo de Ajuste"}),(0,r.jsxs)("select",{className:"form-input",value:eA,onChange:e=>eR(e.target.value),children:[(0,r.jsx)("option",{value:"percent",children:"Percentual (%)"}),(0,r.jsx)("option",{value:"fixed",children:"Valor Fixo (R$)"})]})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"percent"===eA?"Percentual (use negativo para desconto)":"Valor (use negativo para reduzir)"}),(0,r.jsx)("input",{type:"number",className:"form-input",value:eI,onChange:e=>eM(e.target.value),placeholder:"percent"===eA?"Ex: 10 para +10%, -5 para -5%":"Ex: 2.00 ou -1.50",step:"0.01"})]}),(0,r.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[(0,r.jsx)("button",{className:"btn btn-secondary",onClick:()=>eW(!1),children:"Cancelar"}),(0,r.jsx)("button",{className:"btn btn-primary",disabled:eF||!eI,onClick:()=>eJ("price_adjust",{type:eA,amount:parseFloat(eI)}),children:eF?"Aplicando...":"Aplicar"})]})]})]})}),ed&&(0,r.jsx)("div",{className:"modal-overlay",onClick:()=>ep(!1),children:(0,r.jsxs)("div",{className:"modal",style:{maxWidth:520},onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"modal-header",children:[(0,r.jsx)("h3",{children:"Gerenciar Categorias"}),(0,r.jsx)("button",{className:"modal-close",onClick:()=>ep(!1),children:(0,r.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",children:[(0,r.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,r.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,r.jsxs)("div",{className:"modal-body",style:{maxHeight:"60vh",overflowY:"auto"},children:[(0,r.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:16},children:[(0,r.jsx)("input",{type:"text",className:"form-input",placeholder:"Nome da nova categoria...",value:eg,onChange:e=>ev(e.target.value),maxLength:100,style:{flex:1},onKeyDown:e=>{"Enter"===e.key&&eg.trim()&&(e.preventDefault(),(async()=>{ef(!0),await eG(eg.trim())&&ev(""),ef(!1)})())}}),(0,r.jsx)("button",{className:"btn btn-primary btn-sm",disabled:!eg.trim()||ey,onClick:async()=>{ef(!0),await eG(eg.trim())&&ev(""),ef(!1)},style:{whiteSpace:"nowrap"},children:ey?(0,r.jsx)("span",{className:"spinner-sm"}):"+ Criar"})]}),(0,r.jsxs)("div",{style:{fontSize:12,color:"#888",marginBottom:8},children:[s.length," categoria",1!==s.length?"s":""]}),0===s.length?(0,r.jsx)("div",{style:{textAlign:"center",padding:24,color:"#999"},children:"Nenhuma categoria. Crie a primeira acima."}):(0,r.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:2},children:s.map(t=>{let a=t.category_id||t.id,o=eu===a;return(0,r.jsx)("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"8px 10px",borderRadius:6,background:o?"#f0fdf4":"#fafafa",border:o?"1px solid #00A868":"1px solid transparent"},children:o?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{type:"text",className:"form-input",value:ex,onChange:e=>eh(e.target.value),maxLength:100,style:{flex:1,fontSize:13,padding:"4px 8px"},autoFocus:!0,onKeyDown:t=>{"Enter"===t.key?(t.preventDefault(),(async()=>{if(ex.trim()){ef(!0);try{await (0,n.pE)("/categories.php",{category_id:a,name:ex.trim()}),e("Categoria atualizada","success"),await eT(),em(null)}catch(t){e(t.message||"Erro ao atualizar","error")}ef(!1)}})()):"Escape"===t.key&&em(null)}}),(0,r.jsx)("button",{className:"btn btn-sm btn-primary",disabled:ey||!ex.trim(),onClick:async()=>{if(ex.trim()){ef(!0);try{await (0,n.pE)("/categories.php",{category_id:a,name:ex.trim()}),e("Categoria atualizada","success"),await eT(),em(null)}catch(t){e(t.message||"Erro ao atualizar","error")}ef(!1)}},style:{padding:"4px 10px"},children:"Salvar"}),(0,r.jsx)("button",{className:"btn btn-sm btn-secondary",onClick:()=>em(null),style:{padding:"4px 8px"},children:(0,r.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",children:[(0,r.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,r.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("span",{style:{flex:1,fontSize:14},children:[t.parent_name&&(0,r.jsxs)("span",{style:{color:"#999",fontSize:12},children:[t.parent_name," > "]}),t.name||t.nome]}),(0,r.jsx)("button",{className:"btn btn-sm",style:{padding:"3px 6px",background:"transparent",border:"1px solid #ddd"},onClick:()=>{em(a),eh(t.name||t.nome||"")},title:"Editar",children:(0,r.jsxs)("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M12 20h9"}),(0,r.jsx)("path",{d:"M16.5 3.5a2.121 2.121 0 013 3L7 19l-4 1 1-4L16.5 3.5z"})]})}),(0,r.jsx)("button",{className:"btn btn-sm",style:{padding:"3px 6px",background:"transparent",border:"1px solid #fcc",color:"#e55"},onClick:async()=>{if(confirm('Excluir categoria "'.concat(t.name||t.nome,'"?')))try{await (0,n.apiDelete)("/categories.php?id="+a),e("Categoria removida","success"),await eT(),String(p)===String(a)&&f("")}catch(t){e(t.message||"Erro ao excluir","error")}},title:"Excluir",children:(0,r.jsxs)("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("polyline",{points:"3 6 5 6 21 6"}),(0,r.jsx)("path",{d:"M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})]})})]})},a)})})]}),(0,r.jsx)("div",{className:"modal-footer",children:(0,r.jsx)("button",{className:"btn btn-secondary",onClick:()=>ep(!1),children:"Fechar"})})]})})]})}}},function(e){e.O(0,[448,565,205,971,117,744],function(){return e(e.s=1694)}),_N_E=e.O()}]);
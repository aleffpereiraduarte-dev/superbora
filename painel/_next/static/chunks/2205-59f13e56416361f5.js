"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2205],{4565:function(e,a,s){s.d(a,{Z:function(){return h}});var i=s(7437),n=s(2265),t=s(9376),r=s(7128),l=s(6428),o=s(5904);function c(){let{logout:e,refreshSession:a}=(0,r.a)(),[s,t]=(0,n.useState)(null),[c,d]=(0,n.useState)(!0),{registrationUpdate:h}=(0,o.pO)();if((0,n.useEffect)(()=>{(async function(){try{let e=await (0,l.SC)("/registration-status.php");t(e)}catch(e){}finally{d(!1)}})()},[]),(0,n.useEffect)(()=>{h&&(t(e=>({...e,...h})),"approved"===h.status&&a&&a())},[h,a]),c)return(0,i.jsx)("div",{className:"loading-screen",children:(0,i.jsx)("div",{className:"spinner"})});let u=(null==s?void 0:s.checklist)||{},m=(null==s?void 0:s.status)||"pending";return(0,i.jsx)("div",{className:"pending-approval-page",children:(0,i.jsxs)("div",{className:"pending-approval-card",children:[(0,i.jsx)("div",{className:"pending-approval-icon",children:(0,i.jsxs)("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,i.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,i.jsx)("polyline",{points:"12 6 12 12 16 14"})]})}),(0,i.jsx)("h1",{className:"pending-approval-title",children:"Cadastro em Analise"}),(0,i.jsx)("p",{className:"pending-approval-desc",children:"rejected"===m?"Seu cadastro foi recusado. Verifique os documentos abaixo e reenvie se necessario.":"Seu cadastro esta sendo analisado pela nossa equipe. Voce sera notificado quando for aprovado."}),"rejected"===m&&(0,i.jsx)("div",{className:"pending-approval-rejected-badge",children:"Cadastro Recusado"}),(0,i.jsxs)("div",{className:"pending-approval-checklist",children:[(0,i.jsx)("h3",{children:"Checklist do Cadastro"}),Object.entries(u).map(e=>{let[a,s]=e;return(0,i.jsxs)("div",{className:"pending-check-item ".concat(s.completed?"pending-check-done":"pending-check-missing"),children:[(0,i.jsx)("div",{className:"pending-check-icon",children:s.completed?"rejected"===s.status?(0,i.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"#dc2626",strokeWidth:"2.5",children:[(0,i.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,i.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}):"approved"===s.status?(0,i.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"#16a34a",strokeWidth:"2.5",children:(0,i.jsx)("polyline",{points:"20 6 9 17 4 12"})}):(0,i.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"#f59e0b",strokeWidth:"2.5",children:[(0,i.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,i.jsx)("polyline",{points:"12 6 12 12 16 14"})]}):(0,i.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"#94a3b8",strokeWidth:"2",children:(0,i.jsx)("circle",{cx:"12",cy:"12",r:"10"})})}),(0,i.jsxs)("div",{className:"pending-check-info",children:[(0,i.jsx)("span",{className:"pending-check-label",children:s.label}),s.optional&&!s.completed&&(0,i.jsx)("span",{className:"pending-check-optional",children:"Opcional"}),s.review_note&&(0,i.jsx)("span",{className:"pending-check-note",children:s.review_note}),"approved"===s.status&&(0,i.jsx)("span",{className:"pending-check-status-ok",children:"Aprovado"}),"rejected"===s.status&&(0,i.jsx)("span",{className:"pending-check-status-rejected",children:"Rejeitado"}),s.completed&&!s.status&&(0,i.jsx)("span",{className:"pending-check-status-pending",children:"Em analise"})]})]},a)})]}),(0,i.jsxs)("div",{className:"pending-approval-footer",children:[(0,i.jsx)("p",{children:"Duvidas? Entre em contato pelo nosso suporte."}),(0,i.jsx)("button",{className:"btn btn-secondary",onClick:e,children:"Sair"})]})]})})}let d=["/login","/cadastro","/contrato","/setup"];function h(e){let{children:a}=e,{isAuthenticated:s,loading:l,partner:o}=(0,r.a)(),h=(0,t.useRouter)(),u=(0,t.usePathname)();if((0,n.useEffect)(()=>{if(!l&&!s){let e="/painel",a=u||window.location.pathname;a.startsWith(e)&&(a=a.slice(e.length)||"/"),d.some(e=>a.startsWith(e))||h.push("/login?return=".concat(encodeURIComponent(a)))}},[l,s,h,u]),l)return(0,i.jsx)("div",{className:"loading-screen",children:(0,i.jsx)("div",{className:"spinner"})});if(!s)return null;let m=null==o?void 0:o.status;if(0===m||"0"===m||"pending"===m)return(0,i.jsx)(c,{});let p=u||"",v=p.endsWith("/contrato")||p.endsWith("/contrato/"),f=p.endsWith("/setup")||p.endsWith("/setup/");return(null==o?void 0:o.contract_signed)!==!1||v||f?(null==o?void 0:o.contract_signed)&&(null==o?void 0:o.first_setup_complete)===!1&&!f?(h.push("/setup"),null):a:(h.push("/contrato"),null)}},4477:function(e,a,s){s.d(a,{Z:function(){return j}});var i=s(7437),n=s(2265),t=s(9376),r=s(7648),l=s(7128),o=s(6971),c=s(6428),d=s(4058),h=s(5904);let u=[{label:"Principal",items:["/","/pedidos","/kds","/qr-code","/produtos","/estoque","/produto-opcoes","/precos","/promocoes","/disponibilidade"]},{label:"Gestao",items:["/avaliacoes","/combos","/minha-loja","/chat","/wallet","/recebiveis","/beneficios","/relatorios","/metricas"]},{label:"IA & Analytics",items:["/cardapio-ia","/cardapio-horarios","/engenharia-cardapio","/segmentacao","/assistente","/insights","/financeiro","/fiscal","/custos","/concorrentes"]},{label:"Marketing",items:["/cupons","/fidelidade","/promocoes-avancadas","/marketing","/indicacao","/campanhas"]},{label:"Suporte",items:["/disputas","/problemas"]},{label:"Configuracao",items:["/preview","/equipe","/zonas-entrega","/stories","/express","/configuracoes","/ajuda"]}],m=[{href:"/",label:"Dashboard",icon:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-4 0h4"},{href:"/pedidos",label:"Pedidos",icon:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"},{href:"/kds",label:"KDS Cozinha",icon:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"},{href:"/qr-code",label:"QR Code Mesas",icon:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"},{href:"/produtos",label:"Produtos",icon:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4",stockAlert:!0},{href:"/estoque",label:"Estoque",icon:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4 M9 12h6 M9 16h6"},{href:"/produto-opcoes",label:"Opcoes Produto",icon:"M4 6h16M4 12h8m-8 6h16"},{href:"/precos",label:"Precos",icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},{href:"/promocoes",label:"Promocoes",icon:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A2 2 0 013 12V7a4 4 0 014-4z"},{href:"/disponibilidade",label:"Disponibilidade",icon:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"},{href:"/avaliacoes",label:"Avaliacoes",icon:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"},{href:"/combos",label:"Combos",icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"},{href:"/minha-loja",label:"Minha Loja",icon:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"},{href:"/chat",label:"Chat",icon:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"},{href:"/wallet",label:"Wallet",icon:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"},{href:"/recebiveis",label:"Recebiveis",icon:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"},{href:"/beneficios",label:"Beneficios",icon:"M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"},{href:"/relatorios",label:"Relatorios",icon:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"},{href:"/metricas",label:"Metricas & Score",icon:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"},{divider:!0,label:"IA & Analytics"},{href:"/cardapio-ia",label:"Cardapio IA",icon:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z",aiFeature:!0},{href:"/cardapio-horarios",label:"Cardapio Horarios",icon:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},{href:"/engenharia-cardapio",label:"Engenharia Cardapio",icon:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"},{href:"/segmentacao",label:"Segmentacao Clientes",icon:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"},{href:"/assistente",label:"Assistente IA",icon:"M9.75 3.104v5.714a2.25 2.25 0 01-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 014.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19 14.5M14.25 3.104c.251.023.501.05.75.082M19 14.5l-2.47 2.47a2.25 2.25 0 01-1.59.66H9.06a2.25 2.25 0 01-1.59-.66L5 14.5m14 0V17a2 2 0 01-2 2H7a2 2 0 01-2-2v-2.5",aiFeature:!0},{href:"/insights",label:"Insights",icon:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},{href:"/financeiro",label:"Financeiro",icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},{href:"/fiscal",label:"Fiscal",icon:"M9 14l6-6m-5.5.5h.01m4.99 5h.01M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16l3.5-2 3.5 2 3.5-2 3.5 2z"},{href:"/custos",label:"Custos & Margens",icon:"M9 7h6m0 10v-3m-3 3v-6m-3 6v-1m9-9a2 2 0 012 2v10a2 2 0 01-2 2H7a2 2 0 01-2-2V9a2 2 0 012-2"},{href:"/concorrentes",label:"Concorrentes",icon:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"},{divider:!0,label:"Marketing"},{href:"/cupons",label:"Cupons Smart",icon:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"},{href:"/fidelidade",label:"Fidelidade",icon:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"},{href:"/promocoes-avancadas",label:"Happy Hour & BOGO",icon:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},{href:"/marketing",label:"Ofertas do Dia",icon:"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"},{href:"/indicacao",label:"Indicacao",icon:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"},{href:"/campanhas",label:"Campanhas",icon:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"},{divider:!0,label:"Gestao"},{href:"/preview",label:"Preview Loja",icon:"M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},{href:"/equipe",label:"Equipe",icon:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"},{href:"/zonas-entrega",label:"Zonas Entrega",icon:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z M15 11a3 3 0 11-6 0 3 3 0 016 0z"},{href:"/stories",label:"Stories",icon:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"},{href:"/express",label:"Express",icon:"M13 10V3L4 14h7v7l9-11h-7z"},{divider:!0,label:"Suporte"},{href:"/disputas",label:"Disputas",icon:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"},{href:"/problemas",label:"Reportar Problema",icon:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"}],p=[{href:"/configuracoes",label:"Configuracoes",icon:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.066 2.573c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.573 1.066c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.066-2.573c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z M15 12a3 3 0 11-6 0 3 3 0 016 0z"},{href:"/ajuda",label:"Ajuda",icon:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}],v=m.slice(0,4).filter(e=>!e.divider),f=[{label:"30 min",minutes:30},{label:"1 hora",minutes:60},{label:"2 horas",minutes:120},{label:"Ate eu reativar",minutes:0}],x="painel_pause_until";function b(e){let{d:a,size:s=20}=e;return(0,i.jsx)("svg",{width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,i.jsx)("path",{d:a})})}function j(e){let{children:a}=e,s=(0,t.usePathname)(),{partner:j,logout:g,updatePartner:N}=(0,l.a)(),{unreadCount:k}=(0,o.l)(),[M,y]=(0,n.useState)(!1),[w,C]=(0,n.useState)(!1),[S,z]=(0,n.useState)(null),[L,A]=(0,n.useState)(""),_=(0,n.useRef)(null);(0,n.useRef)(null);let[P,H]=(0,n.useState)(!1),[V,B]=(0,n.useState)(0),{supported:W,isDefault:E,requestPermission:I}=(0,d.O)(),{stockUpdates:q,onEvent:R}=(0,h.cP)();(0,n.useEffect)(()=>{H(!1)},[s]);let[D,F]=(0,n.useState)(!1),[O,T]=(0,n.useState)([]),[U,G]=(0,n.useState)(!1),J=(0,n.useRef)(null),Z=(0,n.useRef)(null),Y="/painel";function K(e){return"/"===e?s===Y+"/"||s===Y:s.startsWith(Y+e)}async function Q(){G(!0);try{let a=(0,c.LP)();if(!a)return;let s=await fetch("/api/mercado/notifications/list.php?limit=10",{credentials:"include",headers:{Authorization:"Bearer ".concat(a)}});if(!s.ok)return;let i=await s.json();if(i.success){var e;T((null===(e=i.data)||void 0===e?void 0:e.notifications)||[])}}catch(e){}finally{G(!1)}}async function X(){try{let e=(0,c.LP)();if(!e)return;await fetch("/api/mercado/notifications/list.php",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({})}),T(e=>e.map(e=>({...e,is_read:!0})))}catch(e){}}function $(){D||Q(),F(e=>!e)}async function ee(){if(!M){if(null==j?void 0:j.is_open){C(!0);return}await ea()}}async function ea(){if(!M){y(!0);try{await (0,c.sg)("/pause-store.php",{action:"resume"}),N({is_open:!0}),z(null),localStorage.removeItem(x)}catch(e){try{let e=await (0,c.sg)("/toggle-status.php",{is_open:!0});N({is_open:e.is_open})}catch(e){console.error("Resume error:",e)}}finally{y(!1),C(!1)}}}async function es(e){if(!M){y(!0);try{if(await (0,c.sg)("/pause-store.php",{action:"pause",duration_minutes:e}),N({is_open:!1}),e>0){let a=new Date;a.setMinutes(a.getMinutes()+e),z(a),localStorage.setItem(x,a.toISOString())}else z(null),localStorage.removeItem(x)}catch(e){try{let e=await (0,c.sg)("/toggle-status.php",{is_open:!1});N({is_open:e.is_open})}catch(e){console.error("Pause error:",e)}}finally{y(!1),C(!1)}}}return(0,n.useEffect)(()=>{(async function(){try{let e=await (0,c.SC)("/products.php",{page:1,limit:100}),a=(e.products||e.items||[]).filter(e=>{var a,s;let i=null!==(s=null!==(a=e.estoque)&&void 0!==a?a:e.stock)&&void 0!==s?s:null;return null!==i&&i<=0}).length;B(a)}catch(e){}})()},[]),(0,n.useEffect)(()=>{q.length>0&&(0,c.SC)("/products.php",{page:1,limit:100}).then(e=>{B((e.products||e.items||[]).filter(e=>{var a,s;let i=null!==(s=null!==(a=e.estoque)&&void 0!==a?a:e.stock)&&void 0!==s?s:null;return null!==i&&i<=0}).length)}).catch(()=>{})},[q]),(0,n.useEffect)(()=>{function e(e){let a=J.current&&J.current.contains(e.target),s=Z.current&&Z.current.contains(e.target);a||s||F(!1)}return D&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[D]),(0,n.useEffect)(()=>{let e=localStorage.getItem(x);if(e){let a=new Date(e);a>new Date?z(a):localStorage.removeItem(x)}},[]),(0,n.useEffect)(()=>{if(!S){A(""),_.current&&clearInterval(_.current);return}function e(){let e=new Date,a=S.getTime()-e.getTime();if(a<=0){A(""),z(null),localStorage.removeItem(x),ea();return}let s=Math.floor(a/6e4),i=Math.floor(s/60),n=s%60;i>0?A("".concat(i,"h ").concat(n,"min")):A("".concat(n,"min"))}return e(),_.current=setInterval(e,3e4),()=>{_.current&&clearInterval(_.current)}},[S]),(null==j?void 0:j.is_open)||S||null==j||j.is_open,null==j||j.is_open,(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("aside",{className:"sidebar",children:[(0,i.jsx)("div",{className:"sidebar-header",children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"sidebar-logo",children:"SuperBora"}),(0,i.jsx)("div",{className:"sidebar-subtitle",children:"Painel Parceiro"})]}),(0,i.jsxs)("div",{ref:J,style:{position:"relative"},children:[(0,i.jsxs)("button",{className:"sidebar-bell",onClick:$,title:k>0?"".concat(k," notificacao(oes) nao lida(s)"):"Notificacoes",style:{display:"inline-flex",marginTop:0},children:[(0,i.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,i.jsx)("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),(0,i.jsx)("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),k>0&&(0,i.jsx)("span",{className:"sidebar-bell-badge",children:k>99?"99+":k})]}),D&&(0,i.jsxs)("div",{className:"notif-panel",children:[(0,i.jsxs)("div",{className:"notif-panel-header",children:[(0,i.jsx)("span",{className:"notif-panel-title",children:"Notificacoes"}),k>0&&(0,i.jsx)("button",{className:"notif-mark-read",onClick:X,children:"Marcar todas como lidas"})]}),(0,i.jsx)("div",{className:"notif-panel-body",children:U?(0,i.jsx)("div",{style:{textAlign:"center",padding:"20px 0"},children:(0,i.jsx)("div",{className:"spinner-sm"})}):0===O.length?(0,i.jsxs)("div",{className:"notif-empty",children:[(0,i.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",style:{color:"#94a3b8",marginBottom:8},children:[(0,i.jsx)("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),(0,i.jsx)("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),(0,i.jsx)("div",{children:"Nenhuma notificacao"})]}):O.map(e=>(0,i.jsxs)("div",{className:"notif-item ".concat(e.is_read?"":"notif-item-unread"),children:[(0,i.jsx)("div",{className:"notif-item-dot-wrap",children:!e.is_read&&(0,i.jsx)("span",{className:"notif-item-dot"})}),(0,i.jsxs)("div",{className:"notif-item-content",children:[(0,i.jsx)("div",{className:"notif-item-title",children:e.title||"Notificacao"}),(0,i.jsx)("div",{className:"notif-item-body",children:e.body||""}),(0,i.jsx)("div",{className:"notif-item-time",children:e.created_at?new Date(e.created_at).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}):""})]})]},e.id))})]})]})]})}),j&&(0,i.jsxs)("div",{className:"sidebar-partner",children:[(0,i.jsx)("div",{className:"sidebar-partner-avatar",children:j.nome?j.nome.charAt(0).toUpperCase():"P"}),(0,i.jsxs)("div",{className:"sidebar-partner-info",children:[(0,i.jsx)("div",{className:"sidebar-partner-name",children:j.nome||j.razao_social||"Parceiro"}),(0,i.jsx)("div",{className:"sidebar-partner-email",children:j.email||""})]})]}),j&&(0,i.jsx)("div",{className:"sidebar-toggle-status",children:(0,i.jsxs)("div",{className:"toggle-status-row",children:[(0,i.jsx)("span",{className:"toggle-status-dot ".concat(j.is_open?"dot-open":"dot-closed")}),(0,i.jsxs)("div",{className:"toggle-status-info",children:[(0,i.jsx)("span",{className:"toggle-status-label",children:j.is_open?"Aberto":S?"Pausado":"Fechado"}),!j.is_open&&S&&L&&(0,i.jsxs)("span",{className:"toggle-status-countdown",children:["Volta em ",L]})]}),(0,i.jsx)("button",{className:"toggle-switch ".concat(j.is_open?"toggle-on":""),onClick:ee,disabled:M,"aria-label":"Toggle loja aberta/fechada",children:(0,i.jsx)("span",{className:"toggle-knob"})})]})}),W&&E&&(0,i.jsxs)("div",{className:"push-banner",children:[(0,i.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{flexShrink:0},children:[(0,i.jsx)("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),(0,i.jsx)("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),(0,i.jsx)("span",{style:{flex:1,fontSize:12},children:"Ativar alertas de pedidos"}),(0,i.jsx)("button",{onClick:I,children:"Ativar"})]}),(0,i.jsxs)("nav",{className:"sidebar-nav",children:[m.map((e,a)=>e.divider?(0,i.jsx)("div",{className:"sidebar-divider",children:(0,i.jsx)("span",{children:e.label})},"divider-".concat(a)):(0,i.jsxs)(r.default,{href:e.href,className:"sidebar-link ".concat(K(e.href)?"sidebar-link-active":""," ").concat(e.aiFeature?"sidebar-link-ai":""),children:[(0,i.jsx)(b,{d:e.icon}),(0,i.jsx)("span",{children:e.label}),e.stockAlert&&V>0&&(0,i.jsx)("span",{className:"sidebar-stock-badge",title:"".concat(V," produto(s) esgotado(s)"),children:V}),e.aiFeature&&(0,i.jsx)("span",{className:"ai-badge",children:"IA"})]},e.href)),(0,i.jsx)("div",{style:{borderTop:"1px solid var(--color-border)",margin:"8px 12px"}}),p.map(e=>(0,i.jsxs)(r.default,{href:e.href,className:"sidebar-link ".concat(K(e.href)?"sidebar-link-active":""),children:[(0,i.jsx)(b,{d:e.icon}),(0,i.jsx)("span",{children:e.label})]},e.href))]}),(0,i.jsx)("div",{className:"sidebar-footer",children:(0,i.jsxs)("button",{className:"sidebar-logout",onClick:g,children:[(0,i.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,i.jsx)("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"})}),(0,i.jsx)("span",{children:"Sair"})]})})]}),(0,i.jsxs)("main",{className:"main-content",children:[(0,i.jsxs)("div",{className:"mobile-top-bar",children:[(0,i.jsx)("div",{className:"mobile-top-bar-title",children:"SuperBora"}),(0,i.jsxs)("div",{ref:Z,style:{position:"relative"},children:[(0,i.jsxs)("button",{className:"sidebar-bell",onClick:$,title:k>0?"".concat(k," notificacao(oes)"):"Notificacoes",style:{display:"inline-flex",marginTop:0},children:[(0,i.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,i.jsx)("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),(0,i.jsx)("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),k>0&&(0,i.jsx)("span",{className:"sidebar-bell-badge",children:k>99?"99+":k})]}),D&&(0,i.jsxs)("div",{className:"notif-panel",children:[(0,i.jsxs)("div",{className:"notif-panel-header",children:[(0,i.jsx)("span",{className:"notif-panel-title",children:"Notificacoes"}),k>0&&(0,i.jsx)("button",{className:"notif-mark-read",onClick:X,children:"Marcar todas como lidas"})]}),(0,i.jsx)("div",{className:"notif-panel-body",children:U?(0,i.jsx)("div",{style:{textAlign:"center",padding:"20px 0"},children:(0,i.jsx)("div",{className:"spinner-sm"})}):0===O.length?(0,i.jsxs)("div",{className:"notif-empty",children:[(0,i.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",style:{color:"#94a3b8",marginBottom:8},children:[(0,i.jsx)("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),(0,i.jsx)("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),(0,i.jsx)("div",{children:"Nenhuma notificacao"})]}):O.map(e=>(0,i.jsxs)("div",{className:"notif-item ".concat(e.is_read?"":"notif-item-unread"),children:[(0,i.jsx)("div",{className:"notif-item-dot-wrap",children:!e.is_read&&(0,i.jsx)("span",{className:"notif-item-dot"})}),(0,i.jsxs)("div",{className:"notif-item-content",children:[(0,i.jsx)("div",{className:"notif-item-title",children:e.title||"Notificacao"}),(0,i.jsx)("div",{className:"notif-item-body",children:e.body||""}),(0,i.jsx)("div",{className:"notif-item-time",children:e.created_at?new Date(e.created_at).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}):""})]})]},e.id))})]})]})]}),a]}),(0,i.jsxs)("nav",{className:"mobile-nav",children:[v.map(e=>(0,i.jsxs)(r.default,{href:e.href,className:"mobile-nav-item ".concat(K(e.href)?"mobile-nav-active":""),children:[(0,i.jsx)(b,{d:e.icon,size:22}),(0,i.jsx)("span",{children:e.label})]},e.href)),(0,i.jsxs)("button",{className:"mobile-nav-item ".concat(P?"mobile-nav-active":""),onClick:()=>H(!0),children:[(0,i.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,i.jsx)("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),(0,i.jsx)("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),(0,i.jsx)("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]}),(0,i.jsx)("span",{children:"Mais"})]})]}),P&&(0,i.jsx)("div",{className:"mobile-menu-overlay",onClick:()=>H(!1),children:(0,i.jsxs)("div",{className:"mobile-menu-drawer",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"mobile-menu-header",children:[(0,i.jsx)("div",{className:"mobile-menu-title",children:"Menu"}),(0,i.jsx)("button",{className:"mobile-menu-close",onClick:()=>H(!1),children:(0,i.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,i.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,i.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),j&&(0,i.jsxs)("div",{className:"mobile-menu-partner",children:[(0,i.jsx)("div",{className:"sidebar-partner-avatar",children:j.nome?j.nome.charAt(0).toUpperCase():"P"}),(0,i.jsxs)("div",{className:"sidebar-partner-info",children:[(0,i.jsx)("div",{className:"sidebar-partner-name",children:j.nome||j.razao_social||"Parceiro"}),(0,i.jsx)("div",{className:"mobile-menu-status ".concat(j.is_open?"status-open":"status-closed"),children:j.is_open?"Aberto":"Fechado"})]})]}),(0,i.jsx)("div",{className:"mobile-menu-body",children:u.map(e=>(0,i.jsxs)("div",{className:"mobile-menu-section",children:[(0,i.jsx)("div",{className:"mobile-menu-section-label",children:e.label}),e.items.map(e=>{let a=[...m,...p].find(a=>a.href===e);return a?(0,i.jsxs)(r.default,{href:e,className:"mobile-menu-item ".concat(K(e)?"mobile-menu-item-active":""),onClick:()=>H(!1),children:[(0,i.jsx)(b,{d:a.icon,size:20}),(0,i.jsx)("span",{children:a.label}),a.stockAlert&&V>0&&(0,i.jsx)("span",{className:"sidebar-stock-badge",children:V}),a.aiFeature&&(0,i.jsx)("span",{className:"ai-badge",children:"IA"})]},e):null})]},e.label))}),(0,i.jsx)("div",{className:"mobile-menu-footer",children:(0,i.jsxs)("button",{className:"mobile-menu-logout",onClick:g,children:[(0,i.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,i.jsx)("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"})}),(0,i.jsx)("span",{children:"Sair"})]})})]})}),w&&(0,i.jsx)("div",{className:"modal-overlay",onClick:()=>C(!1),children:(0,i.jsxs)("div",{className:"modal pause-modal",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"modal-header",children:[(0,i.jsx)("h3",{className:"modal-title",children:"Pausar Recebimento de Pedidos"}),(0,i.jsx)("button",{className:"modal-close",onClick:()=>C(!1),children:"\xd7"})]}),(0,i.jsxs)("div",{className:"modal-body",children:[(0,i.jsx)("p",{style:{color:"var(--color-text-secondary)",fontSize:14,marginBottom:20},children:"Sua loja ficara temporariamente indisponivel para novos pedidos. Escolha por quanto tempo deseja pausar:"}),(0,i.jsx)("div",{className:"pause-duration-grid",children:f.map(e=>(0,i.jsxs)("button",{className:"pause-duration-btn",disabled:M,onClick:()=>es(e.minutes),children:[(0,i.jsx)("span",{className:"pause-duration-icon",children:0===e.minutes?(0,i.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,i.jsx)("rect",{x:"6",y:"4",width:"4",height:"16",rx:"1"}),(0,i.jsx)("rect",{x:"14",y:"4",width:"4",height:"16",rx:"1"})]}):(0,i.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,i.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,i.jsx)("polyline",{points:"12 6 12 12 16 14"})]})}),(0,i.jsx)("span",{className:"pause-duration-label",children:e.label}),e.minutes>0&&(0,i.jsx)("span",{className:"pause-duration-hint",children:"Reabre automaticamente"})]},e.minutes))}),(0,i.jsx)("div",{style:{marginTop:16,textAlign:"center"},children:(0,i.jsx)("button",{className:"btn btn-secondary",onClick:()=>C(!1),children:"Cancelar"})})]})]})})]})}},4058:function(e,a,s){s.d(a,{O:function(){return t}});var i=s(2265),n=s(6428);function t(){let[e,a]=(0,i.useState)("default"),[s,t]=(0,i.useState)(!1),[r,l]=(0,i.useState)(null),[o,c]=(0,i.useState)(!1),[d,h]=(0,i.useState)(null),u=(0,i.useRef)(null);(0,i.useEffect)(()=>{"Notification"in window&&"serviceWorker"in navigator&&"PushManager"in window&&(t(!0),a(Notification.permission),navigator.serviceWorker.ready.then(e=>(u.current=e,e.pushManager.getSubscription())).then(e=>{e&&l(e)}).catch(console.error))},[]);let m=(0,i.useCallback)(async()=>{if(!s)return null;try{let e=await navigator.serviceWorker.register("/painel/sw.js");return u.current=e,console.log("[Push] Service Worker registered"),e}catch(e){return console.error("[Push] SW registration failed:",e),h("Falha ao registrar Service Worker"),null}},[s]),p=(0,i.useCallback)(async()=>{if(u.current||await m(),!u.current)throw Error("Service Worker nao registrado");try{let e=await u.current.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:function(e){let a="=".repeat((4-e.length%4)%4),s=(e+a).replace(/-/g,"+").replace(/_/g,"/"),i=window.atob(s),n=new Uint8Array(i.length);for(let e=0;e<i.length;++e)n[e]=i.charCodeAt(e);return n}("BEl62iUYgUivxIkv69yViEuiBIa-Ib9-SkvMeAtA3LFgDzkrxZJjSgSnfckjBJuBkr3qBUYIHBQFLXYp5Nksh8U")});return l(e),e}catch(e){throw console.error("[Push] Subscription failed:",e),e}},[m]),v=(0,i.useCallback)(async e=>{try{let a=e.toJSON().keys;return await (0,n.sg)("/push-subscribe.php",{endpoint:e.endpoint,p256dh:a.p256dh,auth:a.auth}),console.log("[Push] Subscription sent to server"),!0}catch(e){throw console.error("[Push] Failed to send subscription:",e),e}},[]),f=(0,i.useCallback)(async()=>{if(!s)return h("Notificacoes nao suportadas neste navegador"),!1;c(!0),h(null);try{let e=await Notification.requestPermission();if(a(e),"granted"!==e)return h("Permissao de notificacao negada"),c(!1),!1;await m();let s=await p();return await v(s),c(!1),!0}catch(e){return console.error("[Push] Permission request error:",e),h(e.message||"Erro ao ativar notificacoes"),c(!1),!1}},[s,m,p,v]),x=(0,i.useCallback)(async()=>{if(!r)return!0;c(!0),h(null);try{return await r.unsubscribe(),await (0,n.sg)("/push-subscribe.php",{action:"unsubscribe",endpoint:r.endpoint}),l(null),c(!1),!0}catch(e){return console.error("[Push] Unsubscribe error:",e),h(e.message||"Erro ao desativar notificacoes"),c(!1),!1}},[r]),b=(0,i.useCallback)(function(a){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("granted"!==e){console.warn("[Push] Permission not granted");return}u.current?u.current.showNotification(a,{icon:"/painel/icon-192.png",badge:"/painel/icon-192.png",...s}):new Notification(a,s)},[e]);return(0,i.useEffect)(()=>{"granted"===e&&s&&!u.current&&m()},[e,s,m]),{permission:e,supported:s,subscription:r,loading:o,error:d,isSubscribed:!!r,isGranted:"granted"===e,isDenied:"denied"===e,isDefault:"default"===e,requestPermission:f,unsubscribe:x,showNotification:b,registerSW:m}}}}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7693],{1785:function(e,a,s){Promise.resolve().then(s.bind(s,5191))},5191:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return h}});var t=s(7437),i=s(2265),n=s(4565),r=s(4477),o=s(6428),l=s(7128),c=s(6971),d=s(3563),m=s(4058);let p=[{key:"conta",label:"Conta"},{key:"senha",label:"Senha"},{key:"seguranca",label:"Seguranca"},{key:"notificacoes",label:"Notificacoes"},{key:"impressora",label:"Impressora"},{key:"culinaria",label:"Culinaria"},{key:"perigo",label:"Zona de Perigo"}];function h(){return(0,t.jsx)(n.Z,{children:(0,t.jsx)(r.Z,{children:(0,t.jsx)(u,{})})})}function u(){let[e,a]=(0,i.useState)("conta");return(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"page-header",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"page-title",children:"Configuracoes"}),(0,t.jsx)("p",{className:"page-subtitle",children:"Gerencie sua conta e preferencias"})]})}),(0,t.jsx)("div",{className:"tabs",children:p.map(s=>(0,t.jsx)("button",{className:"tab ".concat(e===s.key?"tab-active":""),onClick:()=>a(s.key),children:s.label},s.key))}),"conta"===e&&(0,t.jsx)(g,{}),"senha"===e&&(0,t.jsx)(x,{}),"seguranca"===e&&(0,t.jsx)(f,{}),"notificacoes"===e&&(0,t.jsx)(v,{}),"impressora"===e&&(0,t.jsx)(j,{}),"culinaria"===e&&(0,t.jsx)(y,{}),"perigo"===e&&(0,t.jsx)(b,{})]})}function g(){let{partner:e}=(0,l.a)(),[a,s]=(0,i.useState)(null),[n,r]=(0,i.useState)(!0);if((0,i.useEffect)(()=>{(async function(){try{let e=await (0,o.SC)("/profile.php");s(e)}catch(e){}r(!1)})()},[]),n)return(0,t.jsx)("div",{style:{padding:40,textAlign:"center"},children:(0,t.jsx)("div",{className:"spinner"})});let c=[{label:"Nome",value:(null==e?void 0:e.nome)||(null==a?void 0:a.name)||"--"},{label:"Nome Fantasia",value:(null==a?void 0:a.trade_name)||"--"},{label:"Email",value:(null==e?void 0:e.email)||(null==a?void 0:a.email)||"--"},{label:"CNPJ",value:(null==e?void 0:e.cnpj)||"--"},{label:"Categoria",value:(null==a?void 0:a.categoria)||(null==e?void 0:e.categoria)||"--"},{label:"Telefone",value:(null==a?void 0:a.phone)||"--"},{label:"WhatsApp",value:(null==a?void 0:a.whatsapp)||"--"},{label:"Endereco",value:(null==a?void 0:a.address)||"--"},{label:"Cidade",value:[null==a?void 0:a.city,null==a?void 0:a.state].filter(Boolean).join(" - ")||"--"},{label:"CEP",value:(null==a?void 0:a.cep)||"--"}];return(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h2",{className:"card-title",children:"Informacoes da Conta"})}),(0,t.jsx)("p",{style:{color:"var(--color-text-secondary)",fontSize:14,marginBottom:16},children:"Para alterar informacoes como nome, CNPJ ou email, entre em contato com o suporte."}),(0,t.jsx)("div",{style:{display:"grid",gap:0},children:c.map((e,a)=>(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px 0",borderBottom:a<c.length-1?"1px solid var(--color-border)":"none",gap:16},children:[(0,t.jsx)("span",{style:{fontWeight:500,color:"var(--color-text-secondary)",fontSize:14},children:e.label}),(0,t.jsx)("span",{style:{fontWeight:500,fontSize:14,textAlign:"right"},children:e.value})]},a))})]})}function x(){let{addNotification:e}=(0,c.l)(),[a,s]=(0,i.useState)(""),[n,r]=(0,i.useState)(""),[l,d]=(0,i.useState)(""),[m,p]=(0,i.useState)(!1),[h,u]=(0,i.useState)("");async function g(t){if(t.preventDefault(),u(""),!a||!n||!l){u("Todos os campos sao obrigatorios");return}if(n!==l){u("Nova senha e confirmacao nao conferem");return}if(n.length<6){u("Nova senha deve ter no minimo 6 caracteres");return}p(!0);try{await (0,o.sg)("/change-password.php",{current_password:a,new_password:n,confirm_password:l}),e("Senha alterada com sucesso!","success"),s(""),r(""),d("")}catch(e){u(e.message||"Erro ao alterar senha")}finally{p(!1)}}return(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h2",{className:"card-title",children:"Alterar Senha"})}),(0,t.jsxs)("form",{onSubmit:g,style:{maxWidth:400},children:[h&&(0,t.jsx)("div",{className:"toast-inline toast-inline-error",style:{marginBottom:16},children:h}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Senha Atual"}),(0,t.jsx)("input",{type:"password",className:"form-input",value:a,onChange:e=>s(e.target.value),placeholder:"Digite sua senha atual"})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Nova Senha"}),(0,t.jsx)("input",{type:"password",className:"form-input",value:n,onChange:e=>r(e.target.value),placeholder:"Minimo 6 caracteres"})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Confirmar Nova Senha"}),(0,t.jsx)("input",{type:"password",className:"form-input",value:l,onChange:e=>d(e.target.value),placeholder:"Repita a nova senha"})]}),(0,t.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:m,children:m?"Alterando...":"Alterar Senha"})]})]})}function v(){let{addNotification:e}=(0,c.l)(),a=(0,m.O)(),[s,n]=(0,i.useState)(null),[r,l]=(0,i.useState)(!0),[d,p]=(0,i.useState)(!1),h=[{key:"new_order",label:"Novo Pedido",desc:"Receber alerta quando um novo pedido chegar"},{key:"order_cancelled",label:"Pedido Cancelado",desc:"Receber alerta quando um pedido for cancelado"},{key:"new_review",label:"Nova Avaliacao",desc:"Receber alerta quando receber uma avaliacao"},{key:"low_stock",label:"Estoque Baixo",desc:"Receber alerta quando produtos estiverem esgotados"},{key:"daily_summary",label:"Resumo Diario",desc:"Receber resumo diario de vendas e pedidos"},{key:"promotions",label:"Promocoes da Plataforma",desc:"Receber novidades e promocoes do SuperBora"}];async function u(){p(!0);try{await (0,o.sg)("/notification-settings.php",{settings:s}),e("Preferencias salvas!","success")}catch(a){e(a.message||"Erro ao salvar","error")}finally{p(!1)}}async function g(){await a.requestPermission()&&e("Notificacoes push ativadas!","success")}return(0,i.useEffect)(()=>{!async function(){try{let e=await (0,o.SC)("/notification-settings.php");n(e.settings||{})}catch(e){n({new_order:!0,order_cancelled:!0,new_review:!0,low_stock:!0,daily_summary:!0,promotions:!0})}l(!1)}()},[]),r?(0,t.jsx)("div",{style:{padding:40,textAlign:"center"},children:(0,t.jsx)("div",{className:"spinner"})}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"card",style:{marginBottom:20},children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h2",{className:"card-title",children:"Notificacoes Push"})}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,t.jsxs)("div",{style:{flex:1},children:[(0,t.jsx)("p",{style:{color:"var(--color-text-secondary)",fontSize:14,marginBottom:8},children:"Receba notificacoes mesmo quando o navegador estiver em segundo plano"}),a.supported?(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,t.jsx)("span",{className:"badge ".concat(a.isGranted?"badge-success":a.isDenied?"badge-danger":"badge-warning"),children:a.isGranted?"Ativo":a.isDenied?"Bloqueado":"Inativo"}),a.isSubscribed&&(0,t.jsx)("span",{className:"badge badge-info",children:"Inscrito"})]}):(0,t.jsx)("span",{className:"badge badge-neutral",children:"Nao suportado"})]}),a.supported&&!a.isGranted&&(0,t.jsx)("button",{className:"btn btn-primary",onClick:g,disabled:a.loading||a.isDenied,children:a.loading?"Ativando...":"Ativar Push"}),a.isGranted&&a.isSubscribed&&(0,t.jsx)("button",{className:"btn btn-secondary",onClick:()=>a.unsubscribe().then(()=>e("Push desativado","info")),disabled:a.loading,children:"Desativar"})]}),a.error&&(0,t.jsx)("div",{className:"toast-inline toast-inline-error",style:{marginTop:12},children:a.error})]}),(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h2",{className:"card-title",children:"Preferencias de Notificacao"})}),(0,t.jsx)("div",{style:{display:"grid",gap:0},children:h.map((e,a)=>(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"14px 0",borderBottom:a<h.length-1?"1px solid var(--color-border)":"none",gap:16},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontWeight:500,fontSize:14},children:e.label}),(0,t.jsx)("div",{style:{fontSize:13,color:"var(--color-text-secondary)",marginTop:2},children:e.desc})]}),(0,t.jsx)("button",{className:"toggle-switch ".concat((null==s?void 0:s[e.key])?"toggle-on":""),onClick:()=>{var a;return a=e.key,void n(e=>({...e,[a]:!e[a]}))},type:"button",children:(0,t.jsx)("span",{className:"toggle-knob"})})]},e.key))}),(0,t.jsx)("button",{className:"btn btn-primary",disabled:d,onClick:u,style:{marginTop:16},children:d?"Salvando...":"Salvar Preferencias"})]})]})}function j(){let{addNotification:e}=(0,c.l)(),a=(0,d.Gf)();async function s(){try{let s=await a.connect();s.success?e("Impressora conectada via ".concat("serial"===s.type?"Serial":"usb"===s.type?"USB":"Navegador"),"success"):s.fallback&&e("Usando impressao pelo navegador como fallback","info")}catch(a){e(a.message||"Erro ao conectar impressora","error")}}async function i(){let s=await a.testPrint();s.success?e("Impressao de teste enviada!","success"):e(s.error||"Erro na impressao de teste","error")}async function n(){await a.disconnect(),e("Impressora desconectada","info")}return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"card",style:{marginBottom:20},children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h2",{className:"card-title",children:"Status da Impressora"})}),(0,t.jsxs)("div",{style:{display:"grid",gap:16},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 0",borderBottom:"1px solid var(--color-border)"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontWeight:500,fontSize:14},children:"Conexao"}),(0,t.jsx)("div",{style:{fontSize:13,color:"var(--color-text-secondary)",marginTop:2},children:"serial"===a.printerType?"Conectado via Serial (USB)":"usb"===a.printerType?"Conectado via USB direto":"Usando impressao do navegador"})]}),(0,t.jsx)("span",{className:"badge ".concat(a.connected?"badge-success":"browser"===a.printerType?"badge-info":"badge-warning"),children:a.connected?"Conectado":"browser"===a.printerType?"Navegador":"Desconectado"})]}),(0,t.jsxs)("div",{style:{background:"var(--color-surface)",borderRadius:8,padding:12,fontSize:13},children:[(0,t.jsx)("div",{style:{fontWeight:500,marginBottom:8},children:"Suporte do navegador:"}),(0,t.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[(0,t.jsxs)("span",{className:"badge ".concat(a.isSerialSupported?"badge-success":"badge-neutral"),children:["Web Serial: ",a.isSerialSupported?"Sim":"Nao"]}),(0,t.jsxs)("span",{className:"badge ".concat(a.isUSBSupported?"badge-success":"badge-neutral"),children:["WebUSB: ",a.isUSBSupported?"Sim":"Nao"]})]}),!a.isSerialSupported&&!a.isUSBSupported&&(0,t.jsx)("p",{style:{marginTop:8,color:"var(--color-text-muted)"},children:"Este navegador nao suporta conexao direta com impressoras. Use Chrome ou Edge para melhor compatibilidade."})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[!a.connected&&(a.isSerialSupported||a.isUSBSupported)&&(0,t.jsx)("button",{className:"btn btn-primary",onClick:s,disabled:a.connecting,children:a.connecting?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"spinner-sm",style:{marginRight:8}}),"Conectando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:8},children:[(0,t.jsx)("polyline",{points:"6 9 6 2 18 2 18 9"}),(0,t.jsx)("path",{d:"M6 18H4a2 2 0 01-2-2v-5a2 2 0 012-2h16a2 2 0 012 2v5a2 2 0 01-2 2h-2"}),(0,t.jsx)("rect",{x:"6",y:"14",width:"12",height:"8"})]}),"Conectar Impressora"]})}),a.connected&&(0,t.jsx)("button",{className:"btn btn-secondary",onClick:n,children:"Desconectar"}),(0,t.jsx)("button",{className:"btn btn-secondary",onClick:i,disabled:a.printing,children:a.printing?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"spinner-sm",style:{marginRight:8}}),"Imprimindo..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:8},children:[(0,t.jsx)("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),(0,t.jsx)("polyline",{points:"14 2 14 8 20 8"}),(0,t.jsx)("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),(0,t.jsx)("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),"Imprimir Teste"]})})]})]})]}),(0,t.jsxs)("div",{className:"card",style:{marginBottom:20},children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h2",{className:"card-title",children:"Impressao Automatica"})}),(0,t.jsxs)("div",{style:{display:"grid",gap:0},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"14px 0",borderBottom:"1px solid var(--color-border)"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontWeight:500,fontSize:14},children:"Imprimir automaticamente novos pedidos"}),(0,t.jsx)("div",{style:{fontSize:13,color:"var(--color-text-secondary)",marginTop:2},children:"Quando um novo pedido chegar, imprimir automaticamente"})]}),(0,t.jsx)("button",{className:"toggle-switch ".concat(a.autoPrint?"toggle-on":""),onClick:a.toggleAutoPrint,type:"button",children:(0,t.jsx)("span",{className:"toggle-knob"})})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"14px 0",borderBottom:"1px solid var(--color-border)"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontWeight:500,fontSize:14},children:"Abrir gaveta de dinheiro"}),(0,t.jsx)("div",{style:{fontSize:13,color:"var(--color-text-secondary)",marginTop:2},children:"Abrir a gaveta automaticamente apos imprimir (requer impressora conectada)"})]}),(0,t.jsx)("button",{className:"toggle-switch ".concat(a.openDrawerOnPrint?"toggle-on":""),onClick:a.toggleOpenDrawer,type:"button",disabled:!a.connected,children:(0,t.jsx)("span",{className:"toggle-knob"})})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"14px 0"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontWeight:500,fontSize:14},children:"Largura do papel"}),(0,t.jsx)("div",{style:{fontSize:13,color:"var(--color-text-secondary)",marginTop:2},children:"Selecione o tamanho da bobina da sua impressora"})]}),(0,t.jsxs)("select",{className:"form-input",style:{width:"auto",minWidth:100},value:a.paperWidth,onChange:e=>a.updatePaperWidth(e.target.value),children:[(0,t.jsx)("option",{value:"58mm",children:"58mm"}),(0,t.jsx)("option",{value:"80mm",children:"80mm"})]})]})]})]}),a.printQueue.length>0&&(0,t.jsxs)("div",{className:"card",children:[(0,t.jsxs)("div",{className:"card-header",children:[(0,t.jsx)("h2",{className:"card-title",children:"Fila de Impressao"}),(0,t.jsxs)("span",{className:"badge badge-warning",children:[a.printQueue.length," na fila"]})]}),(0,t.jsx)("div",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:a.printQueue.map((e,s)=>{var i,n;return(0,t.jsxs)("div",{style:{padding:"8px 0",borderBottom:s<a.printQueue.length-1?"1px solid var(--color-border)":"none"},children:["Pedido #",(null===(i=e.order)||void 0===i?void 0:i.order_number)||(null===(n=e.order)||void 0===n?void 0:n.id)||s+1]},s)})})]}),(0,t.jsxs)("div",{className:"card",style:{marginTop:20,background:"var(--color-surface)"},children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h2",{className:"card-title",children:"Impressoras Compativeis"})}),(0,t.jsxs)("div",{style:{fontSize:13,color:"var(--color-text-secondary)",lineHeight:1.6},children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Impressoras Termicas USB:"})," A maioria das impressoras termicas de 58mm ou 80mm sao compativeis, incluindo:"]}),(0,t.jsxs)("ul",{style:{marginLeft:20,marginTop:8,marginBottom:12},children:[(0,t.jsx)("li",{children:"Epson TM-T20, TM-T88"}),(0,t.jsx)("li",{children:"Elgin i7, i9"}),(0,t.jsx)("li",{children:"Bematech MP-4200 TH"}),(0,t.jsx)("li",{children:"Daruma DR700, DR800"}),(0,t.jsx)("li",{children:"Sweda SI-250"}),(0,t.jsx)("li",{children:"Impressoras genericas com chip CH340/PL2303"})]}),(0,t.jsx)("p",{children:(0,t.jsx)("strong",{children:"Requisitos:"})}),(0,t.jsxs)("ul",{style:{marginLeft:20,marginTop:8},children:[(0,t.jsx)("li",{children:"Navegador Chrome 89+ ou Microsoft Edge"}),(0,t.jsx)("li",{children:"Impressora conectada via USB"}),(0,t.jsx)("li",{children:"Permissao de acesso a dispositivo USB/Serial"})]}),(0,t.jsx)("p",{style:{marginTop:12,fontStyle:"italic"},children:"Se sua impressora nao for detectada, a impressao sera feita usando a funcao de impressao do navegador."})]})]})]})}function y(){let{addNotification:e}=(0,c.l)(),[a,s]=(0,i.useState)([]),[n,r]=(0,i.useState)(!0),[l,d]=(0,i.useState)(!1);async function m(){d(!0);try{let s=a.filter(e=>e.selected).map(e=>e.id);await (0,o.sg)("/culinaria.php",{action:"set_tags",tag_ids:s}),e("Tags de culinaria atualizadas!","success")}catch(a){e(a.message||"Erro ao salvar","error")}finally{d(!1)}}return(0,i.useEffect)(()=>{!async function(){try{let e=await (0,o.SC)("/culinaria.php");s(e.tags||[])}catch(e){}r(!1)}()},[]),n?(0,t.jsx)("div",{style:{padding:40,textAlign:"center"},children:(0,t.jsx)("div",{className:"spinner"})}):0===a.length?(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h2",{className:"card-title",children:"Tags de Culinaria"})}),(0,t.jsx)("div",{className:"empty-state",children:(0,t.jsx)("div",{className:"empty-state-text",children:"Nenhuma tag de culinaria disponivel"})})]}):(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h2",{className:"card-title",children:"Tags de Culinaria"})}),(0,t.jsx)("p",{style:{color:"var(--color-text-secondary)",fontSize:14,marginBottom:16},children:"Selecione os tipos de culinaria que seu estabelecimento oferece. Isso ajuda clientes a encontrarem sua loja."}),(0,t.jsx)("div",{className:"tag-grid",children:a.map(e=>(0,t.jsxs)("button",{className:"tag-chip ".concat(e.selected?"tag-chip-selected":""),onClick:()=>{var a;return a=e.id,void s(e=>e.map(e=>e.id===a?{...e,selected:!e.selected}:e))},type:"button",children:[e.icon&&(0,t.jsx)("span",{style:{marginRight:4},children:e.icon}),e.name]},e.id))}),(0,t.jsx)("button",{className:"btn btn-primary",disabled:l,onClick:m,style:{marginTop:20},children:l?"Salvando...":"Salvar Tags"})]})}function f(){let{partner:e,updatePartner:a}=(0,l.a)(),{addNotification:s}=(0,c.l)(),[n,r]=(0,i.useState)(!0),[d,m]=(0,i.useState)(!1),[p,h]=(0,i.useState)(!1),[u,g]=(0,i.useState)(""),[x,v]=(0,i.useState)(!1),[j,y]=(0,i.useState)(""),[f,b]=(0,i.useState)(""),[N,S]=(0,i.useState)(""),[C,w]=(0,i.useState)(!1),[k,B]=(0,i.useState)("");async function A(){g(""),h(!0);try{let e=await (0,o.SC)("/auth/totp-setup.php");y(e.qr_url||e.otpauth_url||""),b(e.secret||""),v(!0)}catch(e){g(e.message)}finally{h(!1)}}async function z(){if(6===N.length){h(!0),g("");try{await (0,o.sg)("/auth/totp-setup.php",{code:N}),m(!0),a({totp_enabled:!0}),v(!1),S(""),s("2FA ativado com sucesso!","success")}catch(e){g(e.message||"Codigo invalido")}finally{h(!1)}}}async function T(){if(k){h(!0),g("");try{let e=await fetch("/api/mercado/partner/auth/totp-setup.php",{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("painel_partner_token"))},body:JSON.stringify({senha:k})}),t=await e.json();if(!e.ok||!t.success)throw Error(t.message||"Erro ao desativar 2FA");m(!1),a({totp_enabled:!1}),w(!1),B(""),s("2FA desativado","info")}catch(e){g(e.message||"Erro ao desativar 2FA")}finally{h(!1)}}}return((0,i.useEffect)(()=>{m(!!(null==e?void 0:e.totp_enabled)),r(!1)},[e]),n)?(0,t.jsx)("div",{style:{padding:40,textAlign:"center"},children:(0,t.jsx)("div",{className:"spinner"})}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h2",{className:"card-title",children:"Verificacao em 2 Etapas (2FA)"})}),(0,t.jsx)("p",{style:{color:"var(--color-text-secondary)",fontSize:14,marginBottom:16},children:"Adicione uma camada extra de seguranca a sua conta. Apos ativar, sera necessario um codigo do app autenticador para fazer login."}),u&&(0,t.jsx)("div",{className:"toast-inline toast-inline-error",style:{marginBottom:16},children:u}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"14px 0",borderBottom:"1px solid var(--color-border)"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontWeight:500,fontSize:14},children:"Status"}),(0,t.jsx)("div",{style:{fontSize:13,color:"var(--color-text-secondary)",marginTop:2},children:d?"Verificacao em 2 etapas esta ativa":"Verificacao em 2 etapas esta desativada"})]}),(0,t.jsx)("span",{className:"badge ".concat(d?"badge-success":"badge-warning"),children:d?"Ativo":"Inativo"})]}),(0,t.jsx)("div",{style:{marginTop:16},children:d?(0,t.jsx)("button",{className:"btn btn-danger",onClick:()=>w(!0),children:"Desativar 2FA"}):(0,t.jsx)("button",{className:"btn btn-primary",onClick:A,disabled:p,children:p?"Carregando...":"Ativar 2FA"})})]}),x&&(0,t.jsx)("div",{className:"modal-overlay",onClick:()=>{v(!1),S("")},children:(0,t.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),style:{maxWidth:420},children:[(0,t.jsx)("h3",{style:{fontSize:18,fontWeight:600,marginBottom:16},children:"Configurar 2FA"}),(0,t.jsxs)("div",{style:{marginBottom:16},children:[(0,t.jsx)("p",{style:{fontSize:14,color:"var(--color-text-secondary)",marginBottom:12},children:"1. Instale um app autenticador (Google Authenticator, Authy, etc.)"}),(0,t.jsx)("p",{style:{fontSize:14,color:"var(--color-text-secondary)",marginBottom:12},children:"2. Escaneie o QR Code abaixo ou insira a chave manualmente:"})]}),j&&(0,t.jsx)("div",{style:{textAlign:"center",marginBottom:16},children:(0,t.jsx)("img",{src:"https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=".concat(encodeURIComponent(j)),alt:"QR Code",style:{width:200,height:200,borderRadius:8}})}),f&&(0,t.jsxs)("div",{style:{background:"var(--color-surface)",borderRadius:8,padding:12,textAlign:"center",marginBottom:16,fontSize:14},children:[(0,t.jsx)("div",{style:{color:"var(--color-text-secondary)",fontSize:12,marginBottom:4},children:"Chave manual:"}),(0,t.jsx)("code",{style:{fontFamily:"monospace",fontWeight:600,letterSpacing:2},children:f})]}),(0,t.jsxs)("div",{style:{marginBottom:16},children:[(0,t.jsx)("p",{style:{fontSize:14,color:"var(--color-text-secondary)",marginBottom:8},children:"3. Digite o codigo de 6 digitos do app:"}),(0,t.jsx)("input",{type:"text",inputMode:"numeric",className:"form-input",placeholder:"000000",maxLength:6,value:N,onChange:e=>S(e.target.value.replace(/\D/g,"").slice(0,6)),style:{textAlign:"center",fontSize:24,letterSpacing:8,fontFamily:"monospace",fontWeight:600}})]}),u&&(0,t.jsx)("div",{className:"toast-inline toast-inline-error",style:{marginBottom:12},children:u}),(0,t.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[(0,t.jsx)("button",{className:"btn btn-secondary",onClick:()=>{v(!1),S("")},children:"Cancelar"}),(0,t.jsx)("button",{className:"btn btn-primary",onClick:z,disabled:p||6!==N.length,children:p?"Verificando...":"Confirmar e Ativar"})]})]})}),C&&(0,t.jsx)("div",{className:"modal-overlay",onClick:()=>{w(!1),B("")},children:(0,t.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),style:{maxWidth:400},children:[(0,t.jsx)("h3",{style:{fontSize:18,fontWeight:600,marginBottom:16},children:"Desativar 2FA"}),(0,t.jsx)("p",{style:{fontSize:14,color:"var(--color-text-secondary)",marginBottom:16},children:"Para desativar a verificacao em 2 etapas, digite sua senha:"}),u&&(0,t.jsx)("div",{className:"toast-inline toast-inline-error",style:{marginBottom:12},children:u}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Senha"}),(0,t.jsx)("input",{type:"password",className:"form-input",value:k,onChange:e=>B(e.target.value),placeholder:"Sua senha atual"})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[(0,t.jsx)("button",{className:"btn btn-secondary",onClick:()=>{w(!1),B("")},children:"Cancelar"}),(0,t.jsx)("button",{className:"btn btn-danger",onClick:T,disabled:p||!k,children:p?"Desativando...":"Desativar 2FA"})]})]})})]})}function b(){let[e,a]=(0,i.useState)(""),s="DESATIVAR"===e;return(0,t.jsxs)("div",{className:"danger-zone",children:[(0,t.jsx)("h2",{style:{color:"var(--color-danger)",fontSize:18,fontWeight:700,marginBottom:8},children:"Zona de Perigo"}),(0,t.jsx)("p",{style:{color:"var(--color-text-secondary)",fontSize:14,marginBottom:20,lineHeight:1.6},children:"Ao desativar sua conta, sua loja sera removida da plataforma e voce nao podera receber novos pedidos. Pedidos em andamento serao concluidos normalmente. Esta acao pode ser revertida entrando em contato com o suporte."}),(0,t.jsxs)("div",{className:"form-group",style:{maxWidth:400},children:[(0,t.jsxs)("label",{className:"form-label",children:["Para confirmar, digite ",(0,t.jsx)("strong",{children:"DESATIVAR"})," abaixo:"]}),(0,t.jsx)("input",{type:"text",className:"form-input",value:e,onChange:e=>a(e.target.value),placeholder:"DESATIVAR"})]}),(0,t.jsx)("button",{className:"btn btn-danger",disabled:!s,onClick:()=>{alert("Para desativar sua conta, entre em contato com o suporte: contato@superbora.com.br")},children:"Desativar Minha Conta"})]})}}},function(e){e.O(0,[3448,565,2205,3563,2971,2117,1744],function(){return e(e.s=1785)}),_N_E=e.O()}]);
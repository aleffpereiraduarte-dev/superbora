(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1969],{3764:function(e,a,t){Promise.resolve().then(t.bind(t,6627))},6627:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return h}});var n=t(7437),s=t(2265),o=t(4565),i=t(4477),r=t(6428),l=t(6971);function d(e){return e?new Date(e).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):""}let c={push:{label:"Push",color:"#3b82f6",bg:"#eff6ff",icon:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"},whatsapp:{label:"WhatsApp",color:"#25d366",bg:"#f0fdf4",icon:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"},sms:{label:"SMS",color:"#f59e0b",bg:"#fffbeb",icon:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"},email:{label:"Email",color:"#8b5cf6",bg:"#f5f3ff",icon:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"}},m={rascunho:{label:"Rascunho",badge:"badge-neutral"},agendada:{label:"Agendada",badge:"badge-info"},enviando:{label:"Enviando",badge:"badge-warning"},enviada:{label:"Enviada",badge:"badge-success"},cancelada:{label:"Cancelada",badge:"badge-danger"}},p={all:"Todos os Clientes",new:"Novos Clientes",returning:"Clientes Recorrentes",inactive:"Inativos (+30 dias)",champions:"Clientes Champions"};function h(){return(0,n.jsx)(o.Z,{children:(0,n.jsx)(i.Z,{children:(0,n.jsx)(g,{})})})}function g(){let{addNotification:e}=(0,l.l)(),[a,t]=(0,s.useState)([]),[o,i]=(0,s.useState)(null),[h,g]=(0,s.useState)(!0),[x,u]=(0,s.useState)({total:0,page:1,pages:1}),[v,y]=(0,s.useState)(""),[b,f]=(0,s.useState)(""),[j,C]=(0,s.useState)(!1),[S,N]=(0,s.useState)(!1),[k,_]=(0,s.useState)([]),[w,z]=(0,s.useState)(!1),[T,W]=(0,s.useState)(!1),[A,E]=(0,s.useState)([]),[R,B]=(0,s.useState)(null),[L,M]=(0,s.useState)({nome:"",tipo:"push",segmento_alvo:"all",titulo:"",mensagem:"",cupom_id:"",agendado_para:"",send_immediately:!0}),I=(0,s.useCallback)(async function(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;g(!0);try{let e={page:a,limit:15};v&&(e.status=v),b&&(e.tipo=b);let n=await (0,r.SC)("/campanhas.php",e);t((null==n?void 0:n.items)||[]),i((null==n?void 0:n.stats)||null),u((null==n?void 0:n.pagination)||{total:0,page:1,pages:1})}catch(a){e(a.message||"Erro ao carregar campanhas","error")}finally{g(!1)}},[v,b]);async function D(){W(!0);try{let e=await (0,r.SC)("/campanhas.php",{action:"templates"});_((null==e?void 0:e.templates)||[])}catch(e){console.error("Erro ao carregar templates:",e)}finally{W(!1)}}function V(){M({nome:"",tipo:"push",segmento_alvo:"all",titulo:"",mensagem:"",cupom_id:"",agendado_para:"",send_immediately:!0}),C(!0),z(!1)}async function F(a){if(a.preventDefault(),!L.nome||!L.mensagem){e("Nome e mensagem sao obrigatorios","error");return}N(!0);try{let a={action:"create",nome:L.nome,tipo:L.tipo,segmento_alvo:L.segmento_alvo,titulo:L.titulo,mensagem:L.mensagem};L.cupom_id&&(a.cupom_id=parseInt(L.cupom_id)),!L.send_immediately&&L.agendado_para&&(a.agendado_para=L.agendado_para),await (0,r.sg)("/campanhas.php",a),e("Campanha criada com sucesso!","success"),C(!1),await I()}catch(a){e(a.message||"Erro ao criar campanha","error")}finally{N(!1)}}async function H(a){if(confirm("Deseja enviar esta campanha agora?"))try{let t=await (0,r.sg)("/campanhas.php",{action:"send",campaign_id:a});e("Campanha enviada para ".concat((null==t?void 0:t.enviados)||0," clientes!"),"success"),await I()}catch(a){e(a.message||"Erro ao enviar campanha","error")}}async function P(a){if(confirm("Cancelar esta campanha?"))try{await (0,r.sg)("/campanhas.php",{action:"cancel",campaign_id:a}),e("Campanha cancelada","success"),await I()}catch(a){e(a.message||"Erro ao cancelar","error")}}async function O(a){if(confirm("Excluir esta campanha permanentemente?"))try{await (0,r.apiDelete)("/campanhas.php",{id:a}),e("Campanha excluida","success"),t(e=>e.filter(e=>e.id!==a))}catch(a){e(a.message||"Erro ao excluir","error")}}return(0,s.useEffect)(()=>{I()},[I]),(0,s.useEffect)(()=>{(0,r.SC)("/coupons.php",{status:"active",limit:100}).then(e=>E((null==e?void 0:e.items)||[])).catch(()=>{})},[]),h&&0===a.length?(0,n.jsx)("div",{style:{padding:60,textAlign:"center"},children:(0,n.jsx)("div",{className:"spinner"})}):(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"page-header",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"page-title",children:"Campanhas"}),(0,n.jsx)("p",{className:"page-subtitle",children:"Envie mensagens segmentadas para seus clientes"})]}),(0,n.jsx)("button",{className:"btn btn-primary",onClick:V,children:"+ Nova Campanha"})]}),o&&(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:16,marginBottom:24},children:[(0,n.jsxs)("div",{className:"card",style:{padding:20,textAlign:"center"},children:[(0,n.jsx)("div",{style:{fontSize:28,fontWeight:700,color:"#3b82f6"},children:o.total_campaigns}),(0,n.jsx)("div",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:"Total Campanhas"})]}),(0,n.jsxs)("div",{className:"card",style:{padding:20,textAlign:"center"},children:[(0,n.jsx)("div",{style:{fontSize:28,fontWeight:700,color:"#10b981"},children:o.total_enviados}),(0,n.jsx)("div",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:"Total Enviados"})]}),(0,n.jsxs)("div",{className:"card",style:{padding:20,textAlign:"center"},children:[(0,n.jsx)("div",{style:{fontSize:28,fontWeight:700,color:"#f59e0b"},children:o.total_abertos}),(0,n.jsx)("div",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:"Total Aberturas"})]}),(0,n.jsxs)("div",{className:"card",style:{padding:20,textAlign:"center"},children:[(0,n.jsxs)("div",{style:{fontSize:28,fontWeight:700,color:"#8b5cf6"},children:[o.avg_conversion,"%"]}),(0,n.jsx)("div",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:"Taxa Conversao"})]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:16,flexWrap:"wrap"},children:[(0,n.jsxs)("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[(0,n.jsx)("span",{style:{fontSize:13,color:"var(--color-text-secondary)",marginRight:4},children:"Status:"}),["","rascunho","agendada","enviada","cancelada"].map(e=>{var a;return(0,n.jsx)("button",{className:"btn btn-sm ".concat(v===e?"btn-primary":"btn-secondary"),onClick:()=>y(e),children:""===e?"Todos":(null===(a=m[e])||void 0===a?void 0:a.label)||e},e)})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:4,alignItems:"center",marginLeft:8},children:[(0,n.jsx)("span",{style:{fontSize:13,color:"var(--color-text-secondary)",marginRight:4},children:"Tipo:"}),["","push","whatsapp","sms"].map(e=>{var a;return(0,n.jsx)("button",{className:"btn btn-sm ".concat(b===e?"btn-primary":"btn-secondary"),onClick:()=>f(e),children:""===e?"Todos":(null===(a=c[e])||void 0===a?void 0:a.label)||e},e)})]})]}),0===a.length?(0,n.jsx)("div",{className:"card",children:(0,n.jsxs)("div",{className:"empty-state",children:[(0,n.jsx)("div",{className:"empty-state-icon",children:(0,n.jsx)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:(0,n.jsx)("path",{d:"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"})})}),(0,n.jsx)("div",{className:"empty-state-title",children:"Nenhuma campanha encontrada"}),(0,n.jsx)("div",{className:"empty-state-text",children:"Crie sua primeira campanha para engajar seus clientes"}),(0,n.jsx)("button",{className:"btn btn-primary",onClick:V,style:{marginTop:16},children:"+ Criar Campanha"})]})}):(0,n.jsx)("div",{style:{display:"grid",gap:12},children:a.map(e=>{let a=c[e.tipo]||c.push,t=m[e.status]||m.rascunho,s=R===e.id;return(0,n.jsxs)("div",{className:"card",style:{padding:0,overflow:"hidden"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:14,padding:"16px 20px",cursor:"pointer"},onClick:()=>B(s?null:e.id),children:[(0,n.jsx)("div",{style:{width:44,height:44,borderRadius:12,background:a.bg,color:a.color,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,n.jsx)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:a.icon})})}),(0,n.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[(0,n.jsx)("span",{style:{fontWeight:600,fontSize:15},children:e.nome}),(0,n.jsx)("span",{className:"badge ".concat(t.badge),children:t.label}),(0,n.jsx)("span",{style:{fontSize:11,color:a.color,background:a.bg,padding:"2px 8px",borderRadius:20,fontWeight:600},children:a.label}),e.cupom_code&&(0,n.jsxs)("span",{style:{fontSize:11,color:"#8b5cf6",background:"#f5f3ff",padding:"2px 8px",borderRadius:20,fontWeight:600},children:["Cupom: ",e.cupom_code]})]}),(0,n.jsxs)("div",{style:{fontSize:13,color:"var(--color-text-secondary)",marginTop:4},children:[p[e.segmento_alvo]||e.segmento_alvo,e.agendado_para&&"agendada"===e.status&&(0,n.jsxs)("span",{children:[" \xb7 Agendada para ",d(e.agendado_para)]}),e.sent_at&&(0,n.jsxs)("span",{children:[" \xb7 Enviada em ",d(e.sent_at)]})]})]}),"enviada"===e.status&&(0,n.jsxs)("div",{style:{display:"flex",gap:16,flexShrink:0},children:[(0,n.jsxs)("div",{style:{textAlign:"center"},children:[(0,n.jsx)("div",{style:{fontSize:18,fontWeight:700,color:"#3b82f6"},children:e.enviados}),(0,n.jsx)("div",{style:{fontSize:11,color:"var(--color-text-secondary)"},children:"Enviados"})]}),(0,n.jsxs)("div",{style:{textAlign:"center"},children:[(0,n.jsx)("div",{style:{fontSize:18,fontWeight:700,color:"#10b981"},children:e.abertos}),(0,n.jsx)("div",{style:{fontSize:11,color:"var(--color-text-secondary)"},children:"Abertos"})]}),(0,n.jsxs)("div",{style:{textAlign:"center"},children:[(0,n.jsx)("div",{style:{fontSize:18,fontWeight:700,color:"#8b5cf6"},children:e.convertidos}),(0,n.jsx)("div",{style:{fontSize:11,color:"var(--color-text-secondary)"},children:"Convertidos"})]})]}),(0,n.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transition:"transform 0.2s",transform:s?"rotate(180deg)":"rotate(0deg)",flexShrink:0,color:"var(--color-text-secondary)"},children:(0,n.jsx)("polyline",{points:"6 9 12 15 18 9"})})]}),s&&(0,n.jsxs)("div",{style:{borderTop:"1px solid var(--color-border)",padding:"16px 20px",background:"var(--color-bg-secondary)"},children:[e.titulo&&(0,n.jsxs)("div",{style:{marginBottom:8},children:[(0,n.jsx)("strong",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:"Titulo:"}),(0,n.jsx)("div",{style:{fontSize:14,fontWeight:500,marginTop:2},children:e.titulo})]}),(0,n.jsxs)("div",{style:{marginBottom:12},children:[(0,n.jsx)("strong",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:"Mensagem:"}),(0,n.jsx)("div",{style:{fontSize:14,marginTop:4,padding:12,background:"var(--color-bg)",borderRadius:8,border:"1px solid var(--color-border)",whiteSpace:"pre-wrap"},children:e.mensagem})]}),e.cupom_code&&(0,n.jsxs)("div",{style:{marginBottom:12},children:[(0,n.jsx)("strong",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:"Cupom vinculado:"}),(0,n.jsxs)("div",{style:{marginTop:4},children:[(0,n.jsx)("code",{style:{background:"#f5f3ff",color:"#8b5cf6",padding:"4px 10px",borderRadius:6,fontWeight:600},children:e.cupom_code}),e.cupom_desconto&&(0,n.jsxs)("span",{style:{marginLeft:8,fontSize:13,color:"var(--color-text-secondary)"},children:["(",e.cupom_desconto," de desconto)"]})]})]}),"enviada"===e.status&&e.enviados>0&&(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)("strong",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:"Desempenho:"}),(0,n.jsxs)("div",{style:{marginTop:8},children:[(0,n.jsxs)("div",{style:{display:"flex",gap:20},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:"Taxa de abertura: "}),(0,n.jsxs)("strong",{children:[e.enviados>0?(e.abertos/e.enviados*100).toFixed(1):0,"%"]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:"Taxa de conversao: "}),(0,n.jsxs)("strong",{children:[e.enviados>0?(e.convertidos/e.enviados*100).toFixed(1):0,"%"]})]})]}),(0,n.jsxs)("div",{style:{height:8,background:"#e5e7eb",borderRadius:4,marginTop:8,overflow:"hidden",display:"flex"},children:[(0,n.jsx)("div",{style:{width:"".concat(e.enviados>0?e.convertidos/e.enviados*100:0,"%"),background:"#8b5cf6",minWidth:e.convertidos>0?4:0}}),(0,n.jsx)("div",{style:{width:"".concat(e.enviados>0?(e.abertos-e.convertidos)/e.enviados*100:0,"%"),background:"#10b981",minWidth:e.abertos-e.convertidos>0?4:0}})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:16,marginTop:6,fontSize:11,color:"var(--color-text-secondary)"},children:[(0,n.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:4},children:[(0,n.jsx)("span",{style:{width:8,height:8,borderRadius:"50%",background:"#8b5cf6",display:"inline-block"}}),"Convertidos"]}),(0,n.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:4},children:[(0,n.jsx)("span",{style:{width:8,height:8,borderRadius:"50%",background:"#10b981",display:"inline-block"}}),"Abertos"]}),(0,n.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:4},children:[(0,n.jsx)("span",{style:{width:8,height:8,borderRadius:"50%",background:"#e5e7eb",display:"inline-block"}}),"Nao abertos"]})]})]})]}),(0,n.jsxs)("div",{style:{fontSize:12,color:"var(--color-text-secondary)",marginBottom:12},children:["Criada em ",d(e.created_at)]}),(0,n.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[("rascunho"===e.status||"agendada"===e.status)&&(0,n.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>H(e.id),children:"Enviar Agora"}),("rascunho"===e.status||"agendada"===e.status)&&(0,n.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:()=>P(e.id),children:"Cancelar"}),"enviando"!==e.status&&(0,n.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>O(e.id),children:"Excluir"})]})]})]},e.id)})}),x.pages>1&&(0,n.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:8,padding:"24px 0"},children:Array.from({length:x.pages},(e,a)=>a+1).map(e=>(0,n.jsx)("button",{className:"btn btn-sm ".concat(e===x.page?"btn-primary":"btn-secondary"),onClick:()=>I(e),children:e},e))}),j&&(0,n.jsx)("div",{className:"modal-overlay",onClick:e=>e.target===e.currentTarget&&C(!1),children:(0,n.jsxs)("div",{className:"modal",style:{maxWidth:640},children:[(0,n.jsxs)("div",{className:"modal-header",children:[(0,n.jsx)("h3",{className:"modal-title",children:"Nova Campanha"}),(0,n.jsx)("button",{className:"modal-close",onClick:()=>C(!1),children:"\xd7"})]}),(0,n.jsxs)("form",{onSubmit:F,children:[(0,n.jsxs)("div",{className:"modal-body",style:{maxHeight:"70vh",overflowY:"auto"},children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label",children:"Nome da Campanha"}),(0,n.jsx)("input",{type:"text",className:"form-input",value:L.nome,onChange:e=>M(a=>({...a,nome:e.target.value})),placeholder:"Ex: Promocao de Natal",maxLength:255,required:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label",children:"Canal de Envio"}),(0,n.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:8},children:["push","whatsapp","sms"].map(e=>{let a=c[e];return(0,n.jsxs)("button",{type:"button",onClick:()=>M(a=>({...a,tipo:e})),style:{padding:"12px 8px",border:L.tipo===e?"2px solid ".concat(a.color):"2px solid var(--color-border)",borderRadius:10,background:L.tipo===e?a.bg:"var(--color-bg)",cursor:"pointer",textAlign:"center",transition:"all 0.15s"},children:[(0,n.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:L.tipo===e?a.color:"var(--color-text-secondary)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{display:"block",margin:"0 auto 6px"},children:(0,n.jsx)("path",{d:a.icon})}),(0,n.jsx)("div",{style:{fontSize:13,fontWeight:600,color:L.tipo===e?a.color:"var(--color-text)"},children:a.label})]},e)})})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label",children:"Publico Alvo"}),(0,n.jsx)("select",{className:"form-input",value:L.segmento_alvo,onChange:e=>M(a=>({...a,segmento_alvo:e.target.value})),children:Object.entries(p).map(e=>{let[a,t]=e;return(0,n.jsx)("option",{value:a,children:t},a)})})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[(0,n.jsx)("label",{className:"form-label",style:{marginBottom:0},children:"Mensagem"}),(0,n.jsx)("button",{type:"button",className:"btn btn-secondary btn-sm",onClick:()=>{w||0!==k.length||D(),z(!w)},children:w?"Fechar Templates":"Usar Template"})]}),w&&(0,n.jsx)("div",{style:{marginBottom:12,padding:12,background:"var(--color-bg-secondary)",borderRadius:10,border:"1px solid var(--color-border)"},children:T?(0,n.jsx)("div",{style:{textAlign:"center",padding:16},children:(0,n.jsx)("div",{className:"spinner-sm"})}):0===k.length?(0,n.jsx)("div",{style:{textAlign:"center",padding:16,color:"var(--color-text-secondary)",fontSize:13},children:"Nenhum template disponivel"}):(0,n.jsx)("div",{style:{display:"grid",gap:8},children:k.map(e=>(0,n.jsxs)("button",{type:"button",onClick:()=>{M(a=>({...a,titulo:e.titulo,mensagem:e.mensagem,segmento_alvo:e.segmento_sugerido||"all",nome:e.nome})),z(!1)},style:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:"10px 14px",border:"1px solid var(--color-border)",borderRadius:8,background:"var(--color-bg)",cursor:"pointer",textAlign:"left",transition:"border-color 0.15s",width:"100%"},onMouseEnter:e=>e.currentTarget.style.borderColor="var(--color-primary)",onMouseLeave:e=>e.currentTarget.style.borderColor="var(--color-border)",children:[(0,n.jsx)("div",{style:{fontWeight:600,fontSize:14,marginBottom:2},children:e.nome}),(0,n.jsx)("div",{style:{fontSize:12,color:"var(--color-text-secondary)"},children:e.descricao}),(0,n.jsxs)("div",{style:{fontSize:12,color:"var(--color-text-secondary)",marginTop:4,fontStyle:"italic"},children:["“",e.mensagem.substring(0,80),e.mensagem.length>80?"...":"","”"]})]},e.id))})}),(0,n.jsx)("input",{type:"text",className:"form-input",value:L.titulo,onChange:e=>M(a=>({...a,titulo:e.target.value})),placeholder:"Titulo da notificacao (opcional)",maxLength:255,style:{marginBottom:8}}),(0,n.jsx)("textarea",{className:"form-input",value:L.mensagem,onChange:e=>M(a=>({...a,mensagem:e.target.value})),placeholder:"Escreva a mensagem da campanha...",rows:4,maxLength:5e3,required:!0,style:{resize:"vertical"}}),(0,n.jsxs)("div",{style:{textAlign:"right",fontSize:11,color:"var(--color-text-secondary)",marginTop:4},children:[L.mensagem.length,"/5000"]})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label",children:"Vincular Cupom (opcional)"}),(0,n.jsxs)("select",{className:"form-input",value:L.cupom_id,onChange:e=>M(a=>({...a,cupom_id:e.target.value})),children:[(0,n.jsx)("option",{value:"",children:"Nenhum cupom"}),A.map(e=>(0,n.jsxs)("option",{value:e.id,children:[e.code," - ","percent"===e.discount_type?"".concat(e.discount_value,"%"):"R$ ".concat(parseFloat(e.discount_value).toFixed(2))]},e.id))]})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label",children:"Agendamento"}),(0,n.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:8},children:[(0,n.jsx)("button",{type:"button",className:"btn btn-sm ".concat(L.send_immediately?"btn-primary":"btn-secondary"),onClick:()=>M(e=>({...e,send_immediately:!0,agendado_para:""})),children:"Enviar depois (rascunho)"}),(0,n.jsx)("button",{type:"button",className:"btn btn-sm ".concat(L.send_immediately?"btn-secondary":"btn-primary"),onClick:()=>M(e=>({...e,send_immediately:!1})),children:"Agendar envio"})]}),!L.send_immediately&&(0,n.jsx)("input",{type:"datetime-local",className:"form-input",value:L.agendado_para,onChange:e=>M(a=>({...a,agendado_para:e.target.value})),min:new Date().toISOString().slice(0,16),required:!L.send_immediately})]}),L.mensagem&&(0,n.jsxs)("div",{style:{padding:16,background:"var(--color-bg-secondary)",borderRadius:12,border:"1px solid var(--color-border)"},children:[(0,n.jsx)("div",{style:{fontSize:12,fontWeight:600,color:"var(--color-text-secondary)",marginBottom:8},children:"Preview da mensagem:"}),(0,n.jsxs)("div",{style:{padding:12,background:"var(--color-bg)",borderRadius:8,border:"1px solid var(--color-border)"},children:[L.titulo&&(0,n.jsx)("div",{style:{fontWeight:600,fontSize:14,marginBottom:4},children:L.titulo}),(0,n.jsx)("div",{style:{fontSize:14,whiteSpace:"pre-wrap"},children:L.mensagem})]}),(0,n.jsxs)("div",{style:{marginTop:8,display:"flex",gap:8,flexWrap:"wrap"},children:[(0,n.jsx)("span",{style:{fontSize:11,padding:"2px 8px",borderRadius:20,background:(c[L.tipo]||c.push).bg,color:(c[L.tipo]||c.push).color,fontWeight:600},children:(c[L.tipo]||c.push).label}),(0,n.jsx)("span",{style:{fontSize:11,padding:"2px 8px",borderRadius:20,background:"#f3f4f6",color:"#6b7280",fontWeight:600},children:p[L.segmento_alvo]||L.segmento_alvo})]})]})]}),(0,n.jsxs)("div",{className:"modal-footer",children:[(0,n.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>C(!1),children:"Cancelar"}),(0,n.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:S,children:S?(0,n.jsx)("span",{className:"spinner-sm"}):"Criar Campanha"})]})]})]})})]})}}},function(e){e.O(0,[3448,565,2205,2971,2117,1744],function(){return e(e.s=3764)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[952],{5331:function(e,a,t){Promise.resolve().then(t.bind(t,3040))},3040:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return h}});var s=t(7437),i=t(29),o=t.n(i),n=t(2265),r=t(4565),l=t(4477),d=t(6428),c=t(7128),p=t(6971);let u=[{label:"30 min",value:30},{label:"1 hora",value:60},{label:"2 horas",value:120},{label:"Indefinido",value:null}],x=[{key:"status",label:"Status da Loja"},{key:"produtos",label:"Produtos"},{key:"fila",label:"Fila de Pedidos"},{key:"agendamentos",label:"Agendamentos"},{key:"historico",label:"Historico"}];function h(){return(0,s.jsx)(r.Z,{children:(0,s.jsx)(l.Z,{children:(0,s.jsx)(m,{})})})}function m(){let{partner:e,updatePartner:a}=(0,c.a)(),{addNotification:t}=(0,p.l)(),[i,o]=(0,n.useState)("status"),[r,l]=(0,n.useState)(null),[u,h]=(0,n.useState)(!0),[m,N]=(0,n.useState)(""),_=(0,n.useCallback)(async()=>{try{let e=await (0,d.SC)("/disponibilidade.php");l(e),N("")}catch(e){N(e.message||"Erro ao carregar disponibilidade")}finally{h(!1)}},[]);return((0,n.useEffect)(()=>{_()},[_]),(0,n.useEffect)(()=>{let e=setInterval(_,3e4);return()=>clearInterval(e)},[_]),u)?(0,s.jsxs)("div",{style:{padding:40,textAlign:"center"},children:[(0,s.jsx)("div",{className:"spinner"}),(0,s.jsx)("p",{style:{marginTop:12,color:"var(--color-text-secondary)",fontSize:14},children:"Carregando disponibilidade..."})]}):m&&!r?(0,s.jsxs)("div",{style:{padding:40,textAlign:"center"},children:[(0,s.jsx)("div",{className:"toast-inline toast-inline-error",style:{display:"inline-block",marginBottom:16},children:m}),(0,s.jsx)("br",{}),(0,s.jsx)("button",{className:"btn btn-primary",onClick:()=>{h(!0),_()},children:"Tentar Novamente"})]}):(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"page-header",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"page-title",children:"Disponibilidade"}),(0,s.jsx)("p",{className:"page-subtitle",children:"Gerencie o status da loja, produtos e fila de pedidos"})]}),(0,s.jsxs)("button",{className:"btn btn-secondary",onClick:_,style:{display:"flex",alignItems:"center",gap:6},children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("polyline",{points:"23 4 23 10 17 10"}),(0,s.jsx)("polyline",{points:"1 20 1 14 7 14"}),(0,s.jsx)("path",{d:"M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"})]}),"Atualizar"]})]}),(0,s.jsx)(g,{data:r,onRefresh:_}),(0,s.jsx)("div",{className:"tabs",style:{marginTop:24},children:x.map(e=>(0,s.jsxs)("button",{className:"tab ".concat(i===e.key?"tab-active":""),onClick:()=>o(e.key),children:[e.label,"produtos"===e.key&&(null==r?void 0:r.paused_products_count)>0&&(0,s.jsx)("span",{style:{background:"var(--color-danger)",color:"#fff",borderRadius:10,fontSize:11,fontWeight:700,padding:"1px 6px",marginLeft:6},children:r.paused_products_count})]},e.key))}),"status"===i&&(0,s.jsx)(f,{data:r,onRefresh:_}),"produtos"===i&&(0,s.jsx)(y,{data:r,onRefresh:_}),"fila"===i&&(0,s.jsx)(v,{data:r,onRefresh:_}),"agendamentos"===i&&(0,s.jsx)(j,{data:r,onRefresh:_}),"historico"===i&&(0,s.jsx)(b,{data:r})]})}function g(e){let{data:a,onRefresh:t}=e,{updatePartner:i}=(0,c.a)(),{addNotification:r}=(0,p.l)(),[l,x]=(0,n.useState)(!1),[h,m]=(0,n.useState)(""),g=(0,n.useRef)(null);async function f(e){x(!0);try{await (0,d.sg)("/disponibilidade.php",{action:"pause_store",duracao_minutos:e}),i({is_open:!1}),r(e?"Loja pausada por ".concat(e," minutos"):"Loja pausada indefinidamente","success"),t()}catch(e){r(e.message||"Erro ao pausar","error")}finally{x(!1)}}async function y(){x(!0);try{await (0,d.sg)("/disponibilidade.php",{action:"resume_store"}),i({is_open:!0}),r("Loja reaberta com sucesso!","success"),t()}catch(e){r(e.message||"Erro ao reabrir","error")}finally{x(!1)}}(0,n.useEffect)(()=>{if(!(null==a?void 0:a.pause_until)||"paused"!==a.store_status){m(""),g.current&&clearInterval(g.current);return}function e(){let e=new Date,s=new Date(a.pause_until).getTime()-e.getTime();if(s<=0){m("Expirando..."),t();return}let i=Math.floor(s/36e5),o=Math.floor(s%36e5/6e4),n=Math.floor(s%6e4/1e3);i>0?m("".concat(i,"h ").concat(o,"m ").concat(n,"s")):m("".concat(o,"m ").concat(n,"s"))}return e(),g.current=setInterval(e,1e3),()=>{g.current&&clearInterval(g.current)}},[null==a?void 0:a.pause_until,null==a?void 0:a.store_status,t]);let v=(null==a?void 0:a.store_status)||"closed",j={open:{bg:"#ecfdf5",border:"#10b981",dot:"#10b981",text:"#065f46",label:"Aberto"},paused:{bg:"#fffbeb",border:"#f59e0b",dot:"#f59e0b",text:"#92400e",label:"Pausado"},closed:{bg:"#fef2f2",border:"#ef4444",dot:"#ef4444",text:"#991b1b",label:"Fechado"}},b=j[v]||j.closed;return(0,s.jsxs)("div",{style:{background:b.bg,border:"2px solid ".concat(b.border),borderRadius:12,padding:"20px 24px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:16,flexWrap:"wrap"},className:"jsx-82800555234e8b51",children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},className:"jsx-82800555234e8b51",children:[(0,s.jsx)("div",{style:{width:16,height:16,borderRadius:"50%",background:b.dot,boxShadow:"0 0 0 4px ".concat(b.dot,"33"),animation:"open"===v?"pulse 2s infinite":"none",flexShrink:0},className:"jsx-82800555234e8b51"}),(0,s.jsxs)("div",{className:"jsx-82800555234e8b51",children:[(0,s.jsx)("div",{style:{fontSize:20,fontWeight:700,color:b.text},className:"jsx-82800555234e8b51",children:b.label}),"paused"===v&&h&&(0,s.jsxs)("div",{style:{fontSize:14,color:b.text,marginTop:2},className:"jsx-82800555234e8b51",children:["Volta em: ",(0,s.jsx)("strong",{className:"jsx-82800555234e8b51",children:h})]}),"paused"===v&&!(null==a?void 0:a.pause_until)&&(0,s.jsx)("div",{style:{fontSize:14,color:b.text,marginTop:2},className:"jsx-82800555234e8b51",children:"Pausado indefinidamente"}),"paused"===v&&(null==a?void 0:a.pause_reason)&&(0,s.jsxs)("div",{style:{fontSize:13,color:b.text,opacity:.7,marginTop:2},className:"jsx-82800555234e8b51",children:["Motivo: ",a.pause_reason]}),(null==a?void 0:a.horario_abertura)&&(null==a?void 0:a.horario_fechamento)&&(0,s.jsxs)("div",{style:{fontSize:13,color:b.text,opacity:.7,marginTop:2},className:"jsx-82800555234e8b51",children:["Horario: ",a.horario_abertura," - ",a.horario_fechamento]})]})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},className:"jsx-82800555234e8b51",children:["open"===v&&u.map(e=>{var a;return(0,s.jsx)("button",{style:{fontSize:13,padding:"6px 12px"},disabled:l,onClick:()=>f(e.value),className:"jsx-82800555234e8b51 btn btn-secondary",children:e.label},null!==(a=e.value)&&void 0!==a?a:"indef")}),("paused"===v||"closed"===v)&&(0,s.jsx)("button",{disabled:l,onClick:y,style:{padding:"8px 20px"},className:"jsx-82800555234e8b51 btn btn-primary",children:l?"Reabrindo...":"Reabrir Loja"})]}),(0,s.jsx)(o(),{id:"82800555234e8b51",children:"@-webkit-keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}@-moz-keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}@-o-keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}"})]})}function f(e){let{data:a,onRefresh:t}=e,i=(null==a?void 0:a.active_orders)||0,o=(null==a?void 0:a.queue_config)||{},n=(null==a?void 0:a.paused_products_count)||0,r=(null==a?void 0:a.paused_categories_count)||0,l=[{label:"Pedidos Ativos",value:i,color:i>0?"#3b82f6":"#94a3b8",icon:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"},{label:"Max Simultaneos",value:o.max_pedidos_simultaneos||"Ilimitado",color:"#8b5cf6",icon:"M4 6h16M4 12h8m-8 6h16"},{label:"Produtos Pausados",value:n,color:n>0?"#f59e0b":"#94a3b8",icon:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"},{label:"Categorias Pausadas",value:r,color:r>0?"#f59e0b":"#94a3b8",icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"}];return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16,marginTop:16},children:l.map((e,a)=>(0,s.jsxs)("div",{className:"card",style:{padding:20,textAlign:"center"},children:[(0,s.jsx)("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:e.color,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginBottom:8},children:(0,s.jsx)("path",{d:e.icon})}),(0,s.jsx)("div",{style:{fontSize:28,fontWeight:700,color:e.color},children:e.value}),(0,s.jsx)("div",{style:{fontSize:13,color:"var(--color-text-secondary)",marginTop:4},children:e.label})]},a))}),(null==a?void 0:a.paused_products)&&a.paused_products.length>0&&(0,s.jsxs)("div",{className:"card",style:{marginTop:16},children:[(0,s.jsxs)("div",{className:"card-header",children:[(0,s.jsx)("h2",{className:"card-title",children:"Produtos Pausados"}),(0,s.jsx)("span",{className:"badge badge-warning",children:a.paused_products.length})]}),(0,s.jsxs)("div",{style:{display:"grid",gap:0},children:[a.paused_products.slice(0,5).map((e,t)=>(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 0",borderBottom:t<Math.min(a.paused_products.length,5)-1?"1px solid var(--color-border)":"none"},children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{fontWeight:500,fontSize:14},children:e.name}),(0,s.jsx)("div",{style:{fontSize:12,color:"var(--color-text-secondary)"},children:e.category_name||"Sem categoria"})]}),(0,s.jsx)("span",{className:"badge badge-warning",children:"Pausado"})]},e.product_id)),a.paused_products.length>5&&(0,s.jsxs)("div",{style:{padding:"10px 0",fontSize:13,color:"var(--color-text-secondary)",textAlign:"center"},children:["e mais ",a.paused_products.length-5," produto(s)..."]})]})]})]})}function y(e){let{data:a,onRefresh:t}=e,{addNotification:i}=(0,p.l)(),[o,r]=(0,n.useState)(""),[l,c]=(0,n.useState)({}),[u,x]=(0,n.useState)(null),[h,m]=(0,n.useState)(""),g=(null==a?void 0:a.all_products)||[],f=(null==a?void 0:a.all_categories)||[],y=o?g.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())||(e.category_name||"").toLowerCase().includes(o.toLowerCase())):g,v={};y.forEach(e=>{let a=e.category_id||0,t=e.category_name||"Sem Categoria";v[a]||(v[a]={name:t,id:a,products:[]}),v[a].products.push(e)});let j=Object.values(v).sort((e,a)=>e.name.localeCompare(a.name));async function b(e,a){let s="product_".concat(e);c(e=>({...e,[s]:!0}));try{if(a){x({type:"product",id:e}),c(e=>({...e,[s]:!1}));return}await (0,d.sg)("/disponibilidade.php",{action:"resume_product",product_id:e}),i("Produto reativado","success"),t()}catch(e){i(e.message||"Erro","error")}finally{c(e=>({...e,[s]:!1}))}}async function N(e,a){let s="category_".concat(e);c(e=>({...e,[s]:!0}));try{if(a){x({type:"category",id:e}),c(e=>({...e,[s]:!1}));return}await (0,d.sg)("/disponibilidade.php",{action:"resume_category",category_id:e}),i("Categoria reativada","success"),t()}catch(e){i(e.message||"Erro","error")}finally{c(e=>({...e,[s]:!1}))}}async function _(){if(!u)return;let{type:e,id:a}=u,s="".concat(e,"_").concat(a);c(e=>({...e,[s]:!0}));try{"product"===e?(await (0,d.sg)("/disponibilidade.php",{action:"pause_product",product_id:a,motivo:h}),i("Produto pausado","success")):(await (0,d.sg)("/disponibilidade.php",{action:"pause_category",category_id:a,motivo:h}),i("Categoria pausada","success")),t()}catch(e){i(e.message||"Erro","error")}finally{c(e=>({...e,[s]:!1})),x(null),m("")}}return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{marginTop:16,marginBottom:16},children:(0,s.jsx)("input",{type:"text",className:"form-input",placeholder:"Buscar produto ou categoria...",value:o,onChange:e=>r(e.target.value),style:{maxWidth:400}})}),(0,s.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:16,flexWrap:"wrap"},children:[(0,s.jsxs)("span",{className:"badge badge-success",children:[g.filter(e=>e.ativo).length," ativos"]}),(0,s.jsxs)("span",{className:"badge badge-warning",children:[g.filter(e=>!e.ativo).length," pausados"]}),(0,s.jsxs)("span",{className:"badge badge-neutral",children:[g.length," total"]})]}),0===j.length?(0,s.jsx)("div",{className:"card",children:(0,s.jsx)("div",{className:"empty-state",children:(0,s.jsx)("div",{className:"empty-state-text",children:o?"Nenhum produto encontrado para esta busca":"Nenhum produto cadastrado"})})}):j.map(e=>{let a=function(e){let a=f.find(a=>a.category_id===e);if(a)return a.ativo;let t=v[e];return!t||t.products.some(e=>e.ativo)}(e.id),t=e.products.every(e=>e.ativo);e.products.some(e=>e.ativo);let i="category_".concat(e.id);return(0,s.jsxs)("div",{className:"card",style:{marginBottom:12},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 0",borderBottom:"1px solid var(--color-border)",marginBottom:4},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,s.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-text-secondary)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("path",{d:"M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{fontWeight:600,fontSize:15},children:e.name}),(0,s.jsxs)("div",{style:{fontSize:12,color:"var(--color-text-secondary)"},children:[e.products.length," produto(s) - ",e.products.filter(e=>e.ativo).length," ativo(s)"]})]})]}),e.id>0&&(0,s.jsx)("button",{className:"toggle-switch ".concat(a&&t?"toggle-on":""),onClick:()=>N(e.id,a&&t),disabled:!!l[i],type:"button",title:a&&t?"Pausar toda categoria":"Reativar toda categoria",children:(0,s.jsx)("span",{className:"toggle-knob"})})]}),(0,s.jsx)("div",{style:{display:"grid",gap:0},children:e.products.map((a,t)=>{let i="product_".concat(a.product_id);return(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 0 10px 28px",borderBottom:t<e.products.length-1?"1px solid var(--color-border)":"none",opacity:a.ativo?1:.6},children:[(0,s.jsx)("div",{style:{flex:1,minWidth:0},children:(0,s.jsx)("div",{style:{fontWeight:500,fontSize:14,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:a.name})}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,flexShrink:0},children:[!a.ativo&&(0,s.jsx)("span",{className:"badge badge-warning",style:{fontSize:11},children:"Pausado"}),(0,s.jsx)("button",{className:"toggle-switch ".concat(a.ativo?"toggle-on":""),onClick:()=>b(a.product_id,a.ativo),disabled:!!l[i],type:"button",children:(0,s.jsx)("span",{className:"toggle-knob"})})]})]},a.product_id)})})]},e.id)}),u&&(0,s.jsx)("div",{className:"modal-overlay",onClick:()=>{x(null),m("")},children:(0,s.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),style:{maxWidth:420},children:[(0,s.jsxs)("h3",{style:{fontSize:18,fontWeight:600,marginBottom:16},children:["Pausar ","product"===u.type?"Produto":"Categoria"]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{className:"form-label",children:"Motivo (opcional)"}),(0,s.jsx)("input",{type:"text",className:"form-input",placeholder:"Ex: Sem estoque, Em manutencao...",value:h,onChange:e=>m(e.target.value),maxLength:255})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:16},children:[(0,s.jsx)("button",{className:"btn btn-secondary",onClick:()=>{x(null),m("")},children:"Cancelar"}),(0,s.jsx)("button",{className:"btn btn-primary",onClick:_,children:"Confirmar Pausa"})]})]})})]})}function v(e){var a,t;let{data:i,onRefresh:o}=e,{addNotification:r}=(0,p.l)(),[l,c]=(0,n.useState)((null==i?void 0:null===(a=i.queue_config)||void 0===a?void 0:a.max_pedidos_simultaneos)||0),[u,x]=(0,n.useState)((null==i?void 0:null===(t=i.queue_config)||void 0===t?void 0:t.tempo_estimado_extra)||0),[h,m]=(0,n.useState)(!1);async function g(){m(!0);try{await (0,d.sg)("/disponibilidade.php",{action:"queue_config",max_pedidos_simultaneos:l,tempo_estimado_extra_minutos:u}),r("Configuracao de fila atualizada!","success"),o()}catch(e){r(e.message||"Erro ao salvar","error")}finally{m(!1)}}(0,n.useEffect)(()=>{var e,a;c((null==i?void 0:null===(e=i.queue_config)||void 0===e?void 0:e.max_pedidos_simultaneos)||0),x((null==i?void 0:null===(a=i.queue_config)||void 0===a?void 0:a.tempo_estimado_extra)||0)},[i]);let f=(null==i?void 0:i.active_orders)||0,y=l>0?Math.min(100,Math.round(f/l*100)):0;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"card",style:{marginTop:16},children:[(0,s.jsxs)("div",{className:"card-header",children:[(0,s.jsx)("h2",{className:"card-title",children:"Pedidos Ativos"}),(0,s.jsx)("span",{className:"badge badge-info",style:{fontSize:14},children:f})]}),l>0&&(0,s.jsxs)("div",{style:{marginTop:12},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13,color:"var(--color-text-secondary)",marginBottom:6},children:[(0,s.jsx)("span",{children:"Capacidade"}),(0,s.jsxs)("span",{children:[f," / ",l]})]}),(0,s.jsx)("div",{style:{background:"var(--color-surface)",borderRadius:8,height:12,overflow:"hidden"},children:(0,s.jsx)("div",{style:{width:"".concat(y,"%"),height:"100%",background:y>=90?"#ef4444":y>=70?"#f59e0b":"#10b981",borderRadius:8,transition:"width 0.3s ease"}})}),y>=90&&(0,s.jsx)("div",{style:{marginTop:8,fontSize:13,color:"#ef4444",fontWeight:500},children:"Capacidade quase esgotada! Considere pausar o recebimento de novos pedidos."})]}),0===l&&(0,s.jsx)("p",{style:{color:"var(--color-text-secondary)",fontSize:14,marginTop:8},children:"Sem limite definido. A loja aceita pedidos ilimitados simultaneamente."})]}),(0,s.jsxs)("div",{className:"card",style:{marginTop:16},children:[(0,s.jsx)("div",{className:"card-header",children:(0,s.jsx)("h2",{className:"card-title",children:"Configuracao da Fila"})}),(0,s.jsxs)("div",{style:{display:"grid",gap:24,maxWidth:500,marginTop:8},children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"form-label",children:"Maximo de pedidos simultaneos"}),(0,s.jsx)("p",{style:{fontSize:13,color:"var(--color-text-secondary)",marginBottom:8},children:"Quando atingir o limite, novos pedidos serao bloqueados ate que um pedido atual seja finalizado. Use 0 para ilimitado."}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,s.jsx)("input",{type:"range",min:"0",max:"50",step:"1",value:l,onChange:e=>c(parseInt(e.target.value)),style:{flex:1,accentColor:"var(--color-primary)"}}),(0,s.jsx)("div",{style:{background:"var(--color-surface)",borderRadius:8,padding:"6px 14px",fontWeight:700,fontSize:16,minWidth:60,textAlign:"center"},children:0===l?"--":l})]}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,color:"var(--color-text-muted)",marginTop:4},children:[(0,s.jsx)("span",{children:"Ilimitado"}),(0,s.jsx)("span",{children:"50"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"form-label",children:"Tempo extra estimado (minutos)"}),(0,s.jsx)("p",{style:{fontSize:13,color:"var(--color-text-secondary)",marginBottom:8},children:"Minutos adicionais ao tempo de preparo quando a loja estiver ocupada. Exibido ao cliente no checkout."}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,s.jsx)("input",{type:"range",min:"0",max:"120",step:"5",value:u,onChange:e=>x(parseInt(e.target.value)),style:{flex:1,accentColor:"var(--color-primary)"}}),(0,s.jsx)("div",{style:{background:"var(--color-surface)",borderRadius:8,padding:"6px 14px",fontWeight:700,fontSize:16,minWidth:60,textAlign:"center"},children:0===u?"--":"+".concat(u)})]}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,color:"var(--color-text-muted)",marginTop:4},children:[(0,s.jsx)("span",{children:"Sem acrescimo"}),(0,s.jsx)("span",{children:"120 min"})]})]})]}),(0,s.jsx)("button",{className:"btn btn-primary",onClick:g,disabled:h,style:{marginTop:20},children:h?"Salvando...":"Salvar Configuracao"})]})]})}function j(e){let{data:a,onRefresh:t}=e,{addNotification:i}=(0,p.l)(),[o,r]=(0,n.useState)(!1),[l,c]=(0,n.useState)(""),[u,x]=(0,n.useState)(""),[h,m]=(0,n.useState)(""),[g,f]=(0,n.useState)(!1),[y,v]=(0,n.useState)(null),j=(null==a?void 0:a.scheduled_pauses)||[];async function b(){if(!l||!u){i("Preencha as datas de inicio e fim","error");return}f(!0);try{await (0,d.sg)("/disponibilidade.php",{action:"schedule_pause",inicio:l,fim:u,motivo:h||"Pausa agendada"}),i("Pausa agendada com sucesso!","success"),r(!1),c(""),x(""),m(""),t()}catch(e){i(e.message||"Erro ao agendar","error")}finally{f(!1)}}async function N(e){v(e);try{await (0,d.sg)("/disponibilidade.php",{action:"delete_scheduled",pause_id:e}),i("Agendamento removido","success"),t()}catch(e){i(e.message||"Erro ao remover","error")}finally{v(null)}}function _(e){return e?new Date(e).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"--"}return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"card",style:{marginTop:16},children:[(0,s.jsxs)("div",{className:"card-header",children:[(0,s.jsx)("h2",{className:"card-title",children:"Pausas Agendadas"}),(0,s.jsx)("button",{className:"btn btn-primary",onClick:()=>r(!0),style:{fontSize:13,padding:"6px 14px"},children:"+ Agendar Pausa"})]}),0===j.length?(0,s.jsxs)("div",{className:"empty-state",style:{padding:"32px 0"},children:[(0,s.jsxs)("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-text-muted)",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",style:{marginBottom:12},children:[(0,s.jsx)("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),(0,s.jsx)("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),(0,s.jsx)("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),(0,s.jsx)("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),(0,s.jsx)("div",{className:"empty-state-text",children:"Nenhuma pausa agendada"}),(0,s.jsx)("p",{style:{fontSize:13,color:"var(--color-text-muted)",marginTop:4},children:"Agende pausas para feriados, ferias ou manutencao"})]}):(0,s.jsx)("div",{style:{display:"grid",gap:0},children:j.map((e,a)=>(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"14px 0",borderBottom:a<j.length-1?"1px solid var(--color-border)":"none",gap:12},children:[(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-warning)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,s.jsx)("polyline",{points:"12 6 12 12 16 14"})]}),(0,s.jsx)("span",{style:{fontWeight:600,fontSize:14},children:e.motivo||"Pausa agendada"})]}),(0,s.jsxs)("div",{style:{fontSize:13,color:"var(--color-text-secondary)",paddingLeft:24},children:[_(e.inicio)," ate ",_(e.fim),(0,s.jsxs)("span",{style:{marginLeft:8,color:"var(--color-text-muted)"},children:["(",function(e,a){if(!e||!a)return"--";let t=new Date(a).getTime()-new Date(e).getTime(),s=Math.floor(t/36e5),i=Math.floor(t%36e5/6e4);return s>0?"".concat(s,"h ").concat(i,"min"):"".concat(i,"min")}(e.inicio,e.fim),")"]})]})]}),(0,s.jsx)("button",{className:"btn btn-secondary",style:{fontSize:12,padding:"4px 10px",color:"var(--color-danger)"},onClick:()=>N(e.id),disabled:y===e.id,children:y===e.id?"...":"Remover"})]},e.id))})]}),(0,s.jsxs)("div",{className:"card",style:{marginTop:16,background:"var(--color-surface)"},children:[(0,s.jsx)("div",{className:"card-header",children:(0,s.jsx)("h2",{className:"card-title",children:"Dicas"})}),(0,s.jsxs)("ul",{style:{fontSize:13,color:"var(--color-text-secondary)",lineHeight:1.8,paddingLeft:20},children:[(0,s.jsx)("li",{children:"Agende pausas para feriados e dias de folga com antecedencia"}),(0,s.jsx)("li",{children:"Pausas agendadas sao ativadas automaticamente no horario definido"}),(0,s.jsx)("li",{children:"A loja reabre automaticamente apos o fim da pausa"}),(0,s.jsx)("li",{children:"Duracao maxima de cada pausa agendada: 7 dias"})]})]}),o&&(0,s.jsx)("div",{className:"modal-overlay",onClick:()=>r(!1),children:(0,s.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),style:{maxWidth:440},children:[(0,s.jsx)("h3",{style:{fontSize:18,fontWeight:600,marginBottom:16},children:"Agendar Pausa"}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{className:"form-label",children:"Inicio"}),(0,s.jsx)("input",{type:"datetime-local",className:"form-input",value:l,onChange:e=>c(e.target.value)})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{className:"form-label",children:"Fim"}),(0,s.jsx)("input",{type:"datetime-local",className:"form-input",value:u,onChange:e=>x(e.target.value)})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{className:"form-label",children:"Motivo (opcional)"}),(0,s.jsx)("input",{type:"text",className:"form-input",placeholder:"Ex: Feriado, Ferias, Manutencao...",value:h,onChange:e=>m(e.target.value),maxLength:255})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:20},children:[(0,s.jsx)("button",{className:"btn btn-secondary",onClick:()=>r(!1),children:"Cancelar"}),(0,s.jsx)("button",{className:"btn btn-primary",onClick:b,disabled:g||!l||!u,children:g?"Agendando...":"Agendar"})]})]})})]})}function b(e){let{data:a}=e,t=(null==a?void 0:a.pause_history)||[];function i(e){return e?new Date(e).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"--"}return(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"card",style:{marginTop:16},children:[(0,s.jsxs)("div",{className:"card-header",children:[(0,s.jsx)("h2",{className:"card-title",children:"Historico de Pausas"}),(0,s.jsxs)("span",{className:"badge badge-neutral",children:[t.length," registro(s)"]})]}),0===t.length?(0,s.jsxs)("div",{className:"empty-state",style:{padding:"32px 0"},children:[(0,s.jsx)("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-text-muted)",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",style:{marginBottom:12},children:(0,s.jsx)("path",{d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,s.jsx)("div",{className:"empty-state-text",children:"Nenhum registro de pausa"})]}):(0,s.jsx)("div",{style:{overflowX:"auto"},children:(0,s.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:14},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{style:{borderBottom:"2px solid var(--color-border)"},children:[(0,s.jsx)("th",{style:{textAlign:"left",padding:"10px 8px",color:"var(--color-text-secondary)",fontWeight:600,fontSize:12,textTransform:"uppercase"},children:"Tipo"}),(0,s.jsx)("th",{style:{textAlign:"left",padding:"10px 8px",color:"var(--color-text-secondary)",fontWeight:600,fontSize:12,textTransform:"uppercase"},children:"Motivo"}),(0,s.jsx)("th",{style:{textAlign:"left",padding:"10px 8px",color:"var(--color-text-secondary)",fontWeight:600,fontSize:12,textTransform:"uppercase"},children:"Inicio"}),(0,s.jsx)("th",{style:{textAlign:"left",padding:"10px 8px",color:"var(--color-text-secondary)",fontWeight:600,fontSize:12,textTransform:"uppercase"},children:"Fim"}),(0,s.jsx)("th",{style:{textAlign:"left",padding:"10px 8px",color:"var(--color-text-secondary)",fontWeight:600,fontSize:12,textTransform:"uppercase"},children:"Duracao"}),(0,s.jsx)("th",{style:{textAlign:"center",padding:"10px 8px",color:"var(--color-text-secondary)",fontWeight:600,fontSize:12,textTransform:"uppercase"},children:"Status"})]})}),(0,s.jsx)("tbody",{children:t.map((e,a)=>(0,s.jsxs)("tr",{style:{borderBottom:a<t.length-1?"1px solid var(--color-border)":"none"},children:[(0,s.jsx)("td",{style:{padding:"10px 8px"},children:(0,s.jsx)("span",{className:"badge ".concat(function(e){switch(e){case"manual":return"badge-info";case"scheduled":return"badge-warning";default:return"badge-neutral"}}(e.tipo)),children:function(e){switch(e){case"manual":return"Manual";case"scheduled":return"Agendada";case"auto":return"Automatica";default:return e}}(e.tipo)})}),(0,s.jsx)("td",{style:{padding:"10px 8px",maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.motivo||"--"}),(0,s.jsx)("td",{style:{padding:"10px 8px",whiteSpace:"nowrap",fontSize:13},children:i(e.inicio)}),(0,s.jsx)("td",{style:{padding:"10px 8px",whiteSpace:"nowrap",fontSize:13},children:i(e.fim)}),(0,s.jsx)("td",{style:{padding:"10px 8px",whiteSpace:"nowrap",fontSize:13},children:function(e,a){if(!e||!a)return"Indefinido";let t=new Date(a).getTime()-new Date(e).getTime();if(t<=0)return"Indefinido";let s=Math.floor(t/36e5),i=Math.floor(t%36e5/6e4);return s>24?"".concat(Math.floor(s/24),"d ").concat(s%24,"h"):s>0?"".concat(s,"h ").concat(i,"min"):"".concat(i,"min")}(e.inicio,e.fim)}),(0,s.jsx)("td",{style:{padding:"10px 8px",textAlign:"center"},children:e.ativo?(0,s.jsx)("span",{className:"badge badge-warning",children:"Ativa"}):(0,s.jsx)("span",{className:"badge badge-neutral",children:"Encerrada"})})]},e.id))})]})})]})})}}},function(e){e.O(0,[3448,29,565,2205,2971,2117,1744],function(){return e(e.s=5331)}),_N_E=e.O()}]);